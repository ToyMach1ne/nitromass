!function(t){BX.PopupWindowManager||(BX.PopupWindowManager={_popups:[],_currentPopup:null,create:function(t,e,o){var i=-1;if((i=this._getPopupIndex(t))!==-1)return this._popups[i];var s=new BX.PopupWindow(t,e,o);return BX.addCustomEvent(s,"onPopupShow",BX.delegate(this.onPopupShow,this)),BX.addCustomEvent(s,"onPopupClose",BX.delegate(this.onPopupClose,this)),BX.addCustomEvent(s,"onPopupDestroy",BX.delegate(this.onPopupDestroy,this)),this._popups.push(s),s},onPopupShow:function(t){null!==this._currentPopup&&this._currentPopup.close(),this._currentPopup=t},onPopupClose:function(t){this._currentPopup=null},onPopupDestroy:function(t){var e=-1;(e=this._getPopupIndex(t.uniquePopupId))!==-1&&(this._popups=BX.util.deleteFromArray(this._popups,e))},getCurrentPopup:function(){return this._currentPopup},isPopupExists:function(t){return this._getPopupIndex(t)!==-1},_getPopupIndex:function(t){for(var e=-1,o=0;o<this._popups.length;o++)if(this._popups[o].uniquePopupId==t)return o;return e}},BX.PopupWindow=function(e,o,i){if(BX.onCustomEvent("onPopupWindowInit",[e,o,i]),this.uniquePopupId=e,this.params=i||{},this.params.zIndex=parseInt(this.params.zIndex),this.params.zIndex=isNaN(this.params.zIndex)?0:this.params.zIndex,this.buttons=this.params.buttons&&BX.type.isArray(this.params.buttons)?this.params.buttons:[],this.offsetTop=BX.PopupWindow.getOption("offsetTop",0),this.offsetLeft=BX.PopupWindow.getOption("offsetLeft",0),this.firstShow=!1,this.bordersWidth=20,this.bindElementPos=null,this.closeIcon=null,this.angle=null,this.overlay=null,this.titleBar=null,this.bindOptions="object"==typeof this.params.bindOptions?this.params.bindOptions:{},this.isAutoHideBinded=!1,this.closeByEsc=!!this.params.closeByEsc,this.isCloseByEscBinded=!1,this.dragged=!1,this.dragPageX=0,this.dragPageY=0,this.params.events)for(var s in this.params.events)BX.addCustomEvent(this,s,this.params.events[s]);this.popupContainer=document.createElement("DIV"),BX.adjust(this.popupContainer,{props:{id:e},style:{zIndex:this.getZindex(),position:"absolute",display:"none",top:"0px",left:"0px"}});var n="popup-window";i.lightShadow&&(n+=" popup-window-light"),i.titleBar&&(n+=i.lightShadow?" popup-window-titlebar-light":" popup-window-titlebar"),i.className&&BX.type.isNotEmptyString(i.className)&&(n+=" "+i.className),this.popupContainer.innerHTML=['<table class="',n,'" cellspacing="0"> \t\t<tr class="popup-window-top-row"> \t\t\t<td class="popup-window-left-column"><div class="popup-window-left-spacer"></div></td> \t\t\t<td class="popup-window-center-column">',i.titleBar?'<div class="popup-window-titlebar" id="popup-window-titlebar-'+e+'"></div>':"",'</td> \t\t\t<td class="popup-window-right-column"><div class="popup-window-right-spacer"></div></td> \t\t</tr> \t\t<tr class="popup-window-content-row"> \t\t\t<td class="popup-window-left-column"></td> \t\t\t<td class="popup-window-center-column"><div class="popup-window-content" id="popup-window-content-',e,'"> \t\t\t</div></td> \t\t\t<td class="popup-window-right-column"></td> \t\t</tr> \t\t<tr class="popup-window-bottom-row"> \t\t\t<td class="popup-window-left-column"></td> \t\t\t<td class="popup-window-center-column"></td> \t\t\t<td class="popup-window-right-column"></td> \t\t</tr> \t</table>'].join(""),document.body.appendChild(this.popupContainer),i.closeIcon&&(this.popupContainer.appendChild(this.closeIcon=BX.create("a",{props:{className:"popup-window-close-icon",href:""},style:"object"==typeof i.closeIcon?i.closeIcon:{},events:{click:BX.proxy(this._onCloseIconClick,this)}})),BX.browser.IsIE()&&BX.adjust(this.closeIcon,{attrs:{hidefocus:"true"}})),this.contentContainer=BX("popup-window-content-"+e),this.titleBar=BX("popup-window-titlebar-"+e),this.buttonsContainer=this.buttonsHr=null,i.angle&&this.setAngle(i.angle),i.overlay&&this.setOverlay(i.overlay),this.setOffset(this.params),this.setBindElement(o),this.setTitleBar(this.params.titleBar),this.setContent(this.params.content),this.setButtons(this.params.buttons),this.params.bindOnResize!==!1&&BX.bind(t,"resize",BX.proxy(this._onResizeWindow,this))},BX.PopupWindow.prototype.setContent=function(t){this.contentContainer&&t&&(BX.type.isElementNode(t)?(BX.cleanNode(this.contentContainer),this.contentContainer.appendChild(t.parentNode?t.parentNode.removeChild(t):t),t.style.display="block"):BX.type.isString(t)?this.contentContainer.innerHTML=t:this.contentContainer.innerHTML="&nbsp;")},BX.PopupWindow.prototype.setButtons=function(t){if(this.buttons=t&&BX.type.isArray(t)?t:[],this.buttonsHr&&BX.remove(this.buttonsHr),this.buttonsContainer&&BX.remove(this.buttonsContainer),this.buttons.length>0&&this.contentContainer){for(var e=[],o=0;o<this.buttons.length;o++){var i=this.buttons[o];null!=i&&BX.is_subclass_of(i,BX.PopupWindowButton)&&(i.popupWindow=this,e.push(i.render()))}this.buttonsHr=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-hr popup-window-buttons-hr"},children:[BX.create("i",{})]})),this.buttonsContainer=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-buttons"},children:e}))}},BX.PopupWindow.prototype.setBindElement=function(t){t&&"object"==typeof t&&(BX.type.isDomNode(t)||BX.type.isNumber(t.top)&&BX.type.isNumber(t.left)?this.bindElement=t:BX.type.isNumber(t.clientX)&&BX.type.isNumber(t.clientY)&&(BX.fixEventPageXY(t),this.bindElement={left:t.pageX,top:t.pageY,bottom:t.pageY}))},BX.PopupWindow.prototype.getBindElementPos=function(t){if(BX.type.isDomNode(t))return BX.pos(t,!1);if(t&&"object"==typeof t)return BX.type.isNumber(t.bottom)||(t.bottom=t.top),t;var e=BX.GetWindowInnerSize(),o=BX.GetWindowScrollPos(),i=this.popupContainer.offsetWidth,s=this.popupContainer.offsetHeight;return{left:e.innerWidth/2-i/2+o.scrollLeft,top:e.innerHeight/2-s/2+o.scrollTop,bottom:e.innerHeight/2-s/2+o.scrollTop,windowSize:e,windowScroll:o,popupWidth:i,popupHeight:s}},BX.PopupWindow.prototype.setAngle=function(t){var e=this.params.lightShadow?"popup-window-light-angly":"popup-window-angly";if(null==this.angle){var o=this.bindOptions.position&&"top"==this.bindOptions.position?"bottom":"top",i=BX.PopupWindow.getOption("top"==o?"angleMinTop":"angleMinBottom",7);this.angle={element:BX.create("div",{props:{className:e+" "+e+"-"+o}}),position:o,offset:0,defaultOffset:Math.max(BX.type.isNumber(t.offset)?t.offset:0,i)},this.popupContainer.appendChild(this.angle.element)}if("object"==typeof t&&t.position&&BX.util.in_array(t.position,["top","right","bottom","left","hide"])&&(BX.removeClass(this.angle.element,e+"-"+this.angle.position),BX.addClass(this.angle.element,e+"-"+t.position),this.angle.position=t.position),"object"==typeof t&&BX.type.isNumber(t.offset)){var s=t.offset;"top"==this.angle.position?(this.angle.element.style.left=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinTop",7),s))+"px",this.angle.element.style.marginLeft="auto"):"right"==this.angle.position?this.angle.element.style.top=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinRight",2),s))+"px":"bottom"==this.angle.position?(this.angle.element.style.marginLeft=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinBottom",7),s))+"px",this.angle.element.style.left="auto"):"left"==this.angle.position&&(this.angle.element.style.top=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinLeft",2),s))+"px")}},BX.PopupWindow.prototype.setOffset=function(t){"object"==typeof t&&(t.offsetLeft&&BX.type.isNumber(t.offsetLeft)&&(this.offsetLeft=t.offsetLeft+BX.PopupWindow.getOption("offsetLeft",0)),t.offsetTop&&BX.type.isNumber(t.offsetTop)&&(this.offsetTop=t.offsetTop+BX.PopupWindow.getOption("offsetTop",0)))},BX.PopupWindow.prototype.setTitleBar=function(t){this.titleBar&&"object"==typeof t&&BX.type.isDomNode(t.content)&&(this.titleBar.innerHTML="",this.titleBar.appendChild(t.content),this.params.draggable&&(this.titleBar.parentNode.style.cursor="move",BX.bind(this.titleBar.parentNode,"mousedown",BX.proxy(this._startDrag,this))))},BX.PopupWindow.prototype.setClosingByEsc=function(t){t=!!t,t?(this.closeByEsc=!0,this.isCloseByEscBinded||(BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!0)):(this.closeByEsc=!1,this.isCloseByEscBinded&&(BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!1))},BX.PopupWindow.prototype.setOverlay=function(t){null==this.overlay&&(this.overlay={element:BX.create("div",{props:{className:"popup-window-overlay",id:"popup-window-overlay-"+this.uniquePopupId}})},this.adjustOverlayZindex(),this.resizeOverlay(),document.body.appendChild(this.overlay.element)),t&&t.opacity&&BX.type.isNumber(t.opacity)&&t.opacity>=0&&t.opacity<=100&&(BX.browser.IsIE()&&!BX.browser.IsIE9()?this.overlay.element.style.filter="alpha(opacity="+t.opacity+")":(this.overlay.element.style.filter="none",this.overlay.element.style.opacity=parseFloat(t.opacity/100).toPrecision(3))),t&&t.backgroundColor&&(this.overlay.element.style.backgroundColor=t.backgroundColor)},BX.PopupWindow.prototype.removeOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&BX.remove(this.overlay.element),this.overlay=null},BX.PopupWindow.prototype.hideOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.display="none")},BX.PopupWindow.prototype.showOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.display="block")},BX.PopupWindow.prototype.resizeOverlay=function(){if(null!=this.overlay&&null!=this.overlay.element){var t=BX.GetWindowScrollSize();this.overlay.element.style.width=t.scrollWidth+"px",this.overlay.element.style.height=t.scrollHeight+"px"}},BX.PopupWindow.prototype.getZindex=function(){return null!=this.overlay?BX.PopupWindow.getOption("popupOverlayZindex",1100)+this.params.zIndex:BX.PopupWindow.getOption("popupZindex",1e3)+this.params.zIndex},BX.PopupWindow.prototype.adjustOverlayZindex=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.zIndex=parseInt(this.popupContainer.style.zIndex)-1)},BX.PopupWindow.prototype.show=function(){this.firstShow||(BX.onCustomEvent(this,"onPopupFirstShow",[this]),this.firstShow=!0),BX.onCustomEvent(this,"onPopupShow",[this]),this.showOverlay(),this.popupContainer.style.display="block",this.adjustPosition(),BX.onCustomEvent(this,"onAfterPopupShow",[this]),this.closeByEsc&&!this.isCloseByEscBinded&&(BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!0),this.params.autoHide&&!this.isAutoHideBinded&&setTimeout(BX.proxy(function(){this.isAutoHideBinded=!0,BX.bind(this.popupContainer,"click",this.cancelBubble),BX.bind(document,"click",BX.proxy(this.close,this))},this),0)},BX.PopupWindow.prototype.isShown=function(){return"block"==this.popupContainer.style.display},BX.PopupWindow.prototype.cancelBubble=function(e){e||(e=t.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},BX.PopupWindow.prototype.close=function(t){if(this.isShown()){if(t&&!(BX.getEventButton(t)&BX.MSLEFT))return!0;BX.onCustomEvent(this,"onPopupClose",[this,t]),this.hideOverlay(),this.popupContainer.style.display="none",this.isCloseByEscBinded&&(BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!1),setTimeout(BX.proxy(this._close,this),0)}},BX.PopupWindow.prototype._close=function(){this.params.autoHide&&this.isAutoHideBinded&&(this.isAutoHideBinded=!1,BX.unbind(this.popupContainer,"click",this.cancelBubble),BX.unbind(document,"click",BX.proxy(this.close,this)))},BX.PopupWindow.prototype._onCloseIconClick=function(e){e=e||t.event,this.close(e),BX.PreventDefault(e)},BX.PopupWindow.prototype._onKeyUp=function(e){e=e||t.event,27==e.keyCode&&this.close(e)},BX.PopupWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupDestroy",[this]),BX.unbindAll(this),BX.remove(this.popupContainer),this.removeOverlay()},BX.PopupWindow.prototype.adjustPosition=function(t){t&&"object"==typeof t&&(this.bindOptions=t);var e=this.getBindElementPos(this.bindElement);if(this.bindOptions.forceBindPosition||null==this.bindElementPos||e.top!=this.bindElementPos.top||e.left!=this.bindElementPos.left){this.bindElementPos=e;var o=e.windowSize?e.windowSize:BX.GetWindowInnerSize(),i=e.windowScroll?e.windowScroll:BX.GetWindowScrollPos(),s=e.popupWidth?e.popupWidth:this.popupContainer.offsetWidth,n=e.popupHeight?e.popupHeight:this.popupContainer.offsetHeight,p=BX.PopupWindow.getOption("angleTopOffset",5),a=BX.PopupWindow.getOption("angleLeftOffset",15),l=this.bindElementPos.left+this.offsetLeft-(null!=this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])?a:0);if(!this.bindOptions.forceLeft&&l+s+this.bordersWidth>=o.innerWidth+i.scrollLeft&&o.innerWidth+i.scrollLeft-s-this.bordersWidth>0){var u=l;l=o.innerWidth+i.scrollLeft-s-this.bordersWidth,null!=this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])&&this.setAngle({offset:u-l+this.angle.defaultOffset})}else null!=this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])&&this.setAngle({offset:this.angle.defaultOffset+(l<0?l:0)});l<0&&(l=0);var h=0;this.bindOptions.position&&"top"==this.bindOptions.position?(h=this.bindElementPos.top-n-this.offsetTop-(null!=this.angle&&"bottom"==this.angle.position?p:0),h<0||!this.bindOptions.forceTop&&h<i.scrollTop?(h=this.bindElementPos.bottom+this.offsetTop,null!=this.angle&&(h+=p,this.setAngle({position:"top"}))):null!=this.angle&&"top"==this.angle.position?(h=h-p+BX.PopupWindow.getOption("positionTopXOffset",0),this.setAngle({position:"bottom"})):h+=BX.PopupWindow.getOption("positionTopXOffset",0)):(h=this.bindElementPos.bottom+this.offsetTop+(null!=this.angle&&"top"==this.angle.position?p:0),!this.bindOptions.forceTop&&h+n>o.innerHeight+i.scrollTop&&this.bindElementPos.top-n>=0?(h=this.bindElementPos.top-n,null!=this.angle&&(h-=p,this.setAngle({position:"bottom"})),h+=BX.PopupWindow.getOption("positionTopXOffset",0)):null!=this.angle&&"bottom"==this.angle.position&&(h+=p,this.setAngle({position:"top"}))),h<0&&(h=0),BX.adjust(this.popupContainer,{style:{top:h+"px",left:l+"px",zIndex:this.getZindex()}}),this.adjustOverlayZindex()}},BX.PopupWindow.prototype._onResizeWindow=function(t){this.isShown()&&(this.adjustPosition(),null!=this.overlay&&this.resizeOverlay())},BX.PopupWindow.prototype.move=function(t,e){var o=parseInt(this.popupContainer.style.left)+t,i=parseInt(this.popupContainer.style.top)+e;if("object"==typeof this.params.draggable&&this.params.draggable.restrict){o<0&&(o=0);var s=BX.GetWindowScrollSize(),n=this.popupContainer.offsetWidth,p=this.popupContainer.offsetHeight;o>s.scrollWidth-n&&(o=s.scrollWidth-n),i>s.scrollHeight-p&&(i=s.scrollHeight-p),i<0&&(i=0)}this.popupContainer.style.left=o+"px",this.popupContainer.style.top=i+"px"},BX.PopupWindow.prototype._startDrag=function(e){return e=e||t.event,BX.fixEventPageXY(e),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged=!1,BX.bind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.bind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.setCapture&&document.body.setCapture(),document.body.ondrag=BX.False,document.body.onselectstart=BX.False,document.body.style.cursor="move",document.body.style.MozUserSelect="none",this.popupContainer.style.MozUserSelect="none",BX.PreventDefault(e)},BX.PopupWindow.prototype._moveDrag=function(e){e=e||t.event,BX.fixEventPageXY(e),this.dragPageX==e.pageX&&this.dragPageY==e.pageY||(this.move(e.pageX-this.dragPageX,e.pageY-this.dragPageY),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged||(BX.onCustomEvent(this,"onPopupDragStart"),this.dragged=!0),BX.onCustomEvent(this,"onPopupDrag"))},BX.PopupWindow.prototype._stopDrag=function(t){return document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.ondrag=null,document.body.onselectstart=null,document.body.style.cursor="",document.body.style.MozUserSelect="",this.popupContainer.style.MozUserSelect="",BX.onCustomEvent(this,"onPopupDragEnd"),this.dragged=!1,BX.PreventDefault(t)},BX.PopupWindow.options={},BX.PopupWindow.setOptions=function(t){if(t&&"object"==typeof t)for(var e in t)BX.PopupWindow.options[e]=t[e]},BX.PopupWindow.getOption=function(t,e){return"undefined"!=typeof BX.PopupWindow.options[t]?BX.PopupWindow.options[t]:e},BX.PopupWindowButton=function(t){this.popupWindow=null,this.params=t||{},this.text=this.params.text||"",this.id=this.params.id||"",this.className=this.params.className||"",this.events=this.params.events||{},this.contextEvents={};for(var e in this.events)this.contextEvents[e]=BX.proxy(this.events[e],this);this.nameNode=BX.create("span",{props:{className:"popup-window-button-text"},text:this.text}),this.buttonNode=BX.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},children:[BX.create("span",{props:{className:"popup-window-button-left"}}),this.nameNode,BX.create("span",{props:{className:"popup-window-button-right"}})],events:this.contextEvents})},BX.PopupWindowButton.prototype.render=function(){return this.buttonNode},BX.PopupWindowButton.prototype.setName=function(t){this.text=t||"",this.nameNode&&(BX.cleanNode(this.nameNode),BX.adjust(this.nameNode,{text:this.text}))},BX.PopupWindowButton.prototype.setClassName=function(t){this.buttonNode&&(BX.type.isString(this.className)&&""!=this.className&&BX.removeClass(this.buttonNode,this.className),BX.addClass(this.buttonNode,t)),this.className=t},BX.PopupWindowButtonLink=function(t){BX.PopupWindowButtonLink.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"popup-window-button-link-text"},text:this.text,events:this.contextEvents}),this.buttonNode=BX.create("span",{props:{className:"popup-window-button popup-window-button-link"+(this.className.length>0?" "+this.className:""),id:this.id},children:[this.nameNode]})},BX.extend(BX.PopupWindowButtonLink,BX.PopupWindowButton),BX.PopupMenu={Data:{},currentItem:null,stack:[],onkeypresslistener:null,show:function(e,o,i,s,n){if(n||(n=0),n<this.stack.length)for(var p=this.stack.length-1;p>=n;p--)this.currentItem=this.stack.pop(),this.currentItem&&this.currentItem.popupWindow.close(),p>0&&(this.currentItem=this.stack[p-1]);this.Data[e]||(this.Data[e]={id:e,bindElement:o,params:s},this.Data[e].popupWindow=this.__createPopup(this.Data[e],i,s)),this.currentItem=this.Data[e],this.stack[n]=this.currentItem,this.currentItem.popupWindow.show(),this.onkeypresslistener||(this.onkeypresslistener=BX.delegate(function(e){e=e||t.event,e&&27==e.keyCode&&(this.currentItem=this.stack.pop(),this.currentItem&&this.currentItem.popupWindow.close(),this.stack.length>0&&(this.currentItem=this.stack[this.stack.length-1]))},this),BX.bind(document,"keypress",this.onkeypresslistener))},__createPopup:function(t,e,o){for(var i=[],s=0;s<e.length;s++){var n=e[s];if(n){if(s>0&&i.push(BX.create("div",{props:{className:"popup-window-hr"},html:"<i></i>"})),n.delimiter)var p=BX.create("span",{props:{className:"popup-window-delimiter"},html:"<i></i>"});else if(n.text&&BX.type.isNotEmptyString(n.text)){var p=BX.create(n.href?"a":"span",{props:{className:"menu-popup-item"+(BX.type.isNotEmptyString(n.className)?" "+n.className:"")},attrs:{title:n.title?n.title:"",onclick:n.onclick&&BX.type.isString(n.onclick)?n.onclick:null},events:n.onclick&&BX.type.isFunction(n.onclick)?{click:BX.proxy(n.onclick,t)}:null,html:'<span class="menu-popup-item-left"></span><span class="menu-popup-item-icon"></span><span class="menu-popup-item-text">'+n.text+'</span><span class="menu-popup-item-right"></span>'});n.href&&(p.href=n.href)}i.push(p)}}var a=new BX.PopupWindow("menu-popup-"+t.id,t.bindElement,{closeByEsc:!1,autoHide:"undefined"==typeof o.autoHide||o.autoHide,offsetTop:o.offsetTop?o.offsetTop:1,offsetLeft:o.offsetLeft?o.offsetLeft:0,lightShadow:"undefined"==typeof o.lightShadow||o.lightShadow,angle:"undefined"!=typeof o.angle&&o.angle,content:BX.create("div",{props:{className:"menu-popup"},children:[BX.create("div",{props:{className:"menu-popup-items"},children:i})]})});if(o&&o.events)for(var l in o.events)BX.addCustomEvent(a,l,o.events[l]);return a}},t.BXInputPopup=function(t){this.id=t.id||"bx-inp-popup-"+Math.round(1e6*Math.random()),this.handler=t.handler||!1,this.values=t.values||!1,this.pInput=t.input,this.bValues=!!this.values,this.defaultValue=t.defaultValue||"",this.openTitle=t.openTitle||"",this.className=t.className||"",this.noMRclassName=t.noMRclassName||"ec-no-rm",this.emptyClassName=t.noMRclassName||"ec-label";var e=this;this.curInd=!1,this.bValues?(this.pInput.onfocus=this.pInput.onclick=function(t){return this.value==e.defaultValue&&(this.value="",this.className=""),e.ShowPopup(),BX.PreventDefault(t)},this.pInput.onblur=function(){e.bShowed&&setTimeout(function(){e.ClosePopup(!0)},200),e.OnChange()}):(this.pInput.className=this.noMRclassName,this.pInput.onblur=BX.proxy(this.OnChange,this))},BXInputPopup.prototype={ShowPopup:function(){if(!this.bShowed){var t=this;if(!this.oPopup){for(var e,o=BX.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}}),i=0,s=this.values.length;i<s;i++)e=o.appendChild(BX.create("DIV",{props:{id:"bxecmr_"+i,title:this.values[i].DESCRIPTION},text:this.values[i].NAME,events:{mouseover:function(){this.className="bxecplloc-over"},mouseout:function(){this.className=""},click:function(){var e=this.id.substr("bxecmr_".length);t.pInput.value=t.values[e].NAME,t.curInd=e,t.OnChange(),t.ClosePopup(!0)}}})),this.values[i].URL&&e.appendChild(BX.create("A",{props:{href:this.values[i].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}));this.oPopup=new BX.PopupWindow(this.id,this.pInput,{autoHide:!0,offsetTop:1,offsetLeft:0,lightShadow:!0,closeByEsc:!0,content:o}),BX.addCustomEvent(this.oPopup,"onPopupClose",BX.proxy(this.ClosePopup,this))}this.oPopup.show(),this.pInput.select(),this.bShowed=!0,BX.onCustomEvent(this,"onInputPopupShow",[this])}},ClosePopup:function(t){this.bShowed=!1,""==this.pInput.value&&this.OnChange(),BX.onCustomEvent(this,"onInputPopupClose",[this]),t===!0&&this.oPopup.close()},OnChange:function(){var t=this.pInput.value;this.bValues&&(""==this.pInput.value||this.pInput.value==this.defaultValue?(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName,t=""):this.pInput.className=""),isNaN(parseInt(this.curInd))||this.curInd!==!1&&t!=this.values[this.curInd].NAME?this.curInd=!1:this.curInd=parseInt(this.curInd),BX.onCustomEvent(this,"onInputPopupChanged",[this,this.curInd,t]),this.handler&&"function"==typeof this.handler&&this.handler({ind:this.curInd,value:t})},Set:function(t,e,o){this.curInd=t,this.curInd!==!1?this.pInput.value=this.values[this.curInd].NAME:this.pInput.value=e,o!==!1&&this.OnChange()},Get:function(t){var e=!1;return"undefined"==typeof t&&(t=this.curInd),t!==!1&&this.values[t]&&(e=this.values[t].ID),e},GetIndex:function(t){for(var e=0,o=this.values.length;e<o;e++)if(this.values[e].ID==t)return e;return!1},Deactivate:function(t){""!=this.pInput.value&&this.pInput.value!=this.defaultValue||(t?(this.pInput.value="",this.pInput.className=this.noMRclassName):this.oEC.bUseMR&&(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName)),this.pInput.disabled=t}})}(window);
//# sourceMappingURL=maps/core_popup.js.map
