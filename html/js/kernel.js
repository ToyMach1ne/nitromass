function CBXSession(){var t=this;this.mess={},this.timeout=null,this.sessid=null,this.bShowMess=!0,this.dateStart=new Date,this.dateInput=new Date,this.dateCheck=new Date,this.activityInterval=0,this.notifier=null,this.Expand=function(e,i,s,n){this.timeout=e,this.sessid=i,this.bShowMess=s,this.key=n,BX.ready(function(){BX.bind(document,"keypress",t.OnUserInput),BX.bind(document.body,"mousemove",t.OnUserInput),BX.bind(document.body,"click",t.OnUserInput),setTimeout(t.CheckSession,1e3*(t.timeout-60))})},this.OnUserInput=function(){var e=new Date;t.dateInput.setTime(e.valueOf())},this.CheckSession=function(){var e=new Date;if(!(e.valueOf()-t.dateCheck.valueOf()<3e4)){t.activityInterval=Math.round((t.dateInput.valueOf()-t.dateStart.valueOf())/1e3),t.dateStart.setTime(t.dateInput.valueOf());var i=t.activityInterval>t.timeout?t.timeout-60:t.activityInterval;BX.ajax.get("/bitrix/tools/public_session.php?sessid="+t.sessid+"&interval="+i+"&k="+t.key,function(e){t.CheckResult(e)})}},this.CheckResult=function(e){if("SESSION_EXPIRED"==e){if(t.bShowMess){t.notifier=document.body.appendChild(BX.create("DIV",{props:{className:"bx-session-message"},style:{top:"-1000px"},html:'<a class="bx-session-message-close" href="javascript:bxSession.Close()"></a>'+t.mess.messSessExpired}));var i=BX.GetWindowScrollPos(),s=BX.GetWindowInnerSize();t.notifier.style.left=parseInt(i.scrollLeft+s.innerWidth/2-parseInt(t.notifier.clientWidth)/2)+"px";var n=i.scrollTop-t.notifier.offsetHeight,o=i.scrollTop;new BX.fx({time:.5,step:.01,type:"accelerated",start:n,finish:o,callback:function(e){t.notifier.style.top=e+"px"},callback_complete:function(){BX.browser.IsIE()?BX.bind(window,"scroll",function(){var e=BX.GetWindowScrollPos();t.notifier.style.top=e.scrollTop+"px"}):(t.notifier.style.top="0px",t.notifier.style.position="fixed")}}).start()}}else{var a;a="SESSION_CHANGED"==e?t.timeout-60:t.activityInterval<60?60:t.activityInterval>t.timeout?t.timeout-60:t.activityInterval;var r=new Date;t.dateCheck.setTime(r.valueOf()),setTimeout(t.CheckSession,1e3*a)}},this.Close=function(){this.notifier.style.display="none"}}function BXSticker(t,e,i){this.MESS=i,this.Stickers=e||[],this.Params=t,this.sessid_get=t.sessid_get,this.bShowStickers=t.bShowStickers,this.curEditorStickerInd=!1,this.oneGifSrc="/bitrix/images/1.gif",this.colorSchemes=[{name:"bxst-yellow",color:"#FFFCB3",title:this.MESS.Yellow},{name:"bxst-green",color:"#DBFCCD",title:this.MESS.Green},{name:"bxst-blue",color:"#DCE7F7",title:this.MESS.Blue},{name:"bxst-red",color:"#FCDFDF",title:this.MESS.Red},{name:"bxst-purple",color:"#F6DAF8",title:this.MESS.Purple},{name:"bxst-gray",color:"#F5F5F5",title:this.MESS.Gray}],this.curPageCount=this.Params.curPageCount,this.Params.useHotkeys&&BX.bind(document,"keyup",BX.proxy(this.OnKeyUp,this)),window.__bxst_result={},t.bShowStickers&&this.Init(t)}function BXStickerList(t){this.BXSticker=t,this.access=this.BXSticker.access,this.MESS=this.BXSticker.MESS,this.arCurPageIds={}}function JCFloatDiv(){var t=this;this.floatDiv=null,this.x=this.y=0,this.Create=function(t){var e=document.body.appendChild(document.createElement("DIV"));return e.id=t.id,e.style.position="absolute",e.style.left="-10000px",e.style.top="-10000px",t.className&&(e.className=t.className),t.zIndex&&(e.style.zIndex=t.zIndex),t.width&&(e.style.width=t.width+"px"),t.height&&(e.style.height=t.height+"px"),e},this.Show=function(t,e,i,s,n,o){o!==!1&&(o=!0);var a=parseInt(t.style.zIndex);if((a<=0||isNaN(a))&&(a=100),t.style.zIndex=a,e<0&&(e=0),i<0&&(i=0),t.style.left=parseInt(e)+"px",t.style.top=parseInt(i)+"px",jsUtils.IsIE()&&o===!0){var r=document.getElementById(t.id+"_frame");r||(r=document.createElement("IFRAME"),r.src="javascript:''",r.id=t.id+"_frame",r.style.position="absolute",r.style.borderWidth="0px",r.style.zIndex=a-1,document.body.appendChild(r)),r.style.width=t.offsetWidth+"px",r.style.height=t.offsetHeight+"px",r.style.left=t.style.left,r.style.top=t.style.top,r.style.visibility="visible"}if(t.restrictDrag=n||!1,isNaN(s)&&(s=5),s>0){var l=document.getElementById(t.id+"_shadow");l||(jsUtils.IsIE()?(l=document.createElement("DIV"),l.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/shadow.png',sizingMethod='scale')"):(l=document.createElement("IMG"),l.src="/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/shadow.png"),l.id=t.id+"_shadow",l.style.position="absolute",l.style.zIndex=a-2,l.style.left="-1000px",l.style.top="-1000px",l.style.lineHeight="normal",l.className="bx-js-float-shadow",document.body.appendChild(l)),l.style.width=t.offsetWidth+"px",l.style.height=t.offsetHeight+"px",l.style.left=parseInt(t.style.left)+s+"px",l.style.top=parseInt(t.style.top)+s+"px",l.style.visibility="visible"}t.dxShadow=s},this.Close=function(t){if(t){var e=document.getElementById(t.id+"_shadow");e&&(e.style.visibility="hidden");var i=document.getElementById(t.id+"_frame");i&&(i.style.visibility="hidden")}},this.Move=function(t,e,i){if(t){var s=t.dxShadow,n=parseInt(t.style.left)+e,o=parseInt(t.style.top)+i;if(t.restrictDrag){n<0&&(n=0),document.compatMode&&"CSS1Compat"==document.compatMode?windowWidth=document.documentElement.scrollWidth:document.body.scrollWidth>document.body.offsetWidth||document.compatMode&&"BackCompat"==document.compatMode||document.documentElement&&!document.documentElement.clientWidth?windowWidth=document.body.scrollWidth:windowWidth=document.body.offsetWidth;var a=t.offsetWidth;n>windowWidth-a-s&&(n=windowWidth-a-s),o<0&&(o=0)}t.style.left=n+"px",t.style.top=o+"px",this.AdjustShadow(t)}},this.HideShadow=function(t){var e=document.getElementById(t.id+"_shadow");e.style.visibility="hidden"},this.UnhideShadow=function(t){var e=document.getElementById(t.id+"_shadow");e.style.visibility="visible"},this.AdjustShadow=function(t){var e=document.getElementById(t.id+"_shadow");if(e&&"hidden"!=e.style.visibility){var i=t.dxShadow;e.style.width=t.offsetWidth+"px",e.style.height=t.offsetHeight+"px",e.style.left=parseInt(t.style.left)+i+"px",e.style.top=parseInt(t.style.top)+i+"px"}var s=document.getElementById(t.id+"_frame");s&&(s.style.width=t.offsetWidth+"px",s.style.height=t.offsetHeight+"px",s.style.left=t.style.left,s.style.top=t.style.top)},this.StartDrag=function(e,i){e||(e=window.event),this.x=e.clientX+document.body.scrollLeft,this.y=e.clientY+document.body.scrollTop,this.floatDiv=i,jsUtils.addEvent(document,"mousemove",this.MoveDrag),document.onmouseup=this.StopDrag,document.body.setCapture&&document.body.setCapture(),document.onmousedown=jsUtils.False;var s=document.body;s.ondrag=jsUtils.False,s.onselectstart=jsUtils.False,s.style.MozUserSelect=t.floatDiv.style.MozUserSelect="none",s.style.cursor="move"},this.StopDrag=function(e){document.body.releaseCapture&&document.body.releaseCapture(),jsUtils.removeEvent(document,"mousemove",t.MoveDrag),document.onmouseup=null,this.floatDiv=null,document.onmousedown=null;var i=document.body;i.ondrag=null,i.onselectstart=null,i.style.MozUserSelect=t.floatDiv.style.MozUserSelect="",i.style.cursor=""},this.MoveDrag=function(e){var i=e.clientX+document.body.scrollLeft,s=e.clientY+document.body.scrollTop;t.x==i&&t.y==s||(t.Move(t.floatDiv,i-t.x,s-t.y),t.x=i,t.y=s)}}function WaitOnKeyPress(t){t||(t=window.event),t&&27==t.keyCode&&CloseWaitWindow()}function ShowWaitWindow(){CloseWaitWindow();var t=jsUtils.GetWindowSize(),e=document.body.appendChild(document.createElement("DIV"));if(e.id="wait_window_div",e.innerHTML=phpVars.messLoading,e.className="waitwindow",e.style.right=5-t.scrollLeft+"px",e.style.top=t.scrollTop+5+"px",jsUtils.IsIE()){var i=document.createElement("IFRAME");i.src="javascript:''",i.id="wait_window_frame",i.className="waitwindow",i.style.width=e.offsetWidth+"px",i.style.height=e.offsetHeight+"px",i.style.right=e.style.right,i.style.top=e.style.top,document.body.appendChild(i)}jsUtils.addEvent(document,"keypress",WaitOnKeyPress)}function CloseWaitWindow(){jsUtils.removeEvent(document,"keypress",WaitOnKeyPress);var t=document.getElementById("wait_window_frame");t&&t.parentNode.removeChild(t);var e=document.getElementById("wait_window_div");e&&e.parentNode.removeChild(e)}function JCSplitter(t){this.params=t,this.Highlight=function(t){var e=document.getElementById(this.params.control),i=document.getElementById(this.params.divShown);"none"!=i.style.display?e.className=this.params.classShown+(t?"sel":""):e.className=this.params.classHidden+(t?"sel":"")},this.Toggle=function(){var t=jsUtils.ToggleDiv(this.params.divShown);return jsUtils.ToggleDiv(this.params.divHidden),this.Highlight(!1),document.getElementById(this.params.control).title=t?this.params.messHide:this.params.messShow,t}}function JCAdminMenu(t){var e=this;this.sMenuSelected="",this.x=0,this.divToResize=null,this.divToBound=null,this.toggle=!1,this.oSections={},this.request=new JCHttpRequest;var i=t.split(",");for(var s in i)this.oSections[i[s]]=!0;this.verSplitter=new JCSplitter({control:"vdividercell",divShown:"menudiv",divHidden:"hiddenmenucontainer",messHide:phpVars.messHideMenu,messShow:phpVars.messShowMenu,classShown:"vdividerknob vdividerknobleft",classHidden:"vdividerknob vdividerknobright"}),this.horSplitter=new JCSplitter({control:"hdividercell",divShown:"buttonscontainer",divHidden:"smbuttonscontainer",messHide:phpVars.messHideButtons,messShow:phpVars.messShowButtons,classShown:"hdividerknob hdividerknobup",classHidden:"hdividerknob hdividerknobdown"}),this.verSplitterToggle=function(){var t=this.verSplitter.Toggle();jsUserOptions.SaveOption("admin_menu","pos","ver",t?"on":"off")},this.horSplitterToggle=function(){var t=this.horSplitter.Toggle();jsUserOptions.SaveOption("admin_menu","pos","hor",t?"on":"off")},this.ToggleMenu=function(t,e){var i=document.getElementById(t);"none"==i.style.display&&(""!=this.sMenuSelected&&(document.getElementById(this.sMenuSelected).style.display="none"),i.style.display="block",document.getElementById("menutitle").innerHTML=e,document.getElementById("btn_"+this.sMenuSelected).className="button",document.getElementById("smbtn_"+this.sMenuSelected).className="smbutton",document.getElementById("btn_"+t).className="button buttonsel",document.getElementById("smbtn_"+t).className="smbutton smbuttonsel",this.sMenuSelected=t)},this.StartDrag=function(){if(!this.toggle&&"none"!=document.getElementById("menudiv").style.display){this.divToBound=document.getElementById("menu_min_width"),this.divToResize=document.getElementById("menucontainer"),this.x=this.divToResize.offsetWidth,jsUtils.addEvent(document,"mousemove",e.ResizeMenu),document.onmouseup=this.StopDrag;var t=document.body;t.ondrag=jsUtils.False,t.onselectstart=jsUtils.False,t.style.MozUserSelect="none",t.style.cursor="e-resize"}},this.StopDrag=function(t){jsUtils.removeEvent(document,"mousemove",e.ResizeMenu),document.onmouseup=null;var i=document.body;i.ondrag=null,i.onselectstart=null,i.style.MozUserSelect="",i.style.cursor="",window.onresize&&window.onresize(),jsUserOptions.SaveOption("admin_menu","pos","width",parseInt(e.divToResize.style.width))},this.ResizeMenu=function(t){var i=t.clientX+document.body.scrollLeft;if(e.x!=i){var s=e.divToResize,n=e.divToBound;if(i<n.offsetWidth)return s.style.width=n.offsetWidth+"px",void(e.x=i);s.style.width=s.offsetWidth+(i-e.x)+"px",e.x=i}},this.ToggleSection=function(t,e,i){if(jsUtils.ToggleDiv(e)?(i<=2&&(this.oSections[e]=!0),t.className="sign signminus"):(this.oSections[e]=!1,t.className="sign signplus"),i<=2){var s="";for(var n in this.oSections)1==this.oSections[n]&&(s+=(""!=s?",":"")+n);jsUserOptions.SaveOption("admin_menu","pos","sections",s)}},this.ToggleDynSection=function(t,e,i,s){function n(t){for(var e="",i=0;i<s;i++)e+='<td><div class="menuindent"></div></td>\n';return'<div class="menuline"><table cellspacing="0">\t<tr>'+e+'\t\t<td class="menutext menutext-loading">'+t+"</td>\t</tr></table></div>"}var o=document.getElementById(i);""==o.innerHTML&&(o.innerHTML=n(phpVars.messMenuLoading),this.request.Action=function(t){t=jsUtils.trim(t),o.innerHTML=""!=t?t:n(phpVars.messNoData)},this.request.Send("/bitrix/admin/get_menu.php?lang="+phpVars.LANGUAGE_ID+"&admin_mnu_module_id="+e+"&admin_mnu_menu_id="+encodeURIComponent(i))),this.ToggleSection(t,i,s)}}function JCAdminList(t){var e=this;this.table_id=t,this.InitTable=function(){var t=document.getElementById(this.table_id);if(!(!t||t.rows.length<1||t.rows[0].cells.length<1)){var i,s=t.rows[0].cells.length,n=-1;for(i=0;i<s;i++){var o,a=t.rows[1].cells[i],r=jsUtils.FindChildObject(a,"table","sorting");for(o=0;o<2;o++){var l=t.rows[o].cells[i];if(l.onmouseover=function(){e.HighlightGutter(this,!0)},l.onmouseout=function(){e.HighlightGutter(this,!1)},r&&(l.onclick=r.onclick,l.title=r.title,l.style.cursor="pointer",0==o)){var d=r.rows[0].cells[1].className.toLowerCase();"sign up"!=d&&"sign down"!=d||(l.className+=" sorted",n=i)}}r&&(r.onclick=null)}var h=t.rows.length;for(i=0;i<h;i++){var c=t.rows[i];if(c.cells[0].className+=" left",c.cells[c.cells.length-1].className+=" right",(!c.className||"footer"!=c.className)&&(n!=-1&&n<c.cells.length&&(c.cells[n].className+=" sorted"),i>=2)){var p=c.cells[0].childNodes[0];p&&p.tagName&&"INPUT"==p.tagName.toUpperCase()&&"CHECKBOX"==p.type.toUpperCase()&&(p.onclick=function(){e.SelectRow(this),e.EnableActions()},jsUtils.addEvent(c,"click",e.OnClickRow)),c.onmouseover=function(){e.HighlightRow(this,!0)},c.onmouseout=function(){e.HighlightRow(this,!1)},i%2==0?c.className+=" odd":c.className+=" even",c.oncontextmenu&&jsUtils.addEvent(c,"contextmenu",function(t){if(t||(t=window.event),!(!phpVars.opt_context_ctrl&&t.ctrlKey||phpVars.opt_context_ctrl&&!t.ctrlKey)){var i;for(t.target?i=t.target:t.srcElement&&(i=t.srcElement);i&&!i.oncontextmenu;)i=jsUtils.FindParentObject(i,"tr");var s=t.clientX+document.body.scrollLeft,n=t.clientY+document.body.scrollTop,o={};o.left=o.right=s,o.top=o.bottom=n;var a=window[e.table_id+"_menu"];a.PopupHide(),a.SetItems(i.oncontextmenu()),a.BuildItems(),a.PopupShow(o),t.returnValue=!1,t.preventDefault&&t.preventDefault()}})}}t.rows.length>2&&(t.rows[2].className+=" top",t.rows[t.rows.length-1].className+=" bottom")}},this.Destroy=function(t){var i=document.getElementById(this.table_id);if(!(!i||i.rows.length<1||i.rows[0].cells.length<1)){var s,n=i.rows[0].cells.length;for(s=0;s<n;s++){var o;for(o=0;o<2;o++){var a=i.rows[o].cells[s];a.onmouseover=null,a.onmouseout=null,a.onclick=null}}var r=i.rows.length;for(s=0;s<r;s++){var l=i.rows[s],d=l.cells[0].childNodes[0];d&&d.onclick&&(d.onclick=null),l.onmouseover=null,l.onmouseout=null,jsUtils.removeAllEvents(l)}1==t&&(e=null)}},this.HighlightGutter=function(t,e){var i=t.parentNode.parentNode.parentNode,s=i.rows[0].cells[t.cellIndex];e?s.className+=" over":s.className=s.className.replace(/\s*over/i,"")},this.HighlightRow=function(t,e){e?t.className+=" over":t.className=t.className.replace(/\s*over/i,"")},this.SelectRow=function(t){var e=t.parentNode.parentNode,i=e.parentNode.parentNode,s=document.getElementById(i.id+"_selected_span"),n=parseInt(s.innerHTML);t.checked?(e.className+=" selected",n++):(e.className=e.className.replace(/\s*selected/gi,""),n--),s.innerHTML=n;var o=document.getElementById(i.id+"_check_all");n==i.rows.length-2?o.checked=!0:o.checked=!1},this.OnClickRow=function(t){if(!t)var t=window.event;if(t.ctrlKey){var i=t.target?t.target:t.srcElement?t.srcElement:null;if(i&&i.parentNode.cells){var s=i.parentNode.cells[0].childNodes[0];s&&s.tagName&&"INPUT"==s.tagName.toUpperCase()&&"CHECKBOX"==s.type.toUpperCase()&&!s.disabled&&(s.checked=!s.checked,e.SelectRow(s)),e.EnableActions()}}},this.SelectAllRows=function(t){var e,i=t.parentNode.parentNode.parentNode.parentNode,s=t.checked,n=i.rows.length;for(e=2;e<n;e++){var o=i.rows[e].cells[0].childNodes[0];o&&o.tagName&&"INPUT"==o.tagName.toUpperCase()&&"CHECKBOX"==o.type.toUpperCase()&&(o.checked==s||o.disabled||(o.checked=s,this.SelectRow(o)))}this.EnableActions()},this.EnableActions=function(){var t=document.forms["form_"+this.table_id];if(t){var e=this.IsActionEnabled(),i=this.IsActionEnabled("edit");t.apply&&(t.apply.disabled=!e);var s=document.getElementById("action_edit_button");s&&(s.className="context-button icon action-edit-button"+(i?"":"-dis")),s=document.getElementById("action_delete_button"),s&&(s.className="context-button icon action-delete-button"+(e?"":"-dis"))}},this.IsActionEnabled=function(t){var e=document.forms["form_"+this.table_id];if(e){var i=!1,s=document.getElementById(this.table_id+"_selected_span");return s&&parseInt(s.innerHTML)>0&&(i=!0),"edit"==t?!(e.action_target&&e.action_target.checked)&&i:e.action_target&&e.action_target.checked||i}},this.SetActiveResult=function(t,i){CHttpRequest.Action=function(s){CloseWaitWindow(),e.Destroy(!1),document.getElementById(e.table_id+"_result_div").innerHTML=s,e.InitTable(),jsAdminChain.AddItems(e.table_id+"_navchain_div"),t&&t(i)}},this.GetAdminList=function(t,i){ShowWaitWindow();var s=new RegExp("&mode=list&table_id="+escape(e.table_id),"g");t=t.replace(s,"");var n=document.getElementById("navchain-link");n&&(n.href=t),t+=t.indexOf("?")>=0?"&mode=list&table_id="+escape(e.table_id):"?&mode=list&table_id="+escape(e.table_id),e.SetActiveResult(i,t),CHttpRequest.Send(t)},this.Sort=function(t,e,i){if(1==e){var s=null,n=!1;i.length>0&&(s=i[0]),s||(s=window.event),s&&(n=s.ctrlKey),t+=n?"desc":"asc"}this.GetAdminList(t)},this.PostAdminList=function(t){t+=t.indexOf("?")>=0?"&mode=frame&table_id="+escape(this.table_id):"?mode=frame&table_id="+escape(this.table_id);var e=document.getElementById("form_"+this.table_id);try{e.action.act.parentNode.removeChild(e.action)}catch(i){}e.action=t,e.onsubmit(),e.submit()},this.ShowSettings=function(t){document.getElementById("settings_float_div")||(CHttpRequest.Action=function(t){if(CloseWaitWindow(),""!=t){var i=document.body.appendChild(document.createElement("DIV"));i.id="settings_float_div",i.className="settings-float-form",i.style.position="absolute",i.style.zIndex=1e3,i.innerHTML=t;var s=parseInt(document.body.scrollLeft+document.body.clientWidth/2-i.offsetWidth/2),n=parseInt(document.body.scrollTop+document.body.clientHeight/2-i.offsetHeight/2);jsFloatDiv.Show(i,s,n),jsUtils.addEvent(document,"keypress",e.SettingsOnKeyPress)}},ShowWaitWindow(),CHttpRequest.Send(t))},this.CloseSettings=function(){jsUtils.removeEvent(document,"keypress",e.SettingsOnKeyPress);var t=document.getElementById("settings_float_div");jsFloatDiv.Close(t),t.parentNode.removeChild(t)},this.SettingsOnKeyPress=function(t){t||(t=window.event),t&&27==t.keyCode&&e.CloseSettings()},this.SaveSettings=function(){ShowWaitWindow();for(var t="",i="",s="",n="",o=document.list_settings.selected_columns,a=o.length,r=0;r<a;r++)t+=(""!=t?",":"")+o[r].value;o=document.list_settings.order_field,o&&(i=o[o.selectedIndex].value),o=document.list_settings.order_direction,o&&(s=o[o.selectedIndex].value),o=document.list_settings.nav_page_size,n=o[o.selectedIndex].value;var l=document.list_settings.set_default&&document.list_settings.set_default.checked;jsUserOptions.SaveOption("list",this.table_id,"columns",t,l),jsUserOptions.SaveOption("list",this.table_id,"by",i,l),jsUserOptions.SaveOption("list",this.table_id,"order",s,l),jsUserOptions.SaveOption("list",this.table_id,"page_size",n,l);var d=window.location.href;jsUserOptions.SendData(function(){e.GetAdminList(d,e.CloseSettings)})},this.DeleteSettings=function(t){ShowWaitWindow();var i=window.location.href;jsUserOptions.DeleteOption("list",this.table_id,t,function(){e.GetAdminList(i,e.CloseSettings)})}}function TabControl(name,unique_name,aTabs){var _this=this;this.name=name,this.unique_name=unique_name,this.aTabs=aTabs,this.aTabsDisabled={},this.bExpandTabs=!1,this.AUTOSAVE=null;var auto_lnk=BX(this.name+"_autosave_link");auto_lnk&&(auto_lnk.title=BX.message("AUTOSAVE_T"),BX.addCustomEvent("onAutoSavePrepare",function(t,e){BX.bind(auto_lnk,"click",BX.proxy(t.Save,t))}),BX.addCustomEvent("onAutoSave",function(){auto_lnk.className="context-button bx-core-autosave bx-core-autosave-saving"}),BX.addCustomEvent("onAutoSaveFinished",function(t,e){e=parseInt(e),isNaN(e)||(setTimeout(function(){auto_lnk.className="context-button bx-core-autosave bx-core-autosave-ready"},1e3),auto_lnk.title=BX.message("AUTOSAVE_L").replace("#DATE#",BX.formatDate(new Date(1e3*e))))}),BX.addCustomEvent("onAutoSaveInit",function(){auto_lnk.className="context-button bx-core-autosave bx-core-autosave-edited"})),this.NextTab=function(){var t=BX.findChild(document,{className:"tab-selected"},!0);if(t)var e=t.id.substr(4);else var t=BX.findChild(document,{className:"tab-container-selected"},!0),e=t.id.substr(9);for(var i="",s=0;s<this.aTabs.length;s++)e==this.aTabs[s].DIV&&(i=s>=this.aTabs.length-1?this.aTabs[0]:this.aTabs[s+1]);i.DIV&&this.SelectTab(i.DIV)},this.SelectTab=function(tab_id){var div=document.getElementById(tab_id);if("none"==div.style.display){for(var i=0,cnt=this.aTabs.length;i<cnt;i++){var tab=document.getElementById(this.aTabs[i].DIV);if("none"!=tab.style.display){this.ShowTab(this.aTabs[i].DIV,!1),tab.style.display="none";break}}this.ShowTab(tab_id,!0),div.style.display="block",document.getElementById(this.name+"_active_tab").value=tab_id;for(var i=0,cnt=this.aTabs.length;i<cnt;i++)if(this.aTabs[i].DIV==tab_id){this.aTabs[i]._ACTIVE=!0,this.aTabs[i].ONSELECT&&eval(this.aTabs[i].ONSELECT);break}}},this.ShowTab=function(t,e){var i=e?"-selected":"";try{document.getElementById("tab_cont_"+t).className="tab-container"+i,document.getElementById("tab_left_"+t).className="tab-left"+i,document.getElementById("tab_"+t).className="tab"+i,t!=this.aTabs[this.aTabs.length-1].DIV?document.getElementById("tab_right_"+t).className="tab-right"+i:document.getElementById("tab_right_"+t).className="tab-right-last"+i}catch(s){}},this.HoverTab=function(t,e){var i=document.getElementById("tab_"+t);if("tab-selected"!=i.className){document.getElementById("tab_left_"+t).className=e?"tab-left-hover":"tab-left",i.className=e?"tab-hover":"tab";var s=document.getElementById("tab_right_"+t);t!=this.aTabs[this.aTabs.length-1].DIV?s.className=e?"tab-right-hover":"tab-right":s.className=e?"tab-right-last-hover":"tab-right-last"}},this.InitEditTables=function(){for(var t=0,e=this.aTabs.length;t<e;t++){var i=document.getElementById(this.aTabs[t].DIV),s=jsUtils.FindChildObject(i.firstChild,"table","edit-table");if(!s){var s=jsUtils.FindChildObject(i,"table","edit-table");if(!s)continue}for(var n=s.rows.length,o=0;o<n;o++)s.rows[o].cells.length>1&&(s.rows[o].cells[0].className="field-name")}},this.DisableTab=function(t){if(this.aTabsDisabled[t]=!0,this.ShowDisabledTab(t,!0),this.bExpandTabs){var e=document.getElementById(t);e.style.display="none"}},this.EnableTab=function(t){if(this.aTabsDisabled[t]=!1,this.ShowDisabledTab(t,this.bExpandTabs),this.bExpandTabs){var e=document.getElementById(t);e.style.display="block"}},this.ShowDisabledTab=function(t,e){var i=document.getElementById("tab_cont_"+t);e?(i.className="tab-container-disabled",i.onclick=null,i.onmouseover=null,i.onmouseout=null):(i.className="tab-container",i.onclick=function(){_this.SelectTab(t)},i.onmouseover=function(){_this.HoverTab(t,!0)},i.onmouseout=function(){_this.HoverTab(t,!1)})},this.Destroy=function(){for(var t=0,e=this.aTabs.length;t<e;t++){var i=document.getElementById("tab_cont_"+this.aTabs[t].DIV);i&&(i.onclick=null,i.onmouseover=null,i.onmouseout=null)}_this=null},this.ToggleTabs=function(){this.bExpandTabs=!this.bExpandTabs;var t=document.getElementById(this.name+"_expand_link");t.title=this.bExpandTabs?phpVars.messCollapseTabs:phpVars.messExpandTabs,t.className=this.bExpandTabs?t.className.replace(/\s*down/gi," up"):t.className.replace(/\s*up/gi," down");for(var e in this.aTabs){var i=this.aTabs[e].DIV;this.ShowTab(i,!1),this.ShowDisabledTab(i,this.bExpandTabs||this.aTabsDisabled[i]);var s=document.getElementById(i);if(s.style.display=this.bExpandTabs&&!this.aTabsDisabled[i]?"block":"none",e>0){var n=jsUtils.FindChildObject(s.firstChild,"table","edit-tab-title");if(this.bExpandTabs)try{n.rows[0].style.display="table-row"}catch(o){n.rows[0].style.display="block"}else n.rows[0].style.display="none"}}if(!this.bExpandTabs){this.ShowTab(this.aTabs[0].DIV,!0);var s=document.getElementById(this.aTabs[0].DIV);s.style.display="block"}jsUserOptions.SaveOption("edit",this.unique_name,"expand",this.bExpandTabs?"on":"off"),jsUtils.onCustomEvent("OnToggleTabs")},this.ShowWarnings=function(t,e){var i=document.forms[t];if(i)for(var s in e){var n=i.elements[e[s].name];if(n){var o=n.type?n.type.toLowerCase():"",a=!1;n.length>1&&"select-one"!=o&&"select-multiple"!=o&&(n=n[0],a=!0),"textarea"!=o&&"select-multiple"!=o||(a=!0);var r,l=n.parentNode;a?(r=l.insertBefore(new Image,n),l.insertBefore(document.createElement("BR"),n)):(r=l.insertBefore(new Image,n.nextSibling),r.hspace=2,r.vspace=2,r.style.verticalAlign="bottom"),r.src="/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/images/icon_warn.gif",r.title=e[s].title}}},this.ShowSettings=function(t){document.getElementById("settings_float_div")||(CHttpRequest.Action=function(t){if(CloseWaitWindow(),""!=t){var e=document.body.appendChild(document.createElement("DIV"));e.id="settings_float_div",e.className="settings-float-form",e.style.position="absolute",e.style.zIndex=1e3,e.innerHTML=t;var i=parseInt(document.body.scrollLeft+document.body.clientWidth/2-e.offsetWidth/2),s=parseInt(document.body.scrollTop+document.body.clientHeight/2-e.offsetHeight/2);jsFloatDiv.Show(e,i,s),jsUtils.addEvent(document,"keypress",_this.SettingsOnKeyPress)}},ShowWaitWindow(),CHttpRequest.Send(t))},this.CloseSettings=function(){jsUtils.removeEvent(document,"keypress",_this.SettingsOnKeyPress);var t=document.getElementById("settings_float_div");jsFloatDiv.Close(t),t.parentNode.removeChild(t)},this.SettingsOnKeyPress=function(t){t||(t=window.event),t&&27==t.keyCode&&_this.CloseSettings()},this.SaveSettings=function(){ShowWaitWindow();var t,e="",i="",s=document.getElementById("selected_tabs");if(s)for(var n=s.length,o=0;o<n;o++){if(i=s[o].value+"--#--"+s[o].text,t=document.getElementById("selected_fields["+s[o].value+"]"))for(var a=t.length,r=0;r<a;r++)i+="--,--"+t[r].value+"--#--"+jsUtils.trim(t[r].text);e+=i+"--;--"}var l=document.form_settings.set_default&&document.form_settings.set_default.checked,d=new JCHttpRequest;d.Action=function(){BX.reload()};var h="";h+="&p[0][c]=form",h+="&p[0][n]="+encodeURIComponent(this.name),l&&(h+="&p[0][d]=Y"),h+="&p[0][v][tabs]="+encodeURIComponent(e);var c="/bitrix/admin/user_options.php?lang="+phpVars.LANGUAGE_ID+"&sessid="+phpVars.bitrix_sessid;c+="&action=delete&c=form&n="+this.name+"_disabled",d.Post(c,h)},this.DeleteSettings=function(t){ShowWaitWindow(),jsUserOptions.DeleteOption("form",this.name,t,function(){BX.reload()})},this.DisableSettings=function(){var t=new JCHttpRequest;t.Action=function(){BX.reload()};var e="";e+="&p[0][c]=form",e+="&p[0][n]="+encodeURIComponent(this.name+"_disabled"),e+="&p[0][v][disabled]=Y",t.Send("/bitrix/admin/user_options.php?lang="+phpVars.LANGUAGE_ID+e+"&sessid="+phpVars.bitrix_sessid)},this.EnableSettings=function(){var t=new JCHttpRequest;t.Action=function(){BX.reload()};var e="";e+="&c=form",e+="&n="+encodeURIComponent(this.name)+"_disabled",e+="&action=delete",t.Send("/bitrix/admin/user_options.php?lang="+phpVars.LANGUAGE_ID+e+"&sessid="+phpVars.bitrix_sessid)}}function ViewTabControl(aTabs){var _this=this;this.aTabs=aTabs,this.SelectTab=function(tab_id){var div=document.getElementById(tab_id);if("none"==div.style.display){for(var i in this.aTabs){var tab_div=document.getElementById(this.aTabs[i].DIV);if("none"!=tab_div.style.display){var tab=document.getElementById("view_tab_"+this.aTabs[i].DIV);tab.innerHTML=this.aTabs[i].HTML,tab.className="view-tab",this.ToggleDelimiter(tab,!0),tab_div.style.display="none";break}}var active_tab=document.getElementById("view_tab_"+tab_id);active_tab.className="view-tab view-tab-active",this.ToggleDelimiter(active_tab,!1),div.style.display="block",this.RebuildTabs();for(var i in this.aTabs)if(this.aTabs[i].DIV==tab_id){this.ReplaceAnchor(this.aTabs[i]),this.aTabs[i].ONSELECT&&eval(this.aTabs[i].ONSELECT);break}}},this.ToggleDelimiter=function(t,e){var i;(i=jsUtils.FindNextSibling(t,"div"))&&i.className.indexOf("view-tab-delimiter")!=-1&&(i.className="view-tab-delimiter"+(e?"":" view-tab-hide-delimiter")),(i=jsUtils.FindPreviousSibling(t,"div"))&&i.className.indexOf("view-tab-delimiter")!=-1&&(i.className="view-tab-delimiter"+(e?"":" view-tab-hide-delimiter"))},this.DisableTab=function(t){},this.EnableTab=function(t){},this.ReplaceAnchor=function(t){var e=document.getElementById("view_tab_"+t.DIV);t.HTML=e.innerHTML;var i=jsUtils.FindChildObject(e,"a");e.innerHTML=i.innerHTML},this.RebuildTabs=function(){for(var t,e=jsUtils.FindParentObject(document.getElementById("view_tab_"+_this.aTabs[0].DIV),"div"),i=[0],s=-1,n=-1,o=e.childNodes.length,a=0;a<o;a++){var r=e.childNodes[a];r.id&&(n>-1&&r.offsetTop>n&&(i[i.length]=a),n=r.offsetTop,s==-1&&r.className.indexOf("view-tab-active")!=-1&&(s=i.length-1),t=r)}if(s<i.length&&s>-1){for(var l=new Array,r=e.childNodes[i[s]],a=i[s];a<i[s+1];a++)l[l.length]=r,r=r.nextSibling;if(l.length>0){for(var a in l)e.removeChild(l[a]);for(;t.nextSibling&&(t=t.nextSibling,!t.tagName||"BR"!=t.tagName.toUpperCase()||!t.className||"tab-break"!=t.className););var d=document.createElement("BR");d.style.clear="both",e.insertBefore(d,t);for(var a in l)l[a].tagName&&"BR"==l[a].tagName.toUpperCase()||e.insertBefore(l[a],t)}}},this.Init=function(){if(0!=this.aTabs.length){for(var t in this.aTabs){var e=document.getElementById(this.aTabs[t].DIV);if("none"!=e.style.display){this.ReplaceAnchor(this.aTabs[t]),this.ToggleDelimiter(document.getElementById("view_tab_"+this.aTabs[t].DIV),!1);break}}setTimeout(this.RebuildTabs,10),window.onresize=this.RebuildTabs}},this.Init()}function JCHttpRequest(){this.Action=null,this._OnDataReady=function(t){this.Action&&this.Action(t)},this._CreateHttpObject=function(){var t=null;if(window.XMLHttpRequest)try{t=new XMLHttpRequest}catch(e){}else if(window.ActiveXObject){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}if(!t)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}return t},this._SetHandler=function(t){var e=this;t.onreadystatechange=function(){if(4==t.readyState){for(var i,s,n=t.responseText,o=[];(i=n.indexOf("<script>"))!=-1;){var s=n.indexOf("</script>",i);if(s==-1)break;o[o.length]=n.substr(i+8,s-i-8),n=n.substr(0,i)+n.substr(s+9)}e._OnDataReady(n);for(var a=0,r=o.length;a<r;a++)""!=o[a]&&jsUtils.EvalGlobal(o[a])}}},this.Send=function(t){var e=this._CreateHttpObject();if(e)return e.open("GET",t,!0),this._SetHandler(e),e.send("")},this.Post=function(t,e){var i=this._CreateHttpObject();if(i)return i.open("POST",t,!0),this._SetHandler(i),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.send(e)}}function JCUserOptions(){var t=this;this.options=null,this.bSend=!1,this.request=new JCHttpRequest,this.GetParams=function(){if(BX&&BX.userOptions)return t.GetParams=BX.userOptions.__get,t.GetParams.apply(BX.userOptions,arguments);var e="",i=-1,s="";for(var n in t.options){var o=t.options[n];s!=o[0]+"."+o[1]&&(i++,e+="&p["+i+"][c]="+encodeURIComponent(o[0]),e+="&p["+i+"][n]="+encodeURIComponent(o[1]),1==o[4]&&(e+="&p["+i+"][d]=Y"),s=o[0]+"."+o[1]),e+="&p["+i+"][v]["+encodeURIComponent(o[2])+"]="+encodeURIComponent(o[3])}return e.substr(1)},this.SaveOption=function(e,i,s,n,o){if(BX&&BX.userOptions)return t.SaveOption=BX.userOptions.save,t.SaveOption.apply(BX.userOptions,arguments);this.options||(this.options=new Object),1!=o&&(o=!1),this.options[e+"."+i+"."+s]=[e,i,s,n,o];var a=this.GetParams();""!=a&&(document.cookie=phpVars.cookiePrefix+"_LAST_SETTINGS="+a+"&sessid="+phpVars.bitrix_sessid+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"),this.bSend||(this.bSend=!0,setTimeout(function(){t.SendData(null)},5e3))},this.SendData=function(e){if(BX&&BX.userOptions)return t.SendData=BX.userOptions.send,t.SendData.apply(BX.userOptions,arguments);
var i=t.GetParams();t.options=null,t.bSend=!1,""!=i&&(document.cookie=phpVars.cookiePrefix+"_LAST_SETTINGS=; path=/;",t.request.Action=e,t.request.Send("/bitrix/admin/user_options.php?"+i+"&sessid="+phpVars.bitrix_sessid))},this.DeleteOption=function(e,i,s,n){return BX&&BX.userOptions?(t.DeleteOption=BX.userOptions.del,t.DeleteOption.apply(BX.userOptions,arguments)):(t.request.Action=n,void t.request.Send("/bitrix/admin/user_options.php?action=delete&c="+e+"&n="+i+(1==s?"&common=Y":"")+"&sessid="+phpVars.bitrix_sessid))}}function JCPanel(){var t=this;this.FixPanel=function(){var t=document.getElementById("admin_panel_fix_link"),e=document.getElementById("bx_top_panel_container"),i=document.getElementById("bx_top_panel_back"),s="fixed"==e.style.position||"absolute"==e.style.position,n=jsUtils.IsIE();if(n)try{e.style.removeExpression("top")}catch(o){n=!1}if(s){if(t.title=phpVars.messPanelFixOn,t.className="fix-link fix-on",e.style.position="",i.style.display="none",n){e.style.removeExpression("top"),e.style.removeExpression("left"),e.style.removeExpression("width"),e.style.width="100%";var a=document.getElementById("admin_panel_frame");a&&(a.style.visibility="hidden")}}else if(this.ShowOn(),n){var a=document.getElementById("admin_panel_frame");a?a.style.visibility="visible":this.CreateFrame(e)}jsUserOptions.SaveOption("admin_panel","settings","fix",s?"off":"on")},this.ShowOn=function(){var t=document.getElementById("admin_panel_fix_link"),e=document.getElementById("bx_top_panel_container"),i=document.getElementById("bx_top_panel_back"),s=jsUtils.IsIE();if(s)try{e.style.setExpression("top","0")}catch(n){s=!1}t.title=phpVars.messPanelFixOff,t.className="fix-link fix-off",e.style.position=s?"absolute":"fixed",e.style.left="0px",e.style.top="0px",e.style.zIndex="1000",s&&("none"==document.body.currentStyle.backgroundImage&&(document.body.style.backgroundImage="url(/bitrix/images/1.gif)",document.body.style.backgroundAttachment="fixed",document.body.style.backgroundRepeat="no-repeat"),e.style.setExpression("top","eval((document.documentElement && document.documentElement.scrollTop) ? document.documentElement.scrollTop : document.body.scrollTop)"),e.style.setExpression("left","eval((document.documentElement && document.documentElement.scrollLeft) ? document.documentElement.scrollLeft : document.body.scrollLeft)"),e.style.setExpression("width","eval((document.documentElement && document.documentElement.clientWidth) ? document.documentElement.clientWidth : document.body.clientWidth)")),i.style.height=e.offsetHeight+"px",i.style.display="block"},this.FixOn=function(){this.ShowOn(),jsUtils.addEvent(window,"load",this.AdjustBackDiv)},this.AdjustBackDiv=function(){var e=document.getElementById("bx_top_panel_container"),i=document.getElementById("bx_top_panel_back"),s=jsUtils.IsIE();if(s)try{i.style.setExpression("height","0")}catch(n){s=!1}i.style.height=e.offsetHeight+"px",s&&t.CreateFrame(e)},this.CreateFrame=function(t){var e=document.createElement("IFRAME");return e.src="javascript:void(0)",e.id="admin_panel_frame",e.style.position="absolute",e.style.overflow="hidden",e.style.zIndex=parseInt(t.currentStyle.zIndex)-1,e.style.height=t.offsetHeight+"px",document.body.appendChild(e),e.style.setExpression("top","eval(document.body.scrollTop)"),e.style.setExpression("left","eval(document.body.scrollLeft)"),e.style.setExpression("width","eval(document.body.clientWidth)"),e},this.IsFixed=function(){var t=document.getElementById("bx_top_panel_container");return t&&("fixed"==t.style.position||"absolute"==t.style.position)},this.DisplayPanel=function(t){var e=document.getElementById("bx_top_panel_splitter");"none"==e.style.display?(e.style.display="block",t.className="splitterknob",t.title=phpVars.messPanelCollapse,jsUserOptions.SaveOption("admin_panel","settings","collapsed","off")):(e.style.display="none",t.className="splitterknob splitterknobdown",t.title=phpVars.messPanelExpand,jsUserOptions.SaveOption("admin_panel","settings","collapsed","on"));var i=document.getElementById("bx_top_panel_container"),s=document.getElementById("bx_top_panel_back");s.style.height=i.offsetHeight+"px";var n=document.getElementById("admin_panel_frame");n&&(n.style.height=i.offsetHeight+"px")}}function JCDebugWindow(){var t=this;this.div_id="BX_DEBUG_WINDOW",this.div_current=null,this.div_detail_current=null,this.Show=function(t){var e=document.getElementById(this.div_id);if(e){e.style.display="block";var i=document.getElementById(t);i&&(this.div_current&&(this.div_current.style.display="none"),i.style.display="block",this.div_current=i,this.ShowDetails(t+"_1"));var s=jsUtils.GetWindowSize(),n=parseInt(s.scrollLeft+s.innerWidth/2-e.offsetWidth/2),o=parseInt(s.scrollTop+s.innerHeight/2-e.offsetHeight/2);jsFloatDiv.Show(e,n,o),jsUtils.addEvent(document,"keypress",this.OnKeyPress)}},this.Close=function(){jsUtils.removeEvent(document,"keypress",this.OnKeyPress);var t=document.getElementById(this.div_id);jsFloatDiv.Close(t),t.style.display="none"},this.OnKeyPress=function(e){e||(e=window.event),e&&27==e.keyCode&&t.Close()},this.ShowDetails=function(t){var e=document.getElementById(t);e&&(this.div_detail_current&&(this.div_detail_current.style.display="none"),e.style.display="block",this.div_detail_current=e)}}function ImgShw(t,e,i,s){var n="no",o=0,a=0;(e>screen.width-10||i>screen.height-28)&&(n="yes"),i<screen.height-28&&(o=Math.floor((screen.height-i)/2-14)),e<screen.width-10&&(a=Math.floor((screen.width-e)/2-5)),e=Math.min(e,screen.width-10),i=Math.min(i,screen.height-28);var r=window.open("","","scrollbars="+n+",resizable=yes,width="+e+",height="+i+",left="+a+",top="+o);r.document.write('<html><head><script type="text/javascript">function KeyPress(){\tif(window.event.keyCode == 27) \t\twindow.close();}</script><title></title></head><body topmargin="0" leftmargin="0" marginwidth="0" marginheight="0" onKeyPress="KeyPress()"><img src="'+t+'" border="0" alt="'+s+'" /></body></html>'),r.document.close()}function CWizardWindow(){this.iframe=null;var t=this;this.messLoading=phpVars.messLoading,this.Open=function(e,i){document.getElementById("wizard_install_dialog")&&this.Close();var s=document.body.appendChild(document.createElement("DIV"));s.id="wizard_install_dialog",s.className="settings-float-form",s.style.position="absolute",s.style.width="600px",s.style.height="400px",s.style.zIndex=2100,s.style.overflow="hidden",s.innerHTML='<div class="title" style="height:18px;"><table cellspacing="0" width="100%" border="0">\t<tr>\t\t<td width="100%" class="title-text" height="19" onmousedown="jsFloatDiv.StartDrag(arguments[0], document.getElementById(\'wizard_install_dialog\'));" id="wizard_dialog_title"></td></tr></table></div><div class="wizard" style="height:387px;"><iframe class="content" style="background-color: transparent;" allowtransparency="true" scrolling="no" id="wizard_iframe" width="100%" src="/bitrix/admin/wizard_install.php?lang='+phpVars.LANGUAGE_ID+"&wizardName="+e+"&sessid="+i+'" height="100%" frameborder="0"></iframe></div>',this.ShowWaitWindow();var n=parseInt(document.body.scrollLeft+document.body.clientWidth/2-s.offsetWidth/2),o=parseInt(document.body.scrollTop+document.body.clientHeight/2-s.offsetHeight/2);jsFloatDiv.Show(s,n,o),this.iframe=document.getElementById("wizard_iframe"),jsUtils.addEvent(this.iframe,"load",t.OnFrameLoad)},this.OnFrameLoad=function(){t.HideWaitWindow();var e=t.iframe.contentWindow;if(t.iframe.contentDocument)var i=t.iframe.contentDocument;else var i=t.iframe.contentWindow.document;e.focus?e.focus():i.body.focus();var s=i.forms.form_auth;s&&(s.target="_self")},this.Close=function(){var t=document.getElementById("wizard_install_dialog");jsFloatDiv.Close(t),t.parentNode.removeChild(t),t=null},this.ShowWaitWindow=function(){try{var t=document.createElement("DIV");t.id="__bx_wait_window",t.className="waitwindow",t.style.position="absolute",t.style.left="40%",t.style.top="40%",t.style.zIndex="3000",t.innerHTML=this.messLoading,document.getElementById("wizard_install_dialog").appendChild(t)}catch(e){}},this.HideWaitWindow=function(){try{var t=document.getElementById("__bx_wait_window");t.parentNode.removeChild(t),t=null}catch(e){}}}function JCStartMenu(){var menuStart=null,request=new JCHttpRequest,_this=this;this.EvalMenu=function(result){if(0!=jsUtils.trim(result).length){var menuItems;try{eval(result)}catch(e){}if(!menuItems)return!1;var head=document.getElementsByTagName("HEAD");if(head&&head[0]){var style=document.createElement("STYLE");head[0].appendChild(style),jsUtils.IsIE()?document.styleSheets[document.styleSheets.length-1].cssText=menuItems.styles:style.appendChild(document.createTextNode(menuItems.styles))}return menuItems}},this.ShowStartMenu=function(t,e){var i={left:0,top:0,right:0,bottom:0};menuStart&&menuStart.menuItems?menuStart.ShowMenu(t,null,jsPanel.IsFixed(),i):(request.Action=function(e){var s=_this.EvalMenu(e);s&&(menuStart.PopupHide(),menuStart.ShowMenu(t,s.items,jsPanel.IsFixed(),i))},menuStart=new PopupMenu("panel_start_menu"),menuStart.Create(1100),menuStart.ShowMenu(t,[{TEXT:phpVars.messMenuLoading,TITLE:phpVars.messMenuLoadingTitle,ICONCLASS:"loading",AUTOHIDE:!1}],jsPanel.IsFixed(),i),request.Send("/bitrix/admin/get_start_menu.php?lang="+phpVars.LANGUAGE_ID+(e?"&back_url_pub="+encodeURIComponent(e):"")+"&sessid="+phpVars.bitrix_sessid))},this.PreloadMenu=function(t){menuStart||(request.Action=function(t){var e=_this.EvalMenu(t);e&&(menuStart.SetItems(e.items),menuStart.BuildItems())},menuStart=new PopupMenu("panel_start_menu"),menuStart.Create(1100),request.Send("/bitrix/admin/get_start_menu.php?lang="+phpVars.LANGUAGE_ID+(t?"&back_url_pub="+encodeURIComponent(t):"")+"&sessid="+phpVars.bitrix_sessid))},this.OpenDynMenu=function(menu,module_id,items_id,back_url){request.Action=function(result){if(0!=jsUtils.trim(result).length){var menuItems;if(eval(result),menu&&menuItems){var bVisible=menu.IsVisible();menu.PopupHide(),menu.SetItems(menuItems.items),menu.BuildItems(),menu.parentMenu.ShowSubmenu(menu.parentItem,!1,!bVisible)}}},request.Send("/bitrix/admin/get_start_menu.php?mode=dynamic&lang="+phpVars.LANGUAGE_ID+"&admin_mnu_module_id="+encodeURIComponent(module_id)+"&admin_mnu_menu_id="+encodeURIComponent(items_id)+(back_url?"&back_url_pub="+encodeURIComponent(back_url):"")+"&sessid="+phpVars.bitrix_sessid)},this.OpenURL=function(t,arguments,e,i){var s=menuStart.GetItemInfo(t);s&&(request.Action=function(t){},request.Send("/bitrix/admin/get_start_menu.php?mode=save_recent&url="+encodeURIComponent(e)+"&text="+encodeURIComponent(s.TEXT)+"&title="+encodeURIComponent(s.TITLE)+"&icon="+s.ICON+"&sessid="+phpVars.bitrix_sessid)),i&&(e+=(e.indexOf("?")>=0?"&":"?")+"back_url_pub="+encodeURIComponent(i)),jsUtils.Redirect(arguments,e)}}function OnAdd(t){document.form_settings;if("tabs_add"==t){var e=document.getElementById("selected_tabs");if(e){var i=prompt(arFormEditMess.admin_lib_sett_tab_prompt,arFormEditMess.admin_lib_sett_tab_default_name);if(i&&i.length>0){for(var s=e.length,n=0,o=!0;o;){n++,o=!1;for(var a=0;a<s;a++)e[a].value=="cedit"+n&&(o=!0)}jsSelectUtils.addNewOption("selected_tabs","cedit"+n,i,!1);var r=document.getElementById("selected_fields"),l=document.createElement("SPAN");r.appendChild(l),l.innerHTML='<select style="display:none" class="select" name="selected_fields[cedit'+n+']" id="selected_fields[cedit'+n+']" size="12" multiple onchange="Sync();"></select>',jsSelectUtils.selectOption("selected_tabs","cedit"+n)}}}if("tabs_copy"==t){var d=document.getElementById("available_tabs"),h=document.getElementById("selected_tabs");if(d&&h)for(var s=d.length,c=h.length,n=0,a=0;a<s;a++)if(d[a].selected){for(var o=!1,p=0;p<c;p++)h[p].value==d[a].value&&(o=!0);if(!o){var r=document.getElementById("selected_fields"),l=document.createElement("SPAN"),u="selected_fields["+d[a].value+"]";r.appendChild(l),l.innerHTML='<select style="display:none" class="select" name="'+u+'" id="'+u+'" size="12" multiple onchange="Sync();"></select>',jsSelectUtils.addNewOption("selected_tabs",d[a].value,d[a].text,!1),jsSelectUtils.selectAllOptions("available_fields"),jsSelectUtils.addSelectedOptions(document.getElementById("available_fields"),u),jsSelectUtils.selectOption("selected_tabs",d[a].value)}}}if("fields_add"==t){var e=document.getElementById("selected_tabs"),m="";if(e)for(var a=0;a<e.length;a++)e[a].selected&&(m=e[a].value);if(e=GetFieldsActiveSelect()){var i=prompt(arFormEditMess.admin_lib_sett_sec_prompt,arFormEditMess.admin_lib_sett_sec_default_name);if(i&&i.length>0){for(var s=e.length,n=0,o=!0;o;){n++,o=!1;for(var a=0;a<s;a++)e[a].value==m+"_csection"+n&&(o=!0)}jsSelectUtils.addNewOption(e.id,m+"_csection"+n,"--"+i,!1),jsSelectUtils.selectOption(e.id,m+"_csection"+n)}}}if("fields_copy"==t){var d=document.getElementById("available_fields"),h=GetFieldsActiveSelect();if(d&&h&&!h.disabled){var a,f=h.length-1;for(a=0;a<h.length;a++)h[a].selected&&(f=a);var _=new Array;for(a=h.length-1;a>f;a--){var b=new Option(h[a].text,h[a].value,(!1),(!1));b.innerHTML=h[a].innerHTML,_[_.length]=b,h.remove(a)}for(a=0;a<h.length;a++)h[a].selected&&(h[a].selected=!1);var v=0,y="";for(a=0;a<d.length;a++)d[a].selected&&(jsSelectUtils.addNewOption(h.id,d[a].value,d[a].text,!1),h[h.length-1].selected=!0,v++,y=a<d.length-1?d[a+1].value:"");var s=h.length;for(a=_.length-1;a>=0;a--)h[s]=_[a],s++;1==v&&y&&jsSelectUtils.selectOption(d.id,y)}}Sync()}function OnDelete(t){if("tabs_delete"==t){for(var e=document.getElementById("selected_tabs"),i=0;i<e.length;i++)if(e[i].selected){var s=document.getElementById("selected_fields["+e[i].value+"]"),n=s.parentNode;n.removeChild(s)}jsSelectUtils.deleteSelectedOptions(e.id),jsSelectUtils.selectOption(e.id,"")}if("fields_delete"==t){var s=GetFieldsActiveSelect();s&&(jsSelectUtils.deleteSelectedOptions(s.id),jsSelectUtils.selectOption(s.id,""))}Sync()}function Sync(){var t,e,i,s,n=document.getElementById("available_tabs"),o=document.getElementById("available_fields"),a=document.getElementById("selected_tabs"),r="";for(t=0;t<n.length;t++)n[t].selected&&(r=n[t].value);var l=new Object;for(t=0;t<o.length;t++)o[t].selected&&(l[o[t].value]=o[t].value);if(jsSelectUtils.selectAllOptions(o.id),jsSelectUtils.deleteSelectedOptions(o.id),r){var d=new Object;for(t=0;t<a.length;t++){var h=document.getElementById("selected_fields["+a[t].value+"]");for(e=0;e<h.length;e++)d[h[e].value]=h[e].value}i=0;for(available_field in arSystemTabsFields[r])if(!d[available_field]){var c=new Option(arSystemFields[available_field],available_field,(!1),(!1));o.options[i]=c,o.options[i].innerHTML=arSystemFields[available_field],i++}for(t=0;t<o.length;t++)l[o[t].value]&&(o[t].selected=!0)}for(s=!1,t=0;t<a.length;t++){var h=document.getElementById("selected_fields["+a[t].value+"]");a[t].selected?(h.style.display="block",s=!0):h.style.display="none"}s?document.getElementById("selected_fields[undef]").style.display="none":document.getElementById("selected_fields[undef]").style.display="block";var p=0;for(t=0;t<a.length;t++)a[t].selected&&p++;var u=0;for(t=0;t<n.length;t++)n[t].selected&&u++;if(document.getElementById("tabs_delete").disabled=p<=0,u<=0)document.getElementById("tabs_copy").disabled=!0;else{for(s=!1,t=0;t<a.length;t++)a[t].value==r&&(s=!0);document.getElementById("tabs_copy").disabled=s}document.getElementById("tabs_up").disabled=p<=0,document.getElementById("tabs_down").disabled=p<=0,document.getElementById("tabs_rename").disabled=1!=p,document.getElementById("tabs_add").disabled=!1;var m=0;for(t=0;t<a.length;t++)if(a[t].selected){var h=document.getElementById("selected_fields["+a[t].value+"]");for(e=0;e<h.length;e++)h[e].selected&&m++}var f=0;for(t=0;t<o.length;t++)o[t].selected&&f++;document.getElementById("fields_delete").disabled=m<=0,document.getElementById("fields_copy").disabled=f<=0||p<=0,document.getElementById("fields_up").disabled=m<=0,document.getElementById("fields_down").disabled=m<=0,document.getElementById("fields_rename").disabled=1!=m,document.getElementById("fields_add").disabled=1!=p;var _=new Object;for(var b in arSystemFields)_[b]=arSystemFields[b];for(t=0;t<a.length;t++)for(h=document.getElementById("selected_fields["+a[t].value+"]"),e=0;e<h.length;e++)delete _[h[e].value];var v=document.getElementById("save_settings");v.disabled=!1;for(var b in _)"*"==_[b].substring(0,1)&&(v.disabled=!0)}function SyncAvailableFields(){var t=document.getElementById("available_tabs");if(t)for(var e=t.length,i=0;i<e;i++)if(oFieldsSelect=document.getElementById("available_fields"),oFieldsSelect&&(jsSelectUtils.selectAllOptions(oFieldsSelect.id),jsSelectUtils.deleteSelectedOptions(oFieldsSelect.id),t[i].selected)){var s=0;for(var n in arSystemTabsFields[t[i].value]){var o=new Option(arSystemFields[n],n,(!1),(!1));oFieldsSelect.options[s]=o,oFieldsSelect.options[s].innerHTML=arSystemFields[n],s++}}}function GetFieldsActiveSelect(){var t,e=document.getElementById("selected_tabs");if(e)for(var i=e.length,s=0;s<i;s++)if(t=document.getElementById("selected_fields["+e[s].value+"]"),t&&"block"==t.style.display)return t;return!1}function OnRename(t){document.form_settings;if("tabs_rename"==t){var e=document.getElementById("selected_tabs");if(e){for(var i=e.length,s=0,n="",o=0;o<i;o++)e[o].selected&&(s++,n||(n=e[o].text));if(1==s){var a=prompt(arFormEditMess.admin_lib_sett_tab_rename,n);if(a&&a.length>0)for(var o=0;o<i;o++)if(e[o].selected){e[o].text=a;break}}}}if("fields_rename"==t){var e=GetFieldsActiveSelect();if(e){for(var i=e.length,s=0,n="",o=0;o<i;o++)e[o].selected&&(s++,n||(n=e[o].innerHTML));if(1==s){var r="";if("--"==n.substring(0,2))n=n.substring(2),r="--";else if("*"==n.substring(0,1))n=n.substring(1),r="*";else if("&nbsp;&nbsp;"==n.substring(0,12))n=n.substring(12),r="&nbsp;&nbsp;";else for(;"  "==n.substring(0,2)||"Â "==n.substring(0,2);)n=n.substring(2),r="&nbsp;&nbsp;";var a=prompt(arFormEditMess.admin_lib_sett_sec_rename,n);if(a&&a.length>0)for(var o=0;o<i;o++)if(e[o].selected){"&nbsp;&nbsp;"==r?(e[o].text=a,e[o].innerHTML="&nbsp;&nbsp;"+e[o].innerHTML):e[o].text=r+a;break}}}}}function FieldsUpAndDown(t){var e=GetFieldsActiveSelect();e&&("up"==t?jsSelectUtils.moveOptionsUp(e):jsSelectUtils.moveOptionsDown(e))}function PopupMenu(id,zIndex,dxShadow){var _this=this;this.menu_id=id,this.controlDiv=null,this.zIndex=100,this.dxShadow=3,this.menuItems=null,this.submenus=[],this.bDoHide=!1,this.parentItem=null,this.parentMenu=null,this.submenuIndex=null,this.bHasSubmenus=!1,this.OnClose=null,isNaN(zIndex)||(this.zIndex=zIndex),isNaN(dxShadow)||(this.dxShadow=dxShadow),this.Create=function(t,e){isNaN(t)||(this.zIndex=t),isNaN(e)||(this.dxShadow=e);var i=document.createElement("DIV");i.id=this.menu_id,i.className="bx-popup-menu",i.style.position="absolute",i.style.zIndex=this.zIndex,i.style.left="-1000px",i.style.top="-1000px",i.style.visibility="hidden",i.onclick=_this.PreventDefault,document.body.appendChild(i),i.innerHTML='<table cellpadding="0" cellspacing="0" border="0"><tr><td class="popupmenu"><table cellpadding="0" cellspacing="0" border="0" id="'+this.menu_id+'_items"><tr><td></td></tr></table></td></tr></table>'},this.ClearItemsStyle=function(){for(var t=document.getElementById(this.menu_id+"_items"),e=0;e<t.rows.length;e++){var i=jsUtils.FindChildObject(t.rows[e].cells[0],"div");if(i&&i.className.indexOf("popupitemover")!=-1){i.className=i.className.replace(/\s*popupitemover/i,"");break}}},this.PopupShow=function(t){var e=document.getElementById(this.menu_id);e||(this.BuildItems(),e=document.getElementById(this.menu_id)),this.ClearItemsStyle(),setTimeout(function(){jsUtils.addEvent(document,"click",_this.CheckClick)},10),jsUtils.addEvent(document,"keypress",_this.OnKeyPress);var i=e.offsetWidth,s=e.offsetHeight;t=jsUtils.AlignToPos(t,i,s),e.style.width=i+"px",e.style.visibility="visible",jsFloatDiv.Show(e,t.left,t.top,this.dxShadow,!1),e.ondrag=jsUtils.False,e.onselectstart=jsUtils.False,e.style.MozUserSelect="none"},this.PopupHide=function(){for(var t=0,e=this.submenus.length;t<e;t++)this.submenus[t]&&this.submenus[t].IsVisible()&&this.submenus[t].PopupHide();this.parentMenu&&(this.parentMenu.submenuIndex=null);var i=document.getElementById(this.menu_id);i&&(jsFloatDiv.Close(i),i.style.visibility="hidden"),this.OnClose&&this.OnClose(),this.controlDiv=null,jsUtils.removeEvent(document,"click",_this.CheckClick),jsUtils.removeEvent(document,"keypress",_this.OnKeyPress)},this.CheckClick=function(t){for(var e=0,i=_this.submenus.length;e<i;e++)if(_this.submenus[e]&&!_this.submenus[e].CheckClick(t))return!1;var s=document.getElementById(_this.menu_id);if(!s)return!0;if("visible"!=s.style.visibility)return!0;var n=jsUtils.GetWindowScrollPos(),o=t.clientX+n.scrollLeft,a=t.clientY+n.scrollTop,r=parseInt(s.style.left),l=parseInt(s.style.top),d=r+parseInt(s.offsetWidth),h=l+parseInt(s.offsetHeight);if(o>=r&&o<=d&&a>=l&&a<=h)return!1;if(_this.controlDiv){var c=jsUtils.GetRealPos(_this.controlDiv);if(o>=c.left&&o<=c.right&&a>=c.top&&a<=c.bottom)return!1}return _this.PopupHide(),!0},this.OnKeyPress=function(t){t||(t=window.event),t&&27==t.keyCode&&_this.PopupHide()},this.PreventDefault=function(t){return t||(t=window.event),t.stopPropagation?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!0,t.returnValue=!1),!1},this.GetItemIndex=function(t){var e=_this.menu_id+"_item_",i=parseInt(t.id.substr(e.length));return i},this.ShowSubmenu=function(item,bMouseOver,bDontShow){item||(item=this);var item_index=_this.GetItemIndex(item);if(1==bMouseOver){if(!_this.menuItems[item_index].__time)return;var dxTime=(new Date).valueOf()-_this.menuItems[item_index].__time;if(dxTime<500)return}var menu;if(_this.submenus[item_index]?menu=_this.submenus[item_index]:(menu=new PopupMenu(_this.menu_id+"_sub_"+item_index),menu.Create(_this.zIndex+10,_this.dxShadow),menu.SetItems(_this.menuItems[item_index].MENU),menu.BuildItems(),menu.parentItem=document.getElementById(_this.menu_id+"_item_"+item_index),menu.parentMenu=_this,menu.OnClose=function(){jsUtils.addEvent(document,"keypress",_this.OnKeyPress)},_this.submenus[item_index]=menu,_this.menuItems[item_index].ONMENUPOPUP&&eval(_this.menuItems[item_index].ONMENUPOPUP)),_this.submenuIndex=item_index,!menu.IsVisible()&&1!=bDontShow){var item_pos=jsUtils.GetRealPos(item),menu_pos=jsUtils.GetRealPos(document.getElementById(_this.menu_id)),pos={left:menu_pos.right-1,right:menu_pos.left+1,top:item_pos.bottom+1,bottom:item_pos.top};jsUtils.removeEvent(document,"keypress",_this.OnKeyPress),menu.controlDiv=item,menu.PopupShow(pos)}},this.OnSubmenuMouseOver=function(){_this.OnItemMouseOver(this);var t=_this.GetItemIndex(this);_this.menuItems[t].__time||(_this.menuItems[t].__time=(new Date).valueOf());var e=this;setTimeout(function(){_this.ShowSubmenu(e,!0)},550)},this.OnItemMouseOver=function(t){_this.bHasSubmenus&&_this.ClearItemsStyle();var e=t?t:this;if(e.className="popupitem popupitemover",_this.parentItem&&(_this.bDoHide=!1,"popupitem popupitemover"!=_this.parentItem.className&&(_this.parentMenu.ClearItemsStyle(),_this.parentItem.className="popupitem popupitemover")),null!=_this.submenuIndex){var i=_this.GetItemIndex(e);_this.submenuIndex!=i&&_this.submenus[_this.submenuIndex]&&(_this.submenus[_this.submenuIndex].bDoHide=!0,setTimeout(function(){_this.HideSubmenu()},500))}},this.OnSubmenuMouseOut=function(){var t=_this.GetItemIndex(this);_this.menuItems[t].__time=null},this.OnItemMouseOut=function(){this.className="popupitem"},this.HideSubmenu=function(){null!=_this.submenuIndex&&1==_this.submenus[_this.submenuIndex].bDoHide&&_this.submenus[_this.submenuIndex].PopupHide()},this.SetItems=function(t){this.menuItems=t,this.submenus=[]},this.SetItemIcon=function(t,e){if("string"==typeof t||t instanceof String){for(var i in this.menuItems)if(this.menuItems[i].ID&&this.menuItems[i].ID==t){this.menuItems[i].ICONCLASS=e;var s=document.getElementById(t);if(s){var n=jsUtils.FindChildObject(s,"div");n&&(n.className="icon "+e)}break}}else{var n=jsUtils.FindChildObject(jsUtils.FindChildObject(t,"td","gutter",!0),"div");n&&(this.menuItems[this.GetItemIndex(t)].ICONCLASS=e,n.className="icon "+e)}},this.SetAllItemsIcon=function(t){for(var e=0,i=this.menuItems.length;e<i;e++){var s=document.getElementById(this.menu_id+"_item_"+e),n=jsUtils.FindChildObject(jsUtils.FindChildObject(s,"td","gutter",!0),"div");n&&(this.menuItems[e].ICONCLASS=t,n.className="icon "+t)}},this.BuildItems=function(){var t=this.menuItems;if(t&&0!=t.length){var e=document.getElementById(this.menu_id);e||(this.Create(),e=document.getElementById(this.menu_id)),e.style.left="-1000px",e.style.top="-1000px",e.style.width="auto",this.bHasSubmenus=!1;for(var i=document.getElementById(this.menu_id+"_items");i.rows.length>0;)i.deleteRow(0);for(var s=t.length,n=0;n<s;n++){var o=i.insertRow(-1),a=o.insertCell(-1);if(t[n].CLASS&&(o.className=t[n].CLASS),t[n].SEPARATOR)a.innerHTML='<div class="popupseparator"><div class="empty"></div></div>';else{var r='<div id="'+this.menu_id+"_item_"+n+'" class="popupitem"'+(1!=t[n].DISABLED&&t[n].ONCLICK?" "+(t[n].MENU?"ondblclick":"onclick")+'="'+jsUtils.htmlspecialchars(t[n].ONCLICK)+'"':"")+'>\t<div style="width:100%;"><table style="width:100% !important" cellpadding="0" cellspacing="0" border="0" dir="ltr">\t\t<tr>\t\t\t<td class="gutter"'+(t[n].ID?' id="'+t[n].ID+'"':"")+'><div class="icon'+(t[n].ICONCLASS?" "+t[n].ICONCLASS:"")+'"'+(t[n].IMAGE?' style="background-image:url('+t[n].IMAGE+');"':"")+'></div></td>\t\t\t<td class="item'+(1==t[n].DISABLED?" disabled":"")+(1==t[n].DEFAULT?" default":"")+'"'+(t[n].TITLE?' title="'+t[n].TITLE+'"':"")+">"+t[n].TEXT+"</td>";if(t[n].MENU&&(r+='<td class="arrow"></td>'),r+="\t\t</tr>\t</table></div></div>",a.innerHTML=r,1!=t[n].DISABLED){var l=jsUtils.FindChildObject(a,"div");t[n].MENU?(l.onclick=function(){_this.ShowSubmenu(this)},l.onmouseover=_this.OnSubmenuMouseOver,l.onmouseout=_this.OnSubmenuMouseOut,this.bHasSubmenus=!0):(l.onmouseover=function(){_this.OnItemMouseOver(this)},l.onmouseout=_this.OnItemMouseOut,!t[n].ONCLICK||null!=t[n].AUTOHIDE&&1!=t[n].AUTOHIDE||jsUtils.addEvent(l,"click",function(){_this.PopupHide()}))}t[n].__id=this.menu_id+"_item_"+n}}e.style.width=i.parentNode.offsetWidth}},this.GetItemInfo=function(t){var e=jsUtils.FindChildObject(t,"td","item",!0);if(e){var i="",s=jsUtils.FindChildObject(jsUtils.FindChildObject(t,"td","gutter",!0),"div");return s.className.length>5&&(i=s.className.substr(5)),{TEXT:e.innerHTML,TITLE:e.title,ICON:i}}return null},this.GetMenuByItemId=function(t){for(var e=0,i=this.menuItems.length;e<i;e++)if(this.menuItems[e].__id&&this.menuItems[e].__id==t)return this;for(var s,e=0,i=this.submenus.length;e<i;e++)if(this.submenus[e]&&0!=(s=this.submenus[e].GetMenuByItemId(t)))return s;return!1},this.IsVisible=function(){var t=document.getElementById(this.menu_id);return!!t&&"hidden"!=t.style.visibility},this.ShowMenu=function(t,e,i,s,n){if(this.controlDiv==t)this.PopupHide();else{this.IsVisible()&&this.PopupHide(),e&&(this.SetItems(e),this.BuildItems()),t.className+=" pressed bx-pressed";var o=window.BX?BX.pos(t):jsUtils.GetRealPos(t);if(s?(o.left+=s.left,o.right+=s.right,o.top+=s.top,o.bottom+=s.bottom):o.bottom+=2,1==i&&!jsUtils.IsIE()){var a=jsUtils.GetWindowScrollPos();o.top+=a.scrollTop,o.bottom+=a.scrollTop,o.left+=a.scrollLeft,o.right+=a.scrollLeft}this.controlDiv=t,this.OnClose=function(){t.className=t.className.replace(/\s*pressed bx-pressed/gi,""),n&&n()},this.PopupShow(o)}}}function JCAdminTitleSearch(t){var e=this;this.arParams={AJAX_PAGE:t.AJAX_PAGE,CONTAINER_ID:t.CONTAINER_ID,INPUT_ID:t.INPUT_ID,MIN_QUERY_LEN:parseInt(t.MIN_QUERY_LEN)},t.WAIT_IMAGE&&(this.arParams.WAIT_IMAGE=t.WAIT_IMAGE),t.MIN_QUERY_LEN<=0&&(t.MIN_QUERY_LEN=1),this.cache=[],this.cache_key=null,this.startText="",this.currentRow=-1,this.RESULT=null,this.CONTAINER=null,this.INPUT=null,this.WAIT=null,this.Hide=function(){e.RESULT.style.display="none",e.RESULT.innerHTML="",e.currentRow=-1,e.UnSelectAll(),BX.removeClass(e.INPUT.parentNode,"adm-header-search-block-active-popup")},this.ShowResult=function(t){var i=BX.pos(e.CONTAINER);i.width=i.right-i.left,e.RESULT.style.position="absolute",e.RESULT.style.top="4px",e.RESULT.style.left=i.left-7+"px",e.RESULT.style.width=i.width+14+"px",null!=t&&(e.RESULT.innerHTML=t),e.RESULT.innerHTML.length>0?(e.RESULT.style.display="block",BX.addClass(e.INPUT.parentNode,"adm-header-search-block-active-popup")):this.Hide()},this.onKeyPress=function(t){var i=BX.findChild(e.RESULT,{tag:"table","class":"adm-search-result"},!0);if(!i)return!1;var s=i.rows.length;switch(t){case 27:return e.Hide(),!0;case 40:"none"==e.RESULT.style.display&&(e.RESULT.style.display="block");for(var n=-1,o=0;o<s;o++){if(n==-1&&(n=o),e.currentRow<o){e.currentRow=o;break}"adm-search-selected"==i.rows[o].className&&(i.rows[o].className="")}return o==s&&e.currentRow!=o&&(e.currentRow=n),i.rows[e.currentRow].className="adm-search-selected",!0;case 38:"none"==e.RESULT.style.display&&(e.RESULT.style.display="block");for(var a=-1,o=s-1;o>=0;o--){if(a==-1&&(a=o),e.currentRow>o){e.currentRow=o;break}"adm-search-selected"==i.rows[o].className&&(i.rows[o].className="")}return o<0&&(e.currentRow=a),i.rows[e.currentRow].className="adm-search-selected",!0;case 13:if("block"==e.RESULT.style.display)for(var o=0;o<s;o++)if(e.currentRow==o&&!BX.findChild(i.rows[o],{"class":"adm-search-separator"},!0)){var r=BX.findChild(i.rows[o],{tag:"a"},!0);if(r)return window.location=r.href,!0}return!1}return!1},this.onTimeout=function(){if(e.INPUT.value!=e.oldValue&&e.INPUT.value!=e.startText)if(e.INPUT.value.length>=e.arParams.MIN_QUERY_LEN)if(e.oldValue=e.INPUT.value,e.cache_key=e.arParams.INPUT_ID+"|"+e.INPUT.value,null==e.cache[e.cache_key]){if(e.WAIT){var t=BX.pos(e.INPUT),i=t.bottom-t.top-2;e.WAIT.style.top=t.top+1+"px",e.WAIT.style.height=i+"px",e.WAIT.style.width=i+"px",e.WAIT.style.left=t.right-i+2+"px",e.WAIT.style.display="block"}BX.ajax.post(e.arParams.AJAX_PAGE,{ajax_call:"y",INPUT_ID:e.arParams.INPUT_ID,q:e.INPUT.value},function(t){e.cache[e.cache_key]=t,e.ShowResult(t),e.currentRow=-1,e.EnableMouseEvents(),e.WAIT&&(e.WAIT.style.display="none"),setTimeout(e.onTimeout,500)})}else e.ShowResult(e.cache[e.cache_key]),e.currentRow=-1,e.EnableMouseEvents(),setTimeout(e.onTimeout,500);else e.Hide(),setTimeout(e.onTimeout,500);else setTimeout(e.onTimeout,500)},this.UnSelectAll=function(){var t=BX.findChild(e.RESULT,{tag:"table","class":"adm-search-result"},!0);if(t)for(var i=t.rows.length,s=0;s<i;s++)t.rows[s].className=""},this.EnableMouseEvents=function(){var t=BX.findChild(e.RESULT,{tag:"table","class":"adm-search-result"},!0);if(t)for(var i=t.rows.length,s=0;s<i;s++)t.rows[s].id="row_"+s,t.rows[s].onmouseover=function(t){e.currentRow!=this.id.substr(4)&&(e.UnSelectAll(),this.className="adm-search-selected",e.currentRow=this.id.substr(4))},t.rows[s].onmouseout=function(t){this.className="",e.currentRow=-1}},this.onFocusLost=function(t){setTimeout(function(){e.Hide()},250)},this.onFocusGain=function(){e.RESULT.innerHTML.length&&e.ShowResult()},this.onKeyDown=function(t){if(t||(t=window.event),"block"==e.RESULT.style.display&&e.onKeyPress(t.keyCode))return BX.PreventDefault(t)},this.Init=function(){this.CONTAINER=document.getElementById(this.arParams.CONTAINER_ID),this.RESULT=document.getElementById("bx-panel").appendChild(document.createElement("DIV")),this.RESULT.className="adm-search-result-wrap",this.RESULT.style.display="none",this.INPUT=document.getElementById(this.arParams.INPUT_ID),this.startText=this.oldValue=this.INPUT.value,BX.bind(this.INPUT,"focus",function(){e.onFocusGain()}),BX.bind(this.INPUT,"blur",function(){e.onFocusLost()}),BX.bind(window,"resize",function(){e.onFocusGain()}),BX.browser.IsSafari()||BX.browser.IsIE()?this.INPUT.onkeydown=this.onKeyDown:this.INPUT.onkeypress=this.onKeyDown,this.arParams.WAIT_IMAGE&&(this.WAIT=document.body.appendChild(document.createElement("DIV")),this.WAIT.style.backgroundImage="url('"+this.arParams.WAIT_IMAGE+"')",BX.browser.IsIE()||(this.WAIT.style.backgroundRepeat="none"),this.WAIT.style.display="none",
this.WAIT.style.position="absolute",this.WAIT.style.zIndex="1100"),setTimeout(this.onTimeout,500)},BX.ready(function(){e.Init(t)})}function CBXHotKeys(){var _this=this,idxKS=0,idxCode=1,idxCodeId=2,idxName=3,idxHKId=4,arServSymb={8:"Back Space",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"Caps Lock",27:"ESC",32:"Space bar",33:"Page Up",34:"Page Down",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Delete",96:"0 (ext)",97:"1 (ext)",98:"2 (ext)",99:"3 (ext)",100:"4 (ext)",101:"5 (ext)",102:"6 (ext)",105:"9 (ext)",106:"* (ext)",107:"+ (ext)",104:"8 (ext)",103:"7 (ext)",110:". (ext)",111:"/ (ext)",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"Num Lock",186:";",188:",",190:".",191:"/",192:"`",219:"[",220:"|",221:"]",222:"'",189:"-",187:"+",145:"Scrol Lock"},bxHotKeyCode=0,inputKeyCode=0,inputDopString="";this.ArrHKCode=[],this.MesNotAssign="",this.MesClToChange="",this.MesClean="",this.MesBusy="",this.MesClose="",this.MesSettings="",this.MesDefault="",this.MesDelAll="",this.MesDelete="",this.MesDelConfirm="",this.MesDefaultConfirm="",this.MesExport="",this.MesExpFalse="",this.MesImport="",this.MesImpFalse="",this.MesImpSuc="",this.MesImpHeader="",this.MesFileEmpty="",this.MesChooseFile="",this.uid="",this.deleting=!1,this.Init=function(){this.Register()},this.UpdateKS=function(t,e){for(var i=0;i<this.ArrHKCode.length;i++)if(this.ArrHKCode[i][idxCodeId]==t)return this.ArrHKCode[i][idxKS]=e,!0},this.UpdateHk=function(t,e){for(var i=0;i<this.ArrHKCode.length;i++)if(this.ArrHKCode[i][idxCodeId]==t)return this.ArrHKCode[i][idxHKId]=e,i;return-1},this.Add=function(t,e,i,s,n){for(var o=0;o<this.ArrHKCode.length;o++)if(this.ArrHKCode[o][idxCodeId]==i)return!1;return this.ArrHKCode.push([String(t),String(e),i,String(s),n])},this.GetExCode=function(t){var e="";if(t)for(var i=0;i<this.ArrHKCode.length;i++)this.ArrHKCode[i][idxKS]==t&&(e&&(e+=" "),e+=this.ArrHKCode[i][idxCode]);return e},this.MakeKeyString=function(t){return this.inputDopString=(t.ctrlKey?"Ctrl+":"")+(t.altKey?"Alt+":"")+(t.shiftKey?"Shift+":""),this.inputKeyCode=t.keyCode,this.inputKeyCode||(this.inputKeyCode=t.charCode),this.inputDopString+this.inputKeyCode},this.ShowMenu=function(){var t='<table class="bx-hk-settings-toolbar" cellspacing="0" cellpadding="0" border="0"><tr><td class="bx-left"><div class="bx-hk-settings-empty"></div></td><td class="bx-content"><a class="bx-context-button" hidefocus="true" href="javascript:void(0)" onclick="BXHotKeys.Import();"><span class="bx-context-button-icon btn-import"></span><span class="bx-context-button-text">'+this.MesImport+'</span></a><a class="bx-context-button" hidefocus="true" href="javascript:void(0)" onclick="BXHotKeys.Export();"><span class="bx-context-button-icon btn-export"></span><span class="bx-context-button-text">'+this.MesExport+'</span></a><a class="bx-context-button" hidefocus="true" href="javascript:void(0)" onclick="if(confirm(BXHotKeys.MesDelConfirm)) BXHotKeys.DelAll();"><span class="bx-context-button-icon btn-delall"></span><span class="bx-context-button-text">'+this.MesDelAll+'</span></a><a class="bx-context-button" hidefocus="true" href="javascript:void(0)" onclick="if(confirm(BXHotKeys.MesDefaultConfirm)) { BXHotKeys.DelAll(); BXHotKeys.SetDefault(); }"><span class="bx-context-button-icon btn-default"></span><span class="bx-context-button-text">'+this.MesDefault+'</span></a></td><td class="bx-right"><div class="bx-hk-settings-empty"></div></td></tr></table>';return t},this.ShowSettings=function(){for(var t='<table width="100%" id="tbl_hk_settings">',e="",i="",s=0;s<this.ArrHKCode.length;s++)e=this.ArrHKCode[s][idxKS]?this.PrintKSAsChar(this.ArrHKCode[s][idxKS]):this.MesNotAssign,i=this.ArrHKCode[s][idxCode]?"<td width='30%' id='hotkeys-float-form-"+this.ArrHKCode[s][idxCodeId]+"'><a href='javascript:void(0)' onclick='BXHotKeys.SubstInput("+this.ArrHKCode[s][idxCodeId]+", "+this.ArrHKCode[s][idxHKId]+', "'+this.ArrHKCode[s][idxKS]+"\");' title='"+this.MesClToChange+"' class='bx-hk-settings'>"+e+"</a></td><td width='10%' align='right' id='hotkeys-float-form-del-"+this.ArrHKCode[s][idxCodeId]+"'><a href='javascript:void(0)' onclick='BXHotKeys.DeleteBase("+this.ArrHKCode[s][idxCodeId]+","+this.ArrHKCode[s][idxHKId]+");' class='hk-delete-icon' title='"+this.MesDelete+"'></a></td>":"<td width='30%'>&nbsp;</td><td width='10%'>&nbsp</td>",t+="<tr class = 'bx-hk-settings-row'><td width='60%'>"+this.ArrHKCode[s][idxName]+"</td>"+i+"</tr>";t+="</table>";var n=new BX.CWindowButton({title:this.MesClose,action:function(){this.parentWindow.Close()}}),o=new BX.CDialog({title:this.MesSettings,content:t,buttons:[n],width:500,height:400,resizable:!1});this.tblSettParent=BX("tbl_hk_settings").parentNode,BX.addCustomEvent(o,"onWindowClose",function(t){t.DIV.parentNode.removeChild(t.DIV),_this.Register()});var a=document.createElement("div");a.className="bx-hk-settings-toolbar",a.innerHTML=this.ShowMenu();var r=BX.findChild(o.DIV,{attribute:{"class":"bx-core-adm-dialog-content"}},!0);r?(r.appendChild(a),BX.findChild(o.DIV,{attribute:{"class":"bx-core-adm-dialog-content"}},!0).style.marginTop="37px"):(this.hk_getElementsByClass("bx-core-adm-dialog-head")[0].appendChild(a),this.hk_getElementsByClass("bx-hk-settings-toolbar",o.DIV,"div")[0].style.width="480px"),o.Show(),this.Unregister()},this.hk_getElementsByClass=function(t,e,i){var s,e=e||document,i=i||"*",n=e.getElementsByTagName(i),o=n.length,a=[];for(s=0;s<o;s++)if(n[s].className==t){a.push(n[s]);break}return a},this.DelAll=function(){_this.deleting=!0;for(var t=0;t<this.ArrHKCode.length;t++)_this.UpdateKS(this.ArrHKCode[t][idxCodeId],""),_this.UpdateHk(this.ArrHKCode[t][idxCodeId],0),_this.SubstAnch(this.ArrHKCode[t][idxCodeId],0,""),_this.SubstDel(this.ArrHKCode[t][idxCodeId],0);var e=new JCHttpRequest,i="/bitrix/admin/hot_keys_act.php?hkaction=delete_all",s="&sessid="+phpVars.bitrix_sessid;e.Action=function(t){_this.deleting=!1},e.Post(i,s)},this.Register=function(){try{jsUtils.addEvent(document,"keypress",_this.KeyPressHandler),jsUtils.addEvent(document,"keydown",_this.KeyDownHandler)}catch(t){}},this.Unregister=function(){jsUtils.removeEvent(document,"keypress",_this.KeyPressHandler),jsUtils.removeEvent(document,"keydown",_this.KeyDownHandler)},this.SetDefault=function(){var t=new JCHttpRequest,e="/bitrix/admin/hot_keys_act.php?hkaction=set_default",i="&sessid="+phpVars.bitrix_sessid;t.Action=function(t){if(t){if(!t)return!1;for(var e=[],i="",s=t.split(";;"),n=0;n<s.length;n++)e=s[n].split("::"),i=_this.UpdateHk(e[0],e[1]),i>=0&&(_this.UpdateKS(e[0],e[2]),_this.SubstAnch(e[0],e[1],e[2]),_this.SubstDel(e[0],e[1]))}},waiter={func:function(){this.deleting||(t.Post(e,i),clearInterval(intervalID))}},intervalID=window.setInterval(function(){waiter.func.call(waiter)},1e3)},this.IsKeysBusy=function(t,e){for(var i=0;i<this.ArrHKCode.length;i++)if(this.ArrHKCode[i][idxKS]==t&&this.ArrHKCode[i][idxCodeId]!=e)return!0;return!1},this.SubstInput=function(t,e,i){var s=document.getElementById("hotkeys-float-form-"+t);if(!s)return!1;s.innerHTML="",s.innerHTML='<input type="text" class="adm-input" name="HUMAN_KEYS_STRING" size="10" maxlength="30" value="'+this.PrintKSAsChar(i)+'" id="HKeysString" autocomplete="off"><input type="hidden" name="KEYS_STRING" value="'+i+'" id="KeysString">';var n=document.getElementById("HKeysString"),o=document.getElementById("KeysString");n.onkeydown=_this.SetInput,n.onkeypress=_this.SetInput,n.onkeyup=function(){return ShowWaitWindow(),n.onblur="",_this.IsKeysBusy(o.value,t)&&!confirm(_this.MesBusy)?(_this.SubstAnch(t,e,i),!1):(_this.bxHotKeyCode=0,_this.UpdateKS(t,o.value),e?(_this.UpdateHk(t,e),_this.UpdateBase(e,o.value)):_this.AddBase(t,o.value),_this.SubstAnch(t,e,o.value),void CloseWaitWindow())},n.focus(),n.onblur=function(){_this.SubstAnch(t,e,i)}},this.SubstAnch=function(t,e,i){var s=document.getElementById("hotkeys-float-form-"+t);s&&(s.innerHTML="<a href='javascript:void(0)' onclick='BXHotKeys.SubstInput("+t+", "+e+', "'+i+"\");' title='"+this.MesClToChange+"' class='bx-hk-settings'>"+(i?this.PrintKSAsChar(i):this.MesNotAssign)+"</a>")},this.SubstDel=function(t,e){var i=document.getElementById("hotkeys-float-form-del-"+t);i&&(i.innerHTML="<a href='javascript:void(0)' onclick='BXHotKeys.DeleteBase("+t+","+e+");' class='hk-delete-icon' title='"+this.MesDelete+"'></a>")},this.AddBase=function(t,e){var i=new JCHttpRequest,s="/bitrix/admin/hot_keys_act.php?hkaction=add",n="&KEYS_STRING="+encodeURIComponent(e)+"&CODE_ID="+t+"&USER_ID="+_this.uid+"&sessid="+phpVars.bitrix_sessid;i.Action=function(i){if(i&&i==Number(i)){var s=_this.UpdateHk(t,i);s>=0&&(_this.SubstAnch(t,i,e),_this.SubstDel(t,i))}},i.Post(s,n)},this.Export=function(){window.open("/bitrix/admin/hot_keys_act.php?hkaction=export&sessid="+phpVars.bitrix_sessid)},this.OnFileInputChange=function(t){fileName=t.value,fileName=fileName.replace(/\\/g,"/"),fileName=fileName.substr(fileName.lastIndexOf("/")+1),t.parentNode.childNodes[0].textContent?t.parentNode.childNodes[0].textContent=fileName:t.parentNode.childNodes[0].innerText=fileName},this.Import=function(){var t='<form action="/bitrix/admin/hot_keys_act.php?hkaction=import" method="post" enctype="multipart/form-data" target="upload_iframe" id="hk_import_form" name="hk_import_form"><input type="hidden" name="sessid" value="'+BX.bitrix_sessid()+'"><span class="adm-input-file"><span>'+this.MesChooseFile+'</span><input type="file" name="bx_hk_filename" id="bx_hk_filename" class="adm-designed-file" onchange="BXHotKeys.OnFileInputChange(this);"></span></form><iframe id="upload_iframe" name="upload_iframe" style="display:none"></iframe>',e=new BX.CWindowButton({title:this.MesClose,action:function(){this.parentWindow.Close()}}),i=new BX.CWindowButton({title:this.MesImport,action:function(){return BX("bx_hk_filename").value?(BX("hk_import_form").submit(),void ShowWaitWindow()):void alert(_this.MesFileEmpty)}}),s=new BX.CDialog({title:this.MesImpHeader,content:t,buttons:[i,e],width:300,height:60,resizable:!1});s.Show()},this.OnImportResponse=function(t){t?alert(_this.MesImpSuc+t):alert(_this.MesImpFalse),BX.reload()},this.UpdateBase=function(t,e){var i=new JCHttpRequest,s="/bitrix/admin/hot_keys_act.php?hkaction=update",n="&KEYS_STRING="+encodeURIComponent(e)+"&ID="+t+"&sessid="+phpVars.bitrix_sessid;i.Post(s,n)},this.DeleteBase=function(t,e){if(e){var i=new JCHttpRequest,s="/bitrix/admin/hot_keys_act.php?hkaction=delete",n="&ID="+e+"&sessid="+phpVars.bitrix_sessid;i.Post(s,n),_this.UpdateKS(t,""),_this.UpdateHk(t,0),_this.SubstAnch(t,0,""),_this.SubstDel(t,0)}},this.PrintKSAsChar=function(t){if(!t)return"";var e=t.lastIndexOf("+");if(e){var i=t.substr(e+1,t.length-(e+1)),s=t.substr(0,e+1);if(16==i||17==i||18==i)return s.substr(0,s.length-1)}else var i=t,s="";var n=arServSymb[i];return n||(n=String.fromCharCode(i)),s+n},this.SetInput=function(t){t=t||event;var e=(t.ctrlKey?"Ctrl+":"")+(t.altKey?"Alt+":"")+(t.shiftKey?"Shift+":"");t.keyCode&&"keypress"!=t.type&&(_this.bxHotKeyCode=t.keyCode);var i;return i=void 0==t.charCode?t.which:t.charCode,!i||_this.bxHotKeyCode&&17!=_this.bxHotKeyCode&&18!=_this.bxHotKeyCode&&16!=_this.bxHotKeyCode&&224!=_this.bxHotKeyCode||(_this.bxHotKeyCode=i),document.getElementById("KeysString").value=e+_this.bxHotKeyCode,document.getElementById("HKeysString").value=_this.PrintKSAsChar(document.getElementById("KeysString").value),!1},this.KeyPressHandler=function(e){if(e=e||event,e.charCode>256){var ExCode=_this.GetExCode(_this.MakeKeyString(e));ExCode&&eval(ExCode)}},this.KeyDownHandler=function(e){e=e||event;var ExCode=_this.GetExCode(_this.MakeKeyString(e));ExCode&&eval(ExCode)}}function JCPopup(t){t||(t={}),this.suffix=t.suffix?"_"+t.suffix.toString().toLowerCase():"",this.div_id="bx_popup_form_div"+this.suffix,this.overlay_id="bx_popup_overlay"+this.suffix,this.form_name="bx-popup-form"+this.suffix,this.class_name="bx-popup-form",this.url="",this.zIndex=t.zIndex||1020,this.arParams=null,this.bDenyClose=!1,this.bDenyEscKey=!1,this.__arRuntimeResize={},this.bodyOverflow="",this.currentScroll=0,this.div=null,this.div_inner=null,this.x=0,this.y=0,this.error_dy=null,this.arAdditionalResize=[],this.onClose=[];var e=this;window["JCPopup_OnKeyPress"+this.suffix]=function(t){e.__OnKeyPress(t)},window["JCPopup_OverlayResize"+this.suffix]=function(t){e.OverlayResize(t)},window["JCPopup_AjaxAction"+this.suffix]=function(t){e.AjaxAction(t)},window["JCPopup_AjaxPostAction"+this.suffix]=function(t){e.__AjaxPostAction(t)},window["JCPopup_stopResize"+this.suffix]=function(t){e.stopResize(t)},window["JCPopup_startResize"+this.suffix]=function(t){e.startResize(t)},window["JCPopup_doResize"+this.suffix]=function(t){e.doResize(t)},jsExtLoader.jsPopup_name="jsPopup"+this.suffix}function JCComponentUtils(){}function COpacity(t){this.element=t,this.opacityProperty=this.GetOpacityProperty(),this.startOpacity=null,this.finishOpacity=null,this.delay=30,this.currentOpacity=null,this.fadingTimeoutID=null}function jsWizard(){this.currentStep=null,this.firstStep=null,this.arSteps={},this.nextButtonID="btn_popup_next",this.prevButtonID="btn_popup_prev",this.finishButtonID="btn_popup_finish",this.arButtons={}}function BxShowAuthService(t,e){var i="";window["bxCurrentAuthId"+e]&&(i=window["bxCurrentAuthId"+e]),BX("bx_auth_serv"+e).style.display="",""!=i&&i!=t&&(BX("bx_auth_href_"+e+i).className="",BX("bx_auth_serv_"+e+i).style.display="none"),BX("bx_auth_href_"+e+t).className="bx-ss-selected",BX("bx_auth_href_"+e+t).blur(),BX("bx_auth_serv_"+e+t).style.display="";var s=BX.findChild(BX("bx_auth_serv_"+e+t),{tag:"input",attribute:{type:"text"}},!0);if(s)try{s.focus()}catch(n){}window["bxCurrentAuthId"+e]=t,document.forms["bx_auth_services"+e]?document.forms["bx_auth_services"+e].auth_service_id.value=t:document.forms["bx_user_profile_form"+e]&&(document.forms["bx_user_profile_form"+e].auth_service_id.value=t)}function BxShowAuthFloat(t,e){var i=!1;bxAuthWnd||(bxAuthWnd=new BX.CDialog({content:'<div id="bx_auth_float_container"></div>',width:640,height:400,resizable:!1}),i=!0),bxAuthWnd.Show(),i&&BX("bx_auth_float_container").appendChild(BX("bx_auth_float")),BxShowAuthService(t,e)}function CAjaxThread(t){this.TID=t,this.httpRequest=this._CreateHttpObject(),this.arAction=[]}function CAjax(){this.arThreads={},this.obTemporary=null}function CAjaxForm(t,e,i){this.obForm=t,this.obHandler=e,this.obFrame=null,this.isFormProcessed=!1,null==i?this.bFirst=!1:this.bFirst=i,this.__tmpFormTarget="",this.obAJAXIndicator=null,this.currentBrowserDetected="",window.opera?this.currentBrowserDetected="Opera":navigator.userAgent&&(navigator.userAgent.indexOf("MSIE")!=-1?this.currentBrowserDetected="IE":navigator.userAgent.indexOf("Firefox")!=-1&&(this.currentBrowserDetected="Firefox")),this.IsIE9=!!document.documentMode&&document.documentMode>=9}!function(window){function bindReady(){if(!readyBound){if(readyBound=!0,"complete"===document.readyState)return runReady();if(document.addEventListener)document.addEventListener("DOMContentLoaded",__readyHandler,!1),window.addEventListener("load",runReady,!1);else if(document.attachEvent){document.attachEvent("onreadystatechange",__readyHandler),window.attachEvent("onload",runReady);var t=!1;try{t=null==window.frameElement}catch(e){}document.documentElement.doScroll&&t&&doScrollCheck()}}return null}function runReady(){if(!BX.isReady){if(!document.body)return setTimeout(runReady,15);if(BX.isReady=!0,readyList&&readyList.length>0){for(var t,e=0;readyList&&(t=readyList[e++]);)try{t.call(document)}catch(i){BX.debug("BX.ready error: ",i)}readyList=null}}return null}function doScrollCheck(){if(!BX.isReady){try{document.documentElement.doScroll("left")}catch(t){return void setTimeout(doScrollCheck,1)}runReady()}}function _adjustWait(){if(this.bxmsg){var t=BX.pos(this),e=t.top;e<BX.GetDocElement().scrollTop&&(e=BX.GetDocElement().scrollTop+5),this.bxmsg.style.top=e+5+"px",this==BX.GetDocElement()?this.bxmsg.style.right="5px":this.bxmsg.style.left=t.right-this.bxmsg.offsetWidth-5+"px"}}function _checkDisplay(t,e){"undefined"!=typeof e&&(t.BXDISPLAY=e);var i=t.style.display||BX.style(t,"display");return"none"!=i?(t.BXDISPLAY=t.BXDISPLAY||i,!0):(t.BXDISPLAY=t.BXDISPLAY||"block",!1)}function _processTpl(t,e,i){if(t){i&&t.parentNode.removeChild(t);for(var s={},n=BX.findChildren(t,{attribute:"data-role"},!0),o=0,a=n.length;o<a;o++)s[n[o].getAttribute("data-role")]=n[o];e.apply(t,[s])}}function _checkNode(t,e){if(e=e||{},BX.type.isFunction(e))return e.call(window,t);if(!e.allowTextNodes&&!BX.type.isElementNode(t))return!1;var i,s,n;for(i in e)switch(i){case"tag":case"tagName":if(BX.type.isString(e[i])){if(t.tagName.toUpperCase()!=e[i].toUpperCase())return!1}else if(e[i]instanceof RegExp&&!e[i].test(t.tagName))return!1;break;case"class":case"className":if(BX.type.isString(e[i])){if(!BX.hasClass(t,e[i]))return!1}else if(e[i]instanceof RegExp&&(!BX.type.isString(t.className)||!e[i].test(t.className)))return!1;break;case"attr":case"attribute":if(BX.type.isString(e[i])){if(!t.getAttribute(e[i]))return!1}else if(BX.type.isArray(e[i])){for(s=0,n=e[i].length;s<n;s++)if(e[i]&&!t.getAttribute(e[i]))return!1}else for(s in e[i]){var o=t.getAttribute(s);if(e[i][s]instanceof RegExp){if(!BX.type.isString(o)||!e[i][s].test(o))return!1}else if(o!=""+e[i][s])return!1}break;case"property":if(BX.type.isString(e[i])){if(!t[e[i]])return!1}else if(BX.type.isArray(e[i])){for(s=0,n=e[i].length;s<n;s++)if(e[i]&&!t[e[i]])return!1}else for(s in e[i])if(BX.type.isString(e[i][s])){if(t[s]!=e[i][s])return!1}else if(e[i][s]instanceof RegExp&&(!BX.type.isString(t[s])||!e[i][s].test(t[s])))return!1;break;case"callback":return e[i](t)}return!0}function _checkCssList(){var t=document.getElementsByTagName("LINK");window.arKernelCSS&&BX.type.isArray(arKernelCSS)&&(t=BX.util.array_merge(t,arKernelCSS));for(var e=0;e<t.length;e++){var i=BX.type.isDomNode(t[e])?t[e].getAttribute("href"):t[e];i&&i.replace&&cssList.push(i.replace(/\.css(\?\d*)/,".css"))}_checkCssList=BX.DoNothing}function _isScriptLoaded(t){return BX.util.in_array(t,arKernelJS)||t.indexOf("/core/core.js")>0||t.indexOf("/core_access.js")>=0&&!!BX.Access||t.indexOf("/core_admin.js")>=0&&!!BX.admin||t.indexOf("/core_admin_interface.js")>=0&&!!BX.adminPanel||t.indexOf("/core_admin_login.js")>=0&&!!BX.adminLogin||t.indexOf("/core_ajax.js")>=0&&!!BX.ajax||t.indexOf("/core_autosave.js")>=0&&!!BX.CAutoSave||t.indexOf("/core_date.js")>=0&&!!BX.date||t.indexOf("/core_finder.js")>=0&&!!BX.Finder||t.indexOf("/core_fx.js")>=0&&!!BX.easing||t.indexOf("/core_image.js")>=0&&!!BX.CImageView||t.indexOf("/core_ls.js")>=0&&!!BX.localStorage||t.indexOf("/core_popup.js")>=0&&!!BX.PopupWindowManager||t.indexOf("/core_tags.js")>=0&&!!BX.TagsWindowArea||t.indexOf("/core_timer.js")>=0&&!!BX.timer||t.indexOf("/core_tooltip.js")>=0&&!!BX.tooltip||t.indexOf("/core_translit.js")>=0&&!!BX.translit||t.indexOf("/core_window.js")>=0&&!!BX.WindowManager||t.indexOf("/jquery-")>=0&&!!window.jQuery}function Trash(){var t,e;for(t=0,e=garbageCollectors.length;t<e;t++)try{garbageCollectors[t].callback.apply(garbageCollectors[t].context||window),delete garbageCollectors[t],garbageCollectors[t]=null}catch(i){}try{BX.unbindAll()}catch(i){}}if(!window.BX||!window.BX.extend){var _bxtmp;if(window.BX&&(_bxtmp=window.BX),window.BX=function(t,e){if(BX.type.isNotEmptyString(t)){var i;return e&&null!=NODECACHE[t]&&(i=NODECACHE[t]),i=i||document.getElementById(t),e&&(NODECACHE[t]=i),i}return BX.type.isDomNode(t)?t:BX.type.isFunction(t)?BX.ready(t):null},BX.message=function(t){if(BX.type.isString(t))return"undefined"==typeof BX.message[t]&&BX.debug("message undefined: "+t),BX.message[t];for(var e in t)BX.message[e]=t[e];return!0},_bxtmp)for(var i in _bxtmp){if(BX[i]){if("message"==i)for(var j in _bxtmp[i])BX.message[j]=_bxtmp[i][j]}else BX[i]=_bxtmp[i];_bxtmp=null}var __readyHandler=null,readyBound=!1,readyList=[],proxySalt=Math.random(),proxyId=1,proxyList=[],deferList=[],NODECACHE={},deniedEvents=[],eventsList=[],customEvents={},garbageCollectors=[],cssList=[],arKernelJS=[],bSafari=navigator.userAgent.toLowerCase().indexOf("webkit")!=-1,bOpera=navigator.userAgent.toLowerCase().indexOf("opera")!=-1,bFirefox=navigator.userAgent.toLowerCase().indexOf("firefox")!=-1,bChrome=navigator.userAgent.toLowerCase().indexOf("chrome")!=-1,bIE=document.attachEvent&&!bOpera,r={script:/<script([^>]*)>/i,script_src:/src=["\']([^"\']+)["\']/i,space:/\s+/,ltrim:/^[\s\r\n]+/g,rtrim:/[\s\r\n]+$/g,style:/<link.*?(rel="stylesheet"|type="text\/css")[^>]*>/i,style_href:/href=["\']([^"\']+)["\']/i},eventTypes={click:"MouseEvent",dblclick:"MouseEvent",mousedown:"MouseEvent",mousemove:"MouseEvent",mouseout:"MouseEvent",mouseover:"MouseEvent",mouseup:"MouseEvent",focus:"MouseEvent",blur:"MouseEvent"},lastWait=[],CHECK_FORM_ELEMENTS={tagName:/^INPUT|SELECT|TEXTAREA|BUTTON$/i};BX.MSLEFT=1,BX.MSMIDDLE=2,BX.MSRIGHT=4,BX.ext=function(t){for(var e in t)this[e]=t[e]},BX.extend=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t,t.superclass=e.prototype,e.prototype.constructor==Object.prototype.constructor&&(e.prototype.constructor=e)},BX.debug=function(){window.BXDEBUG&&window.console&&window.console.log&&console.log("BX.debug: ",arguments.length>0?arguments:arguments[0])},BX.is_subclass_of=function(t,e){return t instanceof e||!!e.superclass&&BX.is_subclass_of(t,e.superclass)},BX.bitrix_sessid=function(){return BX.message.bitrix_sessid},BX.create=function(t,e,i){i=i||document,null==e&&"object"==typeof t&&t.constructor!==String&&(e=t,t=t.tag);var s;return s=BX.browser.IsIE()&&!BX.browser.IsIE9()&&null!=e&&null!=e.props&&(e.props.name||e.props.id)?i.createElement("<"+t+(e.props.name?' name="'+e.props.name+'"':"")+(e.props.id?' id="'+e.props.id+'"':"")+">"):i.createElement(t),e?BX.adjust(s,e):s},BX.adjust=function(t,e){var i,s;if(!t.nodeType)return null;if(9==t.nodeType&&(t=t.body),e.attrs)for(i in e.attrs)"class"==i||"className"==i?t.className=e.attrs[i]:"for"==i?t.htmlFor=e.attrs[i]:""==e.attrs[i]?t.removeAttribute(i):t.setAttribute(i,e.attrs[i]);if(e.style)for(i in e.style)t.style[i]=e.style[i];if(e.props)for(i in e.props)t[i]=e.props[i];if(e.events)for(i in e.events)BX.bind(t,i,e.events[i]);if(e.children&&e.children.length>0)for(i=0,s=e.children.length;i<s;i++)BX.type.isNotEmptyString(e.children[i])?t.innerHTML+=e.children[i]:BX.type.isElementNode(e.children[i])&&t.appendChild(e.children[i]);else e.text?(BX.cleanNode(t),t.appendChild((t.ownerDocument||document).createTextNode(e.text))):e.html&&(t.innerHTML=e.html);return t},BX.remove=function(t){return null!=t.parentNode&&t.parentNode.removeChild(t),t=null,null},BX.cleanNode=function(t,e){if(t=BX(t),e=!!e,t&&t.childNodes)for(;t.childNodes.length>0;)t.removeChild(t.firstChild);return t&&e&&(t=BX.remove(t)),t},BX.addClass=function(t,e){var i;if(t=BX(t),e=BX.util.trim(e),""==e)return t;if(t)if(t.className)if(t.classList&&e.indexOf(" ")<0)t.classList.add(e);else{i=(e||"").split(r.space);for(var s=" "+t.className+" ",n=0,o=i.length;n<o;n++)s.indexOf(" "+i[n]+" ")<0&&(t.className+=" "+i[n])}else t.className=e;return t},BX.removeClass=function(t,e){if(t=BX(t),t&&t.className&&e)if(BX.type.isString(e))if(t.classList&&e.indexOf(" ")<0)t.classList.remove(e);else{for(var i=e.split(r.space),s=" "+t.className+" ",n=0,o=i.length;n<o;n++)s=s.replace(" "+i[n]+" "," ");t.className=BX.util.trim(s)}else t.className="";return t},BX.toggleClass=function(t,e){var i;if(BX.type.isArray(e)){i=" "+t.className+" ";for(var s=0,n=e.length;s<n;s++)if(BX.hasClass(t,e[s])){i=(" "+i+" ").replace(" "+e[s]+" "," "),i+=" "+e[s>=n-1?0:s+1],s--;break}s==n?t.className+=" "+e[0]:t.className=i,t.className=BX.util.trim(t.className)}else BX.type.isNotEmptyString(e)&&(t.classList?t.classList.toggle(e):(i=t.className,BX.hasClass(t,e)?i=(" "+i+" ").replace(" "+e+" "," "):i+=" "+e,t.className=BX.util.trim(i)));return t},BX.hasClass=function(t,e){return t&&BX.type.isDomNode(t)?!(!t.className||!e)&&(t.classList&&e&&e.indexOf(" ")<0?t.classList.contains(BX.util.trim(e)):(" "+t.className+" ").indexOf(" "+e+" ")>=0):(BX.debug(t),!1)},BX.hoverEvents=function(t){return t?BX.adjust(t,{events:BX.hoverEvents()}):{mouseover:BX.hoverEventsHover,mouseout:BX.hoverEventsHout}},BX.hoverEventsHover=function(){BX.addClass(this,"bx-hover"),this.BXHOVER=!0},BX.hoverEventsHout=function(){BX.removeClass(this,"bx-hover"),this.BXHOVER=!1},BX.focusEvents=function(t){return t?BX.adjust(t,{events:BX.focusEvents()}):{mouseover:BX.focusEventsFocus,mouseout:BX.focusEventsBlur}},BX.focusEventsFocus=function(){BX.addClass(this,"bx-focus"),this.BXFOCUS=!0},BX.focusEventsBlur=function(){BX.removeClass(this,"bx-focus"),this.BXFOCUS=!1},BX.setUnselectable=function(t){BX.addClass(t,"bx-unselectable"),t.setAttribute("unSelectable","on")},BX.setSelectable=function(t){BX.removeClass(t,"bx-unselectable"),t.removeAttribute("unSelectable")},BX.styleIEPropertyName=function(t){if("float"==t)t=BX.browser.IsIE()?"styleFloat":"cssFloat";else{var e=BX.browser.isPropertySupported(t);if(e)t=e;else{var i=/(\-([a-z]){1})/g;i.test(t)&&(t=t.replace(i,function(){return arguments[2].toUpperCase()}))}}return t},BX.style=function(t,e,i){if(!BX.type.isElementNode(t))return null;if(null==i){var s;if(t.currentStyle)s=t.currentStyle[BX.styleIEPropertyName(e)];else if(window.getComputedStyle){var n=BX.browser.isPropertySupported(e,!0);n&&(e=n),s=BX.GetContext(t).getComputedStyle(t,null).getPropertyValue(e)}return s||(s=""),s}return t.style[BX.styleIEPropertyName(e)]=i,t},BX.focus=function(t){try{return t.focus(),!0}catch(e){return!1}},BX.firstChild=function(t){for(var e=t.firstChild;e&&!BX.type.isElementNode(e);)e=e.nextSibling;return e},BX.lastChild=function(t){for(var e=t.lastChild;e&&!BX.type.isElementNode(e);)e=e.previousSibling;return e},BX.previousSibling=function(t){for(var e=t.previousSibling;e&&!BX.type.isElementNode(e);)var e=e.previousSibling;return e},BX.nextSibling=function(t){for(var e=t.nextSibling;e&&!BX.type.isElementNode(e);)var e=e.nextSibling;return e},BX.findChildren=function(t,e,i){return BX.findChild(t,e,i,!0)},BX.findChild=function(t,e,i,s){if(!t||!t.childNodes)return null;i=!!i,s=!!s;for(var n=t.childNodes.length,o=[],a=0;a<n;a++){var r=t.childNodes[a];if(_checkNode(r,e)){if(!s)return r;o.push(r)}if(1==i){var l=BX.findChild(r,e,i,s);if(l){if(!s)return l;o=BX.util.array_merge(o,l)}}}return s&&o.length>0?o:null},BX.findParent=function(t,e,i){if(!t)return null;for(var s=t;s.parentNode;){var n=s.parentNode;if(_checkNode(n,e))return n;if(s=n,i&&(BX.type.isFunction(i)||"object"==typeof i))if(BX.type.isElementNode(i)){if(s==i)break}else if(_checkNode(s,i))break}return null},BX.findNextSibling=function(t,e){if(!t)return null;for(var i=t;i.nextSibling;){var s=i.nextSibling;if(_checkNode(s,e))return s;i=s}return null},BX.findPreviousSibling=function(t,e){if(!t)return null;for(var i=t;i.previousSibling;){var s=i.previousSibling;if(_checkNode(s,e))return s;i=s}return null},BX.findFormElements=function(t){BX.type.isString(t)&&(t=document.forms[t]||BX(t));var e=[];return BX.type.isElementNode(t)&&(e="FORM"==t.tagName.toUpperCase()?t.elements:BX.findChildren(t,CHECK_FORM_ELEMENTS,!0)),e},BX.clone=function(t,e){var i,s,n;if(e!==!1&&(e=!0),null===t)return null;if(BX.type.isDomNode(t))i=t.cloneNode(e);else if("object"==typeof t)if(BX.type.isArray(t))for(i=[],s=0,n=t.length;s<n;s++)"object"==typeof t[s]&&e?i[s]=BX.clone(t[s],e):i[s]=t[s];else{i={},t.constructor&&(i=t.constructor===Date?new Date(t):new t.constructor);for(s in t)"object"==typeof t[s]&&e?i[s]=BX.clone(t[s],e):i[s]=t[s]}else i=t;return i},BX.bind=function(t,e,i){t&&("mousewheel"===e?BX.bind(t,"DOMMouseScroll",i):"transitionend"===e&&(BX.bind(t,"webkitTransitionEnd",i),BX.bind(t,"msTransitionEnd",i),BX.bind(t,"oTransitionEnd",i)),t.addEventListener?t.addEventListener(e,i,!1):t.attachEvent?t.attachEvent("on"+e,BX.proxy(i,t)):t["on"+e]=i,eventsList[eventsList.length]={element:t,event:e,fn:i})},BX.unbind=function(t,e,i){t&&("mousewheel"===e&&BX.unbind(t,"DOMMouseScroll",i),t.removeEventListener?t.removeEventListener(e,i,!1):t.detachEvent?t.detachEvent("on"+e,BX.proxy(i,t)):t["on"+e]=null)},BX.getEventButton=function(t){t=t||window.event;var e=0;if("undefined"!=typeof t.which)switch(t.which){case 1:e|=BX.MSLEFT;break;case 2:e|=BX.MSMIDDLE;break;case 3:e|=BX.MSRIGHT}else"undefined"!=typeof t.button&&(e=event.button);return e||BX.MSLEFT},BX.unbindAll=function(t){if(t){for(var e=0,i=eventsList.length;e<i;e++)try{!eventsList[e]||null!=t&&t!=eventsList[e].element||(BX.unbind(eventsList[e].element,eventsList[e].event,eventsList[e].fn),eventsList[e]=null)}catch(s){}null==t&&(eventsList=[])}};var captured_events=null,_bind=null;BX.CaptureEvents=function(t,e){return!_bind&&(_bind=BX.bind,captured_events=[],void(BX.bind=function(i,s,n){i===t&&s===e&&captured_events.push(n),_bind.apply(this,arguments)}))},BX.CaptureEventsGet=function(){if(_bind){BX.bind=_bind;var t=captured_events;return _bind=null,captured_events=null,t}},BX.fireEvent=function(t,e){var i=!1;if(BX.type.isDomNode(t))if(i=!0,document.createEventObject){if("MouseEvent"!=eventTypes[e]){var s=document.createEventObject();s.type=e,i=t.fireEvent("on"+e,s)}t[e]&&t[e]()}else{var s=null;switch(eventTypes[e]){case"MouseEvent":s=document.createEvent("MouseEvent"),s.initMouseEvent(e,!0,!0,top,1,0,0,0,0,0,0,0,0,0,null);break;default:s=document.createEvent("Event"),s.initEvent(e,!0,!0)}i=t.dispatchEvent(s)}return i},BX.getWheelData=function(t){return t=t||window.event,wheelData=t.detail?t.detail*-1:t.wheelDelta/40},BX.proxy_context=null,BX.delegate=function(t,e){return t&&e?function(){var i=BX.proxy_context;BX.proxy_context=this;var s=t.apply(e,arguments);return BX.proxy_context=i,s}:t},BX.delegateLater=function(t,e,i){return function(){if(e[t]){var s=BX.proxy_context;BX.proxy_context=this;var n=e[t].apply(i||e,arguments);return BX.proxy_context=s,n}}},BX._initObjectProxy=function(t){"undefined"==typeof t["__proxy_id_"+proxySalt]&&(t["__proxy_id_"+proxySalt]=proxyList.length,proxyList[t["__proxy_id_"+proxySalt]]={})},BX.proxy=function(t,e){return t&&e?(BX._initObjectProxy(e),"undefined"==typeof t["__proxy_id_"+proxySalt]&&(t["__proxy_id_"+proxySalt]=proxyId++),proxyList[e["__proxy_id_"+proxySalt]][t["__proxy_id_"+proxySalt]]||(proxyList[e["__proxy_id_"+proxySalt]][t["__proxy_id_"+proxySalt]]=BX.delegate(t,e)),proxyList[e["__proxy_id_"+proxySalt]][t["__proxy_id_"+proxySalt]]):t},BX.defer=function(t,e){return e?BX.defer_proxy(t,e):function(){var e=arguments;setTimeout(function(){t.apply(this,e)},10)}},BX.defer_proxy=function(t,e){if(!t||!e)return t;BX.proxy(t,e);return this._initObjectProxy(e),"undefined"==typeof t["__defer_id_"+proxySalt]&&(t["__defer_id_"+proxySalt]=proxyId++),proxyList[e["__proxy_id_"+proxySalt]][t["__defer_id_"+proxySalt]]||(proxyList[e["__proxy_id_"+proxySalt]][t["__defer_id_"+proxySalt]]=BX.defer(BX.delegate(t,e))),proxyList[e["__proxy_id_"+proxySalt]][t["__defer_id_"+proxySalt]]},BX.bindDelegate=function(t,e,i,s){var n=BX.delegateEvent(i,s);return BX.bind(t,e,n),n},BX.delegateEvent=function(t,e){return function(i){i=i||window.event;for(var s=i.target||i.srcElement;s!=this;){if(_checkNode(s,t))return e.call(s,i);if(!s||!s.parentNode)break;s=s.parentNode}}},BX.False=function(){return!1},BX.DoNothing=function(){},BX.denyEvent=function(t,e){deniedEvents.push([t,e,t["on"+e]]),t["on"+e]=BX.DoNothing},BX.allowEvent=function(t,e){for(var i=0,s=deniedEvents.length;i<s;i++)if(deniedEvents[i][0]==t&&deniedEvents[i][1]==e)return t["on"+e]=deniedEvents[i][2],void BX.util.deleteFromArray(deniedEvents,i)},BX.fixEventPageXY=function(t){return BX.fixEventPageX(t),BX.fixEventPageY(t),t},BX.fixEventPageX=function(t){return null==t.pageX&&null!=t.clientX&&(t.pageX=t.clientX+(document.documentElement&&document.documentElement.scrollLeft||document.body&&document.body.scrollLeft||0)-(document.documentElement.clientLeft||0)),t},BX.fixEventPageY=function(t){return null==t.pageY&&null!=t.clientY&&(t.pageY=t.clientY+(document.documentElement&&document.documentElement.scrollTop||document.body&&document.body.scrollTop||0)-(document.documentElement.clientTop||0)),
t},BX.PreventDefault=function(t){return t||(t=window.event),t.stopPropagation?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!0,t.returnValue=!1),!1},BX.eventReturnFalse=function(t){return t=t||window.event,t&&t.preventDefault?t.preventDefault():t.returnValue=!1,!1},BX.eventCancelBubble=function(t){t=t||window.event,t&&t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},BX.addCustomEvent=function(t,e,i){BX.type.isString(t)&&(i=e,e=t,t=window),e=e.toUpperCase(),customEvents[e]||(customEvents[e]=[]),customEvents[e].push({handler:i,obj:t})},BX.removeCustomEvent=function(t,e,i){if(BX.type.isString(t)&&(i=e,e=t,t=window),e=e.toUpperCase(),customEvents[e])for(var s=0,n=customEvents[e].length;s<n;s++)if(customEvents[e][s]&&customEvents[e][s].handler==i&&customEvents[e][s].obj==t)return void delete customEvents[e][s]},BX.onCustomEvent=function(t,e,i){if(BX.type.isString(t)&&(i=e,e=t,t=window),e=e.toUpperCase(),customEvents[e]){i||(i=[]);for(var s,n=0,o=customEvents[e].length;n<o;n++)s=customEvents[e][n],s&&s.handler&&(s.obj!=window&&s.obj!=t||s.handler.apply(t,i))}},BX.parseJSON=function(data,context){var result=null;if(BX.type.isString(data))try{data.indexOf("\n")>=0?eval("result = "+data):result=new Function("return "+data)()}catch(e){BX.onCustomEvent(context,"onParseJSONFailure",[data,context])}return result},BX.isReady=!1,BX.ready=function(t){bindReady(),BX.type.isFunction(t)?BX.isReady?t.call(document):readyList&&readyList.push(t):BX.debug("READY: not a function! ",t)},BX.submit=function(t,e,i,s){e=e||"save",t["BXFormSubmit_"+e]||(t["BXFormSubmit_"+e]=t.appendChild(BX.create("INPUT",{props:{type:"submit",name:e,value:i||"Y"},style:{display:"none"}}))),t.sessid&&(t.sessid.value=BX.bitrix_sessid()),setTimeout(BX.delegate(function(){BX.fireEvent(this,"click"),s&&s()},t["BXFormSubmit_"+e]),10)},BX.browser={IsIE:function(){return bIE},IsIE6:function(){return/MSIE 6/i.test(navigator.userAgent)},IsIE9:function(){return!!document.documentMode&&document.documentMode>=9},IsIE10:function(){return!!document.documentMode&&document.documentMode>=10},IsOpera:function(){return bOpera},IsSafari:function(){return bSafari},IsFirefox:function(){return bFirefox},IsChrome:function(){return bChrome},IsMac:function(){return/Macintosh/i.test(navigator.userAgent)},IsAndroid:function(){return/Android/i.test(navigator.userAgent)},IsIOS:function(){return/(iPad;)|(iPhone;)/i.test(navigator.userAgent)},IsDoctype:function(t){return t=t||document,t.compatMode?"CSS1Compat"==t.compatMode:!(!t.documentElement||!t.documentElement.clientHeight)},SupportLocalStorage:function(){return!!BX.localStorage&&!!BX.localStorage.checkBrowser()},addGlobalClass:function(){BX.browser.IsIOS()&&BX.addClass(document.documentElement,"bx-ios"),/AppleWebKit/.test(navigator.userAgent)?BX.addClass(document.documentElement,"bx-chrome"):/MSIE 8/.test(navigator.userAgent)?BX.addClass(document.documentElement,"bx-ie bx-ie8"+(BX.browser.IsDoctype()?"":" bx-quirks")):/MSIE 9/.test(navigator.userAgent)?BX.addClass(document.documentElement,"bx-ie bx-ie9"+(BX.browser.IsDoctype()?"":" bx-quirks")):/MSIE 10/.test(navigator.userAgent)?BX.addClass(document.documentElement,"bx-ie bx-ie10"):/Opera/.test(navigator.userAgent)?BX.addClass(document.documentElement,"bx-opera"):/Gecko/.test(navigator.userAgent)&&BX.addClass(document.documentElement,"bx-firefox"),BX.browser.addGlobalClass=BX.DoNothing},isPropertySupported:function(t,e){function i(t){return t.replace(/([A-Z])/g,function(){return"-"+arguments[1].toLowerCase()})}function s(t){var e=/(\-([a-z]){1})/g;return e.test(t)?t.replace(e,function(){return arguments[2].toUpperCase()}):t}if(!BX.type.isNotEmptyString(t))return!1;var n=t.indexOf("-")>-1?s(t):t;e=!!e;for(var o=n.charAt(0).toUpperCase()+n.slice(1),a=(n+" "+["Webkit","Moz","O","ms"].join(o+" ")+o).split(" "),r=document.body||document.documentElement,l=0;l<a.length;l++){var d=a[l];if(void 0!==r.style[d]){var h=d==n?"":"-"+d.substr(0,d.length-n.length).toLowerCase()+"-";return e?h+i(n):d}}return!1},addGlobalFeatures:function(t,e){if(BX.type.isArray(t)){for(var i=[],s=0;s<t.length;s++){var n=!!BX.browser.isPropertySupported(t[s]);i.push("bx-"+(n?"":"no-")+t[s].toLowerCase())}BX.addClass(document.documentElement,i.join(" "))}}},BX.show=function(t,e){!t.BXDISPLAY&&_checkDisplay(t,e)||(t.style.display=t.BXDISPLAY)},BX.hide=function(t,e){t.BXDISPLAY||_checkDisplay(t,e),t.style.display="none"},BX.toggle=function(t,e){if(!e&&BX.type.isElementNode(t)){var i=!0;i=t.BXDISPLAY?!_checkDisplay(t):"none"==t.style.display,i?BX.show(t):BX.hide(t)}else if(BX.type.isArray(e)){for(var s=0,n=e.length;s<n;s++)if(t==e[s]){t=e[s==n-1?0:s+1];break}s==n&&(t=e[0])}return t},BX.util={array_values:function(t){if(!BX.type.isArray(t))return BX.util._array_values_ob(t);for(var e=[],i=0,s=t.length;i<s;i++)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(t[i]);return e},_array_values_ob:function(t){var e=[];for(var i in t)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(t[i]);return e},array_keys:function(t){if(!BX.type.isArray(t))return BX.util._array_keys_ob(t);for(var e=[],i=0,s=t.length;i<s;i++)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(i);return e},_array_keys_ob:function(t){var e=[];for(var i in t)null!==t[i]&&"undefined"!=typeof t[i]&&e.push(i);return e},array_merge:function(t,e){BX.type.isArray(t)||(t=[]),BX.type.isArray(e)||(e=[]);var i=t.length,s=0;if("number"==typeof e.length)for(var n=e.length;s<n;s++)t[i++]=e[s];else for(;void 0!==e[s];)t[i++]=e[s++];return t.length=i,t},array_unique:function(t){var e,i=0,s=t.length;if(s<2)return t;for(;i<s-1;i++)for(e=i+1;e<s;e++)t[i]==t[e]&&(t.splice(e--,1),s--);return t},in_array:function(t,e){for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},array_search:function(t,e){for(var i=0;i<e.length;i++)if(e[i]==t)return i;return-1},object_search_key:function(t,e){if(e[t])return e[t];for(var i in e)if("object"==typeof e[i]){var s=BX.util.object_search_key(t,e[i]);if(s!==!1)return s}return!1},trim:function(t){return BX.type.isString(t)?t.replace(r.ltrim,"").replace(r.rtrim,""):t},urlencode:function(t){return encodeURIComponent(t)},deleteFromArray:function(t,e){return t.slice(0,e).concat(t.slice(e+1))},insertIntoArray:function(t,e,i){return t.slice(0,e).concat([i]).concat(t.slice(e))},htmlspecialchars:function(t){return t.replace?t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t},htmlspecialcharsback:function(t){return t.replace?t.replace(/\&quot;/g,'"').replace(/&#39;/g,"'").replace(/\&lt;/g,"<").replace(/\&gt;/g,">").replace(/\&amp;/g,"&"):t},preg_quote:function(t,e){return t.replace?t.replace(new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\"+(e||"")+"-]","g"),"\\$&"):t},jsencode:function(t){if(!t||!t.replace)return t;for(var e=[{c:"\\\\",r:"\\\\"},{c:"\\t",r:"\\t"},{c:"\\n",r:"\\n"},{c:"\\r",r:"\\r"},{c:'"',r:'\\"'},{c:"'",r:"\\'"},{c:"<",r:"\\x3C"},{c:">",r:"\\x3E"},{c:"\\u2028",r:"\\u2028"},{c:"\\u2029",r:"\\u2029"}],i=0;i<e.length;i++)t=t.replace(new RegExp(e[i].c,"g"),e[i].r);return t},str_pad:function(t,e,i,s){return i=i||" ",s=s||"right",t=t.toString(),"left"==s?BX.util.str_pad_left(t,e,i):BX.util.str_pad_right(t,e,i)},str_pad_left:function(t,e,i){var s=t.length,n=i.length;if(s>=e)return t;for(;s<e;s+=n)t=i+t;return t},str_pad_right:function(t,e,i){var s=t.length,n=i.length;if(s>=e)return t;for(;s<e;s+=n)t+=i;return t},strip_tags:function(t){return t.split(/<[^>]+>/g).join("")},popup:function(t,e,i){var s,n;BX.browser.IsOpera()?(s=document.body.offsetWidth,n=document.body.offsetHeight):(s=screen.width,n=screen.height),window.open(t,"","status=no,scrollbars=yes,resizable=yes,width="+e+",height="+i+",top="+Math.floor((n-i)/2-14)+",left="+Math.floor((s-e)/2-5))},objectSort:function(t,e,i){i="asc"==i?"asc":"desc";var s=Array();for(var n in t)t[n][e]&&s.push([n,t[n][e]]);"asc"==i?s.sort(function(t,e){if(isNaN(t[1])||isNaN(e[1]))var i=t[1].toString().toLowerCase(),s=e[1].toString().toLowerCase();else var i=parseInt(t[1]),s=parseInt(e[1]);return i>s?1:i<s?-1:0}):s.sort(function(t,e){if(isNaN(t[1])||isNaN(e[1]))var i=t[1].toString().toLowerCase(),s=e[1].toString().toLowerCase();else var i=parseInt(t[1]),s=parseInt(e[1]);return i<s?1:i>s?-1:0});for(var o=Array(),n=0;n<s.length;n++)o.push(t[s[n][0]]);return o},hex2rgb:function(t){for(var e=t.replace(/[# ]/g,"").replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3").match(/.{2}/g),i=0;i<3;i++)e[i]=parseInt(e[i],16);return{r:e[0],g:e[1],b:e[2]}},remove_url_param:function(t,e){if(BX.type.isArray(e))for(var i=0;i<e.length;i++)t=BX.util.remove_url_param(t,e[i]);else t=t.replace(new RegExp("([?&])"+e+"=[^&]*[&]*","i"),"$1");return t},even:function(t){return parseInt(t)%2==0}},BX.type={isString:function(t){return""===t||!!t&&("string"==typeof t||t instanceof String)},isNotEmptyString:function(t){return!!BX.type.isString(t)&&t.length>0},isBoolean:function(t){return t===!0||t===!1},isNumber:function(t){return 0===t||!!t&&("number"==typeof t||t instanceof Number)},isFunction:function(t){return null!==t&&("function"==typeof t||t instanceof Function)},isElementNode:function(t){return t&&"object"==typeof t&&"nodeType"in t&&1==t.nodeType&&t.tagName&&"SCRIPT"!=t.tagName.toUpperCase()&&"STYLE"!=t.tagName.toUpperCase()&&"LINK"!=t.tagName.toUpperCase()},isDomNode:function(t){return t&&"object"==typeof t&&"nodeType"in t},isArray:function(t){return t&&"[object Array]"==Object.prototype.toString.call(t)},isDate:function(t){return t&&"[object Date]"==Object.prototype.toString.call(t)}},BX.isNodeInDom=function(t){return t===document||!!t.parentNode&&BX.isNodeInDom(t.parentNode)},BX.isNodeHidden=function(t){return t!==document&&("none"==BX.style(t,"display")||(!t.parentNode||BX.isNodeHidden(t.parentNode)))},BX.evalPack=function(t){for(;t.length>0;){var e=t.shift();"SCRIPT_EXT"==e.TYPE||"SCRIPT_SRC"==e.TYPE?BX.loadScript(e.DATA,function(){BX.evalPack(t)}):"SCRIPT"==e.TYPE&&BX.evalGlobal(e.DATA)}},BX.evalGlobal=function(t){if(t){var e=document.getElementsByTagName("head")[0]||document.documentElement,i=document.createElement("script");i.type="text/javascript",BX.browser.IsIE()?i.text=t:i.appendChild(document.createTextNode(t)),e.insertBefore(i,e.firstChild),e.removeChild(i)}},BX.processHTML=function(t,e){for(var i,s=[],n=[],o=t;null!==(i=o.match(r.script));){var a=o.search(/<\/script>/i);if(a==-1)break;var l,d=e||"-1"!=i[1].indexOf("bxrunfirst");if(null!==(l=i[1].match(r.script_src)))s.push({bRunFirst:d,isInternal:!1,JS:l[1]});else{var h=i.index+i[0].length,c=o.substr(h,a-h);s.push({bRunFirst:d,isInternal:!0,JS:c})}o=o.substr(0,i.index)+o.substr(a+9)}for(;null!==(matchStyle=o.match(r.style));){var p;null!==(p=matchStyle[0].match(r.style_href))&&matchStyle[0].indexOf('media="')<0&&n.push(p[1]),o=o.replace(matchStyle[0],"")}return{HTML:o,SCRIPT:s,STYLE:n}},BX.garbage=function(t,e){garbageCollectors.push({callback:t,context:e})},BX.GetDocElement=function(t){return t=t||document,BX.browser.IsDoctype(t)?t.documentElement:t.body},BX.GetContext=function(t){return BX.type.isElementNode(t)?t.ownerDocument.parentWindow||t.ownerDocument.defaultView||window:BX.type.isDomNode(t)?t.parentWindow||t.defaultView||window:window},BX.GetWindowInnerSize=function(t){var e,i;return t=t||document,self.innerHeight?(e=BX.GetContext(t).innerWidth,i=BX.GetContext(t).innerHeight):t.documentElement&&(t.documentElement.clientHeight||t.documentElement.clientWidth)?(e=t.documentElement.clientWidth,i=t.documentElement.clientHeight):t.body&&(e=t.body.clientWidth,i=t.body.clientHeight),{innerWidth:e,innerHeight:i}},BX.GetWindowScrollPos=function(t){var e,i;return t=t||document,self.pageYOffset?(e=BX.GetContext(t).pageXOffset,i=BX.GetContext(t).pageYOffset):t.documentElement&&(t.documentElement.scrollTop||t.documentElement.scrollLeft)?(e=t.documentElement.scrollLeft,i=t.documentElement.scrollTop):t.body&&(e=t.body.scrollLeft,i=t.body.scrollTop),{scrollLeft:e,scrollTop:i}},BX.GetWindowScrollSize=function(t){var e,i;return t||(t=document),t.compatMode&&"CSS1Compat"==t.compatMode?(e=t.documentElement.scrollWidth,i=t.documentElement.scrollHeight):(i=t.body.scrollHeight>t.body.offsetHeight?t.body.scrollHeight:t.body.offsetHeight,e=t.body.scrollWidth>t.body.offsetWidth||t.compatMode&&"BackCompat"==t.compatMode||t.documentElement&&!t.documentElement.clientWidth?t.body.scrollWidth:t.body.offsetWidth),{scrollWidth:e,scrollHeight:i}},BX.GetWindowSize=function(t){var e=this.GetWindowInnerSize(t),i=this.GetWindowScrollPos(t),s=this.GetWindowScrollSize(t);return{innerWidth:e.innerWidth,innerHeight:e.innerHeight,scrollLeft:i.scrollLeft,scrollTop:i.scrollTop,scrollWidth:s.scrollWidth,scrollHeight:s.scrollHeight}},BX.hide_object=function(t){t=BX(t),t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.height="10px",t.style.width="10px"},BX.is_relative=function(t){var e=BX.style(t,"position");return"relative"==e||"absolute"==e},BX.is_float=function(t){var e=BX.style(t,"float");return"right"==e||"left"==e},BX.is_fixed=function(t){var e=BX.style(t,"position");return"fixed"==e},BX.pos=function(t,e){var i={top:0,right:0,bottom:0,left:0,width:0,height:0};if(e=!!e,!t)return i;if("undefined"==typeof t.getBoundingClientRect||t.ownerDocument!=document||e){for(var s=0,n=0,o=t.offsetWidth,a=t.offsetHeight,r=!0;null!=t&&(r||!e||!BX.is_relative(t));t=t.offsetParent)if(s+=t.offsetLeft,n+=t.offsetTop,r)r=!1;else{var l=parseInt(BX.style(t,"border-left-width")),d=parseInt(BX.style(t,"border-top-width"));!isNaN(l)&&l>0&&(s+=l),!isNaN(d)&&d>0&&(n+=d)}i.top=n,i.left=s,i.width=o,i.height=a,i.right=i.left+o,i.bottom=i.top+a}else{var h=t.getBoundingClientRect(),c=document.documentElement,p=document.body;i.top=h.top+c.scrollTop+p.scrollTop,i.left=h.left+c.scrollLeft+p.scrollLeft,i.width=h.right-h.left,i.height=h.bottom-h.top,i.right=h.right+c.scrollLeft+p.scrollLeft,i.bottom=h.bottom+c.scrollTop+p.scrollTop}for(var u in i)i[u]=parseInt(i[u]);return i},BX.align=function(t,e,i,s){s=s?s.toLowerCase():"";var n=document;BX.type.isElementNode(t)&&(n=t.ownerDocument,t=BX.pos(t));var o=t.left,a=t.bottom,r=BX.GetWindowScrollPos(n),l=BX.GetWindowInnerSize(n);return l.innerWidth+r.scrollLeft-(t.left+e)<0&&(o=t.right-e>=0?t.right-e:r.scrollLeft),(l.innerHeight+r.scrollTop-(t.bottom+i)<0||~s.indexOf("top"))&&(a=t.top-i>=0||~s.indexOf("top")?t.top-i:r.scrollTop),{left:o,top:a}},BX.scrollToNode=function(t){var e=BX(t);if(e.scrollIntoView)e.scrollIntoView(!0);else{var i=BX.pos(e);window.scrollTo(i.left,i.top)}},BX.showWait=function(t,e){t=BX(t)||document.body||document.documentElement,e=e||BX.message("JS_CORE_LOADING");var i=t.id||Math.random(),s=t.bxmsg=document.body.appendChild(BX.create("DIV",{props:{id:"wait_"+i,className:"bx-core-waitwindow"},text:e}));return setTimeout(BX.delegate(_adjustWait,t),10),lastWait[lastWait.length]=s,s},BX.closeWait=function(t,e){if(t&&!e&&(e=t.bxmsg),t&&!e&&BX.hasClass(t,"bx-core-waitwindow")&&(e=t),t&&!e&&(e=BX("wait_"+t.id)),e||(e=lastWait.pop()),e&&e.parentNode){for(var i=0,s=lastWait.length;i<s;i++)if(e==lastWait[i]){lastWait=BX.util.deleteFromArray(lastWait,i);break}e.parentNode.removeChild(e),t&&(t.bxmsg=null),BX.cleanNode(e,!0)}},BX.setKernelJS=function(t){BX.type.isArray(t)&&(arKernelJS=t)},BX.getKernelJS=function(){return arKernelJS},BX.loadScript=function(t,e,i){if(!BX.isReady){var s=arguments;return void BX.ready(function(){BX.loadScript.apply(this,s)})}i=i||document,BX.type.isString(t)&&(t=[t]);var n=function(){return e&&BX.type.isFunction(e)?e():null},o=function(e){if(e>=t.length)return n();if(t[e]){var s=i.getElementsByTagName("head")[0]||i.documentElement,a=i.createElement("script");a.src=t[e];var r=t[e].indexOf(".js?");if(r>0?fileSrc=t[e].substr(0,r+3):fileSrc=t[e],!_isScriptLoaded(fileSrc)){var l=!1;return a.onload=a.onreadystatechange=function(){l||a.readyState&&"loaded"!=a.readyState&&"complete"!=a.readyState||(l=!0,setTimeout(function(){o(++e)},50),a.onload=a.onreadystatechange=null,s&&a.parentNode&&s.removeChild(a))},s.insertBefore(a,s.firstChild)}o(++e)}else o(++e)};o(0)},BX.loadCSS=function(t,e,i){if(!BX.isReady){var s=arguments;return BX.ready(function(){BX.loadCSS.apply(this,s)}),null}if(BX.type.isString(t)){var n=!0;t=[t]}var o=0,a=t.length,r=null,l=[];if(0==a)return null;if(e=e||document,i=i||window,_checkCssList(),!i.bxhead){var d=e.getElementsByTagName("HEAD");if(i.bxhead=d[0],!i.bxhead)return null}for(o=0;o<a;o++){var h=t[o].replace(/\.css(\?\d*)/,".css").replace(/^(http[s]*:)*\/\/[^\/]+/i,"");BX.util.in_array(h,cssList)||(r=document.createElement("LINK"),r.href=t[o],r.rel="stylesheet",r.type="text/css",i.bxhead.appendChild(r),l.push(r),cssList.push(h))}return n?r:l},BX.reload=function(t,e){t===!0&&(e=!0,t=null);var i=t||top.location.href,s=i.indexOf("#"),n="";s!=-1&&(n=i.substr(s),i=i.substr(0,s)),e&&i.indexOf("clear_cache=Y")<0&&(i+=(i.indexOf("?")==-1?"?":"&")+"clear_cache=Y"),n&&(e&&("view/"==n.substr(0,5)||"#view/"==n.substr(0,6))&&n.indexOf("clear_cache%3DY")<0&&(n+=(n.indexOf("%3F")==-1?"%3F":"%26")+"clear_cache%3DY"),i=i.replace(/(\?|\&)_r=[\d]*/,""),i+=(i.indexOf("?")==-1?"?":"&")+"_r="+Math.round(1e4*Math.random())+n),top.location.href=i},BX.clearCache=function(){BX.showWait(),BX.reload(!0)},BX.template=function(t,e,i){BX.ready(function(){_processTpl(BX(t),e,i)})},BX.isAmPmMode=function(){return null!=BX.message("FORMAT_DATETIME").match("T")},BX.formatDate=function(t,e){t=t||new Date;var i=t.getHours()||t.getMinutes()||t.getSeconds(),s=e?e:i?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");return s.replace(/YYYY/gi,t.getFullYear()).replace(/MMMM/gi,BX.util.str_pad_left((t.getMonth()+1).toString(),2,"0")).replace(/MM/gi,BX.util.str_pad_left((t.getMonth()+1).toString(),2,"0")).replace(/DD/gi,BX.util.str_pad_left(t.getDate().toString(),2,"0")).replace(/HH/gi,BX.util.str_pad_left(t.getHours().toString(),2,"0")).replace(/MI/gi,BX.util.str_pad_left(t.getMinutes().toString(),2,"0")).replace(/SS/gi,BX.util.str_pad_left(t.getSeconds().toString(),2,"0"))},BX.getNumMonth=function(t){var e=["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"],s=["january","february","march","april","may","june","july","august","september","october","november","december"],n=t.toUpperCase();for(i=1;i<=12;i++)if(n==BX.message("MON_"+i).toUpperCase()||n==BX.message("MONTH_"+i).toUpperCase()||n==e[i-1].toUpperCase()||n==s[i-1].toUpperCase())return i;return t},BX.parseDate=function(t){if(BX.type.isNotEmptyString(t)){var e="";for(i=1;i<=12;i++)e=e+"|"+BX.message("MON_"+i);var i,s,n=new RegExp("([0-9]+|[a-z]+"+e+")","ig"),o=t.match(n),a=BX.message("FORMAT_DATE").match(/(DD|MI|MMMM|MM|M|YYYY)/gi),r=[],l=[],d={};if(!o)return null;for(o.length>a.length&&(a=BX.message("FORMAT_DATETIME").match(/(DD|MI|MMMM|MM|M|YYYY|HH|H|SS|TT|T|GG|G)/gi)),i=0,s=o.length;i<s;i++)""!=BX.util.trim(o[i])&&(r[r.length]=o[i]);for(i=0,s=a.length;i<s;i++)""!=BX.util.trim(a[i])&&(l[l.length]=a[i]);var h=BX.util.array_search("MMMM",l);for(h>0?(r[h]=BX.getNumMonth(r[h]),l[h]="MM"):(h=BX.util.array_search("M",l),h>0&&(r[h]=BX.getNumMonth(r[h]),l[h]="MM")),i=0,s=l.length;i<s;i++){var c=l[i].toUpperCase();d[c]="T"==c||"TT"==c?r[i]:parseInt(r[i],10)}if(d.DD>0&&d.MM>0&&d.YYYY>0){var p=new Date;if(p.setDate(1),p.setFullYear(d.YYYY),p.setMonth(d.MM-1),p.setDate(d.DD),p.setHours(0,0,0),!(isNaN(d.HH)&&isNaN(d.GG)&&isNaN(d.H)&&isNaN(d.G)||isNaN(d.MI))){if(isNaN(d.H)&&isNaN(d.G))d.HH=parseInt(d.HH||d.GG||0,10);else{var u="PM"==(d.T||d.TT||"am").toUpperCase();d.HH=parseInt(d.H||d.G||0,10)+(u?12:0)}isNaN(d.SS)&&(d.SS=0),p.setHours(d.HH,d.MI,d.SS)}return p}}return null},BX.selectUtils={addNewOption:function(t,e,i,s,n){if(t=BX(t)){var o=t.length;if(n!==!1)for(var a=0;a<o;a++)if(t[a].value==e)return;var r=new Option(i,e,(!1),(!1));t.options[o]=r}s===!0&&this.sortSelect(select_id)},deleteOption:function(t,e){if(t=BX(t))for(var i=0;i<t.length;i++)if(t[i].value==e){t.remove(i);break}},deleteSelectedOptions:function(t){var e=BX(t);if(e)for(var i=0;i<e.length;)e[i].selected?(e[i].selected=!1,e.remove(i)):i++},deleteAllOptions:function(t){if(t=BX(t))for(var e=t.length-1;e>=0;e--)t.remove(e)},optionCompare:function(t,e){var i=t.optText.toLowerCase(),s=e.optText.toLowerCase();return i>s?1:i<s?-1:0},sortSelect:function(t){if(t=BX(select_id)){for(var e=[],i=t.options.length,s=0;s<i;s++)e[s]={optText:t[s].text,optValue:t[s].value};e.sort(this.optionCompare),t.length=0,i=e.length;for(var s=0;s<i;s++){var n=new Option(e[s].optText,e[s].optValue,(!1),(!1));t[s]=n}}},selectAllOptions:function(t){if(t=BX(select_id))for(var e=t.length,i=0;i<e;i++)t[i].selected=!0},selectOption:function(t,e){if(t=BX(select_id))for(var i=t.length,s=0;s<i;s++)t[s].selected=t[s].value==e},addSelectedOptions:function(t,e,i,s){if(t=BX(t))for(var n=t.length,o=0;o<n;o++)t[o].selected&&this.addNewOption(e,t[o].value,t[o].text,s,i)},moveOptionsUp:function(t){if(t=BX(t))for(var e=t.length,i=0;i<e;i++)if(t[i].selected&&i>0&&0==t[i-1].selected){var s=new Option(t[i].text,t[i].value),n=new Option(t[i-1].text,t[i-1].value);t[i]=n,t[i].selected=!1,t[i-1]=s,t[i-1].selected=!0}},moveOptionsDown:function(t){if(t=BX(t))for(var e=t.length,i=e-1;i>=0;i--)if(t[i].selected&&i<e-1&&0==t[i+1].selected){var s=new Option(t[i].text,t[i].value),n=new Option(t[i+1].text,t[i+1].value);t[i]=n,t[i].selected=!1,t[i+1]=s,t[i+1].selected=!0}}},BX.hint=function(t,e,i,s){null==i&&(i=e,e=""),null==t.BXHINT&&(t.BXHINT=new BX.CHint({parent:t,hint:i,title:e,id:s}),t.BXHINT.Show())},BX.hint_replace=function(t,e,i){if(null==i&&(i=e,e=""),!t||!t.parentNode||!i)return null;var s=new BX.CHint({hint:i,title:e});return s.CreateParent(),t.parentNode.insertBefore(s.PARENT,t),t.parentNode.removeChild(t),s.PARENT.style.marginLeft="5px",t},BX.CHint=function(t){this.PARENT=BX(t.parent),this.HINT=t.hint,this.HINT_TITLE=t.title,this.PARAMS={};for(var e in this.defaultSettings)null==t[e]?this.PARAMS[e]=this.defaultSettings[e]:this.PARAMS[e]=t[e];null!=t.id&&(this.ID=t.id),this.timer=null,this.bInited=!1,this.msover=!0,this.PARAMS.showOnce?(this.__show(),this.msover=!1,this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)):this.PARENT&&(BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))),BX.addCustomEvent("onMenuOpen",BX.delegate(this.disable,this)),BX.addCustomEvent("onMenuClose",BX.delegate(this.enable,this))},BX.CHint.prototype.defaultSettings={show_timeout:1e3,hide_timeout:500,dx:2,showOnce:!1,preventHide:!0,min_width:250},BX.CHint.prototype.CreateParent=function(t,e){this.PARENT&&(BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))),e||(e={});var i="icon";return!e.type||"link"!=e.type&&"icon"!=e.type||(i=e.type),t&&(i="element"),"icon"==i?t=BX.create("IMG",{props:{src:e.iconSrc?e.iconSrc:"/bitrix/js/main/core/images/hint.gif"}}):"link"==i&&(t=BX.create("A",{props:{href:"javascript:void(0)"},html:"[?]"})),this.PARENT=t,BX.bind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.bind(this.PARENT,"mouseout",BX.proxy(this.Hide,this)),this.PARENT},BX.CHint.prototype.Show=function(){this.msover=!0,null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(BX.proxy(this.__show,this),this.PARAMS.show_timeout)},BX.CHint.prototype.Hide=function(){this.msover=!1,null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout)},BX.CHint.prototype.__show=function(){this.msover&&!this.disabled&&(this.bInited||this.Init(),this.prepareAdjustPos()&&(this.DIV.style.display="block",this.adjustPos(),BX.bind(window,"scroll",BX.proxy(this.__onscroll,this)),this.PARAMS.showOnce&&(this.timer=setTimeout(BX.proxy(this.__hide,this),this.PARAMS.hide_timeout))))},BX.CHint.prototype.__onscroll=function(){BX.admin&&BX.admin.panel&&BX.admin.panel.isFixed()&&(this.scrollTimer&&clearTimeout(this.scrollTimer),this.DIV.style.display="none",this.scrollTimer=setTimeout(BX.proxy(this.Reopen,this),this.PARAMS.show_timeout))},BX.CHint.prototype.Reopen=function(){null!=this.timer&&clearTimeout(this.timer),this.timer=setTimeout(BX.proxy(this.__show,this),50)},BX.CHint.prototype.__hide=function(){this.msover||this.bInited&&(BX.unbind(window,"scroll",BX.proxy(this.Reopen,this)),this.PARAMS.showOnce?this.Destroy():this.DIV.style.display="none")},BX.CHint.prototype.__hide_immediately=function(){this.msover=!1,this.__hide()},BX.CHint.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip"},style:{display:"none"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-top-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'}),this.CONTENT=BX.create("DIV",{props:{className:"bx-panel-tooltip-content"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay"},children:[BX.create("DIV",{props:{className:"bx-panel-tooltip-underlay-bg"}})]})]}),BX.create("DIV",{props:{className:"bx-panel-tooltip-bottom-border"},html:'<div class="bx-panel-tooltip-corner bx-panel-tooltip-left-corner"></div><div class="bx-panel-tooltip-border"></div><div class="bx-panel-tooltip-corner bx-panel-tooltip-right-corner"></div>'})]})),this.ID&&this.CONTENT.insertBefore(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-panel-tooltip-close"},events:{click:BX.delegate(this.Close,this)}}),this.CONTENT.firstChild),this.HINT_TITLE&&this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-title"},text:this.HINT_TITLE})),this.HINT&&(this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))),this.PARAMS.preventHide&&(BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this)),BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))),this.bInited=!0},BX.CHint.prototype.setContent=function(t){this.HINT=t,this.CONTENT_TEXT?this.CONTENT_TEXT.innerHTML=this.HINT:this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-panel-tooltip-text"}})).appendChild(BX.create("SPAN",{html:this.HINT}))},BX.CHint.prototype.prepareAdjustPos=function(){return this._wnd={scrollPos:BX.GetWindowScrollPos(),scrollSize:BX.GetWindowScrollSize()},"none"!=BX.style(this.PARENT,"display")},BX.CHint.prototype.getAdjustPos=function(){var t={},e=BX.pos(this.PARENT);if(t.top=e.bottom+this.PARAMS.dx,BX.admin&&BX.admin.panel.DIV){var i=BX.admin.panel.DIV.offsetHeight+this.PARAMS.dx;BX.admin.panel.isFixed()&&(i+=this._wnd.scrollPos.scrollTop)}if(t.top<i?t.top=i:t.top+this.DIV.offsetHeight>this._wnd.scrollSize.scrollHeight&&(t.top=e.top-this.PARAMS.dx-this.DIV.offsetHeight),t.left=e.left,e.left<this.PARAMS.dx)e.left=this.PARAMS.dx;else{floatWidth=this.DIV.offsetWidth;var s=this._wnd.scrollSize.scrollWidth-floatWidth-this.PARAMS.dx;t.left>s&&(t.left=s)}return t},BX.CHint.prototype.adjustWidth=function(){if(!this.bWidthAdjusted){var t=this.DIV.offsetWidth,e=this.DIV.offsetHeight;t>this.PARAMS.min_width&&(t=Math.round(Math.sqrt(1.618*t*e))),t<this.PARAMS.min_width&&(t=this.PARAMS.min_width),this.DIV.style.width=t+"px",this._adjustWidthInt&&clearInterval(this._adjustWidthInt),this._adjustWidthInt=setInterval(BX.delegate(this._adjustWidthInterval,this),5),this.bWidthAdjusted=!0}},BX.CHint.prototype._adjustWidthInterval=function(){this.DIV&&"none"!=this.DIV.style.display||clearInterval(this._adjustWidthInt);var t=20,e=1500,i=this.DIV.offsetWidth,s=this.CONTENT_TEXT.offsetWidth;return i>0&&s>0&&i-s<t&&i<e?void(this.DIV.style.width=i+t+"px"):void clearInterval(this._adjustWidthInt)},BX.CHint.prototype.adjustPos=function(){this.adjustWidth();var t=this.getAdjustPos();this.DIV.style.top=t.top+"px",this.DIV.style.left=t.left+"px"},BX.CHint.prototype.Close=function(){this.ID&&BX.WindowManager&&BX.WindowManager.saveWindowOptions(this.ID,{display:"off"}),this.__hide_immediately(),this.Destroy()},BX.CHint.prototype.Destroy=function(){this.PARENT&&(BX.unbind(this.PARENT,"mouseover",BX.proxy(this.Show,this)),BX.unbind(this.PARENT,"mouseout",BX.proxy(this.Hide,this))),this.DIV&&(BX.unbind(this.DIV,"mouseover",BX.proxy(this.Show,this)),BX.unbind(this.DIV,"mouseout",BX.proxy(this.Hide,this)),BX.cleanNode(this.DIV,!0))},BX.CHint.prototype.enable=function(){this.disabled=!1},BX.CHint.prototype.disable=function(){this.__hide_immediately(),this.disabled=!0},document.addEventListener?__readyHandler=function(){document.removeEventListener("DOMContentLoaded",__readyHandler,!1),runReady()}:document.attachEvent&&(__readyHandler=function(){"complete"===document.readyState&&(document.detachEvent("onreadystatechange",__readyHandler),runReady())}),window.attachEvent?window.attachEvent("onunload",Trash):window.addEventListener?window.addEventListener("unload",Trash,!1):window.onunload=Trash,BX(BX.DoNothing),window.BX=BX,BX.browser.addGlobalClass(),BX.browser.addGlobalFeatures(["boxShadow","borderRadius","flexWrap","boxDirection","transition","transform"])}}(window),function(t){if(!t.BX.ajax){var e=t.BX,s={},n={method:"GET",dataType:"html",timeout:0,async:!0,processData:!0,scriptsRunFirst:!1,emulateOnload:!0,start:!0,cache:!0,preparePost:!0,headers:!1,lsTimeout:30,lsForce:!1},o=null,a={},r={url_utf:/[^\034-\254]+/g,script_self:/\/bitrix\/js\/main\/core\/core(_ajax)*.js$/i,script_self_window:/\/bitrix\/js\/main\/core\/core_window.js$/i,script_self_admin:/\/bitrix\/js\/main\/core\/core_admin.js$/i,script_onload:/window.onload/g};e.ajax=function(t){var i;if(!t||!t.url||!e.type.isString(t.url))return!1;for(var o in s)"undefined"==typeof t[o]&&(t[o]=s[o]);s={};for(var o in n)"undefined"==typeof t[o]&&(t[o]=n[o]);if(t.method=t.method.toUpperCase(),e.localStorage||(t.lsId=null),e.browser.IsIE()){var a=r.url_utf.exec(t.url);if(a)do t.url=t.url.replace(a,e.util.urlencode(a)),a=r.url_utf.exec(t.url);while(a)}t.cache||"GET"!=t.method||(t.url=e.ajax._uncache(t.url)),"POST"==t.method&&t.preparePost&&(t.data=e.ajax.prepareData(t.data));var l=!0;if(t.lsId&&!t.lsForce){var d=e.localStorage.get("ajax-"+t.lsId);if(null!==d){l=!1;var h=function(i){if(i.key=="ajax-"+t.lsId&&"BXAJAXWAIT"!=i.value){var s=i.value,n=!!i.oldValue&&null==s;n?t.onfailure&&t.onfailure("timeout"):e.ajax.__run(t,s),e.removeCustomEvent("onLocalStorageChange",h)}};"BXAJAXWAIT"==d?e.addCustomEvent("onLocalStorageChange",h):setTimeout(function(){h({key:"ajax-"+t.lsId,value:d})},10)}}if(l){if(t.xhr=e.ajax.xhr(),!t.xhr)return;if(t.lsId&&e.localStorage.set("ajax-"+t.lsId,"BXAJAXWAIT",t.lsTimeout),t.xhr.open(t.method,t.url,t.async),"POST"==t.method&&t.preparePost&&t.xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),"object"==typeof t.headers)for(var o=0;o<t.headers.length;o++)t.xhr.setRequestHeader(t.headers[o].name,t.headers[o].value);var c=!1,p=t.xhr.onreadystatechange=function(s){if(!c)if("timeout"===s)t.onfailure&&t.onfailure("timeout"),e.onCustomEvent(t.xhr,"onAjaxFailure",["timeout","",t]),t.xhr.onreadystatechange=e.DoNothing,t.xhr.abort(),t.async&&(t.xhr=null);else if(4==t.xhr.readyState||"run"==s){if(i=e.ajax.xhrSuccess(t.xhr)?"success":"error",c=!0,t.xhr.onreadystatechange=e.DoNothing,"success"==i){var n=t.xhr.responseText;t.lsId&&e.localStorage.set("ajax-"+t.lsId,n,t.lsTimeout),e.ajax.__run(t,n)}else t.onfailure&&(t.onfailure("status",t.xhr.status),e.onCustomEvent(t.xhr,"onAjaxFailure",["status",t.xhr.status,t]));t.async&&(t.xhr=null)}};return t.async&&t.timeout>0&&setTimeout(function(){t.xhr&&!c&&p("timeout")},1e3*t.timeout),t.start&&(t.xhr.send(t.data),t.async||p("run")),t.xhr}},e.ajax.xhr=function(){if(t.XMLHttpRequest)try{return new XMLHttpRequest}catch(e){}else if(t.ActiveXObject){try{return new ActiveXObject("Msxml2.XMLHTTP.6.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP.3.0")}catch(e){}try{return new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}throw new Error("This browser does not support XMLHttpRequest.")}return null},e.ajax.__prepareOnload=function(i){
if(i.length>0){e.ajax["onload_"+o]=null;for(var s=0,n=i.length;s<n;s++)i[s].isInternal&&(i[s].JS=i[s].JS.replace(r.script_onload,"BX.ajax.onload_"+o))}e.CaptureEventsGet(),e.CaptureEvents(t,"load")},e.ajax.__runOnload=function(){null!=e.ajax["onload_"+o]&&(e.ajax["onload_"+o].apply(t),e.ajax["onload_"+o]=null);var i=e.CaptureEventsGet();if(i)for(var s=0;s<i.length;s++)i[s].apply(t)},e.ajax.__run=function(t,i){t.processData?i=e.ajax.processRequestData(i,t):(t.onsuccess&&t.onsuccess(i),e.onCustomEvent(t.xhr,"onAjaxSuccess",[i,t]))},e.ajax._onParseJSONFailure=function(t){this.jsonFailure=!0,this.jsonResponse=t,this.jsonProactive=/^\[WAF\]/.test(t)},e.ajax.processRequestData=function(t,i){var s,n=[],a=[];switch(i.dataType.toUpperCase()){case"JSON":e.addCustomEvent(i.xhr,"onParseJSONFailure",e.proxy(e.ajax._onParseJSONFailure,i)),s=e.parseJSON(t,i.xhr),e.removeCustomEvent(i.xhr,"onParseJSONFailure",e.proxy(e.ajax._onParseJSONFailure,i));break;case"SCRIPT":n.push({isInternal:!0,JS:t,bRunFirst:i.scriptsRunFirst}),i.processScriptsConsecutive=!0,s=t;break;default:var r=e.processHTML(t,i.scriptsRunFirst);s=r.HTML,n=r.SCRIPT,a=r.STYLE}var l=!1;null==o&&(o=parseInt(1e6*Math.random()),l=!0),a.length>0&&e.loadCSS(a),i.emulateOnload&&e.ajax.__prepareOnload(n);var d=e.DoNothing;(i.emulateOnload||l)&&(d=e.defer(function(){i.emulateOnload&&e.ajax.__runOnload(),l&&(o=null)}));try{if(i.jsonFailure)throw{type:"json_failure",data:i.jsonResponse,bProactive:i.jsonProactive};i.scripts=n,e.ajax.processScripts(i.scripts,!0),i.onsuccess&&i.onsuccess(s),e.onCustomEvent(i.xhr,"onAjaxSuccess",[s,i]),i.processScriptsConsecutive?(e.ajax.processScriptsConsecutive(i.scripts,!1),d()):e.ajax.processScripts(i.scripts,!1,d)}catch(h){i.onfailure&&i.onfailure("processing",h),e.onCustomEvent(i.xhr,"onAjaxFailure",["processing",h,i])}},e.ajax.processScripts=function(t,i,s){var n=[],o="";s=s||e.DoNothing;for(var a=0,r=t.length;a<r;a++)"undefined"!=typeof i&&i!=!!t[a].bRunFirst||(t[a].isInternal?o+=";"+t[a].JS:n.push(t[a].JS));n=e.util.array_unique(n);var l=l1=n.length,d=o.length>0?function(){e.evalGlobal(o)}:e.DoNothing;if(l>0)for(var h=function(){--l1<=0&&(d(),s(),d=e.DoNothing)},a=0;a<l;a++)e.loadScript(n[a],h);else d(),s()},e.ajax.processScriptsConsecutive=function(t,i){for(var s=0,n=t.length;s<n;s++)null!=i&&i!=!!t[s].bRunFirst||(t[s].isInternal?e.evalGlobal(t[s].JS):e.ajax.loadScriptAjax([t[s].JS]))},e.ajax.prepareData=function(t,i){var s="";if(e.type.isString(t))s=t;else if(null!=t)for(var n in t)if(t.hasOwnProperty(n)){s.length>0&&(s+="&");var o=e.util.urlencode(n);i&&(o=i+"["+o+"]"),s+="object"==typeof t[n]?e.ajax.prepareData(t[n],o):o+"="+e.util.urlencode(t[n])}return s},e.ajax.xhrSuccess=function(t){return t.status>=200&&t.status<300||304===t.status||1223===t.status||0===t.status},e.ajax.Setup=function(t,e){e=!!e;for(var i in t)e?s[i]=t[i]:n[i]=t[i]},e.ajax.replaceLocalStorageValue=function(t,i,s){e.localStorage&&e.localStorage.set("ajax-"+t,i,s)},e.ajax._uncache=function(t){return t+((t.indexOf("?")!==-1?"&":"?")+"_="+(new Date).getTime())},e.ajax.get=function(t,i,s){return e.type.isFunction(i)&&(s=i,i=""),i=e.ajax.prepareData(i),i&&(t+=(t.indexOf("?")!==-1?"&":"?")+i,i=""),e.ajax({method:"GET",dataType:"html",url:t,data:"",onsuccess:s})},e.ajax.getCaptcha=function(t){return e.ajax.loadJSON("/bitrix/tools/ajax_captcha.php",t)},e.ajax.insertToNode=function(t,i){if(i=e(i)){e.onCustomEvent("onAjaxInsertToNode",[{url:t,node:i}]);var n=null;return s.denyShowWait||(n=e.showWait(i),delete s.denyShowWait),e.ajax.get(t,function(t){i.innerHTML=t,e.closeWait(i,n)})}},e.ajax.post=function(t,i,s){return i=e.ajax.prepareData(i),e.ajax({method:"POST",dataType:"html",url:t,data:i,onsuccess:s})},e.ajax.loadScriptAjax=function(t,i,s){if(e.type.isArray(t))for(var n=0,o=t.length;n<o;n++)e.ajax.loadScriptAjax(t[n],i,s);else{var l=t.replace(/\.js\?.*/,".js");if(r.script_self.test(l))return;if(r.script_self_window.test(l)&&e.CWindow)return;if(r.script_self_admin.test(l)&&e.admin)return;if("undefined"==typeof a[l])return s?(a[l]="",e.loadScript(t)):e.ajax({url:t,method:"GET",dataType:"script",processData:!0,emulateOnload:!1,scriptsRunFirst:!0,async:!1,start:!0,onsuccess:function(t){a[l]=t,i&&i(t)}});i&&i(a[l])}},e.ajax.loadJSON=function(t,i,s,n){return e.type.isFunction(i)&&(n=s,s=i,i=""),i=e.ajax.prepareData(i),i&&(t+=(t.indexOf("?")!==-1?"&":"?")+i,i=""),e.ajax({method:"GET",dataType:"json",url:t,onsuccess:s,onfailure:n})},e.ajax.load=function(t,i){e.type.isArray(t)||(t=[t]);var s=0;e.type.isFunction(i)||(i=e.DoNothing);for(var n=function(t){e.type.isFunction(this.callback)&&this.callback(t),++s>=a&&i()},o=0,a=t.length;o<a;o++)switch(t.type.toUpperCase()){case"SCRIPT":e.loadScript([t[o].url],jsBX.proxy(n,t[o]));break;case"CSS":e.loadCSS([t[o].url]),++s>=a&&i();break;case"JSON":e.ajax.loadJSON(t.url,jsBX.proxy(n,t[o]));break;default:e.ajax.get(t.url,"",jsBX.proxy(n,t[o]))}},e.ajax.submit=function(t,i){if(!t.target){if(null==t.BXFormTarget){var s="formTarget_"+Math.random();t.BXFormTarget=document.body.appendChild(e.create("IFRAME",{props:{name:s,id:s,src:"javascript:void(0)"},style:{display:"none"}}))}t.target=t.BXFormTarget.name}return t.BXFormCallback=i,e.bind(t.BXFormTarget,"load",e.proxy(e.ajax._submit_callback,t)),e.submit(t),!1},e.ajax.submitComponentForm=function(i,s,n){if(!i.target){if(null==i.BXFormTarget){var o="formTarget_"+Math.random();i.BXFormTarget=document.body.appendChild(e.create("IFRAME",{props:{name:o,id:o,src:"javascript:void(0)"},style:{display:"none"}}))}i.target=i.BXFormTarget.name}if(n)var a=e.showWait(s);return i.BXFormCallback=function(i){n&&e.closeWait(a),e(s).innerHTML=i,t.bxcompajaxframeonload&&setTimeout("window.bxcompajaxframeonload();window.bxcompajaxframeonload=null;",10),e.onCustomEvent("onAjaxSuccess",[])},e.bind(i.BXFormTarget,"load",e.proxy(e.ajax._submit_callback,i)),!0},e.ajax._submit_callback=function(){try{if(0!=this.BXFormTarget.contentWindow.location.href.indexOf("http"))return}catch(t){return}this.BXFormCallback&&this.BXFormCallback.apply(this,[this.BXFormTarget.contentWindow.document.body.innerHTML]),e.unbindAll(this.BXFormTarget)},e.ajax.submitAjax=function(t,e){},e.ajax.UpdatePageData=function(t){if(t.TITLE&&e.ajax.UpdatePageTitle(t.TITLE),t.NAV_CHAIN&&e.ajax.UpdatePageNavChain(t.NAV_CHAIN),t.CSS&&t.CSS.length>0&&e.loadCSS(t.CSS),t.SCRIPTS&&t.SCRIPTS.length>0){var i=function(s,n){if(n&&e.type.isArray(n.scripts))for(var o=0,a=t.SCRIPTS.length;o<a;o++)n.scripts.push({isInternal:!1,JS:t.SCRIPTS[o]});else e.loadScript(t.SCRIPTS);e.removeCustomEvent("onAjaxSuccess",i)};e.addCustomEvent("onAjaxSuccess",i)}},e.ajax.UpdatePageTitle=function(t){var i=e("pagetitle");i&&(i.removeChild(i.firstChild),i.firstChild?i.insertBefore(document.createTextNode(t),i.firstChild):i.appendChild(document.createTextNode(t))),document.title=t},e.ajax.UpdatePageNavChain=function(t){var i=e("navigation");i&&(i.innerHTML=t)},e.userOptions={options:null,bSend:!1,delay:5e3},e.userOptions.save=function(t,i,s,n,o){null==e.userOptions.options&&(e.userOptions.options={}),o=!!o,e.userOptions.options[t+"."+i+"."+s]=[t,i,s,n,o];var a=e.userOptions.__get();""!=a&&(document.cookie=e.message("COOKIE_PREFIX")+"_LAST_SETTINGS="+a+"&sessid="+e.bitrix_sessid()+"; expires=Thu, 31 Dec 2020 23:59:59 GMT; path=/;"),e.userOptions.bSend||(e.userOptions.bSend=!0,setTimeout(function(){e.userOptions.send(null)},e.userOptions.delay))},e.userOptions.send=function(t){var i=e.userOptions.__get();e.userOptions.options=null,e.userOptions.bSend=!1,""!=i&&(document.cookie=e.message("COOKIE_PREFIX")+"_LAST_SETTINGS=; path=/;",e.ajax({method:"GET",dataType:"html",processData:!1,cache:!1,url:"/bitrix/admin/user_options.php?"+i+"&sessid="+e.bitrix_sessid(),onsuccess:t}))},e.userOptions.del=function(t,i,s,n){e.ajax.get("/bitrix/admin/user_options.php?action=delete&c="+t+"&n="+i+(1==s?"&common=Y":"")+"&sessid="+e.bitrix_sessid(),n)},e.userOptions.__get=function(){if(!e.userOptions.options)return"";var t,i,s="",n=-1,o="";for(i in e.userOptions.options)t=e.userOptions.options[i],o!=t[0]+"."+t[1]&&(n++,s+="&p["+n+"][c]="+e.util.urlencode(t[0]),s+="&p["+n+"][n]="+e.util.urlencode(t[1]),1==t[4]&&(s+="&p["+n+"][d]=Y"),o=t[0]+"."+t[1]),s+="&p["+n+"][v]["+e.util.urlencode(t[2])+"]="+e.util.urlencode(t[3]);return s.substr(1)},e.ajax.history={expected_hash:"",obParams:null,obFrame:null,obImage:null,obTimer:null,bInited:!1,bHashCollision:!1,bPushState:!(!history.pushState||!e.type.isFunction(history.pushState)),init:function(i){if(!e.ajax.history.bInited){this.obParams=i;var s=this.obParams.getState();e.ajax.history.bPushState?(e.ajax.history.expected_hash=t.location.pathname,t.location.search&&(e.ajax.history.expected_hash+=t.location.search),e.ajax.history.put(s,e.ajax.history.expected_hash),e.bind(t,"popstate",e.ajax.history.__hashListener)):(e.ajax.history.expected_hash=t.location.hash,e.ajax.history.expected_hash&&"#"!=e.ajax.history.expected_hash||(e.ajax.history.expected_hash="__bx_no_hash__"),l.put(e.ajax.history.expected_hash,s),e.ajax.history.obTimer=setTimeout(e.ajax.history.__hashListener,500),e.browser.IsIE()?(e.ajax.history.obFrame=document.createElement("IFRAME"),e.hide_object(e.ajax.history.obFrame),document.body.appendChild(e.ajax.history.obFrame),e.ajax.history.obFrame.contentWindow.document.open(),e.ajax.history.obFrame.contentWindow.document.write(e.ajax.history.expected_hash),e.ajax.history.obFrame.contentWindow.document.close()):e.browser.IsOpera()&&(e.ajax.history.obImage=document.createElement("IMG"),e.hide_object(e.ajax.history.obImage),document.body.appendChild(e.ajax.history.obImage),e.ajax.history.obImage.setAttribute("src","javascript:location.href = 'javascript:BX.ajax.history.__hashListener();';"))),e.ajax.history.bInited=!0}},__hashListener:function(i){if(i=i||t.event||{state:!1},e.ajax.history.bPushState&&i.state)e.ajax.history.obParams.setState(i.state);else{if(e.ajax.history.obTimer&&(t.clearTimeout(e.ajax.history.obTimer),e.ajax.history.obTimer=null),null!=e.ajax.history.obFrame)var s=e.ajax.history.obFrame.contentWindow.document.body.innerText;else var s=t.location.hash;if(s&&"#"!=s||(s="__bx_no_hash__"),0==s.indexOf("#")&&(s=s.substring(1)),s!=e.ajax.history.expected_hash){var n=l.get(s);if(n&&(e.ajax.history.obParams.setState(n),e.ajax.history.expected_hash=s,null!=e.ajax.history.obFrame)){var o="__bx_no_hash__"==s?"":s;t.location.hash!=o&&t.location.hash!="#"+o&&(t.location.hash=o)}}e.ajax.history.obTimer=setTimeout(e.ajax.history.__hashListener,500)}},put:function(i,s,n){this.bPushState?history.pushState(i,"",s):(s="undefined"!=typeof n?n:"view"+s,l.put(s,i),e.ajax.history.expected_hash=s,t.location.hash=e.util.urlencode(s),null!=e.ajax.history.obFrame&&(e.ajax.history.obFrame.contentWindow.document.open(),e.ajax.history.obFrame.contentWindow.document.write(s),e.ajax.history.obFrame.contentWindow.document.close()))},checkRedirectStart:function(i,s){var n=t.location.hash;"#"==n.substring(0,1)&&(n=n.substring(1));var o=n.substring(0,5);"view/"!=o&&"view%"!=o||(e.ajax.history.bHashCollision=!0,document.write('<div id="__ajax_hash_collision_'+s+'" style="display: none;">'))},checkRedirectFinish:function(i,s){document.write("</div>");var n=t.location.hash;"#"==n.substring(0,1)&&(n=n.substring(1)),e.ready(function(){var t=n.substring(0,5);if("view/"==t||"view%"==t){var o=e("__ajax_hash_collision_"+s),a=o.firstChild;e.cleanNode(a),o.style.display="block","view%"!=t&&(n=e.util.urlencode(n)),n+=(n.indexOf("%3F")==-1?"%3F":"%26")+i+"="+s;var r="/bitrix/tools/ajax_redirector.php?hash="+n;e.ajax.insertToNode(r,a)}})}},e.ajax.component=function(t){this.node=t},e.ajax.component.prototype.getState=function(){var i={node:this.node,title:t.document.title,data:e(this.node).innerHTML},s=e("navigation");return null!=s&&(i.nav_chain=s.innerHTML),i},e.ajax.component.prototype.setState=function(t){e(t.node).innerHTML=t.data,e.ajax.UpdatePageTitle(t.title),t.nav_chain&&e.ajax.UpdatePageNavChain(t.nav_chain)};var l={arHistory:{},put:function(t,e){this.arHistory[t]=e},get:function(t){return this.arHistory[t]}};e.ajax.FormData=function(){this.elements=[],this.files=[],this.features={},this.isSupported(),this.log("BX FormData init")},e.ajax.FormData.isSupported=function(){var t=new e.ajax.FormData,i=t.features.supported;return t=null,i},e.ajax.FormData.prototype.log=function(t){},e.ajax.FormData.prototype.isSupported=function(){var e={};return e.fileReader=t.FileReader&&t.FileReader.prototype.readAsBinaryString,e.readFormData=e.sendFormData=!!t.FormData,e.supported=!(!e.readFormData||!e.sendFormData),this.features=e,this.log("features:"),this.log(e),e.supported},e.ajax.FormData.prototype.append=function(t,e){"object"==typeof e?this.files.push({name:t,value:e}):this.elements.push({name:t,value:e})},e.ajax.FormData.prototype.send=function(t,s,n,o){if(this.log("FD send"),this.xhr=e.ajax({method:"POST",dataType:"html",url:t,onsuccess:s,onfailure:o,start:!1,preparePost:!1}),n&&this.xhr.upload.addEventListener("progress",function(t){t.lengthComputable&&n(t.loaded/t.totalSize)},!1),this.features.readFormData&&this.features.sendFormData){var a=new FormData;this.log("use browser formdata");for(i in this.elements)a.append(this.elements[i].name,this.elements[i].value);for(i in this.files)a.append(this.files[i].name,this.files[i].value);this.xhr.send(a)}return this.xhr},e.addCustomEvent("onAjaxFailure",e.debug)}}(window);var bxSession=new CBXSession;!function(t){BX.PopupWindowManager||(BX.PopupWindowManager={_popups:[],_currentPopup:null,create:function(t,e,i){var s=-1;if((s=this._getPopupIndex(t))!==-1)return this._popups[s];var n=new BX.PopupWindow(t,e,i);return BX.addCustomEvent(n,"onPopupShow",BX.delegate(this.onPopupShow,this)),BX.addCustomEvent(n,"onPopupClose",BX.delegate(this.onPopupClose,this)),BX.addCustomEvent(n,"onPopupDestroy",BX.delegate(this.onPopupDestroy,this)),this._popups.push(n),n},onPopupShow:function(t){null!==this._currentPopup&&this._currentPopup.close(),this._currentPopup=t},onPopupClose:function(t){this._currentPopup=null},onPopupDestroy:function(t){var e=-1;(e=this._getPopupIndex(t.uniquePopupId))!==-1&&(this._popups=BX.util.deleteFromArray(this._popups,e))},getCurrentPopup:function(){return this._currentPopup},isPopupExists:function(t){return this._getPopupIndex(t)!==-1},_getPopupIndex:function(t){for(var e=-1,i=0;i<this._popups.length;i++)if(this._popups[i].uniquePopupId==t)return i;return e}},BX.PopupWindow=function(e,i,s){if(BX.onCustomEvent("onPopupWindowInit",[e,i,s]),this.uniquePopupId=e,this.params=s||{},this.params.zIndex=parseInt(this.params.zIndex),this.params.zIndex=isNaN(this.params.zIndex)?0:this.params.zIndex,this.buttons=this.params.buttons&&BX.type.isArray(this.params.buttons)?this.params.buttons:[],this.offsetTop=BX.PopupWindow.getOption("offsetTop",0),this.offsetLeft=BX.PopupWindow.getOption("offsetLeft",0),this.firstShow=!1,this.bordersWidth=20,this.bindElementPos=null,this.closeIcon=null,this.angle=null,this.overlay=null,this.titleBar=null,this.bindOptions="object"==typeof this.params.bindOptions?this.params.bindOptions:{},this.isAutoHideBinded=!1,this.closeByEsc=!!this.params.closeByEsc,this.isCloseByEscBinded=!1,this.dragged=!1,this.dragPageX=0,this.dragPageY=0,this.params.events)for(var n in this.params.events)BX.addCustomEvent(this,n,this.params.events[n]);this.popupContainer=document.createElement("DIV"),BX.adjust(this.popupContainer,{props:{id:e},style:{zIndex:this.getZindex(),position:"absolute",display:"none",top:"0px",left:"0px"}});var o="popup-window";s.lightShadow&&(o+=" popup-window-light"),s.titleBar&&(o+=s.lightShadow?" popup-window-titlebar-light":" popup-window-titlebar"),s.className&&BX.type.isNotEmptyString(s.className)&&(o+=" "+s.className),this.popupContainer.innerHTML=['<table class="',o,'" cellspacing="0"> \t\t<tr class="popup-window-top-row"> \t\t\t<td class="popup-window-left-column"><div class="popup-window-left-spacer"></div></td> \t\t\t<td class="popup-window-center-column">',s.titleBar?'<div class="popup-window-titlebar" id="popup-window-titlebar-'+e+'"></div>':"",'</td> \t\t\t<td class="popup-window-right-column"><div class="popup-window-right-spacer"></div></td> \t\t</tr> \t\t<tr class="popup-window-content-row"> \t\t\t<td class="popup-window-left-column"></td> \t\t\t<td class="popup-window-center-column"><div class="popup-window-content" id="popup-window-content-',e,'"> \t\t\t</div></td> \t\t\t<td class="popup-window-right-column"></td> \t\t</tr> \t\t<tr class="popup-window-bottom-row"> \t\t\t<td class="popup-window-left-column"></td> \t\t\t<td class="popup-window-center-column"></td> \t\t\t<td class="popup-window-right-column"></td> \t\t</tr> \t</table>'].join(""),document.body.appendChild(this.popupContainer),s.closeIcon&&(this.popupContainer.appendChild(this.closeIcon=BX.create("a",{props:{className:"popup-window-close-icon",href:""},style:"object"==typeof s.closeIcon?s.closeIcon:{},events:{click:BX.proxy(this._onCloseIconClick,this)}})),BX.browser.IsIE()&&BX.adjust(this.closeIcon,{attrs:{hidefocus:"true"}})),this.contentContainer=BX("popup-window-content-"+e),this.titleBar=BX("popup-window-titlebar-"+e),this.buttonsContainer=this.buttonsHr=null,s.angle&&this.setAngle(s.angle),s.overlay&&this.setOverlay(s.overlay),this.setOffset(this.params),this.setBindElement(i),this.setTitleBar(this.params.titleBar),this.setContent(this.params.content),this.setButtons(this.params.buttons),this.params.bindOnResize!==!1&&BX.bind(t,"resize",BX.proxy(this._onResizeWindow,this))},BX.PopupWindow.prototype.setContent=function(t){this.contentContainer&&t&&(BX.type.isElementNode(t)?(BX.cleanNode(this.contentContainer),this.contentContainer.appendChild(t.parentNode?t.parentNode.removeChild(t):t),t.style.display="block"):BX.type.isString(t)?this.contentContainer.innerHTML=t:this.contentContainer.innerHTML="&nbsp;")},BX.PopupWindow.prototype.setButtons=function(t){if(this.buttons=t&&BX.type.isArray(t)?t:[],this.buttonsHr&&BX.remove(this.buttonsHr),this.buttonsContainer&&BX.remove(this.buttonsContainer),this.buttons.length>0&&this.contentContainer){for(var e=[],i=0;i<this.buttons.length;i++){var s=this.buttons[i];null!=s&&BX.is_subclass_of(s,BX.PopupWindowButton)&&(s.popupWindow=this,e.push(s.render()))}this.buttonsHr=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-hr popup-window-buttons-hr"},children:[BX.create("i",{})]})),this.buttonsContainer=this.contentContainer.parentNode.appendChild(BX.create("div",{props:{className:"popup-window-buttons"},children:e}))}},BX.PopupWindow.prototype.setBindElement=function(t){t&&"object"==typeof t&&(BX.type.isDomNode(t)||BX.type.isNumber(t.top)&&BX.type.isNumber(t.left)?this.bindElement=t:BX.type.isNumber(t.clientX)&&BX.type.isNumber(t.clientY)&&(BX.fixEventPageXY(t),this.bindElement={left:t.pageX,top:t.pageY,bottom:t.pageY}))},BX.PopupWindow.prototype.getBindElementPos=function(t){if(BX.type.isDomNode(t))return BX.pos(t,!1);if(t&&"object"==typeof t)return BX.type.isNumber(t.bottom)||(t.bottom=t.top),t;var e=BX.GetWindowInnerSize(),i=BX.GetWindowScrollPos(),s=this.popupContainer.offsetWidth,n=this.popupContainer.offsetHeight;return{left:e.innerWidth/2-s/2+i.scrollLeft,top:e.innerHeight/2-n/2+i.scrollTop,bottom:e.innerHeight/2-n/2+i.scrollTop,windowSize:e,windowScroll:i,popupWidth:s,popupHeight:n}},BX.PopupWindow.prototype.setAngle=function(t){var e=this.params.lightShadow?"popup-window-light-angly":"popup-window-angly";if(null==this.angle){var i=this.bindOptions.position&&"top"==this.bindOptions.position?"bottom":"top",s=BX.PopupWindow.getOption("top"==i?"angleMinTop":"angleMinBottom",7);this.angle={element:BX.create("div",{props:{className:e+" "+e+"-"+i}}),position:i,offset:0,defaultOffset:Math.max(BX.type.isNumber(t.offset)?t.offset:0,s)},this.popupContainer.appendChild(this.angle.element)}if("object"==typeof t&&t.position&&BX.util.in_array(t.position,["top","right","bottom","left","hide"])&&(BX.removeClass(this.angle.element,e+"-"+this.angle.position),BX.addClass(this.angle.element,e+"-"+t.position),this.angle.position=t.position),"object"==typeof t&&BX.type.isNumber(t.offset)){var n=t.offset;"top"==this.angle.position?(this.angle.element.style.left=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinTop",7),n))+"px",this.angle.element.style.marginLeft="auto"):"right"==this.angle.position?this.angle.element.style.top=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinRight",2),n))+"px":"bottom"==this.angle.position?(this.angle.element.style.marginLeft=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinBottom",7),n))+"px",this.angle.element.style.left="auto"):"left"==this.angle.position&&(this.angle.element.style.top=(this.angle.offset=Math.max(BX.PopupWindow.getOption("angleMinLeft",2),n))+"px")}},BX.PopupWindow.prototype.setOffset=function(t){"object"==typeof t&&(t.offsetLeft&&BX.type.isNumber(t.offsetLeft)&&(this.offsetLeft=t.offsetLeft+BX.PopupWindow.getOption("offsetLeft",0)),t.offsetTop&&BX.type.isNumber(t.offsetTop)&&(this.offsetTop=t.offsetTop+BX.PopupWindow.getOption("offsetTop",0)))},BX.PopupWindow.prototype.setTitleBar=function(t){this.titleBar&&"object"==typeof t&&BX.type.isDomNode(t.content)&&(this.titleBar.innerHTML="",this.titleBar.appendChild(t.content),this.params.draggable&&(this.titleBar.parentNode.style.cursor="move",BX.bind(this.titleBar.parentNode,"mousedown",BX.proxy(this._startDrag,this))))},BX.PopupWindow.prototype.setClosingByEsc=function(t){t=!!t,t?(this.closeByEsc=!0,this.isCloseByEscBinded||(BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!0)):(this.closeByEsc=!1,this.isCloseByEscBinded&&(BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!1))},BX.PopupWindow.prototype.setOverlay=function(t){null==this.overlay&&(this.overlay={element:BX.create("div",{props:{className:"popup-window-overlay",id:"popup-window-overlay-"+this.uniquePopupId}})},this.adjustOverlayZindex(),this.resizeOverlay(),document.body.appendChild(this.overlay.element)),t&&t.opacity&&BX.type.isNumber(t.opacity)&&t.opacity>=0&&t.opacity<=100&&(BX.browser.IsIE()&&!BX.browser.IsIE9()?this.overlay.element.style.filter="alpha(opacity="+t.opacity+")":(this.overlay.element.style.filter="none",this.overlay.element.style.opacity=parseFloat(t.opacity/100).toPrecision(3))),t&&t.backgroundColor&&(this.overlay.element.style.backgroundColor=t.backgroundColor)},BX.PopupWindow.prototype.removeOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&BX.remove(this.overlay.element),this.overlay=null},BX.PopupWindow.prototype.hideOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.display="none")},BX.PopupWindow.prototype.showOverlay=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.display="block")},BX.PopupWindow.prototype.resizeOverlay=function(){if(null!=this.overlay&&null!=this.overlay.element){var t=BX.GetWindowScrollSize();this.overlay.element.style.width=t.scrollWidth+"px",this.overlay.element.style.height=t.scrollHeight+"px"}},BX.PopupWindow.prototype.getZindex=function(){return null!=this.overlay?BX.PopupWindow.getOption("popupOverlayZindex",1100)+this.params.zIndex:BX.PopupWindow.getOption("popupZindex",1e3)+this.params.zIndex},BX.PopupWindow.prototype.adjustOverlayZindex=function(){null!=this.overlay&&null!=this.overlay.element&&(this.overlay.element.style.zIndex=parseInt(this.popupContainer.style.zIndex)-1)},BX.PopupWindow.prototype.show=function(){this.firstShow||(BX.onCustomEvent(this,"onPopupFirstShow",[this]),this.firstShow=!0),BX.onCustomEvent(this,"onPopupShow",[this]),this.showOverlay(),this.popupContainer.style.display="block",this.adjustPosition(),BX.onCustomEvent(this,"onAfterPopupShow",[this]),this.closeByEsc&&!this.isCloseByEscBinded&&(BX.bind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!0),this.params.autoHide&&!this.isAutoHideBinded&&setTimeout(BX.proxy(function(){this.isAutoHideBinded=!0,BX.bind(this.popupContainer,"click",this.cancelBubble),BX.bind(document,"click",BX.proxy(this.close,this))},this),0)},BX.PopupWindow.prototype.isShown=function(){return"block"==this.popupContainer.style.display},BX.PopupWindow.prototype.cancelBubble=function(e){e||(e=t.event),e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},BX.PopupWindow.prototype.close=function(t){if(this.isShown()){if(t&&!(BX.getEventButton(t)&BX.MSLEFT))return!0;BX.onCustomEvent(this,"onPopupClose",[this,t]),this.hideOverlay(),this.popupContainer.style.display="none",this.isCloseByEscBinded&&(BX.unbind(document,"keyup",BX.proxy(this._onKeyUp,this)),this.isCloseByEscBinded=!1),setTimeout(BX.proxy(this._close,this),0)}},BX.PopupWindow.prototype._close=function(){this.params.autoHide&&this.isAutoHideBinded&&(this.isAutoHideBinded=!1,BX.unbind(this.popupContainer,"click",this.cancelBubble),BX.unbind(document,"click",BX.proxy(this.close,this)))},BX.PopupWindow.prototype._onCloseIconClick=function(e){e=e||t.event,this.close(e),BX.PreventDefault(e)},BX.PopupWindow.prototype._onKeyUp=function(e){e=e||t.event,27==e.keyCode&&this.close(e)},BX.PopupWindow.prototype.destroy=function(){BX.onCustomEvent(this,"onPopupDestroy",[this]),BX.unbindAll(this),BX.remove(this.popupContainer),this.removeOverlay()},BX.PopupWindow.prototype.adjustPosition=function(t){t&&"object"==typeof t&&(this.bindOptions=t);var e=this.getBindElementPos(this.bindElement);if(this.bindOptions.forceBindPosition||null==this.bindElementPos||e.top!=this.bindElementPos.top||e.left!=this.bindElementPos.left){this.bindElementPos=e;var i=e.windowSize?e.windowSize:BX.GetWindowInnerSize(),s=e.windowScroll?e.windowScroll:BX.GetWindowScrollPos(),n=e.popupWidth?e.popupWidth:this.popupContainer.offsetWidth,o=e.popupHeight?e.popupHeight:this.popupContainer.offsetHeight,a=BX.PopupWindow.getOption("angleTopOffset",5),r=BX.PopupWindow.getOption("angleLeftOffset",15),l=this.bindElementPos.left+this.offsetLeft-(null!=this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])?r:0);if(!this.bindOptions.forceLeft&&l+n+this.bordersWidth>=i.innerWidth+s.scrollLeft&&i.innerWidth+s.scrollLeft-n-this.bordersWidth>0){var d=l;l=i.innerWidth+s.scrollLeft-n-this.bordersWidth,null!=this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])&&this.setAngle({offset:d-l+this.angle.defaultOffset})}else null!=this.angle&&BX.util.in_array(this.angle.position,["top","bottom"])&&this.setAngle({offset:this.angle.defaultOffset+(l<0?l:0)});l<0&&(l=0);var h=0;this.bindOptions.position&&"top"==this.bindOptions.position?(h=this.bindElementPos.top-o-this.offsetTop-(null!=this.angle&&"bottom"==this.angle.position?a:0),h<0||!this.bindOptions.forceTop&&h<s.scrollTop?(h=this.bindElementPos.bottom+this.offsetTop,null!=this.angle&&(h+=a,this.setAngle({position:"top"}))):null!=this.angle&&"top"==this.angle.position?(h=h-a+BX.PopupWindow.getOption("positionTopXOffset",0),this.setAngle({position:"bottom"})):h+=BX.PopupWindow.getOption("positionTopXOffset",0)):(h=this.bindElementPos.bottom+this.offsetTop+(null!=this.angle&&"top"==this.angle.position?a:0),!this.bindOptions.forceTop&&h+o>i.innerHeight+s.scrollTop&&this.bindElementPos.top-o>=0?(h=this.bindElementPos.top-o,null!=this.angle&&(h-=a,this.setAngle({position:"bottom"})),h+=BX.PopupWindow.getOption("positionTopXOffset",0)):null!=this.angle&&"bottom"==this.angle.position&&(h+=a,this.setAngle({position:"top"}))),h<0&&(h=0),BX.adjust(this.popupContainer,{style:{top:h+"px",left:l+"px",zIndex:this.getZindex()}}),this.adjustOverlayZindex()}},BX.PopupWindow.prototype._onResizeWindow=function(t){this.isShown()&&(this.adjustPosition(),null!=this.overlay&&this.resizeOverlay())},BX.PopupWindow.prototype.move=function(t,e){var i=parseInt(this.popupContainer.style.left)+t,s=parseInt(this.popupContainer.style.top)+e;if("object"==typeof this.params.draggable&&this.params.draggable.restrict){i<0&&(i=0);var n=BX.GetWindowScrollSize(),o=this.popupContainer.offsetWidth,a=this.popupContainer.offsetHeight;i>n.scrollWidth-o&&(i=n.scrollWidth-o),s>n.scrollHeight-a&&(s=n.scrollHeight-a),s<0&&(s=0)}this.popupContainer.style.left=i+"px",this.popupContainer.style.top=s+"px"},BX.PopupWindow.prototype._startDrag=function(e){return e=e||t.event,BX.fixEventPageXY(e),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged=!1,BX.bind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.bind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.setCapture&&document.body.setCapture(),document.body.ondrag=BX.False,document.body.onselectstart=BX.False,document.body.style.cursor="move",document.body.style.MozUserSelect="none",this.popupContainer.style.MozUserSelect="none",BX.PreventDefault(e)},BX.PopupWindow.prototype._moveDrag=function(e){e=e||t.event,BX.fixEventPageXY(e),this.dragPageX==e.pageX&&this.dragPageY==e.pageY||(this.move(e.pageX-this.dragPageX,e.pageY-this.dragPageY),this.dragPageX=e.pageX,this.dragPageY=e.pageY,this.dragged||(BX.onCustomEvent(this,"onPopupDragStart"),this.dragged=!0),BX.onCustomEvent(this,"onPopupDrag"))},BX.PopupWindow.prototype._stopDrag=function(t){return document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this._moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this._stopDrag,this)),document.body.ondrag=null,document.body.onselectstart=null,document.body.style.cursor="",document.body.style.MozUserSelect="",this.popupContainer.style.MozUserSelect="",BX.onCustomEvent(this,"onPopupDragEnd"),this.dragged=!1,BX.PreventDefault(t)},BX.PopupWindow.options={},BX.PopupWindow.setOptions=function(t){if(t&&"object"==typeof t)for(var e in t)BX.PopupWindow.options[e]=t[e]},BX.PopupWindow.getOption=function(t,e){return"undefined"!=typeof BX.PopupWindow.options[t]?BX.PopupWindow.options[t]:e},BX.PopupWindowButton=function(t){this.popupWindow=null,this.params=t||{},this.text=this.params.text||"",this.id=this.params.id||"",this.className=this.params.className||"",this.events=this.params.events||{},this.contextEvents={};for(var e in this.events)this.contextEvents[e]=BX.proxy(this.events[e],this);this.nameNode=BX.create("span",{props:{className:"popup-window-button-text"},text:this.text}),this.buttonNode=BX.create("span",{props:{className:"popup-window-button"+(this.className.length>0?" "+this.className:""),id:this.id},children:[BX.create("span",{props:{className:"popup-window-button-left"}}),this.nameNode,BX.create("span",{props:{className:"popup-window-button-right"}})],events:this.contextEvents})},BX.PopupWindowButton.prototype.render=function(){return this.buttonNode},BX.PopupWindowButton.prototype.setName=function(t){this.text=t||"",this.nameNode&&(BX.cleanNode(this.nameNode),BX.adjust(this.nameNode,{text:this.text}))},BX.PopupWindowButton.prototype.setClassName=function(t){this.buttonNode&&(BX.type.isString(this.className)&&""!=this.className&&BX.removeClass(this.buttonNode,this.className),BX.addClass(this.buttonNode,t)),this.className=t},BX.PopupWindowButtonLink=function(t){BX.PopupWindowButtonLink.superclass.constructor.apply(this,arguments),this.nameNode=BX.create("span",{props:{className:"popup-window-button-link-text"},text:this.text,events:this.contextEvents}),this.buttonNode=BX.create("span",{props:{className:"popup-window-button popup-window-button-link"+(this.className.length>0?" "+this.className:""),id:this.id},children:[this.nameNode]})},BX.extend(BX.PopupWindowButtonLink,BX.PopupWindowButton),BX.PopupMenu={Data:{},currentItem:null,stack:[],onkeypresslistener:null,show:function(e,i,s,n,o){if(o||(o=0),o<this.stack.length)for(var a=this.stack.length-1;a>=o;a--)this.currentItem=this.stack.pop(),this.currentItem&&this.currentItem.popupWindow.close(),a>0&&(this.currentItem=this.stack[a-1]);this.Data[e]||(this.Data[e]={id:e,bindElement:i,params:n},this.Data[e].popupWindow=this.__createPopup(this.Data[e],s,n)),this.currentItem=this.Data[e],this.stack[o]=this.currentItem,this.currentItem.popupWindow.show(),this.onkeypresslistener||(this.onkeypresslistener=BX.delegate(function(e){
e=e||t.event,e&&27==e.keyCode&&(this.currentItem=this.stack.pop(),this.currentItem&&this.currentItem.popupWindow.close(),this.stack.length>0&&(this.currentItem=this.stack[this.stack.length-1]))},this),BX.bind(document,"keypress",this.onkeypresslistener))},__createPopup:function(t,e,i){for(var s=[],n=0;n<e.length;n++){var o=e[n];if(o){if(n>0&&s.push(BX.create("div",{props:{className:"popup-window-hr"},html:"<i></i>"})),o.delimiter)var a=BX.create("span",{props:{className:"popup-window-delimiter"},html:"<i></i>"});else if(o.text&&BX.type.isNotEmptyString(o.text)){var a=BX.create(o.href?"a":"span",{props:{className:"menu-popup-item"+(BX.type.isNotEmptyString(o.className)?" "+o.className:"")},attrs:{title:o.title?o.title:"",onclick:o.onclick&&BX.type.isString(o.onclick)?o.onclick:null},events:o.onclick&&BX.type.isFunction(o.onclick)?{click:BX.proxy(o.onclick,t)}:null,html:'<span class="menu-popup-item-left"></span><span class="menu-popup-item-icon"></span><span class="menu-popup-item-text">'+o.text+'</span><span class="menu-popup-item-right"></span>'});o.href&&(a.href=o.href)}s.push(a)}}var r=new BX.PopupWindow("menu-popup-"+t.id,t.bindElement,{closeByEsc:!1,autoHide:"undefined"==typeof i.autoHide||i.autoHide,offsetTop:i.offsetTop?i.offsetTop:1,offsetLeft:i.offsetLeft?i.offsetLeft:0,lightShadow:"undefined"==typeof i.lightShadow||i.lightShadow,angle:"undefined"!=typeof i.angle&&i.angle,content:BX.create("div",{props:{className:"menu-popup"},children:[BX.create("div",{props:{className:"menu-popup-items"},children:s})]})});if(i&&i.events)for(var l in i.events)BX.addCustomEvent(r,l,i.events[l]);return r}},t.BXInputPopup=function(t){this.id=t.id||"bx-inp-popup-"+Math.round(1e6*Math.random()),this.handler=t.handler||!1,this.values=t.values||!1,this.pInput=t.input,this.bValues=!!this.values,this.defaultValue=t.defaultValue||"",this.openTitle=t.openTitle||"",this.className=t.className||"",this.noMRclassName=t.noMRclassName||"ec-no-rm",this.emptyClassName=t.noMRclassName||"ec-label";var e=this;this.curInd=!1,this.bValues?(this.pInput.onfocus=this.pInput.onclick=function(t){return this.value==e.defaultValue&&(this.value="",this.className=""),e.ShowPopup(),BX.PreventDefault(t)},this.pInput.onblur=function(){e.bShowed&&setTimeout(function(){e.ClosePopup(!0)},200),e.OnChange()}):(this.pInput.className=this.noMRclassName,this.pInput.onblur=BX.proxy(this.OnChange,this))},BXInputPopup.prototype={ShowPopup:function(){if(!this.bShowed){var t=this;if(!this.oPopup){for(var e,i=BX.create("DIV",{props:{className:"bxecpl-loc-popup "+this.className}}),s=0,n=this.values.length;s<n;s++)e=i.appendChild(BX.create("DIV",{props:{id:"bxecmr_"+s,title:this.values[s].DESCRIPTION},text:this.values[s].NAME,events:{mouseover:function(){this.className="bxecplloc-over"},mouseout:function(){this.className=""},click:function(){var e=this.id.substr("bxecmr_".length);t.pInput.value=t.values[e].NAME,t.curInd=e,t.OnChange(),t.ClosePopup(!0)}}})),this.values[s].URL&&e.appendChild(BX.create("A",{props:{href:this.values[s].URL,className:"bxecplloc-view",target:"_blank",title:this.openTitle}}));this.oPopup=new BX.PopupWindow(this.id,this.pInput,{autoHide:!0,offsetTop:1,offsetLeft:0,lightShadow:!0,closeByEsc:!0,content:i}),BX.addCustomEvent(this.oPopup,"onPopupClose",BX.proxy(this.ClosePopup,this))}this.oPopup.show(),this.pInput.select(),this.bShowed=!0,BX.onCustomEvent(this,"onInputPopupShow",[this])}},ClosePopup:function(t){this.bShowed=!1,""==this.pInput.value&&this.OnChange(),BX.onCustomEvent(this,"onInputPopupClose",[this]),t===!0&&this.oPopup.close()},OnChange:function(){var t=this.pInput.value;this.bValues&&(""==this.pInput.value||this.pInput.value==this.defaultValue?(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName,t=""):this.pInput.className=""),isNaN(parseInt(this.curInd))||this.curInd!==!1&&t!=this.values[this.curInd].NAME?this.curInd=!1:this.curInd=parseInt(this.curInd),BX.onCustomEvent(this,"onInputPopupChanged",[this,this.curInd,t]),this.handler&&"function"==typeof this.handler&&this.handler({ind:this.curInd,value:t})},Set:function(t,e,i){this.curInd=t,this.curInd!==!1?this.pInput.value=this.values[this.curInd].NAME:this.pInput.value=e,i!==!1&&this.OnChange()},Get:function(t){var e=!1;return"undefined"==typeof t&&(t=this.curInd),t!==!1&&this.values[t]&&(e=this.values[t].ID),e},GetIndex:function(t){for(var e=0,i=this.values.length;e<i;e++)if(this.values[e].ID==t)return e;return!1},Deactivate:function(t){""!=this.pInput.value&&this.pInput.value!=this.defaultValue||(t?(this.pInput.value="",this.pInput.className=this.noMRclassName):this.oEC.bUseMR&&(this.pInput.value=this.defaultValue,this.pInput.className=this.emptyClassName)),this.pInput.disabled=t}})}(window),function(window){BX.WindowManager||(BX.WindowManager={_stack:[],_runtime_resize:{},_delta:2,_delta_start:1e3,currently_loaded:null,settings_category:"BX.WindowManager.9.5",register:function(t){this.currently_loaded=null;var e=t.Get();e.style.zIndex=t.zIndex=this.GetZIndex(),t.WM_REG_INDEX=this._stack.length,this._stack.push(t),this._stack.length<2&&BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},unregister:function(t){if(null!=t.WM_REG_INDEX){var e;if(this._stack.length>0){for(;(e=this.__pop_stack())!=t;)if(!e){e=null;break}return this._stack.length<=0&&this.enableKeyCheck(),e}return null}},__pop_stack:function(t){if(this._stack.length>0){var e=this._stack.pop();return e.WM_REG_INDEX=null,BX.onCustomEvent(e,"onWindowUnRegister",[t===!0]),e}return null},clean:function(){for(;this.__pop_stack(!0););this._stack=null,this.disableKeyCheck()},Get:function(){return this.currently_loaded?this.currently_loaded:this._stack.length>0?this._stack[this._stack.length-1]:null},setStartZIndex:function(t){this._delta_start=t},restoreStartZIndex:function(){this._delta_start=1e3},GetZIndex:function(){var t=null!=(_current=this._stack[this._stack.length-1])?parseInt(_current.Get().style.zIndex)+this._delta:this._delta_start;return t},__get_check_url:function(t){var e=t.indexOf("?");return e==-1?t:t.substring(0,e)},saveWindowSize:function(t,e){var i=this.__get_check_url(t);BX.userOptions&&(BX.userOptions.save(this.settings_category,"size_"+i,"width",e.width),BX.userOptions.save(this.settings_category,"size_"+i,"height",e.height)),this._runtime_resize[i]=e},saveWindowOptions:function(t,e){if(BX.userOptions)for(var i in e)BX.userOptions.save(this.settings_category,"options_"+t,i,e[i])},getRuntimeWindowSize:function(t){return this._runtime_resize[this.__get_check_url(t)]},disableKeyCheck:function(){BX.unbind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},enableKeyCheck:function(){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},__checkKeyPress:function(t){if(null==t&&(t=window.event),27==t.keyCode){var e=BX.WindowManager.Get();e&&!e.unclosable&&e.Close()}}},BX.garbage(BX.WindowManager.clean,BX.WindowManager),BX.CWindowButton=function(t){t.btn?(this.btn=t.btn,this.parentWindow=t.parentWindow,/save|apply/i.test(this.btn.name)&&BX.bind(this.btn,"click",BX.delegate(this.disableUntilError,this))):(this.title=t.title,this.hint=t.hint,this.id=t.id,this.name=t.name,this.className=t.className,this.action=t.action,this.onclick=t.onclick,t.Button&&BX.type.isFunction(t.Button)&&(this.Button=t.Button),this.btn=null)},BX.CWindowButton.prototype.disable=function(){this.btn&&this.parentWindow.showWait(this.btn)},BX.CWindowButton.prototype.enable=function(){this.btn&&this.parentWindow.closeWait(this.btn)},BX.CWindowButton.prototype.emulate=function(){if(!this.btn||!this.btn.disabled){var t=this.action?BX.delegate(this.action,this):this.onclick?this.onclick:this.btn?this.btn.getAttribute("onclick"):"";t&&(setTimeout(t,50),this.btn&&/save|apply/i.test(this.btn.name)&&!this.action&&this.disableUntilError())}},BX.CWindowButton.prototype.Button=function(parentWindow){this.parentWindow=parentWindow;var btn={props:{type:"button",name:this.id?this.id:this.name,value:this.title?this.title:this.name,id:this.id}};return this.hint&&(btn.props.title=this.hint),this.className&&(btn.props.className=this.className),this.action?btn.events={click:BX.delegate(this.action,this)}:this.onclick&&(BX.browser.IsIE()?btn.events={click:BX.delegate(function(){eval(this.onclick)},this)}:btn.attrs={onclick:this.onclick}),this.btn=BX.create("INPUT",btn),this.btn},BX.CWindowButton.prototype.disableUntilError=function(){this.disable(),this.__window_error_handler_set||(BX.addCustomEvent(this.parentWindow,"onWindowError",BX.delegate(this.enable,this)),this.__window_error_handler_set=!0)},BX.CWindow=function(t,e){this.DIV=t||document.createElement("DIV"),this.SETTINGS={resizable:!1,min_height:0,min_width:0,top:0,left:0,draggable:!1,drag_restrict:!0,resize_restrict:!0},this.ELEMENTS={draggable:[],resizer:[],close:[]},this.type="float"==e?"float":"dialog",BX.adjust(this.DIV,{props:{className:"bx-core-window"},style:{zIndex:0,position:"absolute",display:"none",top:this.SETTINGS.top+"px",left:this.SETTINGS.left+"px",height:"100px",width:"100px"}}),this.isOpen=!1,BX.addCustomEvent(this,"onWindowRegister",BX.delegate(this.onRegister,this)),BX.addCustomEvent(this,"onWindowUnRegister",BX.delegate(this.onUnRegister,this)),this.MOUSEOVER=null,BX.bind(this.DIV,"mouseover",BX.delegate(this.__set_msover,this)),BX.bind(this.DIV,"mouseout",BX.delegate(this.__unset_msover,this)),BX.ready(BX.delegate(function(){document.body.appendChild(this.DIV)},this))},BX.CWindow.prototype.Get=function(){return this.DIV},BX.CWindow.prototype.visible=function(){return this.isOpen},BX.CWindow.prototype.Show=function(t){this.DIV.style.display="block",t||(BX.WindowManager.register(this),BX.onCustomEvent(this,"onWindowRegister"))},BX.CWindow.prototype.Hide=function(){BX.WindowManager.unregister(this),this.DIV.style.display="none"},BX.CWindow.prototype.onRegister=function(){this.isOpen=!0},BX.CWindow.prototype.onUnRegister=function(t){this.isOpen=!1,t||this.PARAMS&&this.PARAMS.content_url?(t&&BX.onCustomEvent(this,"onWindowClose",[this,!0]),this.DIV.parentNode&&this.DIV.parentNode.removeChild(this.DIV)):this.DIV.style.display="none"},BX.CWindow.prototype.CloseDialog=BX.CWindow.prototype.Close=function(t){if(BX.onCustomEvent(this,"onBeforeWindowClose",[this]),t!==!0&&this.denyClose)return!1;if(BX.onCustomEvent(this,"onWindowClose",[this]),this.bExpanded){var e=BX.GetDocElement();BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),e.style.overflow=this.__expand_settings.overflow}BX.WindowManager.unregister(this)},BX.CWindow.prototype.SetResize=function(t){t.style.cursor="se-resize",BX.bind(t,"mousedown",BX.proxy(this.__startResize,this)),this.ELEMENTS.resizer.push(t),this.SETTINGS.resizable=!0},BX.CWindow.prototype.SetExpand=function(t,e){e=e||"click",BX.bind(t,e,BX.proxy(this.__expand,this))},BX.CWindow.prototype.__expand_onresize=function(){var t=BX.GetWindowInnerSize();this.DIV.style.width=t.innerWidth+"px",this.DIV.style.height=t.innerHeight+"px",BX.onCustomEvent(this,"onWindowResize")},BX.CWindow.prototype.__expand=function(){var t=BX.GetDocElement();if(this.bExpanded)BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),this.SETTINGS.resizable=this.__expand_settings.resizable,this.SETTINGS.draggable=this.__expand_settings.draggable,t.style.overflow=this.__expand_settings.overflow,this.DIV.style.top=this.__expand_settings.top,this.DIV.style.left=this.__expand_settings.left,this.DIV.style.width=this.__expand_settings.width,this.DIV.style.height=this.__expand_settings.height,window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop),this.bExpanded=!1,BX.onCustomEvent(this,"onWindowNarrow"),BX.onCustomEvent(this,"onWindowResize");else{var e=BX.GetWindowScrollPos(),i=BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.DIV.style.width,height:this.DIV.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")},this.SETTINGS.resizable=!1,this.SETTINGS.draggable=!1,window.scrollTo(0,0),t.style.overflow="hidden",this.DIV.style.top="0px",this.DIV.style.left="0px",this.DIV.style.width=i.innerWidth+"px",this.DIV.style.height=i.innerHeight+"px",this.bExpanded=!0,BX.onCustomEvent(this,"onWindowExpand"),BX.onCustomEvent(this,"onWindowResize"),BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}},BX.CWindow.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width),s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var n=BX.GetWindowScrollSize();this.pos.left+i>n.scrollWidth-this.dw&&(i=n.scrollWidth-this.pos.left-this.dw)}this.DIV.style.width=i+"px",this.DIV.style.height=s+"px",BX.onCustomEvent(this,"onWindowResize")},BX.CWindow.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return!1;t||(t=window.event),this.wndSize=BX.GetWindowScrollPos(),this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth,this.pos=BX.pos(this.DIV),this.x=t.clientX+this.wndSize.scrollLeft,this.y=t.clientY+this.wndSize.scrollTop,this.dx=this.pos.left+this.pos.width-this.x,this.dy=this.pos.top+this.pos.height-this.y,this.dw=this.pos.width-parseInt(this.DIV.style.width),BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="se-resize",BX.onCustomEvent(this,"onWindowResizeStart")},BX.CWindow.prototype.__moveResize=function(t){t||(t=window.event);var e=BX.GetWindowScrollPos(),i=t.clientX+e.scrollLeft,s=t.clientY+e.scrollTop;this.x==i&&this.y==s||(this.Resize(i,s),this.x=i,this.y=s)},BX.CWindow.prototype.__stopResize=function(){document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.unbind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.onmousedown=null;var t=document.body;t.ondrag=t.onselectstart=null,t.style.MozUserSelect=this.DIV.style.MozUserSelect="",t.style.cursor="",BX.onCustomEvent(this,"onWindowResizeFinished")},BX.CWindow.prototype.SetClose=function(t){BX.bind(t,"click",BX.proxy(this.Close,this)),this.ELEMENTS.close.push(t)},BX.CWindow.prototype.SetDraggable=function(t){BX.bind(t,"mousedown",BX.proxy(this.__startDrag,this)),t.style.cursor="move",this.ELEMENTS.draggable.push(t),this.SETTINGS.draggable=!0},BX.CWindow.prototype.Move=function(t,e){var i=1,s=parseInt(this.DIV.style.left)+t,n=parseInt(this.DIV.style.top)+e;if(this.SETTINGS.drag_restrict){s<0&&(s=0);var o=BX.GetWindowScrollSize(),a=this.DIV.offsetWidth;floatHeight=this.DIV.offsetHeight,s>o.scrollWidth-a-i&&(s=o.scrollWidth-a-i),n>o.scrollHeight-floatHeight-i&&(n=o.scrollHeight-floatHeight-i),n<0&&(n=0)}this.DIV.style.left=s+"px",this.DIV.style.top=n+"px"},BX.CWindow.prototype.__startDrag=function(t){if(!this.SETTINGS.draggable)return!1;t||(t=window.event),this.x=t.clientX+document.body.scrollLeft,this.y=t.clientY+document.body.scrollTop,this.__bWasDragged=!1,BX.bind(document,"mousemove",BX.proxy(this.__moveDrag,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopDrag,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;return e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="move",BX.PreventDefault(t)},BX.CWindow.prototype.__moveDrag=function(t){t||(t=window.event);var e=t.clientX+document.body.scrollLeft,i=t.clientY+document.body.scrollTop;this.x==e&&this.y==i||(this.Move(e-this.x,i-this.y),this.x=e,this.y=i,this.__bWasDragged||(BX.onCustomEvent(this,"onWindowDragStart"),this.__bWasDragged=!0,BX.bind(BX.proxy_context,"click",BX.PreventDefault)),BX.onCustomEvent(this,"onWindowDrag"))},BX.CWindow.prototype.__stopDrag=function(t){document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this.__moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this.__stopDrag,this)),document.onmousedown=null;var e=document.body;if(e.ondrag=e.onselectstart=null,e.style.MozUserSelect=this.DIV.style.MozUserSelect="",e.style.cursor="",this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragFinished");var i=BX.proxy_context;setTimeout(function(){BX.unbind(i,"click",BX.PreventDefault)},100),this.__bWasDragged=!1}return BX.PreventDefault(t)},BX.CWindow.prototype.DenyClose=function(){this.denyClose=!0},BX.CWindow.prototype.AllowClose=function(){this.denyClose=!1},BX.CWindow.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]),this._wait&&BX.closeWait(this._wait),alert(t)},BX.CWindow.prototype.__set_msover=function(){this.MOUSEOVER=!0},BX.CWindow.prototype.__unset_msover=function(){this.MOUSEOVER=!1},BX.CWindowDialog=function(){arguments[1]="dialog",BX.CWindowDialog.superclass.constructor.apply(this,arguments),this.DIV.style.top="10px",this.OVERLAY=null},BX.extend(BX.CWindowDialog,BX.CWindow),BX.CWindowDialog.prototype.__resizeOverlay=function(){var t=BX.GetWindowScrollSize();this.OVERLAY.style.width=t.scrollWidth+"px"},BX.CWindowDialog.prototype.CreateOverlay=function(t){if(null==this.OVERLAY){var e=BX.GetWindowScrollSize();this.OVERLAY=document.body.appendChild(BX.create("DIV",{style:{position:"absolute",top:"0px",left:"0px",zIndex:t||parseInt(this.DIV.style.zIndex)-2,width:e.scrollWidth+"px",height:e.scrollHeight+"px"}}))}return this.OVERLAY},BX.CWindowDialog.prototype.Show=function(){BX.CWindowDialog.superclass.Show.apply(this,arguments),this.CreateOverlay(),this.OVERLAY.style.display="block",this.OVERLAY.style.zIndex=parseInt(this.DIV.style.zIndex)-2,BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this)),BX.bind(window,"resize",BX.proxy(this.__resizeOverlay,this))},BX.CWindowDialog.prototype.onUnRegister=function(t){BX.CWindowDialog.superclass.onUnRegister.apply(this,arguments),this.clean?this.OVERLAY.parentNode&&this.OVERLAY.parentNode.removeChild(this.OVERLAY):this.OVERLAY.style.display="none",BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this))},BX.CDialog=function(t){BX.CDialog.superclass.constructor.apply(this),this._sender="core_window_cdialog",this.PARAMS=t||{};for(var e in this.defaultParams)"undefined"==typeof this.PARAMS[e]&&(this.PARAMS[e]=this.defaultParams[e]);if(this.PARAMS.width=isNaN(parseInt(this.PARAMS.width))?this.defaultParams.width:this.PARAMS.width,this.PARAMS.height=isNaN(parseInt(this.PARAMS.height))?this.defaultParams.height:this.PARAMS.height,this.PARAMS.resize_id||this.PARAMS.content_url){var i=BX.WindowManager.getRuntimeWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url);i&&(this.PARAMS.width=i.width,this.PARAMS.height=i.height)}BX.addClass(this.DIV,"bx-core-adm-dialog"),this.DIV.id="bx-admin-prefix",this.PARTS={},this.DIV.style.height=null,this.DIV.style.width=null,this.PARTS.TITLEBAR=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head"}})),this.PARTS.TITLE_CONTAINER=this.PARTS.TITLEBAR.appendChild(BX.create("SPAN",{props:{className:"bx-core-adm-dialog-head-inner"},text:this.PARAMS.title})),this.PARTS.TITLEBAR_ICONS=this.PARTS.TITLEBAR.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-icons"},children:this.PARAMS.resizable?[BX.create("SPAN",{props:{className:"bx-core-adm-icon-expand",title:BX.message("JS_CORE_WINDOW_EXPAND")}}),BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]:[BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]})),this.PARTS.CONTENT=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap adm-workarea"}})),this.PARTS.CONTENT_DATA=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content"},style:{height:this.PARAMS.height+"px",width:this.PARAMS.width+"px"}})),this.PARTS.HEAD=this.PARTS.CONTENT_DATA.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-block"+(this.PARAMS.icon?" "+this.PARAMS.icon:"")}})),this.SetHead(this.PARAMS.head),this.SetContent(this.PARAMS.content),this.SetTitle(this.PARAMS.title),this.SetClose(this.PARTS.TITLEBAR_ICONS.lastChild),this.PARAMS.resizable&&(this.SetExpand(this.PARTS.TITLEBAR_ICONS.firstChild),BX.addCustomEvent(this,"onWindowExpand",BX.proxy(this.__onexpand,this)),BX.addCustomEvent(this,"onWindowNarrow",BX.proxy(this.__onexpand,this))),this.PARTS.FOOT=this.PARTS.BUTTONS_CONTAINER=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-buttons"},children:this.ShowButtons()})),this.PARAMS.draggable&&this.SetDraggable(this.PARTS.TITLEBAR),this.SetExpand(this.PARTS.TITLEBAR,"dblclick"),this.PARAMS.resizable&&(this.PARTS.RESIZER=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-resizer"}})),this.SetResize(this.PARTS.RESIZER),this.SETTINGS.min_width=this.PARAMS.min_width,this.SETTINGS.min_height=this.PARAMS.min_height),this.auth_callback=BX.delegate(function(){this.PARAMS.content="",this.hideNotify(),this.Show()},this)},BX.extend(BX.CDialog,BX.CWindowDialog),BX.CDialog.prototype.defaultParams={width:700,height:400,min_width:500,min_height:300,resizable:!0,draggable:!0,title:"",icon:""},BX.CDialog.prototype.showWait=function(t){if(BX.type.isElementNode(t)&&("button"==t.type||"submit"==t.type)){BX.defer(function(){t.disabled=!0})();var e=BX.hasClass(t,"adm-btn-save")||BX.hasClass(t,"adm-btn-save"),i=(BX.findParent(t,BX.is_fixed)||document.body,BX.pos(t,!0));return t.bxwaiter=this.PARTS.FOOT.appendChild(BX.create("DIV",{props:{className:"adm-btn-load-img"+(e?"-green":"")},style:{top:parseInt((i.bottom+i.top)/2-10)+"px",left:parseInt((i.right+i.left)/2-10)+"px"}})),BX.addClass(t,"adm-btn-load"),this.lastWaitElement=t,t.bxwaiter}},BX.CDialog.prototype.closeWait=function(t){t=t||this.lastWaitElement,BX.type.isElementNode(t)&&(t.bxwaiter&&(t.bxwaiter.parentNode&&t.bxwaiter.parentNode.removeChild(t.bxwaiter),t.bxwaiter=null),t.disabled=!1,BX.removeClass(t,"adm-btn-load"),this.lastWaitElement==t&&(this.lastWaitElement=null))},BX.CDialog.prototype.Authorize=function(t){this.bSkipReplaceContent=!0,this.ShowError(BX.message("JSADM_AUTH_REQ")),BX.onCustomEvent(this,"onWindowError",[]),BX.closeWait(),new BX.CAuthDialog({content_url:this.PARAMS.content_url,auth_result:t,callback:BX.delegate(function(){this.auth_callback&&this.auth_callback()},this)}).Show()},BX.CDialog.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]),this.closeWait(),this._wait&&BX.closeWait(this._wait),this.Notify(t,!0)},BX.CDialog.prototype.__expandGetSize=function(){var t=BX.GetDocElement();t.style.overflow="hidden";var e=BX.GetWindowInnerSize();return t.scrollTop=0,this.DIV.style.top="-"+this.dxShadow+"px",this.DIV.style.left="-"+this.dxShadow+"px",{width:e.innerWidth-parseInt(BX.style(this.PARTS.CONTENT,"padding-right"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-left"))+this.dxShadow,height:e.innerHeight-this.PARTS.TITLEBAR.offsetHeight-this.PARTS.FOOT.offsetHeight-parseInt(BX.style(this.PARTS.CONTENT,"padding-top"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-bottom"))+this.dxShadow}},BX.CDialog.prototype.__expand=function(){var t=BX.GetDocElement();if(this.dxShadow=2,this.bExpanded)BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),this.SETTINGS.resizable=this.__expand_settings.resizable,this.SETTINGS.draggable=this.__expand_settings.draggable,t.style.overflow=this.__expand_settings.overflow,this.DIV.style.top=this.__expand_settings.top,this.DIV.style.left=this.__expand_settings.left,this.PARTS.CONTENT_DATA.style.width=this.__expand_settings.width,this.PARTS.CONTENT_DATA.style.height=this.__expand_settings.height,window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop),this.bExpanded=!1,BX.onCustomEvent(this,"onWindowNarrow"),BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{width:parseInt(this.__expand_settings.width),height:parseInt(this.__expand_settings.height)}]);else{var e=BX.GetWindowScrollPos();BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.PARTS.CONTENT_DATA.style.width,height:this.PARTS.CONTENT_DATA.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")},this.SETTINGS.resizable=!1,this.SETTINGS.draggable=!1;var i=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=i.width+"px",this.PARTS.CONTENT_DATA.style.height=i.height+"px",window.scrollTo(0,0),t.style.overflow="hidden",this.bExpanded=!0,BX.onCustomEvent(this,"onWindowExpand"),BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{width:i.width,height:i.height}]),BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}},BX.CDialog.prototype.__expand_onresize=function(){var t=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=t.width+"px",this.PARTS.CONTENT_DATA.style.height=t.height+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[t])},BX.CDialog.prototype.__onexpand=function(){var t=this.PARTS.TITLEBAR_ICONS.firstChild;t.className=BX.toggle(t.className,["bx-core-adm-icon-expand","bx-core-adm-icon-narrow"]),t.title=BX.toggle(t.title,[BX.message("JS_CORE_WINDOW_EXPAND"),BX.message("JS_CORE_WINDOW_NARROW")]),this.PARTS.RESIZER&&(this.PARTS.RESIZER.style.display=this.bExpanded?"none":"block")},BX.CDialog.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return!1;t||(t=window.event),this.wndSize=BX.GetWindowScrollPos(),this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth,this.pos=BX.pos(this.PARTS.CONTENT_DATA),this.x=t.clientX+this.wndSize.scrollLeft,this.y=t.clientY+this.wndSize.scrollTop,this.dx=this.pos.left+this.pos.width-this.x,this.dy=this.pos.top+this.pos.height-this.y,this.dw=this.pos.width-parseInt(this.PARTS.CONTENT_DATA.style.width)+parseInt(BX.style(this.PARTS.CONTENT,"padding-right")),BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="se-resize",BX.onCustomEvent(this,"onWindowResizeStart")},BX.CDialog.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width),s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var n=BX.GetWindowScrollSize();this.pos.left+i>n.scrollWidth-this.dw&&(i=n.scrollWidth-this.pos.left-this.dw)}this.PARTS.CONTENT_DATA.style.width=i+"px",this.PARTS.CONTENT_DATA.style.height=s+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{height:s,width:i}])},BX.CDialog.prototype.SetSize=function(t){this.PARTS.CONTENT_DATA.style.width=t.width+"px",this.PARTS.CONTENT_DATA.style.height=t.height+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[t])},BX.CDialog.prototype.GetParameters=function(t){var e=this.GetForm();if(!e)return"";var i,s="",n=e.elements.length,o="";for(i=0;i<n;i++){""!=s&&(o="&");var a=e.elements[i];if(!a.disabled)switch(a.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==t&&"_alt"==a.name.substr(a.name.length-4)&&e.elements[a.name.substr(0,a.name.length-4)])break;s+=o+a.name+"="+BX.util.urlencode(a.value);break;case"radio":a.checked&&(s+=o+a.name+"="+BX.util.urlencode(a.value));break;case"checkbox":s+=o+a.name+"="+BX.util.urlencode(a.checked?"Y":"N");break;case"select-one":var r="";r=null==t&&e.elements[a.name+"_alt"]&&0==a.selectedIndex?e.elements[a.name+"_alt"].value:a.value,s+=o+a.name+"="+BX.util.urlencode(r);break;case"select-multiple":var l,d=!1,h=a.options.length;for(l=0;l<h;l++)a.options[l].selected&&(s+=o+a.name+"="+BX.util.urlencode(a.options[l].value),d=!0);d||(s+=o+a.name+"=")}}return s},BX.CDialog.prototype.PostParameters=function(t){var e=this.PARAMS.content_url;null==t&&(t=""),t+=(""==t?"":"&")+"bxsender="+this._sender,index=e.indexOf("?"),index==-1?e+="?"+t:e=e.substring(0,index)+"?"+t+"&"+e.substring(index+1),BX.showWait(),this.auth_callback=BX.delegate(function(){this.hideNotify(),this.PostParameters(t)},this),BX.ajax.post(e,this.GetParameters(),BX.delegate(function(t){BX.closeWait(),this.bSkipReplaceContent||(this.ClearButtons(),this.SetContent(t),this.Show(!0)),this.bSkipReplaceContent=!1},this))},BX.CDialog.prototype.Submit=function(t,e){var i=this.GetForm();if(i){if(i.onsubmit=null,i.method="POST",!i.action||e){var e=e||this.PARAMS.content_url;null!=t&&(index=e.indexOf("?"),index==-1?e+="?"+t:e=e.substring(0,index)+"?"+t+"&"+e.substring(index+1)),i.action=e}i._bxsender||(i._bxsender=i.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:"bxsender",value:this._sender}}))),this._wait=BX.showWait(),this.auth_callback=BX.delegate(function(){this.hideNotify(),this.Submit(t)},this),BX.ajax.submit(i,BX.delegate(function(){this.closeWait()},this))}else alert("no form registered!")},BX.CDialog.prototype.GetForm=function(){if(null==this.__form){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__form=t[0]?t[0]:null}return this.__form},BX.CDialog.prototype.GetRealForm=function(){if(null==this.__rform){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__rform=t[1]?t[1]:t[0]?t[0]:null}return this.__rform},BX.CDialog.prototype._checkButton=function(t){for(var e=["btnSave","btnCancel","btnClose"],i=0;i<e.length;i++)if(this[e[i]]&&t==this[e[i]])return e[i];return!1},BX.CDialog.prototype.ShowButtons=function(){var t=[];if(this.PARAMS.buttons){this.PARAMS.buttons.title&&(this.PARAMS.buttons=[this.PARAMS.buttons]);for(var e=0,i=this.PARAMS.buttons.length;e<i;e++)if(BX.type.isNotEmptyString(this.PARAMS.buttons[e]))t.push(this.PARAMS.buttons[e]);else if(this.PARAMS.buttons[e]){if(!BX.is_subclass_of(this.PARAMS.buttons[e],BX.CWindowButton)){var s=this._checkButton(this.PARAMS.buttons[e]);this.PARAMS.buttons[e]=new BX.CWindowButton(this.PARAMS.buttons[e]),s&&(this[s]=this.PARAMS.buttons[e])}t.push(this.PARAMS.buttons[e].Button(this))}}return t},BX.CDialog.prototype.setAutosave=function(){if(!this.bSetAutosaveDelay)return this.bSetAutosaveDelay=!0,void setTimeout(BX.proxy(this.setAutosave,this),10)},BX.CDialog.prototype.SetTitle=function(t){this.PARAMS.title=t,BX.cleanNode(this.PARTS.TITLE_CONTAINER).appendChild(document.createTextNode(this.PARAMS.title))},BX.CDialog.prototype.SetHead=function(t){this.PARAMS.head=BX.util.trim(t),this.PARTS.HEAD.innerHTML=this.PARAMS.head||"&nbsp;",this.PARTS.HEAD.style.display=this.PARAMS.head?"block":"none",this.adjustSize()},BX.CDialog.prototype.Notify=function(t,e){this.PARTS.NOTIFY||(this.PARTS.NOTIFY=this.DIV.insertBefore(BX.create("DIV",{props:{className:"adm-warning-block"},children:[BX.create("SPAN",{props:{className:"adm-warning-text"}}),BX.create("SPAN",{props:{className:"adm-warning-icon"}}),BX.create("SPAN",{props:{className:"adm-warning-close"},events:{click:BX.proxy(this.hideNotify,this)}})]}),this.DIV.firstChild)),e?BX.addClass(this.PARTS.NOTIFY,"adm-warning-block-red"):BX.removeClass(this.PARTS.NOTIFY,"adm-warning-block-red"),this.PARTS.NOTIFY.firstChild.innerHTML=t||"&nbsp;",this.PARTS.NOTIFY.firstChild.style.width=this.PARAMS.width+"px",BX.removeClass(this.PARTS.NOTIFY,"adm-warning-animate")},BX.CDialog.prototype.hideNotify=function(){BX.addClass(this.PARTS.NOTIFY,"adm-warning-animate")},BX.CDialog.prototype.__adjustHeadToIcon=function(){this.PARTS.HEAD.offsetHeight?(this.icon_image&&this.icon_image.height&&this.icon_image.height>this.PARTS.HEAD.offsetHeight-5&&(this.PARTS.HEAD.style.height=this.icon_image.height+5+"px",
this.adjustSize()),this.icon_image.onload=null,this.icon_image=null):setTimeout(BX.delegate(this.__adjustHeadToIcon,this),50)},BX.CDialog.prototype.SetIcon=function(t){if(this.PARAMS.icon!=t&&(this.PARAMS.icon&&BX.removeClass(this.PARTS.HEAD,this.PARAMS.icon),this.PARAMS.icon=t,this.PARAMS.icon)){BX.addClass(this.PARTS.HEAD,this.PARAMS.icon);var e=(BX.style(this.PARTS.HEAD,"background-image")||BX.style(this.PARTS.HEAD,"backgroundImage")).replace('url("',"").replace('")',"");BX.type.isNotEmptyString(e)&&"none"!=e&&(this.icon_image=new Image,this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this),this.icon_image.src=e)}this.adjustSize()},BX.CDialog.prototype.SetIconFile=function(t){this.icon_image=new Image,this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this),this.icon_image.src=t,BX.adjust(this.PARTS.HEAD,{style:{backgroundImage:"url("+t+")",backgroundPosition:"right 9px"}}),this.adjustSize()},BX.CDialog.prototype.SetButtons=function(t){if(BX.type.isString(t)){if(t.length>0){this.PARTS.BUTTONS_CONTAINER.innerHTML+=t;var e=this.PARTS.BUTTONS_CONTAINER.getElementsByTagName("INPUT");if(e.length>0){this.PARAMS.buttons=[];for(var i=0;i<e.length;i++)this.PARAMS.buttons.push(new BX.CWindowButton({btn:e[i],parentWindow:this}))}}}else this.PARAMS.buttons=t,BX.adjust(this.PARTS.BUTTONS_CONTAINER,{children:this.ShowButtons()});this.adjustSize()},BX.CDialog.prototype.ClearButtons=function(){BX.cleanNode(this.PARTS.BUTTONS_CONTAINER),this.adjustSize()},BX.CDialog.prototype.SetContent=function(t){this.__form=null,BX.type.isElementNode(t)?t.parentNode&&t.parentNode.removeChild(t):BX.type.isString(t)&&(t=BX.create("DIV",{html:t})),this.PARAMS.content=t,BX.cleanNode(this.PARTS.CONTENT_DATA),BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARTS.HEAD,BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap-inner"},children:[this.PARAMS.content]})]}),this.PARAMS.content_url&&this.GetForm()&&(this.__form.submitbtn=this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}})),this.__form.onsubmit=BX.delegate(this.__submit,this))},BX.CDialog.prototype.__submit=function(t){for(var e=0,i=this.PARAMS.buttons.length;e<i;e++)if(this.PARAMS.buttons[e]&&(this.PARAMS.buttons[e].name&&/save|apply/i.test(this.PARAMS.buttons[e].name)||this.PARAMS.buttons[e].btn&&this.PARAMS.buttons[e].btn.name&&/save|apply/i.test(this.PARAMS.buttons[e].btn.name))){this.PARAMS.buttons[e].emulate();break}return BX.PreventDefault(t)},BX.CDialog.prototype.SwapContent=function(t){t=BX(t),BX.cleanNode(this.PARTS.CONTENT_DATA),t.parentNode.removeChild(t),this.PARTS.CONTENT_DATA.appendChild(t),t.style.display="block",this.SetContent(t.innerHTML)},BX.CDialog.prototype.adjustSize=function(){},BX.CDialog.prototype.__adjustSize=function(){},BX.CDialog.prototype.adjustSizeEx=function(){BX.defer(this.__adjustSizeEx,this)()},BX.CDialog.prototype.__adjustSizeEx=function(){for(var t=this.PARTS.CONTENT_DATA.firstChild,e=0;t;)e+=t.offsetHeight+parseInt(BX.style(t,"margin-top"))+parseInt(BX.style(t,"margin-bottom")),t=BX.nextSibling(t);e&&(this.PARTS.CONTENT_DATA.style.height=e+"px")},BX.CDialog.prototype.__onResizeFinished=function(){BX.WindowManager.saveWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url,{height:parseInt(this.PARTS.CONTENT_DATA.style.height),width:parseInt(this.PARTS.CONTENT_DATA.style.width)})},BX.CDialog.prototype.Show=function(t){if(!this.PARAMS.content&&this.PARAMS.content_url&&BX.ajax&&!t){var e=BX.showWait();BX.WindowManager.currently_loaded=this,this.CreateOverlay(parseInt(BX.style(e,"z-index"))-1),this.OVERLAY.style.display="block",this.OVERLAY.className="bx-core-dialog-overlay";var i="",s="GET";this.PARAMS.content_post&&(i=this.PARAMS.content_post,s="POST");var n=this.PARAMS.content_url+(this.PARAMS.content_url.indexOf("?")<0?"?":"&")+"bxsender="+this._sender;this.auth_callback=BX.delegate(function(){this.PARAMS.content="",this.hideNotify(),this.Show()},this),BX.ajax({method:s,dataType:"html",url:n,data:i,onsuccess:BX.delegate(function(t){BX.closeWait(null,e),this.SetContent(t||"&nbsp;"),this.Show()},this),processScriptsConsecutive:!0})}else BX.WindowManager.currently_loaded=null,BX.CDialog.superclass.Show.apply(this,arguments),this.adjustPos(),this.OVERLAY.className="bx-core-dialog-overlay",this.__adjustSize(),BX.addCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this)),this.PARAMS.resizable&&(this.PARAMS.content_url||this.PARAMS.resize_id)&&BX.addCustomEvent(this,"onWindowResizeFinished",BX.delegate(this.__onResizeFinished,this))},BX.CDialog.prototype.GetInnerPos=function(){return{width:parseInt(this.PARTS.CONTENT_DATA.style.width),height:parseInt(this.PARTS.CONTENT_DATA.style.height)}},BX.CDialog.prototype.adjustPos=function(){if(!this.bExpanded){var t=BX.GetWindowInnerSize(),e=BX.GetWindowScrollPos();BX.adjust(this.DIV,{style:{left:parseInt(e.scrollLeft+t.innerWidth/2-parseInt(this.DIV.offsetWidth)/2)+"px",top:Math.max(parseInt(e.scrollTop+t.innerHeight/2-parseInt(this.DIV.offsetHeight)/2),0)+"px"}})}},BX.CDialog.prototype.GetContent=function(){return this.PARTS.CONTENT_DATA},BX.CDialog.prototype.btnSave=BX.CDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:BX.browser.IsIE()&&BX.browser.IsDoctype()&&!BX.browser.IsIE10()?"":"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.PostParameters()}},BX.CDialog.prototype.btnCancel=BX.CDialog.btnCancel={title:BX.message("JS_CORE_WINDOW_CANCEL"),id:"cancel",name:"cancel",action:function(){this.parentWindow.Close()}},BX.CDialog.prototype.btnClose=BX.CDialog.btnClose={title:BX.message("JS_CORE_WINDOW_CLOSE"),id:"close",name:"close",action:function(){this.parentWindow.Close()}},BX.CAdminDialog=function(t){BX.CAdminDialog.superclass.constructor.apply(this,arguments),this._sender="core_window_cadmindialog",BX.addClass(this.DIV,"bx-core-adm-admin-dialog"),this.PARTS.CONTENT.insertBefore(this.PARTS.HEAD,this.PARTS.CONTENT.firstChild),this.PARTS.HEAD.className="bx-core-adm-dialog-tabs"},BX.extend(BX.CAdminDialog,BX.CDialog),BX.CAdminDialog.prototype.SetHead=function(){if(BX.CAdminDialog.superclass.SetHead.apply(this,arguments),this.PARTS.HEAD.firstChild&&BX.type.isElementNode(this.PARTS.HEAD.firstChild)){for(var t=this.PARTS.HEAD.firstChild,e=0;t;)e+=t.offsetWidth+parseInt(BX.style(t,"margin-left"))+parseInt(BX.style(t,"margin-right")),t=BX.nextSibling(t);this.SETTINGS.min_width=Math.max(e,this.SETTINGS.min_width)-2,this.PARAMS.width<this.SETTINGS.min_width&&BX.adjust(this.PARTS.CONTENT_DATA,{style:{width:this.SETTINGS.min_width+"px"}})}},BX.CAdminDialog.prototype.SetContent=function(t){this.__form=null,BX.type.isElementNode(t)&&t.parentNode&&t.parentNode.removeChild(t),this.PARAMS.content=t,BX.cleanNode(this.PARTS.CONTENT_DATA),BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARAMS.content||"&nbsp;"]}),this.PARAMS.content_url&&this.GetForm()&&(this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}})),this.__form.onsubmit=BX.delegate(this.__submit,this))},BX.CAdminDialog.prototype.__adjustSizeEx=function(){var t=BX.firstChild(this.PARTS.CONTENT_DATA).offsetHeight;t&&(this.PARTS.CONTENT_DATA.style.height=t+"px")},BX.CAdminDialog.prototype.__expandGetSize=function(){var t=BX.CAdminDialog.superclass.__expandGetSize.apply(this,arguments);return t.width-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-right"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-left")),t.height-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-top"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-bottom")),t.height-=this.PARTS.HEAD.offsetHeight,t},BX.CAdminDialog.prototype.Submit=function(){var t=this.GetForm();return!t||t.bxpublic||/bxpublic=/.test(t.action)||t.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"bxpublic",value:"Y"}})),BX.CAdminDialog.superclass.Submit.apply(this,arguments)},BX.CAdminDialog.prototype.btnSave=BX.CAdminDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.Submit()}},BX.CAdminDialog.btnCancel=BX.CAdminDialog.superclass.btnCancel,BX.CAdminDialog.btnClose=BX.CAdminDialog.superclass.btnClose,BX.CDebugDialog=function(t){BX.CDebugDialog.superclass.constructor.apply(this,arguments)},BX.extend(BX.CDebugDialog,BX.CDialog),BX.CDebugDialog.prototype.ShowDetails=function(t){var e=BX(t);e&&(this.div_detail_current&&(this.div_detail_current.style.display="none"),e.style.display="block",this.div_detail_current=e)},BX.CDebugDialog.prototype.SetContent=function(t){if(t){var e=t.split("#DIVIDER#");e.length>1?(this.PARAMS.content=e[1],this.PARTS.CONTENT_DATA.style.overflow="hidden",BX.CDebugDialog.superclass.SetContent.apply(this,[e[1]]),this.PARTS.CONTENT_INNER=this.PARTS.CONTENT_DATA.firstChild.nextSibling,this.PARTS.CONTENT_TOP=this.PARTS.CONTENT_DATA.insertBefore(BX.create("DIV",{props:{className:"bx-debug-content-top"},html:e[0]}),this.PARTS.CONTENT_INNER),this.PARTS.CONTENT_INNER.style.overflow="auto"):BX.CDebugDialog.superclass.SetContent.apply(this,arguments)}},BX.CDebugDialog.prototype.__adjustSize=function(){if(BX.CDebugDialog.superclass.__adjustSize.apply(this,arguments),this.PARTS.CONTENT_TOP){var t=this.PARTS.CONTENT_DATA.offsetHeight-this.PARTS.HEAD.offsetHeight-this.PARTS.CONTENT_TOP.offsetHeight-38;t>0&&(this.PARTS.CONTENT_INNER.style.height=t+"px")}},BX.CEditorDialog=function(t){BX.CEditorDialog.superclass.constructor.apply(this,arguments),BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap"),BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content"),BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner"),BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons"),BX.addClass(this.PARTS.CONTENT,"bx-core-editor-dialog-content-wrap"),BX.addClass(this.PARTS.CONTENT_DATA,"bx-core-editor-dialog-content"),BX.addClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-editor-dialog-buttons")},BX.extend(BX.CEditorDialog,BX.CDialog),BX.CEditorDialog.prototype.SetContent=function(){BX.CEditorDialog.superclass.SetContent.apply(this,arguments),BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner")},BX.CAuthDialog=function(t){t.resizable=!1,t.width=350,t.height=200,t.buttons=[this.btnSave],BX.CAuthDialog.superclass.constructor.apply(this,arguments),this._sender="core_window_cauthdialog",BX.addClass(this.DIV,"bx-core-auth-dialog"),BX.AUTHAGENT=this},BX.extend(BX.CAuthDialog,BX.CDialog),BX.CAuthDialog.prototype.btnSave=BX.CAuthDialog.btnSave={title:BX.message("JS_CORE_WINDOW_AUTH"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.Submit({},this.parentWindow.PARAMS.content_url)}},BX.CAuthDialog.prototype.SetError=function(t){BX.closeWait(),t&&this.ShowError(t.MESSAGE||t)},BX.CAuthDialog.prototype.setAuthResult=function(t){BX.closeWait(),t===!1?(this.Close(),this.PARAMS.callback&&this.PARAMS.callback()):this.SetError(t)},BX.CWindowFloat=function(t){BX.CWindowFloat.superclass.constructor.apply(this,[t,"float"]),this.SETTINGS.resizable=!1},BX.extend(BX.CWindowFloat,BX.CWindow),BX.CWindowFloat.prototype.adjustPos=function(){this.PARAMS.parent?this.adjustToNode():this.PARAMS.x&&this.PARAMS.y&&this.adjustToPos([this.PARAMS.x,this.PARAMS.y])},BX.CWindowFloat.prototype.adjustToPos=function(t){this.DIV.style.left=parseInt(t[0])+"px",this.DIV.style.top=parseInt(t[1])+"px"},BX.CWindowFloat.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent);return t},BX.CWindowFloat.prototype.adjustToNode=function(t){if(t=t||this.PARAMS.parent,this.PARAMS.parent=BX(t),this.PARAMS.parent){var e=this.adjustToNodeGetPos();this.DIV.style.top=e.top+"px",this.DIV.style.left=e.left+"px",this.PARAMS.parent.OPENER=this}},BX.CWindowFloat.prototype.Show=function(){this.adjustToPos([-1e3,-1e3]),BX.CWindowFloat.superclass.Show.apply(this,arguments),this.adjustPos()},BX.COpener=function(t){this.PARAMS=t||{},this.MENU=t.MENU||[],this.DIV=t.DIV,this.ATTACH=t.ATTACH||t.DIV,this.ATTACH_MODE=t.ATTACH_MODE||"bottom",this.ACTIVE_CLASS=t.ACTIVE_CLASS||"",this.LEVEL=t.LEVEL||0,this.CLOSE_ON_CLICK="undefined"==typeof t.CLOSE_ON_CLICK||!!t.CLOSE_ON_CLICK,this.ADJUST_ON_CLICK="undefined"==typeof t.ADJUST_ON_CLICK||!!t.ADJUST_ON_CLICK,this.TYPE="hover"==this.PARAMS.TYPE?"hover":"click",this._openTimeout=null,"hover"==this.PARAMS.TYPE&&0!==t.TIMEOUT?this.TIMEOUT=t.TIMEOUT||1e3:this.TIMEOUT=0,this.PARAMS.MENU_URL&&(this.bMenuLoaded=!1,this.bMenuLoading=!1,this.MENU=[{TEXT:BX.message("JS_CORE_LOADING"),CLOSE_ON_CLICK:!1}],this.PARAMS.MENU_PRELOAD&&BX.defer(this.Load,this)()),BX.ready(BX.defer(this.Init,this))},BX.COpener.prototype.Init=function(){switch(this.DIV=BX(this.DIV),this.TYPE){case"hover":BX.bind(this.DIV,"mouseover",BX.proxy(this.Open,this)),BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break;case"click":BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this))}this.bMenuInit=!1},BX.COpener.prototype.Load=function(){if(this.PARAMS.MENU_URL&&!this.bMenuLoaded&&!this.bMenuLoading){var t=this.PARAMS.MENU_URL;t.indexOf("sessid=")<=0&&(t+=(t.indexOf("?")>0?"&":"?")+"sessid="+BX.bitrix_sessid()),this.bMenuLoading=!0,BX.ajax.loadJSON(t,BX.proxy(this.SetMenu,this),BX.proxy(this.LoadFailed,this))}},BX.COpener.prototype.SetMenu=function(t){this.bMenuLoaded=!0,this.bMenuLoading=!1,this.bMenuInit?this.MENU.setItems(t):this.MENU=t},BX.COpener.prototype.LoadFailed=function(){this.bMenuLoading=!1,BX.debug(arguments)},BX.COpener.prototype.checkAdminMenu=function(){return"bx-admin-prefix"==document.documentElement.id||!!BX.findParent(this.DIV,{property:{id:"bx-admin-prefix"}})},BX.COpener.prototype.Toggle=function(t){if(this.__clear_timeout(),this.bMenuInit&&this.MENU.visible())this.MENU.Close();else{var e=this.TIMEOUT;this.TIMEOUT=0,this.Open(t),this.TIMEOUT=e}return!(!t&&!window.event)&&BX.PreventDefault(t)},BX.COpener.prototype.GetMenu=function(){return this.bMenuInit||(BX.type.isArray(this.MENU)&&(this.MENU=new BX.CMenu({ITEMS:this.MENU,ATTACH_MODE:this.ATTACH_MODE,SET_ID:this.checkAdminMenu()?"bx-admin-prefix":"",CLOSE_ON_CLICK:!!this.CLOSE_ON_CLICK,ADJUST_ON_CLICK:!!this.ADJUST_ON_CLICK,LEVEL:this.LEVEL,parent:BX(this.DIV),parent_attach:BX(this.ATTACH)}),this.LEVEL>0&&(BX.bind(this.MENU.DIV,"mouseover",BX.proxy(this._on_menu_hover,this)),BX.bind(this.MENU.DIV,"mouseout",BX.proxy(this._on_menu_hout,this)))),BX.addCustomEvent(this.MENU,"onMenuOpen",BX.proxy(this.handler_onopen,this)),BX.addCustomEvent(this.MENU,"onMenuClose",BX.proxy(this.handler_onclose,this)),BX.addCustomEvent("onMenuItemHover",BX.proxy(this.handler_onover,this)),this.bMenuInit=!0),this.MENU},BX.COpener.prototype.Open=function(t){return this.GetMenu(),this.bOpen=!0,this.__clear_timeout(),this.TIMEOUT>0?(BX.bind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this)),this._openTimeout=setTimeout(BX.proxy(this.__open,this),this.TIMEOUT)):this.__open(),this.PARAMS.MENU_URL&&!this.bMenuLoaded&&(this._loadTimeout=setTimeout(BX.proxy(this.Load,this),parseInt(this.TIMEOUT/2))),!0},BX.COpener.prototype.__clear_timeout=function(){this._openTimeout&&clearTimeout(this._openTimeout),this._loadTimeout&&clearTimeout(this._loadTimeout),BX.unbind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this))},BX.COpener.prototype._on_menu_hover=function(){this.bMenuHover=!0,this.__clear_timeout(),this.ACTIVE_CLASS&&BX.addClass(this.DIV,this.ACTIVE_CLASS)},BX.COpener.prototype._on_menu_hout=function(){this.bMenuHover=!1},BX.COpener.prototype.handler_onover=function(t,e){this.bMenuHover||(e!=this&&t==this.LEVEL-1&&this.ACTIVE_CLASS&&BX.removeClass(this.DIV,this.ACTIVE_CLASS),this.bMenuInit&&t<=this.LEVEL-1&&this.MENU.visible()&&e!=this&&(this.__clear_timeout(),this._openTimeout=setTimeout(BX.proxy(this.Close,this),this.TIMEOUT)))},BX.COpener.prototype.handler_onopen=function(){this.bOpen=!0,this.ACTIVE_CLASS&&BX.addClass(this.DIV,this.ACTIVE_CLASS),BX.defer(function(){BX.onCustomEvent(this,"onOpenerMenuOpen")},this)()},BX.COpener.prototype.handler_onclose=function(){this.bOpen=!1,BX.onCustomEvent(this,"onOpenerMenuClose"),this.ACTIVE_CLASS&&BX.removeClass(this.DIV,this.ACTIVE_CLASS)},BX.COpener.prototype.Close=function(t){this.bMenuInit&&(this._openTimeout&&clearTimeout(this._openTimeout),this.bOpen=!1,this.__close())},BX.COpener.prototype.__open=function(){this.__clear_timeout(),this.bMenuInit&&this.bOpen&&!this.MENU.visible()&&this.MENU.Show()},BX.COpener.prototype.__close=function(){this.bMenuInit&&!this.bOpen&&this.MENU.visible()&&this.MENU.Hide()},BX.COpener.prototype.__close_immediately=function(){this.bOpen=!1,this.__close()},BX.COpener.prototype.isMenuVisible=function(){return null!=this.MENU.visible&&this.MENU.visible()},BX.CMenu=function(t){BX.CMenu.superclass.constructor.apply(this),this.DIV.style.width="auto",this.DIV.style.height="auto",this.PARAMS=t||{},this.PARTS={},this.PARAMS.ATTACH_MODE=this.PARAMS.ATTACH_MODE||"bottom",this.PARAMS.CLOSE_ON_CLICK="undefined"==typeof this.PARAMS.CLOSE_ON_CLICK||this.PARAMS.CLOSE_ON_CLICK,this.PARAMS.ADJUST_ON_CLICK="undefined"==typeof this.PARAMS.ADJUST_ON_CLICK||this.PARAMS.ADJUST_ON_CLICK,this.PARAMS.LEVEL=this.PARAMS.LEVEL||0,this.DIV.className="bx-core-popup-menu bx-core-popup-menu-"+this.PARAMS.ATTACH_MODE+" bx-core-popup-menu-level"+this.PARAMS.LEVEL,+("undefined"!=typeof this.PARAMS.ADDITIONAL_CLASS?" "+this.PARAMS.ADDITIONAL_CLASS:""),this.PARAMS.SET_ID&&(this.DIV.id=this.PARAMS.SET_ID),0==this.PARAMS.LEVEL&&(this.ARROW=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-core-popup-menu-angle"},style:{left:"15px"}}))),this.PARAMS.CLASS_NAME&&(this.DIV.className+=" "+this.PARAMS.CLASS_NAME),BX.bind(this.DIV,"click",BX.eventCancelBubble),this.ITEMS=[],this.setItems(this.PARAMS.ITEMS),BX.addCustomEvent("onMenuOpen",BX.proxy(this._onMenuOpen,this)),BX.addCustomEvent("onMenuItemSelected",BX.proxy(this.Hide,this))},BX.extend(BX.CMenu,BX.CWindowFloat),BX.CMenu.broadcastCloseEvent=function(){BX.onCustomEvent("onMenuItemSelected")},BX.CMenu._toggleChecked=function(){BX.toggleClass(this,"bx-core-popup-menu-item-checked")},BX.CMenu._itemDblClick=function(){window.location.href=this.href},BX.CMenu.prototype.toggleArrow=function(t){this.ARROW&&("undefined"==typeof t&&(t="hidden"==this.ARROW.style.visibility),this.ARROW.style.visibility=t?"visible":"hidden")},BX.CMenu.prototype.visible=function(){return"none"!==this.DIV.style.display},BX.CMenu.prototype._onMenuOpen=function(t,e){this.visible()&&e==this.PARAMS.LEVEL&&t!=this&&this.Hide()},BX.CMenu.prototype.onUnRegister=function(){this.visible()&&this.Hide()},BX.CMenu.prototype.setItems=function(t){if(this.PARAMS.ITEMS=t,BX.cleanNode(this.DIV),this.ARROW&&this.DIV.appendChild(this.ARROW),this.PARAMS.ITEMS){this.PARAMS.ITEMS=BX.util.array_values(this.PARAMS.ITEMS);for(var e=!1,i=0,s=0,n=this.PARAMS.ITEMS.length;s<n;s++)(0!=s&&s!=n-1||!this.PARAMS.ITEMS[s].SEPARATOR)&&(i++,e||(e=!!this.PARAMS.ITEMS[s].GLOBAL_ICON),this.addItem(this.PARAMS.ITEMS[s],s));1===i?BX.addClass(this.DIV,"bx-core-popup-menu-single-item"):BX.removeClass(this.DIV,"bx-core-popup-menu-single-item"),e?BX.removeClass(this.DIV,"bx-core-popup-menu-no-icons"):BX.addClass(this.DIV,"bx-core-popup-menu-no-icons")}},BX.CMenu.prototype.addItem=function(t,e){if(this.ITEMS.push(t),t.SEPARATOR)t.NODE=BX.create("DIV",{props:{className:"bx-core-popup-menu-separator"}});else{var i=!!t.MENU&&(BX.type.isArray(t.MENU)&&t.MENU.length>0||t.MENU instanceof BX.CMenu)||!!t.MENU_URL;t.DISABLED&&(t.CLOSE_ON_CLICK=!1,t.LINK=null,t.ONCLICK=null,t.ACTION=null),t.NODE=BX.create(t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?"A":"SPAN",{props:{className:"bx-core-popup-menu-item"+(i?" bx-core-popup-menu-item-opener":"")+(t.DEFAULT?" bx-core-popup-menu-item-default":"")+(t.DISABLED?" bx-core-popup-menu-item-disabled":"")+(t.CHECKED?" bx-core-popup-menu-item-checked":""),title:BX.message.MENU_ENABLE_TOOLTIP?t.TITLE||"":"",BXMENULEVEL:this.PARAMS.LEVEL},attrs:t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?{href:t.LINK||"javascript:void(0)"}:{},events:{mouseover:function(){BX.onCustomEvent("onMenuItemHover",[this.BXMENULEVEL,this.OPENER])}},html:'<span class="bx-core-popup-menu-item-icon'+(t.GLOBAL_ICON?" "+t.GLOBAL_ICON:"")+'"></span><span class="bx-core-popup-menu-item-text">'+t.TEXT+"</span>"}),i&&!t.DISABLED?t.NODE.OPENER=new BX.COpener({DIV:t.NODE,ACTIVE_CLASS:"bx-core-popup-menu-item-opened",TYPE:"hover",MENU:t.MENU,MENU_URL:t.MENU_URL,MENU_PRELOAD:!!t.MENU_PRELOAD,LEVEL:this.PARAMS.LEVEL+1,ATTACH_MODE:"right",TIMEOUT:500}):this.PARAMS.CLOSE_ON_CLICK&&("undefined"==typeof t.CLOSE_ON_CLICK||t.CLOSE_ON_CLICK)?BX.bind(t.NODE,"click",BX.CMenu.broadcastCloseEvent):this.PARAMS.ADJUST_ON_CLICK&&("undefined"==typeof t.ADJUST_ON_CLICK||t.ADJUST_ON_CLICK)&&BX.bind(t.NODE,"click",BX.defer(this.adjustPos,this)),i&&t.LINK&&BX.bind(t.NODE,"dblclick",BX.CMenu._itemDblClick),"undefined"!=typeof t.CHECKED&&BX.bind(t.NODE,"click",BX.CMenu._toggleChecked),t.ONCLICK=t.ACTION||t.ONCLICK,t.ONCLICK&&(BX.type.isString(t.ONCLICK)&&(t.ONCLICK=new Function("event",t.ONCLICK)),BX.bind(t.NODE,"click",t.ONCLICK))}this.DIV.appendChild(t.NODE)},BX.CMenu.prototype._documentClickBind=function(){this._documentClickUnBind(),BX.bind(document,"click",BX.proxy(this._documentClick,this))},BX.CMenu.prototype._documentClickUnBind=function(){BX.unbind(document,"click",BX.proxy(this._documentClick,this))},BX.CMenu.prototype._documentClick=function(t){t=t||window.event,(!t||BX.getEventButton(t)&BX.MSLEFT)&&this.Close()},BX.CMenu.prototype.Show=function(){BX.onCustomEvent(this,"onMenuOpen",[this,this.PARAMS.LEVEL]),BX.CMenu.superclass.Show.apply(this,[]),this.bCloseEventFired=!1,BX.addCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this)),BX.defer(this._documentClickBind,this)()},BX.CMenu.prototype.Close=BX.CMenu.prototype.Hide=function(){this.visible()&&(BX.removeCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this)),this._documentClickUnBind(),this.bCloseEventFired||(BX.onCustomEvent(this,"onMenuClose",[this,this.PARAMS.LEVEL]),this.bCloseEventFired=!0),BX.CMenu.superclass.Hide.apply(this,arguments))},BX.CMenu.prototype.__adjustMenuToNode=function(){var t=BX.pos(this.PARAMS.parent_attach),e=!!BX.findParent(this.PARAMS.parent_attach,BX.is_fixed);if(e?this.DIV.style.position="fixed":this.DIV.style.position="absolute",t.top||(this.DIV.style.top="-1000px",this.DIV.style.left="-1000px"),!this.bTimeoutSet){var i=this.DIV.offsetWidth,s=this.DIV.offsetHeight;if(!i)return setTimeout(BX.delegate(function(){this.bTimeoutSet=!1,this.__adjustMenuToNode()},this),100),void(this.bTimeoutSet=!0);var n={},o=BX.GetWindowSize();switch(this.PARAMS.ATTACH_MODE){case"bottom":if(n.top=t.bottom+9,n.left=t.left,this.ARROW){var a=parseInt(this.ARROW.style.left);a=t.width>i?parseInt(i/2-7):parseInt(Math.min(i,t.width)/2-7),a<7&&(n.left-=15,a+=15)}if(n.left>o.scrollWidth-i-10){var r=n.left;n.left=o.scrollWidth-i-10,this.ARROW&&(a+=r-n.left)}e&&(n.left-=o.scrollLeft),this.ARROW&&(this.ARROW.style.left=a+"px");break;case"right":n.top=t.top-1,n.left=t.right,n.left>o.scrollWidth-i-10&&(n.left=t.left-i-1)}if(e&&(n.top-=o.scrollTop),this.ARROW&&(this.ARROW.className="bx-core-popup-menu-angle"),n.top+s>o.scrollTop+o.innerHeight||n.top+s>o.scrollHeight){var l="bottom"==this.PARAMS.ATTACH_MODE?t.top-s-9:t.bottom-s+1;(l>o.scrollTop||n.top+s>o.scrollHeight)&&(n.top+s>o.scrollHeight?(n.top=Math.max(0,o.scrollHeight-s),this.toggleArrow(!1)):(n.top=l,this.ARROW&&(this.ARROW.className="bx-core-popup-menu-angle-bottom")))}n.top+n.left==0?this.Hide():(this.DIV.style.top=n.top+"px",this.DIV.style.left=n.left+"px")}},BX.CMenu.prototype.adjustToNode=function(t){this.PARAMS.parent_attach=BX(t)||this.PARAMS.parent_attach||this.PARAMS.parent,this.__adjustMenuToNode()},BX.CMenuOpener=function(t){BX.CMenuOpener.superclass.constructor.apply(this),this.PARAMS=t||{},this.setParent(this.PARAMS.parent),this.PARTS={},this.SETTINGS.drag_restrict=!0,this.defaultAction=null,this.timeout=500,this.DIV.className="bx-component-opener",this.DIV.ondblclick=BX.PreventDefault,this.PARAMS.component_id&&(this.PARAMS.transform=!!this.PARAMS.transform),this.OPENERS=[],this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar"+(this.PARAMS.transform?" bx-context-toolbar-vertical-mode":"")}})),this.PARTS.INNER=this.DIV.firstChild.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-inner"},html:'<span class="bx-context-toolbar-drag-icon"></span><span class="bx-context-toolbar-vertical-line"></span><br>'})),this.EXTRA_BUTTONS={};for(var e=0,i=0,s=this.PARAMS.menu.length;i<s;i++){var n=this.addItem(this.PARAMS.menu[i]);null!=n&&(e++,this.PARTS.INNER.appendChild(n),this.PARTS.INNER.appendChild(BX.create("BR")))}var o=e>0;if(this.PARTS.ICONS=this.PARTS.INNER.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-icons"}})),this.PARAMS.component_id&&(this.PARAMS.pin=!!this.PARAMS.pin,o&&this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-separator"}})),this.PARTS.ICON_PIN=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin"},events:{click:BX.delegate(this.__pin_btn_clicked,this)}}))),this.EXTRA_BUTTONS.components2_props){var a=this.EXTRA_BUTTONS.components2_props||{URL:"javascript:void(0)"};null==this.defaultAction&&(this.defaultAction=a.ONCLICK,this.defaultActionTitle=a.TITLE||a.TEXT),a.URL="javascript:"+BX.util.urlencode(a.ONCLICK),this.ATTACH=this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button bx-context-toolbar-button-settings"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"},children:[BX.create("A",{attrs:{href:a.URL},events:{mouseover:BX.proxy(this.__msover_text,this),mouseout:BX.proxy(this.__msout_text,this),mousedown:BX.proxy(this.__msdown_text,this)},html:'<span class="bx-context-toolbar-button-icon bx-context-toolbar-settings-icon"></span>'}),BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-button-arrow"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},html:'<span class="bx-context-toolbar-button-arrow"></span>'})]})]})),this.OPENER=this.ATTACH.firstChild.lastChild;var r=this.attachMenu(this.EXTRA_BUTTONS.components2_submenu.MENU);BX.addCustomEvent(r,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this)),BX.addCustomEvent(r,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(e>1&&(this.PARTS.ICONS.appendChild(BX.create("span",{props:{className:"bx-context-toolbar-separator bx-context-toolbar-separator-switcher"}})),this.ICON_TRANSFORM=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-switcher"},events:{click:BX.delegate(this.__trf_btn_clicked,this)}}))),this.PARAMS.HINT&&(this.DIV.BXHINT=this.HINT=new BX.CHint({parent:this.DIV,hint:this.PARAMS.HINT.TEXT||"",title:this.PARAMS.HINT.TITLE||"",hide_timeout:this.timeout/2,preventHide:!1})),BX.addCustomEvent(this,"onWindowDragFinished",BX.delegate(this.__onMoveFinished,this)),BX.addCustomEvent("onDynamicModeChange",BX.delegate(this.__onDynamicModeChange,this)),BX.addCustomEvent("onTopPanelCollapse",BX.delegate(this.__onPanelCollapse,this)),BX.addCustomEvent("onMenuOpenerMoved",BX.delegate(this.checkPosition,this)),BX.addCustomEvent("onMenuOpenerUnhide",BX.delegate(this.checkPosition,this)),this.OPENERS)for(var i=0,s=this.OPENERS.length;i<s;i++)BX.addCustomEvent(this.OPENERS[i],"onOpenerMenuOpen",BX.proxy(this.__hide_hint,this))},BX.extend(BX.CMenuOpener,BX.CWindowFloat),BX.CMenuOpener.prototype.setParent=function(t){t=BX(t),t.OPENER&&t.OPENER!=this&&(t.OPENER.Close(),t.OPENER.clearHoverHoutEvents()),this.PARAMS.parent&&this.PARAMS.parent!=t&&(this.clearHoverHoutEvents(),this.PARAMS.parent.OPENER=null),this.PARAMS.parent=t,this.PARAMS.parent.OPENER=this},BX.CMenuOpener.prototype.setHoverHoutEvents=function(t,e){this.__opener_events_set||(BX.bind(this.Get(),"mouseover",t),BX.bind(this.Get(),"mouseout",e),this.__opener_events_set=!0)},BX.CMenuOpener.prototype.clearHoverHoutEvents=function(){this.Get()&&(BX.unbindAll(this.Get()),this.__opener_events_set=!1)},BX.CMenuOpener.prototype.unclosable=!0,BX.CMenuOpener.prototype.__check_intersection=function(t,e){return!(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)},BX.CMenuOpener.prototype.__msover_text=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-hover")},BX.CMenuOpener.prototype.__msout_text=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.ATTACH,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")},BX.CMenuOpener.prototype.__msover_arrow=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover")},BX.CMenuOpener.prototype.__msout_arrow=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")},BX.CMenuOpener.prototype.__msdown_text=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-active")},BX.CMenuOpener.prototype.__msdown_arrow=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-active")},BX.CMenuOpener.prototype.__menu_close=function(){this._menu_open=!1,this.bx_active=!1,BX.removeClass(this.ATTACH,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active"),this.bx_hover||(BX.removeClass(this.ATTACH,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover"),this.bx_hover=!1)},BX.CMenuOpener.prototype.__menu_open=function(){this._menu_open=!0},BX.CMenuOpener.prototype.checkPosition=function(){this.isMenuVisible()||"none"==this.DIV.style.display||this==BX.proxy_context||BX.proxy_context.zIndex>this.zIndex||this.correctPosition(BX.proxy_context)},BX.CMenuOpener.prototype.correctPosition=function(t){var e=BX.pos(this.DIV),i=BX.pos(t.Get());if(this.__check_intersection(e,i)){var s=i.top-e.height;s<0&&(s=i.bottom),this.DIV.style.top=s+"px",BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),BX.onCustomEvent(this,"onMenuOpenerMoved")}},BX.CMenuOpener.prototype.restorePosition=function(){this.MOUSEOVER||this.isMenuVisible()?this.restore_pos_timeout=setTimeout(BX.proxy(this.restorePosition,this),this.timeout):(this.originalPos&&(this.DIV.style.top=this.originalPos.top+"px"),BX.removeCustomEvent(BX.proxy_context,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),this.restore_pos_timeout&&clearTimeout(this.restore_pos_timeout))},BX.CMenuOpener.prototype.Show=function(){BX.CMenuOpener.superclass.Show.apply(this,arguments),this.SetDraggable(this.PARTS.INNER.firstChild),this.DIV.style.width="auto",this.DIV.style.height="auto",this.PARAMS.pin?(this.bPosAdjusted=!0,this.bMoved=!0,this.PARAMS.top&&(this.DIV.style.top=this.PARAMS.top+"px"),this.PARAMS.left&&(this.DIV.style.left=this.PARAMS.left+"px"),this.DIV.style.display=!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders?"block":"none","block"==this.DIV.style.display&&setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"onMenuOpenerUnhide")},this),50)):(this.DIV.style.left="-1000px",this.DIV.style.top="-1000px",this.Hide())},BX.CMenuOpener.prototype.executeDefaultAction=function(){this.defaultAction&&(BX.type.isFunction(this.defaultAction)?this.defaultAction():BX.type.isString(this.defaultAction)&&BX.evalGlobal(this.defaultAction))},BX.CMenuOpener.prototype.__onDynamicModeChange=function(t){this.DIV.style.display=t?"block":"none";
},BX.CMenuOpener.prototype.__onPanelCollapse=function(t,e){this.DIV.style.top=parseInt(this.DIV.style.top)+e+"px",this.PARAMS.pin&&this.__savePosition()},BX.CMenuOpener.prototype.__onMoveFinished=function(){BX.onCustomEvent(this,"onMenuOpenerMoved"),this.bMoved=!0,this.PARAMS.pin&&this.__savePosition()},BX.CMenuOpener.prototype.__savePosition=function(){var t={};t.pin=this.PARAMS.pin,this.PARAMS.pin?(t.transform=this.PARAMS.transform,this.bMoved&&(t.left=parseInt(this.DIV.style.left),t.top=parseInt(this.DIV.style.top))):(t.top=!1,t.left=!1,t.transform=!1),BX.WindowManager.saveWindowOptions(this.PARAMS.component_id,t)},BX.CMenuOpener.prototype.__pin_btn_clicked=function(){this.Pin()},BX.CMenuOpener.prototype.Pin=function(t){null==t?this.PARAMS.pin=!this.PARAMS.pin:this.PARAMS.pin=!!t,this.PARTS.ICON_PIN.className=this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin",this.__savePosition()},BX.CMenuOpener.prototype.__trf_btn_clicked=function(){this.Transform()},BX.CMenuOpener.prototype.Transform=function(t){if(null==t?this.PARAMS.transform=!this.PARAMS.transform:this.PARAMS.transform=!!t,this.bMoved)var e=BX.pos(this.DIV);this.PARAMS.transform?BX.addClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode"):BX.removeClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode"),this.bMoved?this.DIV.style.left=e.right-this.DIV.offsetWidth-(BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0)+"px":this.adjustPos(),this.__savePosition()},BX.CMenuOpener.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent),e=BX.GetWindowScrollSize(),i=this.DIV.offsetWidth;return t.left-=BX.admin.__border_dx,t.top-=BX.admin.__border_dx,t.top-=45,t.left>e.scrollWidth-i&&(t.left=e.scrollWidth-i),t},BX.CMenuOpener.prototype.addItem=function(t){if(t.TYPE)return this.EXTRA_BUTTONS[t.TYPE]=t,null;var e=new BX.CMenuOpenerItem(t);return null==this.defaultAction&&(e.item.ONCLICK?this.defaultAction=t.ONCLICK:e.item.MENU&&(this.defaultAction=BX.delegate(function(){this.Open()},e.item.OPENER)),this.defaultActionTitle=t.TITLE||t.TEXT,BX.addClass(e.Get(),"bx-content-toolbar-default")),e.item.OPENER&&(this.OPENERS[this.OPENERS.length]=e.item.OPENER),e.Get()},BX.CMenuOpener.prototype.attachMenu=function(t){var e=new BX.COpener({DIV:this.OPENER,ATTACH:this.ATTACH,MENU:t,TYPE:"click"});return this.OPENERS[this.OPENERS.length]=e,e},BX.CMenuOpener.prototype.__hide_hint=function(){this.HINT&&this.HINT.__hide_immediately()},BX.CMenuOpener.prototype.isMenuVisible=function(){for(var t=0,e=this.OPENERS.length;t<e;t++)if(this.OPENERS[t].isMenuVisible())return!0;return!1},BX.CMenuOpener.prototype.Hide=function(){this.PARAMS.pin||(this.DIV.style.display="none",BX.onCustomEvent(this,"onMenuOpenerHide"))},BX.CMenuOpener.prototype.UnHide=function(){this.DIV.style.display="block",this.bPosAdjusted||this.PARAMS.pin||(this.adjustPos(),this.bPosAdjusted=!0),null!=this.originalPos||this.bMoved||(this.originalPos=BX.pos(this.DIV)),BX.onCustomEvent(this,"onMenuOpenerUnhide")},BX.CMenuOpenerItem=function(t){this.item=t,this.item.ACTION&&!this.item.ONCLICK&&(this.item.ONCLICK=this.item.ACTION),this.DIV=BX.create("SPAN"),this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-underlay"}})),this.WRAPPER=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-wrapper"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button",title:t.TITLE},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"}})]})]}));var e=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-icon"+(this.item.ICON||this.item.ICONCLASS?" "+(this.item.ICON||this.item.ICONCLASS):"")},attrs:this.item.ICON||this.item.ICONCLASS||!this.item.SRC&&!this.item.IMAGE?{}:{style:"background: scroll transparent url("+(this.item.SRC||this.item.IMAGE)+") no-repeat center center !important;"}}),i=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-text"},text:this.item.TEXT});this.item.ACTION&&!this.item.ONCLICK&&(this.item.ONCLICK=this.item.ACTION),this.bHasMenu=!!this.item.MENU,this.bHasAction=!!this.item.ONCLICK,this.bHasAction?(this.LINK=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:this.bHasMenu?BX.proxy(this.__msover_text,this):BX.proxy(this.__msover,this),mouseout:this.bHasMenu?BX.proxy(this.__msout_text,this):BX.proxy(this.__msout,this),mousedown:this.bHasMenu?BX.proxy(this.__msdown_text,this):BX.proxy(this.__msdown,this)},children:[e,i]})),this.bHasMenu&&(this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{props:{className:"bx-context-toolbar-button-arrow"},attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-arrow"}})]})))):this.bHasMenu&&(this.item.ONCLICK=null,this.LINK=this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover,this),mouseout:BX.proxy(this.__msout,this),mousedown:BX.proxy(this.__msdown,this)},children:[e,i]})),this.LINK.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-single-button-arrow"}}))),this.bHasMenu&&(this.item.SUBMENU=new BX.CMenu({ATTACH_MODE:"bottom",ITEMS:this.item.MENU,parent:this.LINK_MENU,parent_attach:this.WRAPPER.firstChild}),this.item.OPENER=new BX.COpener({DIV:this.LINK_MENU,TYPE:"click",MENU:this.item.SUBMENU}),BX.addCustomEvent(this.item.OPENER,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this)),BX.addCustomEvent(this.item.OPENER,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))),this.bHasAction&&BX.bind(this.LINK,"click",BX.delegate(this.__click,this))},BX.CMenuOpenerItem.prototype.Get=function(){return this.DIV},BX.CMenuOpenerItem.prototype.__msover=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover")},BX.CMenuOpenerItem.prototype.__msout=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-active")},BX.CMenuOpenerItem.prototype.__msover_text=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover")},BX.CMenuOpenerItem.prototype.__msout_text=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")},BX.CMenuOpenerItem.prototype.__msover_arrow=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover")},BX.CMenuOpenerItem.prototype.__msout_arrow=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")},BX.CMenuOpenerItem.prototype.__msdown=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active")},BX.CMenuOpenerItem.prototype.__msdown_text=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-active")},BX.CMenuOpenerItem.prototype.__msdown_arrow=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-active")},BX.CMenuOpenerItem.prototype.__menu_close=function(){this._menu_open=!1,this.bx_active=!1,BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active"),this.bx_hover||(BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover"),this.bx_hover=!1)},BX.CMenuOpenerItem.prototype.__menu_open=function(){this._menu_open=!0},BX.CMenuOpenerItem.prototype.__click=function(){BX.evalGlobal(this.item.ONCLICK)},BX.CPageOpener=function(t){BX.CPageOpener.superclass.constructor.apply(this,arguments),this.timeout=505,window.PAGE_EDIT_CONTROL=this},BX.extend(BX.CPageOpener,BX.CMenuOpener),BX.CPageOpener.prototype.checkPosition=function(){this!=BX.proxy_context&&this.correctPosition(BX.proxy_context)},BX.CPageOpener.prototype.correctPosition=function(t){if(!this.bPosCorrected){if("none"==this.DIV.style.display){var e=this.adjustToNodeGetPos();e.bottom=e.top+30,e.right=e.left+300}else var e=BX.pos(this.DIV);var i=BX.pos(t.Get());this.__check_intersection(e,i)&&(this.DIV.style.display="none",BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),this.bPosCorrected=!0)}},BX.CPageOpener.prototype.restorePosition=function(){BX.proxy_context&&"none"==BX.proxy_context.Get().style.display&&(this.bPosCorrected=!1,(this.PARAMS.parent.bx_over||this.PARAMS.pin)&&this.UnHide(),BX.removeCustomEvent("onMenuOpenerHide",BX.proxy(this.restorePosition,this)))},BX.CPageOpener.prototype.UnHide=function(){this.bPosCorrected||BX.CPageOpener.superclass.UnHide.apply(this,arguments)},BX.CPageOpener.prototype.Remove=function(){BX.admin.removeComponentBorder(this.PARAMS.parent),BX.userOptions.save("global","settings","page_edit_control_enable","N"),this.DIV.style.display="none"},BX.CHintSimple=function(){BX.CHintSimple.superclass.constructor.apply(this,arguments)},BX.extend(BX.CHintSimple,BX.CHint),BX.CHintSimple.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-tooltip-simple"},style:{display:"none"},children:[this.CONTENT=BX.create("DIV")]})),this.HINT_TITLE&&this.CONTENT.appendChild(BX.create("B",{text:this.HINT_TITLE})),this.HINT&&(this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV")).appendChild(BX.create("SPAN",{html:this.HINT}))),this.PARAMS.preventHide&&(BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this)),BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))),this.bInited=!0},BX.adminInformer={itemsShow:3,Init:function(t){t&&(BX.adminInformer.itemsShow=t);var e=BX("admin-informer");e&&document.body.appendChild(e),BX.addCustomEvent("onTopPanelCollapse",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},Toggle:function(t){var e=BX("admin-informer");if(!e)return!1;var i=BX.pos(t);return e.style.top=parseInt(i.top)+parseInt(i.height)+7+"px",e.style.left=i.left+"px",BX.hasClass(e,"adm-informer-active")?BX.adminInformer.Hide(e):BX.adminInformer.Show(e),!1},Close:function(t){BX.adminInformer.Hide(BX("admin-informer"))},OnInnerClick:function(t){var e=t.target||t.srcElement;if("a"!=e.nodeName.toLowerCase()||BX.hasClass(e,"adm-informer-footer")){var i=BX.PreventDefault(t);return i}return!0},ToggleExtra:function(){var t=BX("adm-informer-footer");return BX.hasClass(t,"adm-informer-footer-collapsed")?this.ShowAll():this.HideExtra(),!1},ShowAll:function(){for(var t=BX("admin-informer"),e=0;e<t.children.length;e++)BX.hasClass(t.children[e],"adm-informer-item")&&"none"==t.children[e].style.display&&(t.children[e].style.display="block");var i=BX("adm-informer-footer");return void 0!==i.textContent?i.textContent=BX.message("JSADM_AI_HIDE_EXTRA"):i.innerText=BX.message("JSADM_AI_HIDE_EXTRA"),BX.removeClass(i,"adm-informer-footer-collapsed"),!1},HideExtra:function(){for(var t=BX("admin-informer"),e=0,i=BX.adminInformer.itemsShow+1;i<t.children.length;i++)BX.hasClass(t.children[i],"adm-informer-item")&&"block"==t.children[i].style.display&&(t.children[i].style.display="none",e++);var s=BX("adm-informer-footer"),n=BX.message("JSADM_AI_ALL_NOTIF")+" ("+(BX.adminInformer.itemsShow+parseInt(e))+")";return void 0!==s.textContent?s.textContent=n:s.innerText=n,BX.addClass(s,"adm-informer-footer-collapsed"),!1},Show:function(t){var e=BX("adm-header-notif-block");e&&BX.addClass(e,"adm-header-notif-block-active"),BX.onCustomEvent(t,"onBeforeAdminInformerShow"),setTimeout(BX.proxy(function(){BX.bind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},BX.adminInformer),0),BX.addClass(t,"adm-informer-active"),setTimeout(function(){BX.addClass(t,"adm-informer-animate")},0)},Hide:function(t){var e=BX("adm-header-notif-block");e&&BX.removeClass(e,"adm-header-notif-block-active");BX.unbind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer)),BX.removeClass(t,"adm-informer-animate"),this.IsAnimationSupported()?setTimeout(function(){BX.removeClass(t,"adm-informer-active")},300):BX.removeClass(t,"adm-informer-active"),BX.onCustomEvent(t,"onAdminInformerHide")},IsAnimationSupported:function(){var t=document.body||document.documentElement;return"string"==typeof t.style.transition||("string"==typeof t.style.MozTransition||("string"==typeof t.style.OTransition||("string"==typeof t.style.WebkitTransition||"string"==typeof t.style.msTransition)))},SetItemHtml:function(t,e){var i=BX("adm-informer-item-html-"+t);return!!i&&(i.innerHTML=e,!0)},SetItemFooter:function(t,e){var i=BX("adm-informer-item-footer-"+t);return!!i&&(i.innerHTML=e,e?i.style.display="block":i.style.display="none",!0)}})}(window),BXSticker.prototype={Init:function(t){this.oMarkerConfig={attr:{title:!0,src:!0,href:!0,alt:!0,"class":!0,className:!0,id:!0,name:!0,type:!0,value:!0},impAttr:{src:!0,id:!0,name:!0,href:!0}},this.Params.changeColorEffect=!0,this.arStickers=[],this.posReg={},this.bInited=!0,this.access=this.Params.access,this._arSavedStickers={},BX.bind(document,"mousedown",BX.proxy(this.OnMousedown,this));var e=this;BX.addCustomEvent("onMenuOpen",function(){var t=BX.findChild(BX("bxst-show-sticker-icon"),{className:"icon"},!0);t&&(e.bShowStickers?BX.addClass(t,"checked"):BX.removeClass(t,"checked")),e.UpdateStickersCount()}),this.DisplayStickers(!!t.bVisEffects),this.ShowEditor({ind:-1})},ShowAll:function(t,e){"undefined"==typeof t&&(t=!this.bShowStickers);var i=this,s=BX.findChild(BX("bxst-show-sticker-icon"),{className:"icon"},!0);if(s&&(t?BX.addClass(s,"checked"):BX.removeClass(s,"checked")),this.bShowStickers=t,window.__bxst_result.show=null,window.__bxst_result.stickers=null,this.Request(t?"show_stickers":"hide_stickers",{pageUrl:this.Params.pageUrl,b_inited:this.bInited?"Y":"N"},function(t){i.bInited||(i.bShowStickers=window.__bxst_result.show,window.__bxst_result.stickers&&(i.Stickers=window.__bxst_result.stickers,i.Params.bVisEffects=!0,i.bInited||i.Init(i.Params),e&&i.AddSticker()))}),t){if(t&&this.bInited)for(var n,o=0,a=this.arStickers.length;o<a;o++)n=this.arStickers[o],n.pWin.Get().style.display="block",n.pShadow.style.display="block",n.pMarker&&(n.pMarker.style.display="")}else this.HideAll()},HideAll:function(){for(var t,e=0,i=this.arStickers.length;e<i;e++)t=this.arStickers[e],t.pWin.Get().style.display="none",t.pShadow.style.display="none",t.pMarker&&(t.pMarker.style.display="none")},AddSticker:function(t,e,i){if(!this.bInited)return this.ShowAll(!0,!0);if(!this.bShowStickers&&this.bInited&&this.ShowAll(!0,!1),this.curEditorStickerInd!==!1){var s=this;return this.SaveAndCloseEditor(this.curEditorStickerInd,!0,!0),setTimeout(function(){s.AddSticker(t,e,i)},300)}var n;n=t?this.ConvertStickerObj(t):{bNew:!0,personal:!1,colorInd:parseInt(this.Params.start_color),width:parseInt(this.Params.start_width),height:parseInt(this.Params.start_height),collapsed:!1,completed:!1,info:"&nbsp;"};var o=this.CreateWindow(n,!!e,i);n.bNew&&this.SetMarker(o,"area")},CreateWindow:function(t,e,i){var s=new BX.CWindow((!1),"float");s.Show(!0),s.Get().style.zIndex=s.zIndex=this.Params.zIndex,s.SETTINGS.min_width=this.Params.min_width,s.SETTINGS.min_height=this.Params.min_height,BX.addClass(s.Get(),"bx-sticker"),s.DenyClose();var n,o="R"==this.access,a=!!t.bNew,r=this,l=this.arStickers.length,d=s.Get().appendChild(BX.create("DIV",{props:{className:"bxst-header",id:"bxst_head_"+l}})),h=d.appendChild(BX.create("DIV",{props:{className:"bxst-id-cont bxst-title"},html:t.id>0?'<a href="'+this.Params.pageUrl+"?show_sticker="+t.id+'"><span>'+t.id+"</span></a>":""})),c=d.appendChild(BX.create("DIV",{props:{className:"bxst-check-cont"}})),p=c.appendChild(BX.create("INPUT",{props:{id:"bxst_conplited_"+l,name:"bxst_conplited_"+l,type:"checkbox",value:"Y",title:this.MESS.Complete}})),u=(c.appendChild(BX.create("LABEL",{attrs:{"for":"bxst_conplited_"+l,title:this.MESS.Complete},text:this.MESS.CompleteLabel})),d.appendChild(BX.create("DIV",{props:{id:"bxst_col_title_"+l,className:"bxst-col-title-cont",title:this.MESS.UnCollapseTitle}}))),m=d.appendChild(BX.create("DIV",{props:{className:"bxst-close bxst-but",title:this.MESS.Close}})).appendChild(BX.create("IMG",{props:{id:"bxst_close_"+l,src:this.oneGifSrc,className:"bxst-sprite"}})),f=d.appendChild(BX.create("DIV",{props:{className:"bxst-collapse bxst-but"}})).appendChild(BX.create("IMG",{props:{id:"bxst_collapse_"+l,src:this.oneGifSrc,className:"bxst-sprite",title:this.MESS.Collapse}}));(a||this.Params.curUserId==t.authorId)&&(n=d.appendChild(BX.create("DIV",{props:{id:"bxst_type_"+l,className:"bxst-type-cont"}})),n.appendChild(BX.create("DIV",{props:{className:"bxst-type-l bxst-type-corn"}})),n.appendChild(BX.create("DIV",{props:{className:"bxst-type-c bxst-type-c-publ"}})).appendChild(BX.create("SPAN",{props:{},text:this.MESS.Public})),n.appendChild(BX.create("DIV",{props:{className:"bxst-type-c  bxst-type-c-pers"}})).appendChild(BX.create("SPAN",{props:{},text:this.MESS.Personal})),n.appendChild(BX.create("DIV",{props:{className:"bxst-type-r bxst-type-corn"}})),o||(n.onclick=function(){s.__stWasDragged||r.SetType(parseInt(this.id.substr("bxst_type_".length)),!0)}),this.SetUnselectable([n]));var _=s.Get().appendChild(BX.create("DIV",{props:{id:"bxst_body_"+l,className:"bxst-content"}})),b=_.appendChild(BX.create("DIV",{props:{id:"bxst_content_"+l,className:"bxst-content-area"}})),v=s.Get().appendChild(BX.create("DIV",{props:{className:"bxst-footer"}})),y=v.appendChild(BX.create("DIV",{props:{className:"bxst-marker-area-but"}})).appendChild(BX.create("IMG",{props:{id:"bxst_marker_but0_"+l,src:this.oneGifSrc,className:"bxst-sprite",title:this.MESS.SetMarkerArea}})),B=v.appendChild(BX.create("DIV",{props:{className:"bxst-marker-elem-but"}})).appendChild(BX.create("IMG",{props:{id:"bxst_marker_but1_"+l,src:this.oneGifSrc,className:"bxst-sprite",title:this.MESS.SetMarkerEl}})),g=v.appendChild(BX.create("DIV",{props:{className:"bxst-ctrl-txt bxst-color-but"}})).appendChild(BX.create("SPAN",{props:{id:"bxst_color_"+l},text:this.MESS.Color})),S=v.appendChild(BX.create("DIV",{props:{className:"bxst-ctrl-txt bxst-add-but"}})).appendChild(BX.create("SPAN",{props:{id:"bxst_add_but_"+l},text:this.MESS.Add})),x=v.appendChild(BX.create("DIV",{props:{className:"bxst-resizer"}})).appendChild(BX.create("IMG",{props:{src:this.oneGifSrc,className:"bxst-sprite"}})),X=v.appendChild(BX.create("DIV",{props:{className:"bxst-info-icon"}})).appendChild(BX.create("IMG",{props:{id:"bxst_info_"+l,src:this.oneGifSrc,className:"bxst-sprite"},style:{display:a?"none":"block"}})),C=new BX.CHintSimple({parent:X,hint:t.info});o&&BX.addClass(s.Get(),"bx-sticker-readonly");var w=BX.GetWindowInnerSize(),E=BX.GetWindowScrollPos();if((a||t.left<=0||t.top<=0)&&(t.left=s.Get().style.left=parseInt(E.scrollLeft+w.innerWidth/2-parseInt(s.Get().offsetWidth)/2)+Math.round(t.width/2),t.top=Math.max(parseInt(E.scrollTop+w.innerHeight/2-parseInt(s.Get().offsetHeight)/2),0)-Math.round(t.height/2)),s.StickerInd=l,a&&(S.style.display="none"),pShadow=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-shadow"},style:{zIndex:parseInt(s.Get().style.zIndex)-5}})),this.RegisterSticker({obj:t,pWin:s,pCheck:p,pCloseBut:m,pCollapseBut:f,pCollapsedTitle:u,pBody:_,pHead:d,pTypeCont:n||!1,pContentArea:b,pIdsCont:h,pShadow:pShadow,bButPanelShowed:!0,pMarkerAreaBut:y,pMarkerElementBut:B,pColorBut:g,pAddBut:S,pInfo:X,pHint:C,_over:!a&&!i,bButPanelShowed:!a&&!i}),this.AdjustToSize(l,t.width,t.height),this.SetColorScheme(l,t.colorInd,!1),this.SetType(l,!1,t.personal?"personal":"public"),this.SetCompleted(l,t.completed,!1),this.CollapseSticker(l,!1,t.collapsed),s.SetDraggable(d),BX.addCustomEvent(s,"onWindowDragStart",function(){this.__stWasDragged=!0}),BX.addCustomEvent(s,"onWindowDragFinished",function(){r.OnDragEnd(this)}),BX.addCustomEvent(s,"onWindowDrag",function(){r.OnDragDrop(this)}),s.SetResize(x),BX.addCustomEvent(s,"onWindowResize",function(){r.AdjustToSize(this.StickerInd)}),BX.addCustomEvent(s,"onWindowResizeStart",function(){r.OnResizeStart(this)}),BX.addCustomEvent(s,"onWindowResizeFinished",function(){r.OnResizeEnd(this)}),d.ondblclick=function(){r.CollapseSticker(parseInt(this.id.substr("bxst_head_".length)),!0)},f.onclick=function(){s.__stWasDragged||r.CollapseSticker(parseInt(this.id.substr("bxst_collapse_".length)),!0)},o?p.disabled=!0:(m.onclick=function(){s.__stWasDragged||r.CloseSticker(parseInt(this.id.substr("bxst_close_".length)),!0)},S.onclick=function(){r.AddToSticker(parseInt(this.id.substr("bxst_add_but_".length)))},p.onclick=function(){s.__stWasDragged||r.SetCompleted(parseInt(this.id.substr("bxst_conplited_".length)),!!this.checked,!0)},g.onclick=function(){r.ShowColorSelector(parseInt(this.id.substr("bxst_color_".length)))},y.onclick=function(){r.SetMarker(parseInt(this.id.substr("bxst_marker_but0_".length)),"area")},B.onclick=function(){r.SetMarker(parseInt(this.id.substr("bxst_marker_but1_".length)),"element")}),a||i||t.collapsed||(s.Get().style.height=t.height-24+"px"),a){var I=this.GetSuitablePosition(t.left,t.top);I!==!0&&(t.left=I.left,t.top=I.top)}else h.style.display="block";return this.RegisterPosition(t.left,t.top),s.Get().style.left=t.left+"px",s.Get().style.top=t.top+"px",this.SupaFlySticker(l),this.AdjustShadow(l),this.SetUnselectable([m,f,g,y,y,x]),a||i===!0?(this.ShowEditor({ind:l}),i&&(this.OnDivMouseOver(l,!0),this.DisplayMarker(l))):(_.style.overflow="auto",b.innerHTML=t.html_content,this.DisplayMarker(l),t.id==this.Params.focusOnSticker&&(window.scrollTo(0,t.top>200?t.top-200:0),this.Hightlight(l,!0),this.BlinkRed(l))),o||(_.onclick=function(){if(this.id){var t=parseInt(this.id.substr("bxst_body_".length));r.curEditorStickerInd!==t&&r.ShowEditor({ind:t})}}),s.Get().onmouseover=function(){r.OnDivMouseOver(l,!0)},s.Get().onmouseout=function(){r.OnDivMouseOver(l,!1)},l},UpdateNewSticker:function(t){var e=this.arStickers[t];e.pAddBut.style.display="block",e.pInfo.style.display="block",e.pIdsCont.style.display="block",e.pIdsCont.innerHTML='<a href="'+this.Params.pageUrl+"?show_sticker="+e.obj.id+'"><span>'+e.obj.id+"</span></a>",t===this.curEditorStickerInd&&"object"==typeof window.oLHESticker&&(setTimeout(function(){oLHESticker.SetFocusToEnd()},100),setTimeout(function(){oLHESticker.SetFocusToEnd()},500))},RegisterPosition:function(t,e){var i=20,s=Math.round(t/i)*i,n=Math.round(e/i)*i;this.posReg[s+"_"+n]=!0},GetSuitablePosition:function(t,e,i){var s=20,n=Math.round(t/s)*s,o=Math.round(e/s)*s;return this.posReg[n+"_"+o]?this.GetSuitablePosition(t+s,e+s,!0):!i||{left:t,top:e}},RegisterSticker:function(t){return this.arStickers.push(t),this.arStickers.length-1},AdjustToSize:function(t,e,i){var s,n=this.arStickers[t];"undefined"==typeof e||"undefined"==typeof i?(e=parseInt(n.pWin.Get().style.width),i=parseInt(n.pWin.Get().style.height)):(n.pWin.Get().style.width=e+"px",n.pWin.Get().style.height=i+"px"),s=BX.browser.IsIE()&&!BX.browser.IsDoctype()?i-19-27-0:i-19-24-0,window.oLHESticker&&(window.oLHESticker.pFrame.style.width=e-2+"px",window.oLHESticker.pFrame.style.height=s-2+"px",window.oLHESticker.ResizeFrame(s-2)),n.pCollapsedTitle.style.width=e-100+"px",n.pBody.style.height=s+"px",this.AdjustShadow(t)},AdjustShadow:function(t){var e=this.arStickers[t];return e.obj.closed&&e.pShadow.parentNode?e.pShadow.parentNode.removeChild(e.pShadow):(e.pShadow.style.top=parseInt(e.pWin.Get().style.top)+4+"px",e.pShadow.style.left=parseInt(e.pWin.Get().style.left)+3+"px",e.pShadow.style.width=e.pWin.Get().style.width,void(e.pShadow.style.height=e.pWin.Get().style.height))},AdjustEditorSizeAndPos:function(t){var e=this.arStickers[t];this.pEditorCont.style.top=parseInt(e.pWin.Get().style.top)+20+"px",this.pEditorCont.style.left=e.pWin.Get().style.left,this.pEditorCont.style.width=e.pWin.Get().style.width,this.pEditorCont.style.height=e.pBody.style.height,this.pEditorCont.style.zIndex=parseInt(e.pWin.Get().style.zIndex)+10},AdjustHintToCursor:function(t,e){t.style.left=e.realX+30+"px",t.style.top=e.realY-12+"px"},AdjustScrollPosToCursor:function(){},AdjustStickerToArea:function(t){var e,i,s=BX.GetWindowInnerSize(document),n=BX.GetWindowScrollPos(document),o=this.arStickers[t],a=o.obj.marker&&o.obj.marker.adjust?0:10;o.pMarker&&o.obj.marker&&(e=o.obj.marker.left+o.obj.marker.width-60,i=o.obj.marker.top-o.obj.height+a,e+o.obj.width>s.innerWidth&&(e=s.innerWidth-o.obj.width-30),i<n.scrollTop+50&&(i=o.obj.marker.top+o.obj.marker.height-a)),this.MoveToPos(t,{left:e,top:i}),o.obj.top=i,o.obj.left=e,this.arStickers[t].obj.id&&this.SaveSticker(t)},MoveToPos:function(t,e){var i=this.arStickers[t],s=parseInt(i.obj.top),n=parseInt(i.obj.left),o=parseInt(e.top),a=parseInt(e.left),r=parseInt(s),l=parseInt(n),d=this,h=0,c=s>o,p=n>a,u=(BX.browser.IsIE(),10),m=(BX.browser.IsIE(),10,Math.ceil(Math.abs((n-a)/50))),f=Math.ceil(Math.abs((s-o)/50)),_=p?-m:m,b=c?-f:f,v=function(e,s){e!==!1&&(i.pWin.Get().style.top=e+"px"),s!==!1&&(i.pWin.Get().style.left=s+"px"),d.AdjustShadow(t)},y=setInterval(function(){return o!=r&&r!==!1&&(r+=Math.round(b*h/2)),a!=l&&l!==!1&&(l+=Math.round(_*h/2)),r!==!1&&(!c&&r>=o||c&&r<=o)&&(r=o),l!==!1&&(!p&&l>=a||p&&l<=a)&&(l=a),v(r,l),r==o&&(r=!1),l==a&&(l=!1),r===!1&&l===!1?(clearInterval(y),d.OnDragEnd(i.pWin)):void h++},u)},ChangeColor:function(t,e,i,s){this.arStickers[t];return this.Params.changeColorEffect||(i=!1),i&&s===!0?(this.Params.start_color=e,this.ShowColorOverlay(t,e,!0)):(i&&s===!1||!i)&&(this.SetColorScheme(t,e,!0),i)?this.ShowColorOverlay(t,e,!1):void 0},SetColorScheme:function(t,e,i){t===this.curEditorStickerInd&&"object"==typeof window.oLHESticker&&window.oLHESticker.pEditorDocument&&window.oLHESticker.pEditorDocument.body&&(window.oLHESticker.pEditorDocument.body.className=this.colorSchemes[e].name),this.arStickers[t].obj.colorInd=e;for(var s=0,n=this.colorSchemes.length;s<n;s++)s==e?BX.addClass(this.arStickers[t].pWin.Get(),this.colorSchemes[s].name):BX.removeClass(this.arStickers[t].pWin.Get(),this.colorSchemes[s].name);if(this.arStickers[t].pMarker&&(this.arStickers[t].pMarker.className="bxst-sticker-marker "+this.colorSchemes[e].name),i&&this.arStickers[t].obj.id>0){var o=this;this.arStickers[t]._colTimeout&&(clearTimeout(this.arStickers[t]._colTimeout),this.arStickers[t]._colTimeout=null),o.SaveSticker(t)}},SetType:function(t,e,i){var s=this.arStickers[t],n="undefined"==typeof i?!s.obj.personal:"personal"==i;s.pTypeCont&&(n?(BX.addClass(s.pTypeCont,"bxst-type-pers"),BX.removeClass(s.pTypeCont,"bxst-type-publ"),s.pTypeCont.title=this.MESS.PersonalTitle):(BX.addClass(s.pTypeCont,"bxst-type-publ"),BX.removeClass(s.pTypeCont,"bxst-type-pers"),s.pTypeCont.title=this.MESS.PublicTitle),s.obj.personal=n,s.obj.id&&e&&this.SaveSticker(t))},SetCompleted:function(t,e,i){this.arStickers[t].obj.completed=e,this.arStickers[t].pCheck.checked=e,this.arStickers[t].obj.id&&i&&this.SaveSticker(t)},CloseSticker:function(t,e,i){var s=this.arStickers[t];if(!e||!s.obj.authorName||this.Params.curUserId==s.obj.authorId||confirm(this.MESS.CloseConfirm.replace("#USER_NAME#",s.obj.authorName))){s.obj.closed=!s.obj.closed,t===this.curEditorStickerInd&&(this.curEditorStickerInd=!1),this.arStickers[t].pWin.Close(!0),this.arStickers[t].pWin.onUnRegister(!0),s.pMarkerNode&&BX.removeClass(s.pMarkerNode,"bxst-sicked"),s.pMarker&&s.pMarker.parentNode&&s.pMarker.parentNode.removeChild(s.pMarker),this.AdjustShadow(t),this.arStickers[t].obj.id&&e&&(this.SaveSticker(t),BX.admin.panel.Notify(this.MESS.CloseNotify.replace(/(.*?)#LINK#(.*?)#LINK#/gi,'$1<span class="bxst-close-notify-link" onclick="window.oBXSticker.ShowList(\'current\'); return false;">$2</span>')));var n=document.body.getElementsByTagName("A");n&&n[0]&&BX.focus(n[0])}},CollapseSticker:function(t,e,i){var s=this.arStickers[t];"undefined"==typeof i&&(i=!s.obj.collapsed),e&&this.curEditorStickerInd===t&&this.SaveAndCloseEditor(t,!0,!1),i?(BX.addClass(s.pWin.Get(),"bxst-collapsed"),s.pCollapseBut.title=this.MESS.UnCollapse,s.pWin.Get().style.height="19px",s.pCollapsedTitle.innerHTML=this.GetCollapsedContent(s.obj.html_content)):(BX.removeClass(s.pWin.Get(),"bxst-collapsed"),s.pCollapseBut.title=this.MESS.Collapse,s.pWin.Get().style.height=parseInt(s.obj.height)+"px"),this.AdjustShadow(t),s.obj.collapsed=i,s.obj.id&&e&&this.SaveSticker(t)},OnDragEnd:function(t){setTimeout(function(){t.__stWasDragged=!1},200);var e=t.StickerInd;this.arStickers[e].obj.top=parseInt(t.Get().style.top),this.arStickers[e].obj.left=parseInt(t.Get().style.left),this.SaveSticker(e)},OnDragDrop:function(t){this.AdjustShadow(t.StickerInd)},OnResizeEnd:function(t){var e=t.StickerInd;this.arStickers[e].bResizingNow=!1,this.arStickers[e].obj.width=parseInt(t.Get().style.width),this.arStickers[e].obj.height=parseInt(t.Get().style.height),this.arStickers[e].obj.id&&this.SaveSticker(e)},OnResizeStart:function(t){this.arStickers[t.StickerInd].bResizingNow=!0},ShowEditor:function(t){var e=t.ind===-1,i=this,s=this.arStickers[t.ind];if(this.pEditorCont||(this.pEditorCont=(e?document.body:s.pBody).appendChild(BX.create("DIV",{props:{className:"bxst-lhe-cont"}}))),this.pEditorCont.style.visibility="hidden",window.oLHESticker)this.bLoadLHEEditor&&(this.PrepareEditorAfterLoading(),this.bLoadLHEEditor=!1),e||this.DisplayEditor(s,t.ind);else if(this.bLoadLHEEditor){if(i.bLoadLHEEditor&&!window.oLHESticker)return setTimeout(function(){i.ShowEditor(t)},50)}else this.Request("load_lhe",{},function(e){i.pEditorCont.innerHTML=e;var s=setInterval(function(){if("undefined"!=typeof window.LoadLHE_LHEBxStickers)return clearInterval(s),i.bLoadLHEEditor||window.oLHESticker||LoadLHE_LHEBxStickers(),setTimeout(function(){i.bLoadLHEEditor=!0,i.ShowEditor(t)},50)},50)})},PrepareEditorAfterLoading:function(){oLHESticker&&(oLHESticker.oSpecialParsers.st_title={Parse:function(t,e,i){return e=e.replace(/\[ST_TITLE\]((?:\s|\S)*?)\[\/ST_TITLE\]/gi,'<span id="'+i.SetBxTag(!1,{tag:"st_title"})+'" class="bxst-title" >$1</span>')},UnParse:function(t,e,s){var n="[ST_TITLE]";for(i=0;i<e.arNodes.length;i++)n+=s._RecursiveGetHTML(e.arNodes[i]);return n+="[/ST_TITLE]"}},BX.addCustomEvent(oLHESticker,"OnUnParseContentAfter",function(){this.__sContent=this.__sContent.replace(/\[\/ST_TITLE\](?:\n|\r)+/gi,"[/ST_TITLE]\n")}))},DisplayEditor:function(t,e,i){var s=this;if(i)setTimeout(function(){t.pBody.style.overflow="auto",s.pEditorCont.style.visibility="visible",t.pContentArea.style.display="none",s.pEditorCont.style.display="block",setTimeout(function(){oLHESticker.SetFocusToEnd()},100)},100);else{t.pBody.appendChild(this.pEditorCont),this.AdjustToSize(e),oLHESticker.SetContent(t.obj.content||this.GetNewStickerContent()+"\n"),oLHESticker.CreateFrame(),oLHESticker.SetEditorContent(oLHESticker.content),window.oLHESticker.pEditorDocument.body.className=this.colorSchemes[t.obj.colorInd].name,this.Params.useHotkeys&&BX.bind(window.oLHESticker.pEditorDocument,"keyup",BX.proxy(this.OnKeyUp,this)),setTimeout(function(){try{window.oLHESticker.pEditorDocument.execCommand("styleWithCSS",!1,!1)}catch(t){}},100),setTimeout(function(){try{window.oLHESticker.pEditorDocument.execCommand("styleWithCSS",!1,!1)}catch(t){}},500),setTimeout(function(){try{window.oLHESticker.pEditorDocument.execCommand("styleWithCSS",!1,!1)}catch(t){}},1e3),this.curEditorStickerInd=e,t.pBody.style.overflow="hidden";var n=0,o=1,a=22,r=setInterval(function(){n>=a?n=a:n+=o,t.pContentArea.style.top=n+"px",n==a&&(clearInterval(r),s.DisplayEditor(t,e,!0))},BX.browser.IsIE()?5:10)}},AddToSticker:function(t){var e=this.arStickers[t];this.curEditorStickerInd===t&&window.oLHESticker?(oLHESticker.SetFocusToEnd(),
oLHESticker.InsertHTML("<br />"+oLHESticker.ParseContent(this.GetNewStickerContent())+"<br />"),setTimeout(function(){oLHESticker.SetFocusToEnd()},100)):(e.obj.content+="\n"+this.GetNewStickerContent(),this.ShowEditor({ind:t}))},Request:function(t,e,i,s){s=s===!0,s&&BX.showWait();var n="/bitrix/admin/fileman_stickers.php?sticker_action="+t+"&"+this.sessid_get+"&site_id="+this.Params.site_id;return BX.ajax.post(n,e||{},function(t){s&&BX.closeWait(),i&&setTimeout(function(){i(t)},10)})},SetUnselectable:function(t){"object"!=typeof t&&(t=[t]);for(var e=0,i=t.length;e<i;e++)BX.setUnselectable(t[e]),t[e].ondragstart=function(t){return BX.PreventDefault(t)}},ShowColorOverlay:function(t,e,i){var s,n=this,o=0,a=this.arStickers[t];this.pColorOverlay||(this.pColorOverlay=document.body.appendChild(BX.create("DIV",{props:{className:"bx-sticker-overlay"}}))),this.pColorOverlay.style.zIndex=parseInt(a.pWin.Get().style.zIndex)+10,this.pColorOverlay.style.top=a.pWin.Get().style.top,this.pColorOverlay.style.left=a.pWin.Get().style.left,this.pColorOverlay.style.width=a.pWin.Get().style.width,this.pColorOverlay.style.height=a.pWin.Get().style.height,s=setInterval(function(){return o>2?(i?n.ChangeColor(t,e,!0,!1):n.pColorOverlay.className="bx-sticker-overlay",clearInterval(s)):(i?n.pColorOverlay.className="bx-sticker-overlay bx-sticker-op-"+o:n.pColorOverlay.className="bx-sticker-overlay bx-sticker-op-"+(3-o),void o++)},20)},DisplayStickers:function(t){for(var e=0,i=this.Stickers.length;e<i;e++)this.AddSticker(this.Stickers[e],t)},MousePos:function(t){return window.event&&(t=window.event),t.pageX||t.pageY?(t.realX=t.pageX,t.realY=t.pageY):(t.clientX||t.clientY)&&(t.realX=t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft,t.realY=t.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop),t},SaveAndCloseEditor:function(t,e,i){if(!window.oLHESticker||this.bLoadLHEEditor){var s=this;return setTimeout(function(){s.SaveAndCloseEditor(t,e)},100)}var n=this.arStickers[t];oLHESticker.SaveContent();var o=oLHESticker.GetContent(),a=oLHESticker.ParseContent(o);n.obj.html_content=a,n.pContentArea.innerHTML=a,this.arStickers[t].obj.content=o,e!==!1&&(n.pContentArea.style.display="block",this.pEditorCont.style.display="none",n.pContentArea.style.top="0px",n.pBody.style.overflow="auto",this.curEditorStickerInd=!1),i!==!1&&this.SaveSticker(t)},GetNewStickerContent:function(){var t=function(t){return t=parseInt(t),isNaN(t)&&(t=0),t<10?"0"+t.toString():t.toString()},e=new Date,i=this.Params.strDate+" "+t(e.getHours())+":"+t(e.getMinutes());return"[ST_TITLE]"+BX.util.htmlspecialchars(this.Params.curUserName)+" "+i+"[/ST_TITLE]\n"},SaveSticker:function(t){if("R"!=this.access){this.curEditorStickerInd===t&&this.SaveAndCloseEditor(t,!1,!1);var e=this.arStickers[t],i=this,s=Math.round(1e5*Math.random());if(window.__bxst_result[s]=!1,"undefined"==typeof e.obj.content&&(e.obj.content=this.GetNewStickerContent()+"\n"),e.obj.bNew){if(this._arSavedStickers[t])return;this._arSavedStickers[t]=!0}this.Request("save_sticker",{reqid:s,id:e.obj.bNew?0:e.obj.id,page_url:this.Params.pageUrl,page_title:this.Params.pageTitle,personal:e.obj.personal?"Y":"N",content:e.obj.content,width:e.obj.width,height:e.obj.height,top:e.obj.top,left:e.obj.left,color:e.obj.colorInd,collapsed:e.obj.collapsed?"Y":"N",completed:e.obj.completed?"Y":"N",closed:e.obj.closed?"Y":"N",marker:e.obj.marker},function(){if(window.__bxst_result[s]){var n=!!e.obj.bNew;i.arStickers[t].obj=i.ConvertStickerObj(window.__bxst_result[s]),i.arStickers[t].pHint&&(i.arStickers[t].pHint.HINT=i.arStickers[t].obj.info,i.arStickers[t].pHint.CONTENT_TEXT&&(i.arStickers[t].pHint.CONTENT_TEXT.innerHTML=i.arStickers[t].obj.info)),n?(i.UpdateNewSticker(t),i.arStickers[t].obj.closed||(i.curPageCount++,i.UpdateStickersCount())):i.arStickers[t].obj.closed&&(i.curPageCount--,i.UpdateStickersCount())}window.__bxst_result[s]=null})}},GetCollapsedContent:function(t){var e="";return t.indexOf("bxst-title")!=-1&&(e=t.replace(/<span[^>]*?class="bxst-title"[^>]*?>((?:\s|\S)*?)<\/span>/gi,function(t,e){return e.indexOf(String.fromCharCode(160))>0?'<span class="bxst-title">'+e.substr(0,e.indexOf(String.fromCharCode(160)))+"</span> ":e}),e=e.replace(/<br( \/)?>/gi," ")),""!=e?e:t},ConvertStickerObj:function(t){return{bNew:!1,id:parseInt(t.ID),personal:"Y"==t.PERSONAL,colorInd:t.COLOR||0,content:t.CONTENT,html_content:t.HTML_CONTENT,top:parseInt(t.POS_TOP),left:parseInt(t.POS_LEFT),width:parseInt(t.WIDTH),height:parseInt(t.HEIGHT),collapsed:"Y"==t.COLLAPSED,completed:"Y"==t.COMPLETED,closed:"Y"==t.CLOSED,info:t.INFO,authorName:t.AUTHOR,authorId:t.CREATED_BY,marker:t.MARKER_ADJUST||t.MARKER_WIDTH||t.MARKER_HEIGHT?{top:parseInt(t.MARKER_TOP),left:parseInt(t.MARKER_LEFT),width:parseInt(t.MARKER_WIDTH),height:parseInt(t.MARKER_HEIGHT),adjust:t.MARKER_ADJUST}:{}}},SetMarker:function(t,e){var i=this,s=this.arStickers[t];if(this.bHightlightElementMode=!1,this.bSelectAreaMode=!1,BX.removeClass(s.pMarkerElementBut,"bxst-pressed"),BX.removeClass(s.pMarkerAreaBut,"bxst-pressed"),this.oMarker||(this.oMarker={}),this.oMarker.StickerInd=t,s.pMarkerNode&&BX.removeClass(s.pMarkerNode,"bxst-sicked"),s.pMarker&&(s.pMarker.style.display="none",s.pMarker.style.top="-1000px"),s.markerResizer&&s.markerResizer.cont&&(s.markerResizer.cont.style.display="none"),s.obj&&s.obj.marker&&(s.obj.marker={}),this.oMarker.node=null,s.bSetMarkerMode=!0,"area"==e){BX.addClass(s.pMarkerAreaBut,"bxst-pressed"),setTimeout(function(){i.bSelectAreaMode=!0},10),this.oMarker.pOverlay||(this.oMarker.pOverlay=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-marker-overlay"}}))),this.oMarker.pOverlay.style.display="block";var n=BX.GetWindowScrollSize(document);this.oMarker.pOverlay.style.width=n.scrollWidth+"px",this.oMarker.pOverlay.style.height=n.scrollHeight+"px",this.oMarker.pCursorHint||(this.oMarker.pCursorHint=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-cursor-hint"},text:this.MESS.CursorHint}))),this.oMarker.pCursorHint.style.top="",this.oMarker.pCursorHint.style.left="",this.oMarker.pCursorHint.style.display="block",this.oMarker.pWnd=document.body.appendChild(BX.create("DIV")),this.oMarker.pWnd.className="bxst-cur-marker "+this.colorSchemes[s.obj.colorInd].name}else BX.addClass(s.pMarkerElementBut,"bxst-pressed"),setTimeout(function(){i.bHightlightElementMode=!0},10);BX.bind(document,"mousemove",BX.proxy(this.OnMouseMove,this)),BX.bind(document,"mouseup",BX.proxy(this.OnMouseUp,this))},OnMousedown:function(t){if(this.curEditorStickerInd!==!1&&window.oLHESticker&&!window.oLHESticker.bPopup){var e=this.arStickers[this.curEditorStickerInd];if(e&&e.pWin.Get()){var i=this.bSelectAreaMode||this.bHightlightElementMode,s=3,n=parseInt(e.pWin.Get().style.top)-s,o=parseInt(e.pWin.Get().style.left)-s,a=o+parseInt(e.pWin.Get().style.width)+2*s,r=n+parseInt(e.pWin.Get().style.height)+2*s;t=this.MousePos(t),(t.realX<o||t.realX>a||t.realY<n||t.realY>r)&&this.SaveAndCloseEditor(this.curEditorStickerInd,!i,!i)}}if(this.bSelectAreaMode)t=this.MousePos(t),this.bDrawMarkerMode=!0,this.oMarker.pCursorHint&&(this.oMarker.pCursorHint.style.display="none"),this.oMarker.from={top:t.realY,left:t.realX};else if(this.bHightlightElementMode){var l=!1;if(this.pCurMarkeredNode){l=!0;var d=this.pCurMarkeredNode.pNode.className;!d||d.indexOf("bx-sticker")==-1&&d.indexOf("bxst")==-1||d.indexOf("bxst-sicked")!=-1||(l=!1),l&&(l=!BX.findParent(this.pCurMarkeredNode.pNode,{className:new RegExp("bx-sticker","ig")}))}if(l)return BX.PreventDefault(t);this.MarkerHightlightNode()}},OnMouseMove:function(t){if(this.bHightlightElementMode){var e;t.target?e=t.target:t.srcElement&&(e=t.srcElement),3==e.nodeType&&(e=e.parentNode),e&&e.nodeName&&this.MarkerHightlightNode(e)}if(this.bSelectAreaMode){if(t=this.MousePos(t),this.oMarker.pCursorHint&&this.AdjustHintToCursor(this.oMarker.pCursorHint,t),!this.bDrawMarkerMode)return;this.oMarker.to={top:t.realY,left:t.realX};var i=this.oMarker.from.top,s=this.oMarker.from.left,n=Math.abs(this.oMarker.to.left-this.oMarker.from.left),o=Math.abs(this.oMarker.to.top-this.oMarker.from.top);this.oMarker.to.top<=this.oMarker.from.top&&this.oMarker.to.left>=this.oMarker.from.left?(i=this.oMarker.to.top,s=this.oMarker.from.left):this.oMarker.to.top>this.oMarker.from.top&&this.oMarker.to.left>this.oMarker.from.left?(i=this.oMarker.from.top,s=this.oMarker.from.left):this.oMarker.to.top>this.oMarker.from.top&&this.oMarker.to.left<this.oMarker.from.left?(i=this.oMarker.from.top,s=this.oMarker.to.left):this.oMarker.to.top<this.oMarker.from.top&&this.oMarker.to.left<this.oMarker.from.left&&(i=this.oMarker.to.top,s=this.oMarker.to.left),this.oMarker.pWnd.style.display="block",this.oMarker.pWnd.style.width=n+"px",this.oMarker.pWnd.style.height=o+"px",this.oMarker.pWnd.style.top=i+"px",this.oMarker.pWnd.style.left=s+"px",this.oMarker.top=i,this.oMarker.left=s,this.oMarker.width=n,this.oMarker.height=o}},OnMouseUp:function(t){if(this.bHightlightElementMode&&this.pCurMarkeredNode){var e=!1,i=this.pCurMarkeredNode.pNode.className;!i||i.indexOf("bx-sticker")==-1&&i.indexOf("bxst")==-1||i.indexOf("bxst-sicked")!=-1||(e=!0),e||(e=!!BX.findParent(this.pCurMarkeredNode.pNode,{className:new RegExp("bx-sticker","ig")})),e||(this.oMarker.node=this.pCurMarkeredNode.pNode)}if(this.bDrawMarkerMode=!1,this.bHightlightElementMode=!1,this.bSelectAreaMode=!1,this.oMarker.StickerInd>=0&&this.arStickers[this.oMarker.StickerInd]){var s=this.arStickers[this.oMarker.StickerInd];BX.removeClass(s.pMarkerElementBut,"bxst-pressed"),BX.removeClass(s.pMarkerAreaBut,"bxst-pressed"),s.bSetMarkerMode=!1}BX.unbind(document,"mousemove",BX.proxy(this.OnMouseMove,this)),BX.unbind(document,"mouseup",BX.proxy(this.OnMouseUp,this)),this.oMarker.pOverlay&&(this.oMarker.pOverlay.style.display="none"),this.oMarker.pCursorHint&&(this.oMarker.pCursorHint.style.display="none"),e||this.CreateMarker(this.oMarker)},MarkerHightlightNode:function(t){this.pCurMarkeredNode&&(this.pCurMarkeredNode.onclick&&(this.pCurMarkeredNode.pNode.onclick=this.pCurMarkeredNode.onclick),this.pCurMarkeredNode.onmousedown&&(this.pCurMarkeredNode.pNode.onmousedown=this.pCurMarkeredNode.onmousedown),BX.removeClass(this.pCurMarkeredNode.pNode,"bxst-sicked")),t?(this.pCurMarkeredNode={pNode:t},t.onclick&&(this.pCurMarkeredNode.onclick=t.onclick),t.onmousedown&&(this.pCurMarkeredNode.onmousedown=t.onmousedown),t.onmousedown=BX.proxy(this.OnMousedown,this),t.onclick=function(){return BX.PreventDefault(arguments[0])},BX.addClass(t,"bxst-sicked")):this.pCurMarkeredNode=!1},CreateMarker:function(t){if(t){var e=this.arStickers[t.StickerInd];if(t.node){e.pMarkerNode=t.node,e.obj.marker={adjust:this.GetNodeAdjustInfo(t.node)};var i=BX.pos(e.pMarkerNode);i&&(e.obj.marker.top=i.top-2,e.obj.marker.left=i.left-2,e.obj.marker.width=i.width-4,e.obj.marker.height=i.height-4)}else e.obj.marker={top:t.top,left:t.left,width:t.width,height:t.height},this.InitMagicAdjust(t.StickerInd);e.obj.marker&&(e.obj.marker.adjust||e.obj.marker.width&&e.obj.marker.height&&e.obj.marker.top&&e.obj.marker.left)&&(this.DisplayMarker(t.StickerInd,!0),this.AdjustStickerToArea(t.StickerInd)),this.oMarker.pWnd&&(this.oMarker.pWnd.style.display="none"),e.pWin.__stWasDragged||this.SaveSticker(t.StickerInd)}},DisplayMarker:function(t,e){var i=this.arStickers[t];if(i.pMarker&&(i.pMarker.style.display="none"),i.obj.marker&&i.obj.marker.adjust&&(i.pMarkerNode||(i.pMarkerNode=this.FindMarkerNode(i.obj.marker.adjust)),i.pMarkerNode)){var s=BX.pos(i.pMarkerNode);return s&&(i.pMarker||(i.pMarker=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-sticker-marker "+this.colorSchemes[i.obj.colorInd].name}}))),e&&BX.addClass(i.pMarker,"bxst-marker-over"),i.pMarker.style.display="",i.pMarker.style.width=s.width-4+"px",i.pMarker.style.height=s.height-4+"px",i.pMarker.style.top=s.top-2+"px",i.pMarker.style.left=s.left-2+"px"),void BX.removeClass(i.pMarkerNode,"bxst-sicked")}i.obj.marker&&i.obj.marker.width>0&&(i.pMarker||(i.pMarker=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-sticker-marker "+this.colorSchemes[i.obj.colorInd].name}}))),e&&BX.addClass(i.pMarker,"bxst-marker-over"),i.pMarker.style.display="",i.pMarker.style.width=i.obj.marker.width+"px",i.pMarker.style.height=i.obj.marker.height+"px",i.pMarker.style.top=i.obj.marker.top+"px",i.pMarker.style.left=i.obj.marker.left+"px")},InitMagicAdjust:function(t){return},GetNodeAdjustInfo:function(t){var e=this._GetNodeAdjustInfo(t);return e=this._GetNodeAdjustSiblings(t,e)},_GetNodeAdjustInfo:function(t){var e={nodeName:t.nodeName.toLowerCase(),attr:{},innerHTML:null};if(t.innerHTML&&t.innerHTML.length&&(e.innerHTML=BX.util.trim(t.innerHTML.toLowerCase()),e.innerHTML=e.innerHTML.replace(/class=""/gi,""),e.innerHTML=e.innerHTML.replace(/class=''/gi,""),e.innerHTML=e.innerHTML.replace(/\n+/gi,""),e.innerHTML=e.innerHTML.replace(/\r+/gi,""),e.innerHTML=e.innerHTML.replace(/\s+/gi," "),e.innerHTML.length>250&&(e.innerHTML=e.innerHTML.substr(0,250))),t.attributes){var i,s=t.attributes.length;for(i=0;i<s;i++)name=t.attributes[i].name,name&&"string"==typeof name&&(name=name.toLowerCase(),this.oMarkerConfig.attr[name]&&(val=t.attributes[i].value,"class"!=name&&"classname"!=name||(name="classname",val=val.replace("bxst-sicked",""),val=BX.util.trim(val)),val.length>0&&(e.attr[name]=val)))}return e},_GetNodeAdjustSiblings:function(t,e){e.withId={};var i=BX.findParent(t,{attr:{id:new RegExp(".+","ig")}});i&&(e.withId.parent=i.getAttribute("id"));var s=BX.findChild(t,{attr:{id:new RegExp(".+","ig")}},!0,!0);if(s){e.withId.children=[];for(var n=0,o=s.length;n<o;n++)e.withId.children.push(s[n].getAttribute("id"))}var a=BX.findPreviousSibling(t,{attr:{id:new RegExp(".+","ig")}});a&&(e.withId.prevSibling=a.getAttribute("id"));var r=BX.findNextSibling(t,{attr:{id:new RegExp(".+","ig")}});return r&&(e.withId.nextSibling=r.getAttribute("id")),e},FindMarkerNode:function(t){var e=!1;if(!t||!t.nodeName)return!1;t.attr||(t.attr={}),t.attr.id&&(e=BX(t.attr.id));var i,s=[];if(e)s.push({coincide:100,node:e,bImpAttrCoincide:!0});else{if(t.withId||(t.withId={}),t.withId.prevSibling){var n=BX(t.withId.prevSibling);if(n)for(;(n=n.nextSibling)&&(i=this.TestNodeWithAttributes(n,t),i&&s.push(i),100!=i.coincide););}if(t.withId.nextSibling){var o=BX(t.withId.nextSibling);if(o)for(;(o=o.previousSibling)&&(i=this.TestNodeWithAttributes(o,t),i&&s.push(i),100!=i.coincide););}if(t.withId.children){var a,r,l,d=t.withId.children.length;for(a=0;a<d;a++)if(r=BX(t.withId.children[a]))for(l=r;;){if(l=BX.findParent(l,{tagName:t.nodeName}),!l)break;if(i=this.TestNodeWithAttributes(o,t),i&&s.push(i),100==i.coincide)break}}var h;t.withId.parent&&(h=BX(t.withId.parent)),h||(h=document.body);var a,c=h.getElementsByTagName(t.nodeName),d=c.length;for(a=0;a<d&&(i=this.TestNodeWithAttributes(c[a],t),i&&s.push(i),100!=i.coincide);a++);}var a,d=s.length,p=[],u=0,m=!1;for(a=0;a<d;a++)s[a].coincide>u&&(u=s[a].coincide,m=s[a].node,p=[]),s[a].coincide==u&&s[a].node!=m&&p.push(s[a].node);return 0==p.length&&m?m:(p[0],!1)},TestNodeWithAttributes:function(t,e){if(!t||!t.nodeName)return!1;var s={coincide:0,node:t},n=this._GetNodeAdjustInfo(t);if(n.nodeName!=e.nodeName)return!1;var o=0,a="string"==typeof e.innerHTML;if("string"!=typeof n.innerHTML&&a)return!1;var r=0;for(i in e.attr)"string"==typeof e.attr[i]&&r++;if(r>0){o=100/(r+(a?1:0));var l=!0;for(i in e.attr)"string"==typeof e.attr[i]&&(e.attr[i]==n.attr[i]?s.coincide+=o:this.oMarkerConfig.impAttr[i]&&(l=!1));s.bImpAttrCoincide=l}return a&&n.innerHTML==e.innerHTML&&(s.coincide+=r>0?o:95),s.coincide=Math.round(s.coincide),s.coincide>0&&s},OnDivMouseOver:function(t,e){var i=this.arStickers[t];if(i.bSetMarkerMode)return this.ShowButtonsPanel(t,!0,!1);i._over=e,i._overTimeout&&clearTimeout(i._overTimeout);var s=this;i._overTimeout=setTimeout(function(){i._over==e&&(s.ShowButtonsPanel(t,e),s.Hightlight(t,e))},e?100:500)},ShowButtonsPanel:function(t,e,i){this.Params.bHideBottom||(e=!0,i=!1),i=i!==!1;var s=this,n=this.arStickers[t],o=24,a=3,r=1,l=n.obj.height-(n.bButPanelShowed?0:o),d=l+o*(e?1:-1),h=BX.browser.IsIE()?3:10;if(!(this.bSelectAreaMode||this.bHightlightElementMode||n.obj.collapsed||n.obj.closed||n.bColSelShowed||n.bResizingNow)){if(n.bButPanelShowed==e)return n.pWin.Get().style.height=l+"px",this.AdjustShadow(t);var c=setInterval(function(){l+=a*r*(e?1:-1),(e&&l>=d||!e&&l<=d)&&(l=d),n.pWin.Get().style.height=l+"px",s.AdjustShadow(t),l==d&&(clearInterval(c),n.bButPanelShowed=e),r++},h)}},ShowColorSelector:function(t){var e,i=this,s=this.arStickers[t];if(s){if(!s.pColSelector){s.pColSelector=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-col-sel"}}));for(var n=0,o=this.colorSchemes.length;n<o;n++)e=s.pColSelector.appendChild(BX.create("SPAN",{props:{id:"bxst_"+t+"_"+n,className:"bxst-col-pic "+this.colorSchemes[n].name,title:this.colorSchemes[n].title}})),e.onclick=function(){i.ChangeColor(t,parseInt(this.id.substr(("bxst_"+t+"_").length)),!0,!0),i.ShowColorSelector(t)};s.pColSelector.style.zIndex=this.Params.zIndex+20}if(s.bColSelShowed=!s.bColSelShowed,s.bColSelShowed){var a=BX.pos(s.pColorBut);s.pColSelector.style.top=parseInt(a.top)+16+"px",s.pColSelector.style.left=a.left+"px",s.pColSelector.style.display="block",this.ShowOverlay(!0,this.Params.zIndex+15),this.pTransOverlay.onmousedown=function(){i.ShowColorSelector(t)},BX.bind(document,"keydown",BX.proxy(function(e){this.OnKeyDown(e,t)},this))}else s.pColSelector.style.display="none",this.ShowOverlay(!1),BX.unbind(document,"keydown",BX.proxy(function(e){this.OnKeyDown(e,t)},this))}},ShowOverlay:function(t,e){if(this.pTransOverlay||(this.pTransOverlay=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-trans-overlay"}}))),t){this.pTransOverlay.style.display="block",this.pTransOverlay.style.zIndex=e||800;var i=BX.GetWindowScrollSize(document);this.pTransOverlay.style.width=i.scrollWidth+"px",this.pTransOverlay.style.height=i.scrollHeight+"px"}else this.pTransOverlay.style.display="none",this.pTransOverlay.onmousedown=BX.False},OnKeyDown:function(t,e){t||(t=window.event);var i=t.which||t.keyCode;if(27==i){var s=this.arStickers[e];s&&s.bColSelShowed&&this.ShowColorSelector(e)}},SupaFlySticker:function(){return},Hightlight:function(t,e){var i=this.arStickers[t];i.bOver!==e&&(i.bOver=e,e?(i.pMarker&&BX.addClass(i.pMarker,"bxst-marker-over"),BX.addClass(i.pWin.Get(),"bx-sticker-over"),BX.addClass(i.pHead,"bxst-header-over"),i.pWin.Get().style.top=parseInt(i.pWin.Get().style.top)-1+"px",i.pWin.Get().style.left=parseInt(i.pWin.Get().style.left)-1+"px"):(i.pMarker&&BX.removeClass(i.pMarker,"bxst-marker-over"),BX.removeClass(i.pWin.Get(),"bx-sticker-over"),BX.removeClass(i.pHead,"bxst-header-over"),i.pWin.Get().style.top=parseInt(i.pWin.Get().style.top)+1+"px",i.pWin.Get().style.left=parseInt(i.pWin.Get().style.left)+1+"px"))},BlinkRed:function(t){var e,i=this,s=4,n=0,o=0,a=this.arStickers[t];this.pBlinkRed||(this.pBlinkRed=document.body.appendChild(BX.create("DIV",{props:{className:"bxst-blink-red"}}))),this.pBlinkRed.style.zIndex=parseInt(a.pWin.Get().style.zIndex)+10,this.pBlinkRed.style.top=a.pWin.Get().style.top,this.pBlinkRed.style.left=a.pWin.Get().style.left,this.pBlinkRed.style.width=a.pWin.Get().style.width,this.pBlinkRed.style.height=a.pWin.Get().style.height,bFadeIn=!0,e=setInterval(function(){return n>2?(bFadeIn?(i.pBlinkRed.className="bxst-blink-red bx-sticker-op-3",n=1):(i.pBlinkRed.className="bxst-blink-red",n=0),o++,bFadeIn=!bFadeIn,void(o>=s&&clearInterval(e))):(bFadeIn?i.pBlinkRed.className="bxst-blink-red bx-sticker-op-"+n:i.pBlinkRed.className="bxst-blink-red bx-sticker-op-"+(3-n),void n++)},BX.browser.IsIE()?30:60)},ShowList:function(t){this.List||(this.List=new BXStickerList(this)),this.List.Show(t)},OnKeyUp:function(t){t||(t=window.event);var e=t.which||t.keyCode;if(17==e){var i=this;this._bCtrlPressed=!0,setTimeout(function(){i._bCtrlPressed=!1},400)}else if(16==e){var i=this;this._bShiftPressed=!0,setTimeout(function(){i._bShiftPressed=!1},400)}else if((this._bShiftPressed||t.shiftKey)&&(t.ctrlKey||this._bCtrlPressed)){if(83==e&&"W"==this.Params.access)return this.AddSticker(),BX.PreventDefault(t);if(88==e)return this.ShowAll(),BX.PreventDefault(t);if(76==e)return this.ShowList("current"),BX.PreventDefault(t)}},UpdateStickersCount:function(){(this.curPageCount<0||isNaN(parseInt(this.curPageCount)))&&(this.curPageCount=0);var t=BX.findChild(BX("bxst-show-sticker-icon"),{tagName:"B"},!0);t&&(t.innerHTML="("+this.curPageCount+")")}},BXStickerList.prototype={Show:function(t){if(!this.bShowed){var e={content_url:"/bitrix/admin/fileman_stickers.php?sticker_action=show_list&"+this.BXSticker.sessid_get+"&cur_page="+this.BXSticker.Params.pageUrl+"&type="+t+"&site_id="+this.BXSticker.Params.site_id,title:this.MESS.StickerListTitle,width:this.BXSticker.Params.listWidth,height:this.BXSticker.Params.listHeight,min_width:800,min_height:400,resizable:!0,resize_id:"bx_sticker_list_resize_id"};this.type=t,this.bRefreshPage=!1,this.naviSize=this.BXSticker.Params.listNaviSize,this.oDialog=new BX.CDialog(e),this.oDialog.Show(),this.oDialog.SetButtons([this.oDialog.btnClose]),this.bShowed=!0;var i=this;BX.addCustomEvent(this.oDialog,"onWindowUnRegister",function(){i.bShowed=!1,i.bRefreshPage&&(window.location=window.location)}),BX.addCustomEvent(this.oDialog,"onWindowResizeFinished",function(){i.AdjustNaviSize()}),BX.addCustomEvent(this.oDialog,"onWindowExpand",function(){i.AdjustNaviSize()}),BX.addCustomEvent(this.oDialog,"onWindowNarrow",function(){i.AdjustNaviSize()})}},OnLoad:function(t){this.pAllBut=BX("bxstl_fil_all_but"),this.pMyBut=BX("bxstl_fil_my_but"),this.pColorCont=BX("bxstl_col_cont"),this.pOpenedBut=BX("bxstl_fil_opened_but"),this.pClosedBut=BX("bxstl_fil_closed_but"),this.pAllStickersBut=BX("bxstl_fil_all_p_but"),this.pItemsTable=BX("bxstl_items_table"),this.pItemsTableCnt=BX("bxstl_items_table_cnt"),this.pNaviCont=BX("bxstl_navi_cont"),"W"==this.access&&(this.pActionSel=BX("bxstl_action_sel"),this.pActionBut=BX("bxstl_action_ok")),this.pPageSelect=BX("bxstl_fil_page_sel"),"current"==this.type?(this.BXSticker.Params.filterParams.status="all",this.BXSticker.Params.filterParams.page="current"):"all"==this.type&&(this.BXSticker.Params.filterParams.status="opened",this.BXSticker.Params.filterParams.page="all");var e=this,i=this.BXSticker.Params.filterParams.colors;if(i&&"all"!=i&&i.length>0){this.checkedColors=[!1,!1,!1,!1,!1,!1];for(var s=0,n=i.length;s<n;s++)99!=i[s]&&(this.checkedColors[parseInt(i[s])]=!0)}else this.checkedColors=[!0,!0,!0,!0,!0,!0];if(!this.bRefreshPage&&window.__bxst_result.cur_page_ids!==!1&&"object"==typeof window.__bxst_result.cur_page_ids)for(var s in window.__bxst_result.cur_page_ids)this.arCurPageIds[parseInt(window.__bxst_result.cur_page_ids[s])]=!0;var s,o,a,n=this.BXSticker.colorSchemes.length,r=BX.browser.IsIE()&&!BX.browser.IsDoctype()?'style="width: 12px; height: 12px"':"";for(s=0;s<n;s++)o=this.BXSticker.colorSchemes[s],a=this.pColorCont.appendChild(BX.create("DIV",{props:{id:"bxstl_color_"+s,className:"bxstl-color-pick"+(this.checkedColors[s]?" bxstl-color-pick-ch":""),title:o.title},html:'<div class="bxstl-col-pic-l"></div><div class="bxstl-col-pic-c"><div class="'+o.name+'" '+r+'>&nbsp;</div></div><div class="bxstl-col-pic-r"></div>'})),a.onclick=function(){var t=parseInt(this.id.substr("bxstl_color_".length));e.checkedColors[t]=!e.checkedColors[t],e.checkedColors[t]?BX.addClass(this,"bxstl-color-pick-ch"):BX.removeClass(this,"bxstl-color-pick-ch"),e.ReloadList()};this.SetStickerType(this.BXSticker.Params.filterParams.type,!1),this.pAllBut.onclick=function(){e.SetStickerType("all")},this.pMyBut.onclick=function(){e.SetStickerType("my")},this.SetStickerStatus(this.BXSticker.Params.filterParams.status,!1),this.pOpenedBut.onclick=function(){e.SetStickerStatus("opened")},this.pClosedBut.onclick=function(){e.SetStickerStatus("closed")},this.pAllStickersBut.onclick=function(){e.SetStickerStatus("all")},"W"==this.access&&(this.pActionBut.onclick=function(){e.Action()}),this.pPageSelect.onchange=function(){e.SetPage(this.value)},this.SetPage("current"==this.BXSticker.Params.filterParams.page?this.BXSticker.Params.pageUrl:this.BXSticker.Params.filterParams.page,!1),t=parseInt(t),this.oDialog.SetTitle(this.MESS.StickerListTitle+" ("+t+")"),this.EnableActionBut(!1)},SetStickerStatus:function(t,e){"opened"==t?(BX.addClass(this.pOpenedBut,"bxstl-but-checked"),BX.removeClass(this.pClosedBut,"bxstl-but-checked"),BX.removeClass(this.pAllStickersBut,"bxstl-but-checked")):"closed"==t?(BX.removeClass(this.pOpenedBut,"bxstl-but-checked"),BX.addClass(this.pClosedBut,"bxstl-but-checked"),BX.removeClass(this.pAllStickersBut,"bxstl-but-checked")):(BX.removeClass(this.pOpenedBut,"bxstl-but-checked"),BX.removeClass(this.pClosedBut,"bxstl-but-checked"),BX.addClass(this.pAllStickersBut,"bxstl-but-checked")),this.StickersStatus=t,e!==!1&&this.ReloadList()},SetStickerType:function(t,e){"all"==t?(BX.addClass(this.pAllBut,"bxstl-but-checked"),BX.removeClass(this.pMyBut,"bxstl-but-checked")):(BX.addClass(this.pMyBut,"bxstl-but-checked"),BX.removeClass(this.pAllBut,"bxstl-but-checked")),this.StickersType=t,e!==!1&&this.ReloadList()},SetPage:function(t,e){this.pPageSelect.value=t,this.StickersPage=t,e!==!1&&this.ReloadList()},NaviGet:function(t,e){var i={};i["PAGEN_"+e]=t,this.ReloadList(i)},ReloadList:function(t){var e=this;t||(t={}),t.sticker_just_res="Y",t.colors=[99],t.sticker_type=this.StickersType,t.sticker_status=this.StickersStatus,t.sticker_page=this.StickersPage,t.navi_size=this.naviSize,t.cur_page=this.BXSticker.Params.pageUrl,t.type=this.type;var i,s=this.checkedColors.length;for(i=0;i<s;i++)this.checkedColors[i]===!0&&t.colors.push(i);window.__bxst_result.list_rows_count=!1,window.__bxst_result.cur_page_ids=!1,this.BXSticker.Request("show_list",t,function(t){var i=t.split("#BX_STICKER_SPLITER#");if(2==i.length&&(e.pItemsTableCnt.innerHTML=i[0],e.pNaviCont.innerHTML=i[1]),window.__bxst_result.list_rows_count!==!1&&e.oDialog.SetTitle(e.MESS.StickerListTitle+" ("+parseInt(window.__bxst_result.list_rows_count)+")"),!e.bRefreshPage&&window.__bxst_result.cur_page_ids!==!1&&"object"==typeof window.__bxst_result.cur_page_ids)for(var s in window.__bxst_result.cur_page_ids)e.arCurPageIds[parseInt(window.__bxst_result.cur_page_ids[s])]=!0;e.pItemsTable=BX("bxstl_items_table"),e.EnableActionBut(!1)},!0)},AdjustToSize:function(t,e){},AdjustNaviSize:function(){var t,e=parseInt(this.oDialog.GetContent().style.height),i=40,s=e-100-80;s!=i*this.naviSize&&(t=Math.floor(s/i)),t<5&&(t=5),t>30&&(t=30),this.naviSize!=t&&(this.naviSize=t,this.ReloadList())},CheckAll:function(t){var e,i=this.pItemsTable.rows.length,s=!1;for(e=1;e<i;e++)7==this.pItemsTable.rows[e].cells.length&&(this.pItemsTable.rows[e].cells[6].firstChild.checked=!!t,s=!0);s&&this.EnableActionBut(t)},Action:function(){if("W"==this.access){var t=this.pActionSel.value;if(""!=t&&("del"!=t||confirm(this.MESS.DelConfirm))){var e,i=this.pItemsTable.rows.length,s=[];for(e=1;e<i;e++)this.pItemsTable.rows[e].cells.length<7||(ch=this.pItemsTable.rows[e].cells[6].firstChild,ch.checked&&(s.push(ch.value),!this.bRefreshPage&&this.arCurPageIds[parseInt(ch.value)]&&(this.bRefreshPage=!0)));this.ReloadList({list_action:t,list_ids:s})}}},EnableActionBut:function(t){if("W"==this.access){if("check"==t){var e,i=this.pItemsTable.rows.length,t=!1;for(e=1;e<i;e++)if(!(this.pItemsTable.rows[e].cells.length<7)&&this.pItemsTable.rows[e].cells[6].firstChild.checked){t=!0;break}}this.pActionBut.disabled=!t,this.pActionSel.disabled=!t}}},function(t){BX.admin||(BX.admin={__border_style:"solid 1px #777f8c",__bg_style:"#777f8c",__border_dx:0,__border_min_height:12,__border_menu_timeout:500,__borders_last_comp_pos:{},__borders:null,dynamic_mode:!1,dynamic_mode_show_borders:!1,timer:null,createComponentBorder:function(){BX.admin.__borders={},BX.admin.__borders.cont=document.body.appendChild(BX.create("DIV",{style:{display:"none",height:"0px",width:"0px"}})),BX.admin.__borders.top=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",height:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}})),BX.admin.__borders.right=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",width:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}})),BX.admin.__borders.bottom=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",height:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}})),BX.admin.__borders.left=BX.admin.__borders.cont.appendChild(BX.create("DIV",{style:{position:"absolute",width:"1px",fontSize:"1px",overflow:"hidden",zIndex:990,background:BX.admin.__bg_style}}))},__borders_adjust:function(){var t=BX.pos(this),e=BX.admin.__border_dx,i=BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0;BX.adjust(BX.admin.__borders.top,{style:{top:t.top-e-i+"px",left:t.left-e-i+"px",width:t.width+2*e+"px"}}),BX.adjust(BX.admin.__borders.right,{style:{top:t.top-e-i+"px",left:t.right+e-1-i+"px",height:t.height+2*e+"px"}}),BX.adjust(BX.admin.__borders.bottom,{style:{top:t.bottom+e-i+"px",left:t.left-e-i+"px",width:t.width+2*e+"px"}}),BX.adjust(BX.admin.__borders.left,{style:{top:t.top-e-i+"px",left:t.left-e-i+"px",height:t.height+2*e+"px"}}),BX.admin.__borders_last_comp_pos=t},setComponentBorder:function(e){if(!BX.isReady)return BX.ready(function(){BX.admin.setComponentBorder(e)});if(null==BX.admin.__borders&&BX.admin.createComponentBorder(),e=BX(e)){if(e.children.length>0){for(var i=e.firstChild,s=null,n=0;i;){if(BX.type.isElementNode(i)&&"SCRIPT"!=i.tagName.toUpperCase()){if(n++,n>1||!BX.is_relative(i)&&!BX.is_float(i)){n=-1;break}s=i}i=i.nextSibling}1==n&&s&&(e.OPENER&&e.OPENER.setParent(s),e=s)}BX.admin.dynamic_mode&&BX.addCustomEvent(t,"onDynamicModeChange",BX.delegate(BX.admin.__empty_comp_onmodechange,e)),BX.admin.__empty_comp_onmodechange.apply(e,[!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders]),BX.bind(e,"mouseover",BX.admin.__borders_show),BX.bind(e,"mouseout",BX.admin.__borders_hide),e.OPENER&&e.OPENER.defaultAction&&(e.title=BX.message("ADMIN_INCLAREA_DBLCLICK")+" - "+e.OPENER.defaultActionTitle,BX.bind(e,"dblclick",BX.admin.__borders_dblclick))}},removeComponentBorder:function(t){t=BX(t),t&&(BX.unbind(t,"mouseover",BX.admin.__borders_show),BX.unbind(t,"mouseout",BX.admin.__borders_hide),t.bx_msover&&BX.admin.__borders_hide.apply(t))},__empty_comp_onmodechange:function(t){this.offsetHeight<=BX.admin.__border_min_height&&(t?(BX.browser.IsIE()&&!BX.browser.IsDoctype()?this.style.height=BX.admin.__border_min_height+"px":this.style.minHeight=BX.admin.__border_min_height+"px",BX.addClass(this,"bx-context-toolbar-empty-area")):(BX.browser.IsIE()&&!BX.browser.IsDoctype()?this.style.height=null:this.style.minHeight=null,BX.removeClass(this,"bx-context-toolbar-empty-area")))},__borders_dblclick:function(t){return!((!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders)&&this.OPENER&&this.OPENER.defaultAction)||(this.OPENER.executeDefaultAction(),BX.PreventDefault(t))},__borders_show:function(e){e=e||t.event;var i=BX.is_relative(this)?this.parentNode:this;return BX.admin.dynamic_mode&&!BX.admin.dynamic_mode_show_borders?void(i.title&&(i._title=i.title,i.title="")):(i._title&&(i.title=i._title),BX.admin.__borders_adjusted||(BX.admin.__borders.cont.style.display="block",BX.admin.__borders_adjust.apply(this),BX.admin.__borders_adjusted=!0),this.bx_msover=!0,void(this.OPENER&&(this.bxtimer&&clearTimeout(this.bxtimer),this.bxtimer=setTimeout(BX.proxy(BX.admin.__borders_menu_show,this),this.OPENER.timeout||BX.admin.__border_menu_timeout),this.OPENER.setHoverHoutEvents(BX.proxy(BX.admin.__borders_show,this),BX.proxy(BX.admin.__borders_hide,this)))))},__borders_menu_show:function(){this.bx_msover&&this.OPENER&&this.OPENER.UnHide();
},__borders_hide:function(){if(!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders){if(this.OPENER&&this.OPENER.isMenuVisible())return void setTimeout(BX.admin.__borders_hide,3*BX.admin.__border_menu_timeout);if(BX.admin.__borders.cont.style.display="none",BX.admin.__borders_adjusted=!1,this.bx_msover=!1,this.OPENER){var t=BX.admin.__get_hide_timeout(this.OPENER);this.bxtimer&&clearTimeout(this.bxtimer),this.bxtimer=setTimeout(BX.proxy(BX.admin.__borders_menu_hide,this),t)}}},__borders_menu_hide:function(t){!this.bx_msover&&this.OPENER&&this.OPENER.Hide()},__get_hide_timeout:function(t){var e=BX.admin.__border_menu_timeout;return e}},BX.admin.panel={state:{fixed:!1,collapsed:!1},DIV:null,BACKDIV:null,BACKFRAME:null,NOTIFY:null,buttons:[],Init:function(){var e;if(BX.admin.panel.DIV=BX("bx-panel"),BX.admin.panel.DIV){if(BX.setUnselectable(BX.admin.panel.DIV),e=BX("bx-panel-toggle"),e&&(e.onclick=function(e){BX.admin.toggle.toggleStatus(),e=e||t.event,BX.PreventDefault(e)}),e=BX("bx-panel-toggle-icon"),e&&(BX.bind(e,"mousedown",BX.proxy(BX.admin.toggle.start,BX.admin.toggle)),BX.bind(e,"click",BX.PreventDefault)),e=BX("bx-panel-hider")){BX.admin.panel.DIV.ondblclick=BX("bx-panel-expander").onclick=e.onclick=BX.admin.panel.Collapse,BX("bx-panel-tabs").ondblclick=BX.PreventDefault;var i=BX("bx-panel-switcher");i&&(i.ondblclick=BX.PreventDefault)}e=BX("bx-panel-pin"),e&&(BX.bind(e,"click",function(){var t=BX.hasClass(this,"bx-panel-pin-fixed");t?BX.removeClass(this,"bx-panel-pin-fixed"):BX.addClass(this,"bx-panel-pin-fixed"),BX.userOptions.save("admin_panel","settings","fix",t?"off":"on")}),BX.bind(e,"click",BX.admin.panel.Fix),BX.admin.panel.state.fixed&&BX.admin.panel.Fix());for(var s=0,n=BX.admin.panel.buttons.length;s<n;s++){var o=BX(BX.admin.panel.buttons[s].ID);if(o){if(BX.admin.panel.buttons[s].HOVER_CSS&&(o.bx_hover_class=BX.admin.panel.buttons[s].HOVER_CSS,BX.admin.panel.buttons[s].ACTIVE_CSS&&(o.bx_active_class=BX.admin.panel.buttons[s].ACTIVE_CSS),BX.bind(o,"mouseover",BX.admin.panel.__btn_hover),BX.bind(o,"mouseout",BX.admin.panel.__btn_hout),BX.bind(o,"mousedown",BX.admin.panel.__btn_down)),BX.admin.panel.buttons[s].MENU){var a=new BX.COpener({DIV:o,ATTACH:o.parentNode.parentNode,MENU:BX.admin.panel.buttons[s].MENU,TYPE:"click"});BX.addCustomEvent(a,"onOpenerMenuOpen",BX.delegate(BX.admin.panel.__btn_menuopen,o)),BX.addCustomEvent(a,"onOpenerMenuClose",BX.delegate(BX.admin.panel.__btn_menuclose,o))}if(BX.admin.panel.buttons[s].HINT){var r=BX.admin.panel.buttons[s].HINT.TARGET?o.parentNode.parentNode:o;BX.admin.panel.buttons[s].HINT.ID?BX.hint(r,BX.admin.panel.buttons[s].HINT.TITLE,BX.admin.panel.buttons[s].HINT.TEXT,BX.admin.panel.buttons[s].HINT.ID):r.BXHINT=new BX.CHint({parent:r,hint:BX.admin.panel.buttons[s].HINT.TEXT,title:BX.admin.panel.buttons[s].HINT.TITLE,id:BX.admin.panel.buttons[s].HINT.ID})}o.ondblclick=BX.PreventDefault,BX.browser.IsIE()&&o.setAttribute("hideFocus","hidefocus")}}}BX.admin.panel.buttons=[],e=null},__view_mode_toggle:function(e){var i=BX("bx-panel-toggle"),s=BX("bx-panel-toggle-caption-mode");return"bx-panel-toggle-on"==i.className?(i.className="bx-panel-toggle-off",s.innerHTML=BX.message("ADMIN_SHOW_MODE_OFF"),BX.admin.dynamic_mode_show_borders=!1,i.href=i.href.replace("bitrix_include_areas=N","bitrix_include_areas=Y")):(i.className="bx-panel-toggle-on",s.innerHTML=BX.message("ADMIN_SHOW_MODE_ON"),BX.admin.dynamic_mode_show_borders=!0,i.href=i.href.replace("bitrix_include_areas=Y","bitrix_include_areas=N")),null!=this.BXHINT&&this.BXHINT.Destroy(),this.BXHINT=new BX.CHint({parent:this,title:BX.message("AMDIN_SHOW_MODE_TITLE"),hint:BX.admin.dynamic_mode_show_borders?BX.message("ADMIN_SHOW_MODE_ON_HINT"):BX.message("ADMIN_SHOW_MODE_OFF_HINT"),showOnce:!0,preventHide:!0,show_timeout:0,hide_timeout:2e3}),BX.userOptions.save("admin_panel","settings","edit",BX.admin.dynamic_mode_show_borders?"on":"off"),BX.onCustomEvent(t,"onDynamicModeChange",[BX.admin.dynamic_mode_show_borders]),BX.eventReturnFalse(e)},__btn_hover:function(){this.bx_hover=!0,BX.admin.panel._menu_open||BX.addClass(this.parentNode.parentNode,this.bx_hover_class)},__btn_hout:function(){this.bx_hover=!1,BX.admin.panel._menu_open||BX.removeClass(this.parentNode.parentNode,this.bx_hover_class),BX.admin.panel.__btn_inactive.apply(this)},__btn_down:function(){BX.admin.panel.__btn_active.apply(this)},__btn_up:function(){BX.unbind(document,"mouseup",BX.proxy(BX.admin.panel.__btn_up,this)),BX.admin.panel.__btn_inactive.apply(this)},__btn_active:function(){this.bx_active=!0,BX.admin.panel._menu_open||BX.addClass(this.parentNode.parentNode,this.bx_active_class)},__btn_inactive:function(){this.bx_active=!1,BX.admin.panel._menu_open||BX.removeClass(this.parentNode.parentNode,this.bx_active_class)},__btn_menuopen:function(){this.bx_hover&&BX.admin.panel.__btn_hover.apply(this),this.bx_active&&BX.admin.panel.__btn_active.apply(this),BX.admin.panel._menu_open=!0},__btn_menuclose:function(){BX.admin.panel._menu_open=!1,this.bx_hover||BX.admin.panel.__btn_hout.apply(this),BX.admin.panel.__btn_inactive.apply(this)},RegisterButton:function(t){BX.admin.panel.buttons[BX.admin.panel.buttons.length]=t},Collapse:function(e){e=e||t.event,BX.admin.panel.state.collapsed=!(BX.admin.panel.DIV.className.indexOf("bx-panel-folded")>-1);var i=BX.admin.panel.DIV.offsetHeight,s=BX("bx-panel-hider",!0),n=BX("bx-panel-expander",!0),o=BX("bx-panel-toggle");BX.admin.panel.state.collapsed?(BX.admin.toggle.unset(),BX("bx-panel-userinfo").insertBefore(o.parentNode.removeChild(o),n),BX.addClass(BX.admin.panel.DIV,"bx-panel-folded")):(BX.admin.toggle.unset(),BX("bx-panel-switcher").insertBefore(o.parentNode.removeChild(o),s),BX.removeClass(BX.admin.panel.DIV,"bx-panel-folded"));var a=BX.admin.panel.DIV.offsetHeight-i;return BX.userOptions.save("admin_panel","settings","collapsed",BX.admin.panel.state.collapsed?"on":"off"),BX.admin.panel.__adjustBackDiv(),BX.onCustomEvent("onTopPanelCollapse",[BX.admin.panel.state.collapsed,a]),BX.PreventDefault(e)},isFixed:function(){return BX.admin.panel.DIV.className.indexOf("bx-panel-fixed")>-1},Fix:function(){null==BX.admin.panel.BACKDIV&&(BX.admin.panel.BACKDIV=BX("bx-panel-back"));var t=BX.admin.panel.isFixed(),e=BX.browser.IsIE();if(e)try{BX.admin.panel.DIV.style.removeExpression("top")}catch(i){e=!1}if(t)BX.removeClass(BX.admin.panel.DIV,e?"bx-panel-fixed-ie":"bx-panel-fixed"),BX.admin.panel.BACKDIV.style.display="none",e&&(BX.admin.panel.DIV.style.cssText="position: static !important;",BX.admin.panel.BACKFRAME&&(BX.admin.panel.BACKFRAME.style.visibility="hidden"));else{if(e)try{BX.admin.panel.DIV.style.setExpression("top","0")}catch(i){e=!1}e&&(BX.admin.panel.DIV.style.cssText=""),BX.addClass(BX.admin.panel.DIV,e?"bx-panel-fixed-ie":"bx-panel-fixed"),e&&("none"==document.body.currentStyle.backgroundImage&&(document.body.style.backgroundImage="url(/bitrix/images/1.gif)",document.body.style.backgroundAttachment="fixed",document.body.style.backgroundRepeat="no-repeat"),BX.admin.panel.DIV.style.setExpression("top","eval((document.documentElement && document.documentElement.scrollTop) ? document.documentElement.scrollTop : document.body.scrollTop)"),BX.admin.panel.DIV.style.setExpression("left","eval((document.documentElement && document.documentElement.scrollLeft) ? document.documentElement.scrollLeft : document.body.scrollLeft)"),BX.admin.panel.DIV.style.setExpression("width","eval((document.documentElement && document.documentElement.clientWidth) ? document.documentElement.clientWidth : document.body.clientWidth)")),BX.admin.panel.__adjustBackDiv(),BX.admin.panel.BACKDIV.style.display="block",e&&(BX.admin.panel.BACKFRAME?BX.admin.panel.BACKFRAME.style.visibility="visible":BX.admin.panel.CreateFrame())}BX.onCustomEvent("onTopPanelFix",[!t])},__adjustBackDiv:function(){if(BX.admin.panel.BACKDIV){var t=BX.admin.panel.DIV.offsetHeight+"px";BX.admin.panel.BACKDIV.style.height=t;BX("bx-panel-frame");BX.admin.panel.BACKFRAME&&(BX.admin.panel.BACKFRAME.style.height=t)}},CreateFrame:function(){BX.admin.panel.BACKFRAME=document.body.appendChild(BX.create("IFRAME",{props:{id:"bx-panel-frame"},style:{position:"absolute",overflow:"hidden",zIndex:parseInt(BX.admin.panel.DIV.currentStyle.zIndex)-1,height:BX.admin.panel.DIV.offsetHeight+"px"}})),BX.admin.panel.BACKFRAME.style.setExpression("top","eval(document.body.scrollTop)"),BX.admin.panel.BACKFRAME.style.setExpression("left","eval(document.body.scrollLeft)"),BX.admin.panel.BACKFRAME.style.setExpression("width","eval(document.body.clientWidth)")},Notify:function(t){if(!BX.isReady){var e=arguments;return void BX.ready(function(){BX.admin.panel.Notify.apply(this,e)})}BX.admin.panel.DIV&&(null==BX.admin.panel.NOTIFY&&(BX.admin.panel.NOTIFY=BX.admin.panel.DIV.appendChild(BX.create("DIV",{props:{className:"adm-warning-block"},html:'<span class="adm-warning-text">'+(t||"&nbsp;")+'</span><span onclick="BX.admin.panel.hideNotify(this.parentNode)" class="adm-warning-close"></span>'}))),BX.removeClass(BX.admin.panel.NOTIFY,"adm-warning-animate"),BX.admin.panel.__adjustBackDiv())},hideNotify:function(t){var t=BX.type.isDomNode(t)?t:this;if(t&&t.parentNode&&t.parentNode.parentNode&&BX.addClass(t,"adm-warning-animate"),BX.type.isDomNode(t)&&"Y"==t.getAttribute("data-ajax")){var e=parseInt(t.getAttribute("data-id"));e>0&&BX.ajax({url:"/bitrix/admin/admin_notify.php",method:"POST",dataType:"json",data:{ID:e,sessid:BX.bitrix_sessid()}})}BX.defer(BX.admin.panel.__adjustBackDiv,this)(),setTimeout(BX.proxy(BX.admin.panel.__adjustBackDiv,this),310)}},BX.admin.toggle={icon:null,indicator:null,toggle:null,caption:null,pageX:0,initIconPos:0,initIndicatorPos:0,minLeft:-3,maxLeft:17,unset:function(){this.icon=this.indicator=this.toggle=this.caption=null},start:function(e){e=e||t.event,this._init()&&e&&(BX.fixEventPageX(e),this.pageX=e.pageX,this.initIconPos=parseInt(BX.style(this.icon,"left")),this.initIndicatorPos=BX.hasClass(this.toggle,"bx-panel-toggle-on")?-270:-290,BX.removeClass(this.toggle,"bx-panel-toggle-animate"),BX.bind(document,"mousemove",BX.proxy(this._onMouseMove,this)),BX.bind(document,"mouseup",BX.proxy(this._onMouseUp,this)),document.body.onselectstart=BX.False,document.body.ondragstart=BX.False,document.body.style.MozUserSelect="none")},_init:function(){return!!this.toggle||(this.toggle=BX("bx-panel-toggle"),this.icon=BX("bx-panel-toggle-icon"),this.indicator=BX("bx-panel-toggle-indicator"),this.caption=BX("bx-panel-toggle-caption-mode"),this.toggle&&this.icon&&this.indicator&&this.caption)},_onMouseMove:function(e){e=e||t.event,BX.fixEventPageX(e),this._moveToggle(e.pageX-this.pageX)},_onMouseUp:function(){var t=parseInt(BX.style(this.icon,"left"));if(this.initIconPos==t)this.toggleStatus();else{var e=this.minLeft+Math.floor((this.maxLeft-this.minLeft)/2);t>=e?(BX.addClass(this.toggle,"bx-panel-toggle-on bx-panel-toggle-animate"),BX.removeClass(this.toggle,"bx-panel-toggle-off"),this._changePosition(!0)):(BX.addClass(this.toggle,"bx-panel-toggle-off bx-panel-toggle-animate"),BX.removeClass(this.toggle,"bx-panel-toggle-on"),this._changePosition(!1))}this.icon.style.cssText="",this.indicator.style.cssText="",BX.unbind(document,"mousemove",BX.proxy(this._onMouseMove,this)),BX.unbind(document,"mouseup",BX.proxy(this._onMouseUp,this)),document.body.onselectstart=null,document.body.ondragstart=null,document.body.style.MozUserSelect=""},_changePosition:function(e){var i=this.caption.childNodes[0];e&&"bx-panel-toggle-caption-mode-on"==i.id||!e&&"bx-panel-toggle-caption-mode-off"==i.id||(this.caption.appendChild(this.caption.removeChild(i)),BX.admin.dynamic_mode?(e?(BX.admin.dynamic_mode_show_borders=!0,this.toggle.href=this.toggle.href.replace("bitrix_include_areas=Y","bitrix_include_areas=N")):(BX.admin.dynamic_mode_show_borders=!1,this.toggle.href=this.toggle.href.replace("bitrix_include_areas=N","bitrix_include_areas=Y")),null!=BX.admin.panel.BXHINT&&BX.admin.panel.BXHINT.Destroy(),BX.admin.panel.BXHINT=new BX.CHint({parent:this.toggle,title:BX.message("AMDIN_SHOW_MODE_TITLE"),hint:BX.admin.dynamic_mode_show_borders?BX.message("ADMIN_SHOW_MODE_ON_HINT"):BX.message("ADMIN_SHOW_MODE_OFF_HINT"),showOnce:!0,preventHide:!0,show_timeout:0,hide_timeout:2e3}),BX.userOptions.save("admin_panel","settings","edit",BX.admin.dynamic_mode_show_borders?"on":"off"),BX.onCustomEvent(t,"onDynamicModeChange",[BX.admin.dynamic_mode_show_borders])):BX.reload(this.toggle.href))},_moveToggle:function(t){var e=this.initIconPos+t;e=Math.min(this.maxLeft,Math.max(e,this.minLeft)),this.icon.style.cssText="left:"+e+"px !important",this.indicator.style.cssText="background-position: "+(this.initIndicatorPos+e-this.initIconPos)+"px -1751px !important"},toggleStatus:function(){this._init()&&(BX.hasClass(this.toggle,"bx-panel-toggle-off")?(BX.addClass(this.toggle,"bx-panel-toggle-on bx-panel-toggle-animate"),BX.removeClass(this.toggle,"bx-panel-toggle-off"),this._changePosition(!0)):(BX.addClass(this.toggle,"bx-panel-toggle-off bx-panel-toggle-animate"),BX.removeClass(this.toggle,"bx-panel-toggle-on"),this._changePosition(!1)))}},BX.admin.startMenuRecent=function(t){BX.ajax.get("/bitrix/admin/get_start_menu.php",{mode:"save_recent",url:t.LINK,text:t.TEXT,title:t.TITLE,icon:t.GLOBAL_ICON,sessid:BX.bitrix_sessid()})},BX.admin.startMenuFavAdd=function(e){t.location.href="/bitrix/admin/favorite_edit.php?lang="+BX.message("LANGUAGE_ID")+"&name="+BX.util.urlencode(document.title)+"&addurl="+BX.util.urlencode(t.location.href)+"&encoded=Y"+(e?"&back_url_pub="+BX.util.urlencode(e):"")},BX.ready(function(){BX.admin.panel.Init()}))}(window);var phpVars;phpVars||(phpVars={ADMIN_THEME_ID:".default",LANGUAGE_ID:"en",FORMAT_DATE:"DD.MM.YYYY",FORMAT_DATETIME:"DD.MM.YYYY HH:MI:SS",opt_context_ctrl:!1,cookiePrefix:"BITRIX_SM",titlePrefix:"",bitrix_sessid:"",messHideMenu:"",messShowMenu:"",messHideButtons:"",messShowButtons:"",messFilterInactive:"",messFilterActive:"",messFilterLess:"",messLoading:"Loading...",messMenuLoading:"",messMenuLoadingTitle:"",messNoData:"",messExpandTabs:"",messCollapseTabs:"",messPanelFixOn:"",messPanelFixOff:"",messPanelCollapse:"",messPanelExpand:""});var jsUtils={arEvents:Array(),addEvent:function(t,e,i,s){t.attachEvent?t.attachEvent("on"+e,i):t.addEventListener?t.addEventListener(e,i,!1):t["on"+e]=i,this.arEvents[this.arEvents.length]={element:t,event:e,fn:i}},removeEvent:function(t,e,i){t.detachEvent?t.detachEvent("on"+e,i):t.removeEventListener?t.removeEventListener(e,i,!1):t["on"+e]=null},removeAllEvents:function(t){var e;for(e=0;e<this.arEvents.length;e++)!this.arEvents[e]||0!=t&&t!=this.arEvents[e].element||(jsUtils.removeEvent(this.arEvents[e].element,this.arEvents[e].event,this.arEvents[e].fn),this.arEvents[e]=null);0==t&&(this.arEvents.length=0)},IsDoctype:function(){return document.compatMode?"CSS1Compat"==document.compatMode:!(!document.documentElement||!document.documentElement.clientHeight)},GetRealPos:function(t){if(window.BX)return BX.pos(t);if(!t||!t.offsetParent)return!1;var e=Array();e.left=t.offsetLeft,e.top=t.offsetTop;for(var i=t.offsetParent;i&&"BODY"!=i.tagName;)e.left+=i.offsetLeft,e.top+=i.offsetTop,i=i.offsetParent;return e.right=e.left+t.offsetWidth,e.bottom=e.top+t.offsetHeight,e},FindChildObject:function(t,e,i,s){if(!t)return null;for(var n=e.toUpperCase(),o=i?i.toLowerCase():null,a=t.childNodes.length,r=0;r<a;r++){var l=t.childNodes[r];if(l.tagName&&l.tagName.toUpperCase()==n&&(!i||l.className.toLowerCase()==o))return l;if(1==s){var d;if(d=jsUtils.FindChildObject(l,e,i,!0))return d}}return null},FindParentObject:function(t,e,i){if(!t)return null;for(var s=t,n=e.toUpperCase(),o=i?i.toLowerCase():null;s.parentNode;){var a=s.parentNode;if(a.tagName&&a.tagName.toUpperCase()==n&&(!i||a.className.toLowerCase()==o))return a;s=a}return null},FindNextSibling:function(t,e){if(!t)return null;for(var i=t,s=e.toUpperCase();i.nextSibling;){var n=i.nextSibling;if(n.tagName&&n.tagName.toUpperCase()==s)return n;i=n}return null},FindPreviousSibling:function(t,e){if(!t)return null;for(var i=t,s=e.toUpperCase();i.previousSibling;){var n=i.previousSibling;if(n.tagName&&n.tagName.toUpperCase()==s)return n;i=n}return null},bOpera:navigator.userAgent.toLowerCase().indexOf("opera")!=-1,bIsIE:document.attachEvent&&navigator.userAgent.toLowerCase().indexOf("opera")==-1,IsIE:function(){return this.bIsIE},IsOpera:function(){return this.bOpera},IsSafari:function(){var t=navigator.userAgent.toLowerCase();return/webkit/.test(t)},IsEditor:function(){var t=navigator.userAgent.toLowerCase(),e=(t.match(/.+(msie)[\/: ]([\d.]+)/)||[])[2],i=/webkit/.test(t);return!(this.IsOpera()||document.all&&!document.compatMode&&e<6||i)},ToggleDiv:function(t){var e=document.getElementById(t).style;return"none"!=e.display?e.display="none":e.display="block","none"!=e.display},urlencode:function(t){return escape(t).replace(new RegExp("\\+","g"),"%2B")},OpenWindow:function(t,e,i){var s=screen.width,n=screen.height;this.IsOpera()&&(s=document.body.offsetWidth,n=document.body.offsetHeight),window.open(t,"","status=no,scrollbars=yes,resizable=yes,width="+e+",height="+i+",top="+Math.floor((n-i)/2-14)+",left="+Math.floor((s-e)/2-5))},SetPageTitle:function(t){document.title=phpVars.titlePrefix+t;var e=document.getElementsByTagName("H1");e&&(e[0].innerHTML=t)},LoadPageToDiv:function(t,e){var i=document.getElementById(e);i&&(CHttpRequest.Action=function(t){CloseWaitWindow(),document.getElementById(e).innerHTML=t},ShowWaitWindow(),CHttpRequest.Send(t))},trim:function(t){if("string"==typeof t||"object"==typeof t&&t.constructor==String){var e,i;return i=/^[\s\r\n]+/g,e=t.replace(i,""),i=/[\s\r\n]+$/g,e=e.replace(i,"")}return t},Redirect:function(t,e){var i=null,s=!1;t&&t.length>0&&(i=t[0]),i||(i=window.event),i&&(s=i.shiftKey),s?window.open(e):window.location.href=e},False:function(){return!1},AlignToPos:function(t,e,i){var s=t.left,n=t.bottom,o=jsUtils.GetWindowScrollPos(),a=jsUtils.GetWindowInnerSize();return a.innerWidth+o.scrollLeft-(t.left+e)<0&&(s=t.right-e>=0?t.right-e:o.scrollLeft),a.innerHeight+o.scrollTop-(t.bottom+i)<0&&(n=t.top-i>=0?t.top-i:o.scrollTop),{left:s,top:n}},EvalGlobal:function(t){try{window.execScript?window.execScript(t,"javascript"):jsUtils.IsSafari()?window.setTimeout(t,0):window.eval(t)}catch(e){}},GetStyleValue:function(t,e){var i;return t.currentStyle?i=t.currentStyle[e]:window.getComputedStyle&&(i=document.defaultView.getComputedStyle(t,null).getPropertyValue(e)),i||(i=""),i},GetWindowInnerSize:function(t){var e,i;return t||(t=document),self.innerHeight?(e=self.innerWidth,i=self.innerHeight):t.documentElement&&(t.documentElement.clientHeight||t.documentElement.clientWidth)?(e=t.documentElement.clientWidth,i=t.documentElement.clientHeight):t.body&&(e=t.body.clientWidth,i=t.body.clientHeight),{innerWidth:e,innerHeight:i}},GetWindowScrollPos:function(t){var e,i;return t||(t=document),self.pageYOffset?(e=self.pageXOffset,i=self.pageYOffset):t.documentElement&&(t.documentElement.scrollTop||t.documentElement.scrollLeft)?(e=document.documentElement.scrollLeft,i=document.documentElement.scrollTop):t.body&&(e=t.body.scrollLeft,i=t.body.scrollTop),{scrollLeft:e,scrollTop:i}},GetWindowScrollSize:function(t){var e,i;return t||(t=document),t.compatMode&&"CSS1Compat"==t.compatMode?(e=t.documentElement.scrollWidth,i=t.documentElement.scrollHeight):(i=t.body.scrollHeight>t.body.offsetHeight?t.body.scrollHeight:t.body.offsetHeight,e=t.body.scrollWidth>t.body.offsetWidth||t.compatMode&&"BackCompat"==t.compatMode||t.documentElement&&!t.documentElement.clientWidth?t.body.scrollWidth:t.body.offsetWidth),{scrollWidth:e,scrollHeight:i}},GetWindowSize:function(){var t=jsUtils.GetWindowInnerSize(),e=jsUtils.GetWindowScrollPos(),i=jsUtils.GetWindowScrollSize();return{innerWidth:t.innerWidth,innerHeight:t.innerHeight,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop,scrollWidth:i.scrollWidth,scrollHeight:i.scrollHeight}},arCustomEvents:{},addCustomEvent:function(t,e,i,s){this.arCustomEvents[t]||(this.arCustomEvents[t]=[]),i||(i=[]),s||(s=!1),this.arCustomEvents[t].push({handler:e,arParams:i,obj:s})},removeCustomEvent:function(t,e){if(this.arCustomEvents[t]){var i=this.arCustomEvents[t].length;if(1==i)return void delete this.arCustomEvents[t];for(var s=0;s<i;s++)if(this.arCustomEvents[t][s]&&this.arCustomEvents[t][s].handler==e)return void delete this.arCustomEvents[t][s]}},onCustomEvent:function(t,e){if(this.arCustomEvents[t]){e||(e=[]);for(var i,s=0,n=this.arCustomEvents[t].length;s<n;s++)i=this.arCustomEvents[t][s],i&&i.handler&&(i.obj?i.handler.call(i.obj,i.arParams,e):i.handler(i.arParams,e))}},loadJSFile:function(t,e,i){i||(i=document),"string"==typeof t&&(t=[t]);var s=function(){if(e){if("function"==typeof e)return e();if("object"==typeof e&&e.func){var t=e.params||{};e.obj?e.func.apply(e.obj,t):e.func(t)}}},n=function(e){if(e>=t.length)return s();var o=i.body.appendChild(i.createElement("script"));o.src=t[e];var a=!1;o.onload=o.onreadystatechange=function(){a||o.readyState&&"loaded"!=o.readyState&&"complete"!=o.readyState||(a=!0,setTimeout(function(){n(++e)},50))}};n(0)},loadCSSFile:function(t,e,i){if("string"==typeof t){var s=!0;t=[t]}var n,o=t.length,a=[];if(0!=o){if(e||(e=document),i||(i=window),!i.bxhead){var r=e.getElementsByTagName("HEAD");i.bxhead=r[0]}if(i.bxhead){for(n=0;n<o;n++){var l=document.createElement("LINK");l.href=t[n],l.rel="stylesheet",l.type="text/css",i.bxhead.appendChild(l),a.push(l)}return s?l:a}}},appendBXHint:function(t,e){if(t&&t.parentNode&&e){var i=new BXHint(e);t.parentNode.insertBefore(i.oIcon,t),t.parentNode.removeChild(t),i.oIcon.style.marginLeft="5px"}},PreventDefault:function(t){return t||(t=window.event),t.stopPropagation?(t.preventDefault(),t.stopPropagation()):(t.cancelBubble=!0,t.returnValue=!1),!1},CreateElement:function(t,e,i,s){s||(s=document);var n,o=s.createElement(t);if(e)for(n in e)"className"!=n&&"class"!=n?void 0!=e[n]&&null!=e[n]&&o.setAttribute(n,e[n]):(o.setAttribute("class",e[n]),jsUtils.IsIE()&&o.setAttribute("className",e[n]));if(i)for(n in i)o.style[n]=i[n];return o},in_array:function(t,e){for(var i=0;i<e.length;i++)if(e[i]==t)return!0;return!1},htmlspecialchars:function(t){return t.replace?t.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;"):t}},jsFloatDiv=new JCFloatDiv,BXHint=function(t,e,i){this.oDivOver=!1,this.timeOutID=null,this.oIcon=null,this.freeze=!1,this.x=0,this.y=0,this.time=700,t||(t=""),this.Create(t,e,i)};BXHint.prototype.Create=function(t,e,i){var s=this,n=0,o=0,a=null,r="icon";if(this.bWidth=!0,i&&(i.width===!1?this.bWidth=!1:i.width&&(n=i.width),i.height&&(o=i.height),i.className&&(a=i.className),!i.type||"link"!=i.type&&"icon"!=i.type||(r=i.type),i.time>0&&(this.time=i.time)),e&&(r="element"),"icon"==r){var e=document.createElement("IMG");e.src=i&&i.iconSrc?i.iconSrc:"/bitrix/themes/"+phpVars.ADMIN_THEME_ID+"/public/popup/hint.gif",e.ondrag=jsUtils.False}else if("link"==r){var e=document.createElement("A");e.href="",e.onclick=function(t){return!1},e.innerHTML="[?]"}this.element=e,"element"==r?(i&&i.show_on_click?jsUtils.addEvent(e,"click",function(e){e||(e=window.event),s.GetMouseXY(e),s.timeOutID=setTimeout(function(){s.Show(t,n,o,a)},10)}):jsUtils.addEvent(e,"mouseover",function(e){e||(e=window.event),s.GetMouseXY(e),s.timeOutID=setTimeout(function(){s.Show(t,n,o,a)},750)}),jsUtils.addEvent(e,"mouseout",function(t){s.timeOutID&&clearTimeout(s.timeOutID),s.SmartHide(s)})):(this.oIcon=e,e.onmouseover=function(e){e||(e=window.event),s.GetMouseXY(e),s.Show(t,n,o,a)},e.onmouseout=function(){s.SmartHide(s)})},BXHint.prototype.IsFrozen=function(){return this.freeze},BXHint.prototype.Freeze=function(){this.freeze=!0,this.Hide()},BXHint.prototype.UnFreeze=function(){this.freeze=!1},BXHint.prototype.GetMouseXY=function(t){t.pageX||t.pageY?(this.x=t.pageX,this.y=t.pageY):(t.clientX||t.clientY)&&(this.x=t.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft)-document.documentElement.clientLeft,this.y=t.clientY+(document.documentElement.scrollTop||document.body.scrollTop)-document.documentElement.clientTop)},BXHint.prototype.Show=function(t,e,i,s){var n=document.getElementById("__BXHint_div");if(n&&this.Hide(),!this.freeze){var o=this,a=document.body.appendChild(document.createElement("DIV"));a.onmouseover=function(){o.oDivOver=!0},a.onmouseout=function(){o.oDivOver=!1,o.SmartHide(o)},a.id="__BXHint_div",a.className=s?s:"bxhint",a.style.position="absolute",e&&this.bWidth&&(a.style.width=e+"px"),i&&(a.style.height=i+"px"),a.innerHTML=t;var r=a.offsetWidth,l=a.offsetHeight;this.bWidth&&(!e&&r>200&&(r=Math.round(Math.sqrt(1.618*r*l))),a.style.width=r+"px",l=a.offsetHeight);var d={left:this.x+10,right:this.x+r,top:this.y,bottom:this.y+l};d=this.AlignToPos(d,r,l),a.style.zIndex=2100,jsFloatDiv.Show(a,d.left,d.top,3),a=null}},BXHint.prototype.AlignToPos=function(t,e,i){var s=document.body;return s.clientWidth+s.scrollLeft<t.left+e&&(t.left=t.left-e>=0?t.left-e:s.scrollLeft),s.clientHeight+s.scrollTop-t.bottom<0&&(t.top=t.top-i>=0?t.top-i:s.scrollTop),t},BXHint.prototype.Hide=function(){var t=document.getElementById("__BXHint_div");t&&(jsFloatDiv.Close(t),t.parentNode.removeChild(t),t=null)},BXHint.prototype.SmartHide=function(t){setTimeout(function(){t.oDivOver||t.Hide()},100)};var jsSelectUtils={addNewOption:function(t,e,i,s,n){var o="string"==typeof t||t instanceof String?document.getElementById(t):t;if(o){var a=o.length;if(n!==!1)for(var r=0;r<a;r++)if(o[r].value==e)return;var l=new Option(i,e,(!1),(!1));o.options[a]=l}s===!0&&this.sortSelect(t)},deleteOption:function(t,e){var i="string"==typeof t||t instanceof String?document.getElementById(t):t;if(i)for(var s=0;s<i.length;s++)if(i[s].value==e){i.remove(s);break}},deleteSelectedOptions:function(t){var e="string"==typeof t||t instanceof String?document.getElementById(t):t;if(e)for(var i=0;i<e.length;)e[i].selected?(e[i].selected=!1,e.remove(i)):i++},deleteAllOptions:function(t){if(t)for(var e=t.length-1;e>=0;e--)t.remove(e)},optionCompare:function(t,e){var i=t.optText.toLowerCase(),s=e.optText.toLowerCase();return i>s?1:i<s?-1:0},sortSelect:function(t){var e="string"==typeof t||t instanceof String?document.getElementById(t):t;if(e){for(var i=[],s=e.options.length,n=0;n<s;n++)i[n]={optText:e[n].text,optValue:e[n].value};i.sort(this.optionCompare),e.length=0,s=i.length;for(var n=0;n<s;n++){var o=new Option(i[n].optText,i[n].optValue,(!1),(!1));e[n]=o}}},selectAllOptions:function(t){var e="string"==typeof t||t instanceof String?document.getElementById(t):t;if(e)for(var i=e.length,s=0;s<i;s++)e[s].selected=!0},selectOption:function(t,e){var i="string"==typeof t||t instanceof String?document.getElementById(t):t;if(i)for(var s=i.length,n=0;n<s;n++)i[n].selected=i[n].value==e},addSelectedOptions:function(t,e,i,s){if(t)for(var n=t.length,o=0;o<n;o++)t[o].selected&&this.addNewOption(e,t[o].value,t[o].text,s,i)},moveOptionsUp:function(t){if(t)for(var e=t.length,i=0;i<e;i++)if(t[i].selected&&i>0&&0==t[i-1].selected){var s=new Option(t[i].text,t[i].value),n=new Option(t[i-1].text,t[i-1].value);t[i]=n,t[i].selected=!1,t[i-1]=s,t[i-1].selected=!0}},moveOptionsDown:function(t){if(t)for(var e=t.length,i=e-1;i>=0;i--)if(t[i].selected&&i<e-1&&0==t[i+1].selected){var s=new Option(t[i].text,t[i].value),n=new Option(t[i+1].text,t[i+1].value);t[i]=n,t[i].selected=!1,t[i+1]=s,t[i+1].selected=!0}}},phpVars;phpVars||(phpVars={ADMIN_THEME_ID:".default",LANGUAGE_ID:"en",FORMAT_DATE:"DD.MM.YYYY",FORMAT_DATETIME:"DD.MM.YYYY HH:MI:SS",opt_context_ctrl:!1,cookiePrefix:"BITRIX_SM",titlePrefix:"",bitrix_sessid:"",messHideMenu:"",messShowMenu:"",messHideButtons:"",messShowButtons:"",messFilterInactive:"",messFilterActive:"",messFilterLess:"",messLoading:"Loading...",messMenuLoading:"",messMenuLoadingTitle:"",messNoData:"",messExpandTabs:"",messCollapseTabs:"",messPanelFixOn:"",messPanelFixOff:"",messPanelCollapse:"",messPanelExpand:"",messFavAddSucc:"",messFavAddErr:"",messFavDelSucc:"",messFavDelErr:""});var jsAdminChain={_chain:"",AddItems:function(t){var e=document.getElementById("main_navchain");if(e){""==this._chain?this._chain=e.innerHTML:e.innerHTML=this._chain;var i=document.getElementById(t);i&&(e.innerHTML+='<span class="adm-navchain-delimiter"></span>',e.innerHTML+=i.innerHTML)}}},CHttpRequest=new JCHttpRequest,jsUserOptions=new JCUserOptions,jsPanel=new JCPanel,jsDebugWindow=new JCDebugWindow,WizardWindow=new CWizardWindow,jsStartMenu=new JCStartMenu;if(!BXHotKeys){var BXHotKeys=new CBXHotKeys;BXHotKeys.Init(),window.BXHotKeys=BXHotKeys}JCPopup.prototype.addOnClose=function(t){this.onClose[this.onClose.length]=t},JCPopup.prototype.addAdditionalResize=function(t){this.arAdditionalResize[this.arAdditionalResize.length]=document.getElementById(t)},JCPopup.prototype.clearAdditionalResize=function(){this.arAdditionalResize=[]},JCPopup.prototype.DenyClose=function(t){t!==!1&&(t=!0),this.bDenyClose=t,this.obSaveButton||(this.obSaveButton=document.getElementById("btn_popup_save"+this.suffix),this.obCloseButton=document.getElementById("btn_popup_close"+this.suffix),this.obCancelButton=document.getElementById("btn_popup_cancel"+this.suffix)),this.obSaveButton&&(this.obSaveButton.disabled=t),this.obCloseButton&&(this.obCloseButton.disabled=t),this.obCancelButton&&(this.obCancelButton.disabled=t)},JCPopup.prototype.AllowClose=function(){this.DenyClose(!1)},JCPopup.prototype.__OnKeyPress=function(t){this.bDenyEscKey||(t||(t=window.event),t&&(this.bDenyClose||27==t.keyCode&&(jsUtils.removeEvent(document,"keypress",window["JCPopup_OnKeyPress"+this.suffix]),this.CloseDialog())))},JCPopup.prototype.AjaxAction=function(t){CloseWaitWindow(),this.suffix&&(jsPopup.bDenyClose=!0);var e=document.body.appendChild(document.createElement("DIV"));e.id=this.div_id,e.className=this.class_name,e.style.position="absolute",e.style.zIndex=this.zIndex,e.innerHTML=t,null!=this.arParams.height&&(e.style.height=this.arParams.height+"px"),null!=this.arParams.width&&(e.style.width=this.arParams.width+"px");var i=jsUtils.GetWindowInnerSize(),s=jsUtils.GetWindowScrollPos(),n=parseInt(s.scrollLeft+i.innerWidth/2-e.offsetWidth/2),o=parseInt(s.scrollTop+i.innerHeight/2-e.offsetHeight/2);if(jsFloatDiv.Show(e,n,o,5,!0),jsUtils.addEvent(document,"keypress",window["JCPopup_OnKeyPress"+this.suffix]),this.div=e,this.div_inner=document.getElementById("bx_popup_content"+this.suffix),this.div_inner&&(this.div.style.width&&(this.div_inner.style.width=parseInt(parseInt(this.div.style.width)-12)+"px"),this.div.style.height)){for(var a=["bx_popup_title","bx_popup_description_container","bx_popup_buttons"],r=0,l=0;l<a.length;l++){var d=document.getElementById(a[l]+this.suffix);d&&(r+=d.offsetHeight)}this.div_inner.style.height=parseInt(parseInt(this.div.style.height)-r-16)+"px"}var h=this;return setTimeout(function(){h.AdjustShadow()},10),this.arParams.resize&&null!=this.div&&null!=this.div_inner&&this.createResizer(),e},JCPopup.prototype.__AjaxPostAction=function(t){CloseWaitWindow(),this.suffix&&(jsPopup.bDenyClose=!0),this.div.innerHTML=t,this.div_inner=document.getElementById("bx_popup_content"+this.suffix),this.AdjustShadow(),this.arParams.resize&&null!=this.div&&null!=this.div_inner&&this.createResizer()},JCPopup.prototype.ShowDialog=function(t,e){document.getElementById(this.div_id)&&this.CloseDialog(),e||(e={}),null==e.resize&&(e.resize=!0),e.min_width||(e.min_width=250),e.min_height||(e.min_height=200);var i=t.indexOf("?");if(i==-1?t+="?mode=public":t=t.substring(0,i)+"?mode=public&"+t.substring(i+1),this.check_url=i==-1?t:t.substring(0,i),e.resize&&null!=this.__arRuntimeResize[this.check_url]){e.width=this.__arRuntimeResize[this.check_url].width,e.height=this.__arRuntimeResize[this.check_url].height;var s=t.indexOf("bxpiheight");s==-1?t+=(i==-1?"?":"&")+"bxpiheight="+this.__arRuntimeResize[this.check_url].iheight:t=t.substring(0,s)+"bxpiheight="+this.__arRuntimeResize[this.check_url].iheight}this.url=t,this.arParams=e,this.CreateOverlay(),jsExtLoader.onajaxfinish=window["JCPopup_AjaxAction"+this.suffix],e.postData?jsExtLoader.startPost(t,e.postData):jsExtLoader.start(t);
},JCPopup.prototype.RemoveOverlay=function(){this.overlay&&this.overlay.parentNode.removeChild(this.overlay),jsUtils.removeEvent(window,"resize",window["JCPopup_OverlayResize"+this.suffix])},JCPopup.prototype.OverlayResize=function(){if(this.overlay){var t=jsUtils.GetWindowScrollSize();this.overlay.style.width=t.scrollWidth+"px"}},JCPopup.prototype.CreateOverlay=function(){var t=new COpacity;if(t.GetOpacityProperty()){this.overlay=document.body.appendChild(document.createElement("DIV")),this.overlay.className="bx-popup-overlay",this.overlay.id=this.overlay_id,this.overlay.style.zIndex=this.zIndex-5;var e=jsUtils.GetWindowScrollSize();this.overlay.style.width=e.scrollWidth+"px",this.overlay.style.height=e.scrollHeight+"px",jsUtils.addEvent(window,"resize",window["JCPopup_OverlayResize"+this.suffix])}},JCPopup.prototype.CloseDialog=function(){jsUtils.onCustomEvent("OnBeforeCloseDialog",this.suffix);for(var t=0;t<this.onClose.length;t++)this.onClose[t]();if(this.bDenyClose)return!1;this.suffix&&(jsPopup.bDenyClose=!1),jsUtils.removeEvent(document,"keypress",window["JCPopup_OnKeyPress"+this.suffix]);var e=document.getElementById(this.div_id);return e?(jsFloatDiv.Close(e),e.parentNode.removeChild(e),this.clearAdditionalResize(),this.RemoveOverlay(),!0):void 0},JCPopup.prototype.GetParameters=function(t){if(null==t)var e=document.forms[this.form_name];else var e=document.forms[t];if(!e)return"";var i,s="",n=e.elements.length,o="";for(i=0;i<n;i++){""!=s&&(o="&");var a=e.elements[i];if(!a.disabled)switch(a.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==t&&"_alt"==a.name.substr(a.name.length-4)&&e.elements[a.name.substr(0,a.name.length-4)])break;s+=o+a.name+"="+encodeURIComponent(a.value);break;case"radio":a.checked&&(s+=o+a.name+"="+encodeURIComponent(a.value));break;case"checkbox":s+=o+a.name+"="+encodeURIComponent(a.checked?"Y":"N");break;case"select-one":var r="";r=null==t&&e.elements[a.name+"_alt"]&&0==a.selectedIndex?e.elements[a.name+"_alt"].value:a.value,s+=o+a.name+"="+encodeURIComponent(r);break;case"select-multiple":var l,d=!1,h=a.options.length;for(l=0;l<h;l++)a.options[l].selected&&(s+=o+a.name+"="+encodeURIComponent(a.options[l].value),d=!0);d||(s+=o+a.name+"=")}}if(null!=this.arParams&&this.arParams.resize&&this.div_inner){var c=parseInt(this.div_inner.style.width),p=parseInt(this.div_inner.style.height);c>0&&(s+="&bxpiwidth="+c),p>0&&(s+="&bxpiheight="+p)}return s},JCPopup.prototype.PostParameters=function(t){jsExtLoader.onajaxfinish=window["JCPopup_AjaxPostAction"+this.suffix],ShowWaitWindow();var e=this.url;null!=t&&(index=e.indexOf("?"),index==-1?e+="?"+t:e=e.substring(0,index)+"?"+t+"&"+e.substring(index+1)),jsExtLoader.startPost(e,this.GetParameters())},JCPopup.prototype.AdjustShadow=function(){this.div&&jsFloatDiv.AdjustShadow(this.div)},JCPopup.prototype.HideShadow=function(){this.div&&jsFloatDiv.HideShadow(this.div)},JCPopup.prototype.UnhideShadow=function(){this.div&&jsFloatDiv.UnhideShadow(this.div)},JCPopup.prototype.DragPanel=function(t,e){var i=jsUtils.FindParentObject(e,"div");i.style.left=i.offsetLeft+"px",i.style.top=i.offsetTop+"px",jsFloatDiv.StartDrag(t,i)},JCPopup.prototype.createResizer=function(){this.diff_x=null,this.diff_y=null,this.arPos=jsUtils.GetRealPos(this.div);var t=parseInt(jsUtils.GetStyleValue(this.div,jsUtils.IsIE()?"zIndex":"z-index"))+1;this.obResizer=document.createElement("DIV"),this.obResizer.className="bxresizer",this.obResizer.style.position="absolute",this.obResizer.style.zIndex=t,this.obResizer.onmousedown=window["JCPopup_startResize"+this.suffix],this.div.appendChild(this.obResizer)},JCPopup.prototype.startResize=function(t){t||(t=window.event),this.wndSize=jsUtils.GetWindowScrollPos(),this.wndSize.innerWidth=jsUtils.GetWindowInnerSize().innerWidth,this.x=t.clientX+this.wndSize.scrollLeft,this.y=t.clientY+this.wndSize.scrollTop,this.obDescr=document.getElementById("bx_popup_description_container"+this.suffix),jsUtils.IsIE()?(this.arPos=this.div.getBoundingClientRect(),this.arPos={left:this.arPos.left+this.wndSize.scrollLeft,top:this.arPos.top+this.wndSize.scrollTop,right:this.arPos.right+this.wndSize.scrollLeft,bottom:this.arPos.bottom+this.wndSize.scrollTop},this.arPosInner=this.div_inner.getBoundingClientRect(),this.arPosInner={left:this.arPosInner.left+this.wndSize.scrollLeft,top:this.arPosInner.top+this.wndSize.scrollTop,right:this.arPosInner.right+this.wndSize.scrollLeft,bottom:this.arPosInner.bottom+this.wndSize.scrollTop}):(this.arPos=jsUtils.GetRealPos(this.div),this.arPosInner=jsUtils.GetRealPos(this.div_inner)),document.onmouseup=window["JCPopup_stopResize"+this.suffix],jsUtils.addEvent(document,"mousemove",window["JCPopup_doResize"+this.suffix]),document.body.setCapture&&document.body.setCapture();var e=document.body;e.ondrag=jsUtils.False,e.onselectstart=jsUtils.False,e.style.MozUserSelect=this.div.style.MozUserSelect="none",e.style.cursor=this.obResizer.style.cursor,this.HideShadow()},JCPopup.prototype.doResize=function(t){t||(t=window.event);var e=t.clientX+this.wndSize.scrollLeft,i=t.clientY+this.wndSize.scrollTop;this.x==e&&this.y==i||e>this.wndSize.innerWidth+this.wndSize.scrollLeft-10||(this.Resize(e,i),this.x=e,this.y=i)},JCPopup.prototype.Resize=function(t,e){if(null==this.diff_x&&(this.diff_x=this.div.offsetWidth-this.div_inner.offsetWidth,this.diff_y=this.div.offsetHeight-this.div_inner.offsetHeight,this.arAdditionalResize.length>0))for(var i=0,s=this.arAdditionalResize.length;i<s;i++)if(null!=this.arAdditionalResize[i]){var n=jsUtils.IsOpera()?0:parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[i],jsUtils.IsIE()?"borderLeftWidth":"border-left-width"))+parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[i],jsUtils.IsIE()?"borderRightWidth":"border-right-width")),o=jsUtils.IsOpera()||jsUtils.IsIE()?0:parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[i],"border-top-width"))+parseInt(jsUtils.GetStyleValue(this.arAdditionalResize[i],"border-bottom-width"));this.arAdditionalResize[i].diff_x=this.div.offsetWidth-this.arAdditionalResize[i].offsetWidth+n,this.arAdditionalResize[i].diff_y=this.div.offsetHeight-this.arAdditionalResize[i].offsetHeight+o}var a=t-this.arPos.left,r=e-this.arPos.top;a-this.div.offsetWidth;if(null!=this.obDescr)var l=this.obDescr.offsetHeight;var d=!1;if(a>this.arParams.min_width&&(d=!0,this.div.style.width=a+"px",this.div_inner.style.width=a-this.diff_x+"px"),null!=this.obDescr)var h=this.obDescr.offsetHeight-l;else var h=0;this.diff_y+=h;var c=!1;if(r>this.arParams.min_height&&(c=!0,this.div_inner.style.height=r-this.diff_y+"px",this.div.style.height=r+"px"),this.arAdditionalResize.length>0)for(var i=0,s=this.arAdditionalResize.length;i<s;i++)null!=this.arAdditionalResize[i]&&(c&&(this.arAdditionalResize[i].style.height=r-this.arAdditionalResize[i].diff_y+"px"),d&&(this.arAdditionalResize[i].style.width=a-this.arAdditionalResize[i].diff_x+"px"));jsUtils.IsIE()&&this.AdjustShadow()},JCPopup.prototype.stopResize=function(){document.body.releaseCapture&&document.body.releaseCapture(),jsUtils.removeEvent(document,"mousemove",window["JCPopup_doResize"+this.suffix]),document.onmouseup=null;var t=document.body;t.ondrag=null,t.onselectstart=null,t.style.MozUserSelect=this.div.style.MozUserSelect="",t.style.cursor="",this.UnhideShadow(),this.AdjustShadow(),this.SavePosition()},JCPopup.prototype.SavePosition=function(){var t={width:parseInt(this.div.style.width),height:parseInt(this.div.style.height),iheight:parseInt(this.div_inner.style.height)};null!=this.error_dy&&(t.iheight+=this.error_dy),jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,"width",t.width),jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,"height",t.height),jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,"iheight",t.iheight);for(var e=0,i=this.arAdditionalResize.length;e<i;e++)null!=this.arAdditionalResize[e]&&null!=this.arAdditionalResize[e].BXResizeCacheID&&(jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,this.arAdditionalResize[e].BXResizeCacheID+"_height",parseInt(this.arAdditionalResize[e].style.height)),jsUserOptions.SaveOption("jsPopup"+this.suffix,"size_"+this.check_url,this.arAdditionalResize[e].BXResizeCacheID+"_width",parseInt(this.arAdditionalResize[e].style.width)));this.__arRuntimeResize[this.check_url]=t},JCPopup.prototype.IncludePrepare=function(){var t=window.frames.editor;if(null==t)return!1;var e=t.document.forms.inner_form,i=document.forms[this.form_name];return null!=e&&null!=i&&(i.include_data.value=e.filesrc_pub.value,!0)},JCPopup.prototype.ShowError=function(t){if(CloseWaitWindow(),this.AllowClose(),this.obDescr=document.getElementById("bx_popup_description_container"+this.suffix),null!=this.obDescr){var e=this.obDescr.offsetHeight,i=document.getElementById("bx_popup_description_error"+this.suffix);i||(i=document.createElement("P"),i.id="bx_popup_description_error"+this.suffix,this.obDescr.firstChild.appendChild(i)),i.innerHTML='<font class="errortext">'+t+"</font>",this.obDescr.offsetHeight!=e&&(this.error_dy=this.obDescr.offsetHeight-e,this.div_inner&&(this.div_inner.style.height=parseInt(jsUtils.GetStyleValue(this.div_inner,"height"))-this.error_dy+"px"))}else alert(t)},JCComponentUtils.prototype.ClearCache=function(t){CHttpRequest.Action=function(t){window.location=window.location.href},ShowWaitWindow(),CHttpRequest.Send("/bitrix/admin/clear_component_cache.php?"+t)},JCComponentUtils.prototype.EnableComponent=function(t){CHttpRequest.Action=function(t){window.location=window.location.href},ShowWaitWindow(),CHttpRequest.Send("/bitrix/admin/enable_component.php?"+t)},COpacity.prototype.SetElementOpacity=function(t){if(!this.opacityProperty)return!1;if("filter"==this.opacityProperty){t=100*t;var e=this.element.filters["DXImageTransform.Microsoft.alpha"]||this.element.filters.alpha;e?e.opacity=t:this.element.style.filter+="progid:DXImageTransform.Microsoft.Alpha(opacity="+t+")"}else this.element.style[this.opacityProperty]=t;return!0},COpacity.prototype.GetOpacityProperty=function(){var t;return"string"==typeof document.body.style.opacity?"opacity":"string"==typeof document.body.style.MozOpacity?"MozOpacity":"string"==typeof document.body.style.KhtmlOpacity?"KhtmlOpacity":!!(document.body.filters&&(t=navigator.appVersion.match(/MSIE ([\d.]+)/))&&t[1]>=5.5)&&"filter"},COpacity.prototype.Fading=function(t,e,i){if(this.opacityProperty){this.startOpacity=t,this.finishOpacity=e,this.currentOpacity=this.startOpacity,this.fadingTimeoutID&&clearInterval(this.fadingTimeoutID);var s=this;this.fadingTimeoutID=setInterval(function(){s.Run(i)},this.delay)}},COpacity.prototype.Run=function(t){this.currentOpacity=Math.round(10*(this.currentOpacity+.1*(this.finishOpacity-this.startOpacity>0?1:-1)))/10,this.SetElementOpacity(this.currentOpacity),this.currentOpacity!=this.startOpacity&&this.currentOpacity!=this.finishOpacity||(clearInterval(this.fadingTimeoutID),"function"==typeof t&&t(this))},COpacity.prototype.Undo=function(){};var jsExtLoader={obContainer:null,obContainerInner:null,jsPopup_name:"jsPopup",url:"",httpRequest:null,httpRequest2:null,obTemporary:null,onajaxfinish:null,obFrame:null,start:function(t){this.url=t,this.obContainer=null,ShowWaitWindow(),this.httpRequest=this._CreateHttpObject(),this.httpRequest.onreadystatechange=jsExtLoader.stepOne,this.httpRequest.open("GET",this.url,!0),this.httpRequest.send("")},startPost:function(t,e){this.url=t,this.obContainer=null,ShowWaitWindow(),this.httpRequest=this._CreateHttpObject(),this.httpRequest.onreadystatechange=jsExtLoader.stepOne,this.httpRequest.open("POST",this.url,!0),this.httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.httpRequest.send(e)},post:function(t){var e=document.forms[t];null!=e&&(null==this.obFrame&&(jsUtils.IsIE()?this.obFrame=document.createElement('<iframe src="javascript:void(0)" name="frame_'+t+'">'):(this.obFrame=document.createElement("IFRAME"),this.obFrame.name="frame_"+t,this.obFrame.src="javascript:void(0)"),this.obFrame.style.display="none",document.body.appendChild(this.obFrame)),e.target=this.obFrame.name,e.action.length<=0&&(e.action=this.url),window[jsExtLoader.jsPopup_name].DenyClose(),ShowWaitWindow(),e.save.click(),!1===e.BXReturnValue&&(window[jsExtLoader.jsPopup_name].AllowClose(),CloseWaitWindow()),e.BXReturnValue=!0)},urlencode:function(t){return escape(t).replace(new RegExp("\\+","g"),"%2B")},__prepareOnload:function(){this.obTemporary=window.onload,window.onload=null},__runOnload:function(){window.onload&&window.onload(),window.onload=this.obTemporary,this.obTemporary=null},stepOne:function(){if(4==jsExtLoader.httpRequest.readyState){for(var t,e=jsExtLoader.httpRequest.responseText,i=[],s=new RegExp("<script([^>]*)>","i"),n=new RegExp("src=[\"']([^\"']+)[\"']","i");null!==(t=e.match(s));){var o=e.search("</script>","i");if(o==-1)break;var a,r="-1"!=t[1].indexOf("bxrunfirst");if(null!==(a=t[1].match(n)))i[i.length]={bRunFirst:r,isInternal:!1,JS:a[1]};else{var l=t.index+t[0].length,d=e.substr(l,o-l);i[i.length]={bRunFirst:r,isInternal:!0,JS:d}}e=e.substr(0,t.index)+e.substr(o+9)}jsExtLoader.__prepareOnload(),jsExtLoader.processResult(e,i),CloseWaitWindow(),jsExtLoader.__runOnload()}},EvalGlobal:function(t){window.execScript?window.execScript(t,"javascript"):jsUtils.IsSafari()?window.setTimeout(t,0):window.eval(t)},arLoadedScripts:[],__isScriptLoaded:function(t){for(var e=0;e<jsExtLoader.arLoadedScripts.length;e++)if(jsExtLoader.arLoadedScripts[e]==t)return!0;return!1},EvalExternal:function(t){if(!/\/bitrix\/js\/main\/public_tools.js$/i.test(t)&&!jsExtLoader.__isScriptLoaded(t)){if(jsExtLoader.arLoadedScripts.push(t),"/bitrix/"!=t.substring(0,8)&&(t="/bitrix/admin/"+t),jsUtils.IsOpera()){null==this.httpRequest2&&(this.httpRequest2=this._CreateHttpObject());var e=this.httpRequest2}else var e=this.httpRequest;e.onreadystatechange=function(t){},e.open("GET",t,!1),e.send("");var i=e.responseText;e=null;try{this.EvalGlobal(i)}catch(s){}}},processResult:function(t,e){jsExtLoader.processScripts(e,!0),null==jsExtLoader.obContainer?jsExtLoader.obContainer=jsExtLoader.onajaxfinish(t):jsExtLoader.obContainer.innerHTML=t,jsExtLoader.processScripts(e,!1)},processScripts:function(t,e){for(var i=0,s=t.length;i<s;i++)t[i].bRunFirst==e&&(t[i].isInternal?(t[i].JS=t[i].JS.replace("<!--",""),jsExtLoader.EvalGlobal(t[i].JS)):jsExtLoader.EvalExternal(t[i].JS))},_CreateHttpObject:function(){var t=null;if(window.XMLHttpRequest)try{t=new XMLHttpRequest}catch(e){}else if(window.ActiveXObject){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}if(!t)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}return t}},jsAdminStyle={arCSS:{},bInited:!1,httpRequest:null,Init:function(){var t=document.getElementsByTagName("LINK");if(t.length>0)for(var e=0;e<t.length;e++)if(t[e].href){var i=t[e].href,s=i.indexOf("://");s!=-1&&(i=i.substr(i.indexOf("/",s+3))),t[e].bxajaxflag=!1,this.arCSS[i]=t[e]}this.bInited=!0},Load:function(t){if(this.bInited||this.Init(),null!=this.arCSS[t])return void(this.arCSS[t].disabled=!1);var e=document.createElement("STYLE");e.type="text/css";var i=document.getElementsByTagName("HEAD")[0];if(i.insertBefore(e,i.firstChild),jsUtils.IsIE())e.styleSheet.addImport(t);else try{null==this.httpRequest&&(this.httpRequest=jsExtLoader._CreateHttpObject()),this.httpRequest.onreadystatechange=null,this.httpRequest.open("GET",t,!1),this.httpRequest.send("");var s=this.httpRequest.responseText,n=t.lastIndexOf("/");if(n!=-1){var o=t.substring(0,n);s=s.replace(/url\(([^\/\\].*?)\)/gi,"url("+o+"/$1)")}e.appendChild(document.createTextNode(s))}catch(a){}},Unload:function(t){this.bInited||this.Init(),null!=this.arCSS[t]&&(this.arCSS[t].disabled=!0)},UnloadAll:function(){if(this.bInited)for(var t in this.arCSS)this.arCSS[t].bxajaxflag&&this.Unload(t);else this.Init()}};[].pop||(Array.prototype.pop=function(){if(this.length<=0)return!1;var t=this[this.length-1];return delete this[this.length-1],this.length--,t},Array.prototype.shift=function(){if(this.length<=0)return!1;var t=this.reverse(),e=t.pop();return this.prototype=t.reverse(),e},Array.prototype.push=function(t){this[this.length]=t}),jsWizard.prototype.AddStep=function(t,e){var i=document.getElementById(t);if(i){"object"!=typeof e&&(e={}),this.arSteps[t]={element:i};for(var s in e)this.arSteps[t][s]=e[s];null===this.firstStep&&(this.firstStep=t)}},jsWizard.prototype.SetCurrentStep=function(t){this.currentStep=t},jsWizard.prototype.SetFirstStep=function(t){this.firstStep=t},jsWizard.prototype.SetNextButtonID=function(t){this.nextButtonID=t},jsWizard.prototype.SetPrevButtonID=function(t){this.prevButtonID=t},jsWizard.prototype.SetFinishButtonID=function(t){this.finishButtonID=t},jsWizard.prototype.SetCancelButtonID=function(t){this.cancelButtonID=t},jsWizard.prototype.SetButtonDisabled=function(t,e){this.arButtons[t]&&(this.arButtons[t].disabled=e)},jsWizard.prototype.IsStepExists=function(t){return!!this.arSteps[t]},jsWizard.prototype.Display=function(){if(null!==this.firstStep){this.currentStep=this.firstStep;var t=this,e={next:this.nextButtonID,prev:this.prevButtonID,finish:this.finishButtonID};for(var i in e){var s=document.getElementById(e[i]);s&&"INPUT"==s.tagName?(s.buttonID=i,s.onclick=function(){t._OnButtonClick(this.buttonID)},this.arButtons[i]=s):this.arButtons[i]=null}this._OnStepShow()}},jsWizard.prototype._OnButtonClick=function(t){if(this.arSteps[this.currentStep]){var e=this.arSteps[this.currentStep]["on"+t];if(e&&"function"==typeof e&&e(this)===!1)return}if(this.arSteps[this.currentStep])this.arSteps[this.currentStep][t]&&(this.currentStep=this.arSteps[this.currentStep][t]);else{if(!this.arSteps[this.firstStep])return;this.currentStep=this.firstStep}this._OnStepShow()},jsWizard.prototype._OnStepShow=function(){for(var t in this.arSteps)this.arSteps[t].element.style.display=t==this.currentStep?"":"none";for(var e in this.arButtons)if(this.arButtons[e]){var t=this.arSteps[this.currentStep][e];this.arButtons[e].disabled=!t||!this.arSteps[t]}if(this.arSteps[this.currentStep]){var i=this.arSteps[this.currentStep].onshow;i&&"function"==typeof i&&i(this)}};var jsPopup=new JCPopup,jsComponentUtils=new JCComponentUtils,bxAuthWnd=!1;!function(){if(!BX.date){BX.date={},BX.date.format=function(t,e,i,s){function n(t,e,i,s){for(var n=b((i-e)/1e3),l=0;l<t.length;l++){var d=t[l][0],h=t[l][1],c=null;if("s"==d){if(n<60)return BX.date.format(h,e,i,s)}else if(null!=(c=/^s(\d+)/.exec(d))){if(n<c[1])return BX.date.format(h,e,i,s)}else if("i"==d){if(n<3600)return BX.date.format(h,e,i,s)}else if(null!=(c=/^i(\d+)/.exec(d))){if(n<60*c[1])return BX.date.format(h,e,i,s)}else if("H"==d){if(n<86400)return BX.date.format(h,e,i,s)}else if(null!=(c=/^H(\d+)/.exec(d))){if(n<60*c[1]*60)return BX.date.format(h,e,i,s)}else if("d"==d){if(n<2678400)return BX.date.format(h,e,i,s)}else if(null!=(c=/^d(\d+)/.exec(d))){if(n<60*c[1]*60)return BX.date.format(h,e,i,s)}else if("m"==d){if(n<31536e3)return BX.date.format(h,e,i,s)}else if(null!=(c=/^m(\d+)/.exec(d))){if(n<31*c[1]*24*60*60)return BX.date.format(h,e,i,s)}else if("today"==d){var p=o(i),u=r(i),m=a(i),f=s?new Date(Date.UTC(p,u,m,0,0,0,0)):new Date(p,u,m,0,0,0,0),_=s?new Date(Date.UTC(p,u,m+1,0,0,0,0)):new Date(p,u,m+1,0,0,0,0);if(e>=f&&e<_)return BX.date.format(h,e,i,s)}else if("yesterday"==d){p=o(i),u=r(i),m=a(i);var v=s?new Date(Date.UTC(p,u,m-1,0,0,0,0)):new Date(p,u,m-1,0,0,0,0),y=s?new Date(Date.UTC(p,u,m,0,0,0,0)):new Date(p,u,m,0,0,0,0);if(e>=v&&e<y)return BX.date.format(h,e,i,s)}else if("tommorow"==d){p=o(i),u=r(i),m=a(i);var B=s?new Date(Date.UTC(p,u,m+1,0,0,0,0)):new Date(p,u,m+1,0,0,0,0),g=s?new Date(Date.UTC(p,u,m+2,0,0,0,0)):new Date(p,u,m+2,0,0,0,0);if(e>=B&&e<g)return BX.date.format(h,e,i,s)}else if("-"==d&&n<0)return BX.date.format(h,e,i,s)}return t.length>0?BX.date.format(t.pop()[1],e,i,s):""}function o(t){return B?t.getUTCFullYear():t.getFullYear()}function a(t){return B?t.getUTCDate():t.getDate()}function r(t){return B?t.getUTCMonth():t.getMonth()}function l(t){return B?t.getUTCHours():t.getHours()}function d(t){return B?t.getUTCMinutes():t.getMinutes()}function h(t){return B?t.getUTCSeconds():t.getSeconds()}function c(t){return B?t.getUTCMilliseconds():t.getMilliseconds()}function p(t){return B?t.getUTCDay():t.getDay()}function u(t,e){return B?t.setUTCDate(e):t.setDate(e)}function m(t,e,i){return B?t.setUTCMonth(e,i):t.setMonth(e,i)}function f(t,e){var i=t<100?Math.abs(t):Math.abs(t%100),s=i%10,n="";return n=0==i?BX.message(e[0]):1==i?BX.message(e[1]):i>=10&&i<=20?BX.message(e["10_20"]):1==s?BX.message(e.MOD_1):2<=s&&s<=4?BX.message(e.MOD_2_4):BX.message(e.MOD_OTHER),n.replace(/#VALUE#/g,t)}function _(t,e){return S[t]?S[t]():e}function b(t){return t>=0?Math.floor(t):Math.ceil(t)}var v=BX.type.isDate(e)?new Date(e.getTime()):BX.type.isNumber(e)?new Date(1e3*e):new Date,y=BX.type.isDate(i)?new Date(i.getTime()):BX.type.isNumber(i)?new Date(1e3*i):new Date,B=!!s;if(BX.type.isArray(t))return n(t,v,y,B);if(!BX.type.isNotEmptyString(t))return"";var g=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|yesterday|today|tommorow|[a-z])/gi,S={d:function(){return BX.util.str_pad_left(a(v).toString(),2,"0")},D:function(){return BX.message("DOW_"+p(v))},j:function(){return a(v)},l:function(){return BX.message("DAY_OF_WEEK_"+p(v))},N:function(){return p(v)||7},S:function(){return a(v)%10==1&&11!=a(v)?"st":a(v)%10==2&&12!=a(v)?"nd":a(v)%10==3&&13!=a(v)?"rd":"th"},w:function(){return p(v)},z:function(){var t=new Date(o(v),0,1),e=new Date(o(v),r(v),a(v));return Math.ceil((e-t)/864e5)},W:function(){var t=new Date(v.getTime()),e=(p(v)+6)%7;u(t,a(t)-e+3);var i=t.getTime();m(t,0,1),4!=p(t)&&m(t,0,1+(4-p(t)+7)%7);var s=1+Math.ceil((i-t)/6048e5);return BX.util.str_pad_left(s.toString(),2,"0")},F:function(){return BX.message("MONTH_"+(r(v)+1)+"_S")},f:function(){return BX.message("MONTH_"+(r(v)+1))},m:function(){return BX.util.str_pad_left((r(v)+1).toString(),2,"0")},M:function(){return BX.message("MON_"+(r(v)+1))},n:function(){return r(v)+1},t:function(){var t=B?new Date(Date.UTC(o(v),r(v)+1,0)):new Date(o(v),r(v)+1,0);return a(t)},L:function(){var t=o(v);return t%4==0&&t%100!=0||t%400==0?1:0},o:function(){var t=new Date(v.getTime());return u(t,a(t)-(p(v)+6)%7+3),o(t)},Y:function(){return o(v)},y:function(){return o(v).toString().slice(2)},a:function(){return l(v)>11?"pm":"am"},A:function(){return l(v)>11?"PM":"AM"},B:function(){var t=(v.getUTCHours()+1)%24+v.getUTCMinutes()/60+v.getUTCSeconds()/3600;return BX.util.str_pad_left(Math.floor(1e3*t/24).toString(),3,"0")},g:function(){return l(v)%12||12},G:function(){return l(v)},h:function(){return BX.util.str_pad_left((l(v)%12||12).toString(),2,"0")},H:function(){return BX.util.str_pad_left(l(v).toString(),2,"0")},i:function(){return BX.util.str_pad_left(d(v).toString(),2,"0")},s:function(){return BX.util.str_pad_left(h(v).toString(),2,"0")},u:function(){return BX.util.str_pad_left((1e3*c(v)).toString(),6,"0")},e:function(){return B?"UTC":""},I:function(){if(B)return 0;var t=new Date(o(v),0,1),e=Date.UTC(o(v),0,1),i=new Date(o(v),6,0),s=Date.UTC(o(v),6,0);return 0+(t-e!==i-s)},O:function(){if(B)return"+0000";var t=v.getTimezoneOffset(),e=Math.abs(t);return(t>0?"-":"+")+BX.util.str_pad_left((100*Math.floor(e/60)+e%60).toString(),4,"0")},P:function(){if(B)return"+00:00";var t=this.O();return t.substr(0,3)+":"+t.substr(3)},Z:function(){return B?0:60*-v.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(g,_)},r:function(){return"D, d M Y H:i:s O".replace(g,_)},U:function(){return Math.floor(v.getTime()/1e3)},sago:function(){return f(b((y-v)/1e3),{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function(){return f(b((y-v)/1e3),{0:"FD_SECOND_DIFF_0",1:"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},iago:function(){return f(b((y-v)/60/1e3),{0:"FD_MINUTE_AGO_0",1:"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function(){return f(b((y-v)/60/1e3),{0:"FD_MINUTE_DIFF_0",1:"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function(){var t=b((y-v)/60/1e3),e=f(t,{0:"FD_MINUTE_0",1:"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});e+=" ";var i=b((y-v)/1e3)-60*t;return e+=f(i,{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},Hago:function(){return f(b((y-v)/60/60/1e3),{0:"FD_HOUR_AGO_0",1:"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function(){return f(b((y-v)/60/60/1e3),{0:"FD_HOUR_DIFF_0",1:"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},yesterday:function(){return BX.message("FD_YESTERDAY")},today:function(){return BX.message("FD_TODAY")},tommorow:function(){return BX.message("FD_TOMORROW")},dago:function(){return f(b((y-v)/60/60/24/1e3),{0:"FD_DAY_AGO_0",1:"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function(){return f(b((y-v)/60/60/24/1e3),{0:"FD_DAY_DIFF_0",1:"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},mago:function(){return f(b((y-v)/60/60/24/31/1e3),{0:"FD_MONTH_AGO_0",1:"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function(){return f(b((y-v)/60/60/24/31/1e3),{0:"FD_MONTH_DIFF_0",1:"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},Yago:function(){return f(b((y-v)/60/60/24/365/1e3),{0:"FD_YEARS_AGO_0",1:"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function(){return f(b((y-v)/60/60/24/365/1e3),{0:"FD_YEARS_DIFF_0",1:"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},x:function(){return BX.date.format([["tommorow","tommorow, H:i"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")],["s","sago"],["i","iago"],["today","today, H:i"],["yesterday","yesterday, H:i"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")]],v,y,B)},X:function(){var t=BX.date.format([["tommorow","tommorow"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))]],v,y,B),e=BX.date.format([["tommorow","H:i"],["today","H:i"],["yesterday","H:i"],["",""]],v,y,B);return e.length>0?BX.message("FD_DAY_AT_TIME").replace(/#DAY#/g,t).replace(/#TIME#/g,e):t},Q:function(){var t=b((y-v)/60/60/24/1e3);return 0==t?BX.message("FD_DAY_DIFF_1").replace(/#VALUE#/g,1):BX.date.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],v,y)}},x=!1;t[0]&&"^"==t[0]&&(x=!0,t=t.substr(1));var X=t.replace(g,_);return x&&(X=X.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")),X},BX.date.convertBitrixFormat=function(t){return BX.type.isNotEmptyString(t)?t.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a"):""},BX.date.convertToUTC=function(t){return BX.type.isDate(t)?new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())):null},BX.date.getNewDate=function(t){return new Date(BX.date.getBrowserTimestamp(t))},BX.date.getBrowserTimestamp=function(t){return void 0==this._browserOffset&&(this._browserOffset=60*(new Date).getTimezoneOffset()),1e3*(parseInt(t,10)+parseInt(BX.message("SERVER_TZ_OFFSET"))+this._browserOffset)},BX.date.getServerTimestamp=function(t){return void 0==this._browserOffset&&(this._browserOffset=60*(new Date).getTimezoneOffset()),Math.round(t/1e3-(parseInt(BX.message("SERVER_TZ_OFFSET"),10)+parseInt(this._browserOffset,10)))};var t=null;BX.calendar=function(t){return BX.calendar.get().Show(t)},BX.calendar.get=function(){return t||(t=new BX.JCCalendar),t},BX.calendar.InsertDaysBack=function(t,e){if(""!=e){var i=new Date;e>0&&i.setTime(i.valueOf()-864e5*e),t.value=BX.date.format(BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")),i,null,!0)}else t.value=""},BX.calendar.ValueToString=function(t,e,i){return BX.date.format(BX.date.convertBitrixFormat(BX.message(e?"FORMAT_DATETIME":"FORMAT_DATE")),t,null,!!i)},BX.CalendarPeriod={Init:function(t,e,i){""==t.value&&""==e.value||""!=i.value||(i.value="interval"),i.onchange()},ChangeDirectOpts:function(t,e){var i=BX.findChild(e,{className:"adm-select adm-calendar-direction"},!0);"week"==t?(i.options[0].text=BX.message("JSADM_CALEND_PREV_WEEK"),i.options[1].text=BX.message("JSADM_CALEND_CURR_WEEK"),i.options[2].text=BX.message("JSADM_CALEND_NEXT_WEEK")):(i.options[0].text=BX.message("JSADM_CALEND_PREV"),i.options[1].text=BX.message("JSADM_CALEND_CURR"),i.options[2].text=BX.message("JSADM_CALEND_NEXT"))},SaveAndClearInput:function(t){window.SavedPeriodValues||(window.SavedPeriodValues={}),window.SavedPeriodValues[t.id]=t.value,t.value=""},RestoreInput:function(t){window.SavedPeriodValues&&window.SavedPeriodValues[t.id]&&(t.value=window.SavedPeriodValues[t.id],delete window.SavedPeriodValues[t.id])},OnChangeP:function(t){var e=t.parentNode.parentNode,i=bShowTo=bShowDirect=bShowSeparate=!1,s=BX.findChild(e,{className:"adm-input-wrap adm-calendar-inp adm-calendar-first"}),n=BX.findChild(e,{className:"adm-input-wrap adm-calendar-second"}),o=BX.findChild(e,{className:"adm-select-wrap adm-calendar-direction"}),a=BX.findChild(e,{className:"adm-calendar-separate"}),r=BX.findChild(e,{className:"adm-input adm-calendar-from"},!0),l=BX.findChild(e,{className:"adm-input adm-calendar-to"},!0);switch(t.value){case"day":case"week":case"month":case"quarter":case"year":bShowDirect=!0,BX.CalendarPeriod.OnChangeD(o.children[0]);break;case"before":bShowTo=!0;break;case"after":i=!0;break;case"exact":i=!0;break;case"interval":i=bShowTo=bShowSeparate=!0,BX.CalendarPeriod.RestoreInput(r),BX.CalendarPeriod.RestoreInput(l);break;case"":BX.CalendarPeriod.SaveAndClearInput(r),BX.CalendarPeriod.SaveAndClearInput(l)}BX.CalendarPeriod.ChangeDirectOpts(t.value,e),s.style.display=i?"inline-block":"none",n.style.display=bShowTo?"inline-block":"none",o.style.display=bShowDirect?"inline-block":"none",a.style.display=bShowSeparate?"inline-block":"none"},OnChangeD:function(t){var e=t.parentNode.parentNode,i=BX.findChild(e,{className:"adm-input adm-calendar-from"},!0),s=BX.findChild(e,{className:"adm-input adm-calendar-to"},!0),n=BX.findChild(e,{className:"adm-select adm-calendar-period"},!0),o=0;switch(t.value){case"previous":o=-1;break;case"next":o=1;break;case"current":}var a=!1,r=!1,l=new Date,d=l.getFullYear(),h=l.getMonth(),c=l.getDate(),p=l.getDay();switch(0==p&&(p=7),n.value){case"day":a=new Date(d,h,c+o,0,0,0),r=new Date(d,h,c+o,23,59,59);break;case"week":a=new Date(d,h,c-p+1+7*o,0,0,0),r=new Date(d,h,c+(7-p)+7*o,23,59,59);break;case"month":a=new Date(d,h+o,1,0,0,0),r=new Date(d,h+1+o,0,23,59,59);break;case"quarter":
var u=Math.floor(h/3)+o;a=new Date(d,3*u,1,0,0,0),r=new Date(d,3*(u+1),0,23,59,59);break;case"year":a=new Date(d+o,0,1,0,0,0),r=new Date(d+1+o,0,0,23,59,59)}var m=window[i.name+"_bTime"]?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");a&&(i.value=BX.formatDate(a,m),BX.addClass(i,"adm-calendar-inp-setted")),r&&(s.value=BX.formatDate(r,m),BX.addClass(s,"adm-calendar-inp-setted"))}},BX.JCCalendar=function(){this.params={},this.bAmPm=BX.isAmPmMode(),this.popup=null,this.popup_month=null,this.popup_year=null,this.value=null,this.control_id=Math.random(),this._layers={},this._current_layer=null,this.DIV=null,this.PARTS={},this.weekStart=0,this.numRows=6,this._create=function(t){this.popup=new BX.PopupWindow("calendar_popup_"+this.control_id,t.node,{closeByEsc:!0,autoHide:!1,content:this._get_content(),zIndex:3e3,bindOptions:{forceBindPosition:!0}}),BX.bind(this.popup.popupContainer,"click",this.popup.cancelBubble)},this._auto_hide_disable=function(){BX.unbind(document,"click",BX.proxy(this._auto_hide,this))},this._auto_hide_enable=function(){BX.bind(document,"click",BX.proxy(this._auto_hide,this))},this._auto_hide=function(t){this._auto_hide_disable(),this.popup.close()},this._get_content=function(){var t=BX.delegate(function(t){t=t||window.event,this.SetDate(new Date(parseInt(BX.proxy_context.getAttribute("data-date"))),"dblclick"==t.type)},this);this.DIV=BX.create("DIV",{props:{className:"bx-calendar"},children:[BX.create("DIV",{props:{className:"bx-calendar-header"},children:[BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-left-arrow"},events:{click:BX.proxy(this._prev,this)}}),BX.create("SPAN",{props:{className:"bx-calendar-header-content"},children:[this.PARTS.MONTH=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-month"},events:{click:BX.proxy(this._menu_month,this)}}),this.PARTS.YEAR=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-year"},events:{click:BX.proxy(this._menu_year,this)}})]}),BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-right-arrow"},events:{click:BX.proxy(this._next,this)}})]}),this.PARTS.WEEK=BX.create("DIV",{props:{className:"bx-calendar-name-day-wrap"}}),this.PARTS.LAYERS=BX.create("DIV",{props:{className:"bx-calendar-cell-block"},events:{click:BX.delegateEvent({className:"bx-calendar-cell"},t),dblclick:BX.delegateEvent({className:"bx-calendar-cell"},t)}}),this.PARTS.TIME=BX.create("DIV",{props:{className:"bx-calendar-set-time-wrap"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._time_actions,this))},html:'<a href="javascript:void(0)" data-action="time_show" class="bx-calendar-set-time"><i></i>'+BX.message("CAL_TIME_SET")+'</a><div class="bx-calendar-form-block"><span class="bx-calendar-form-text">'+BX.message("CAL_TIME")+'</span><span class="bx-calendar-form"><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" /><span class="bx-calendar-form-separator"></span><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" />'+(this.bAmPm?'<span class="bx-calendar-AM-PM-block"><span class="bx-calendar-AM-PM-text" data-action="time_ampm"></span><span class="bx-calendar-form-arrow-r"><a href="javascript:void(0)" class="bx-calendar-form-arrow-top" data-action="time_ampm_up"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow-bottom" data-action="time_ampm_down"><i></i></a></span></span>':"")+'</span><a href="javascript:void(0)" data-action="time_hide" class="bx-calendar-form-close"><i></i></a></div>'}),BX.create("DIV",{props:{className:"bx-calendar-button-block"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._button_actions,this))},html:'<a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-select" data-action="submit"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("CAL_BUTTON")+'</span><span class="bx-calendar-button-right"></span></a><a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-cancel" data-action="cancel"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("JS_CORE_WINDOW_CLOSE")+'</span><span class="bx-calendar-button-right"></span></a>'})]}),this.PARTS.TIME_INPUT_H=BX.findChild(this.PARTS.TIME,{tag:"INPUT"},!0),this.PARTS.TIME_INPUT_M=this.PARTS.TIME_INPUT_H.nextSibling.nextSibling,this.bAmPm&&(this.PARTS.TIME_AMPM=this.PARTS.TIME_INPUT_M.nextSibling.firstChild);var e=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_H,callback_change:BX.proxy(this._check_time,this),bSaveValue:!1}).Show();e.className="bx-calendar-form-arrow-l",this.PARTS.TIME_INPUT_H.parentNode.insertBefore(e,this.PARTS.TIME_INPUT_H),e=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_M,callback_change:BX.proxy(this._check_time,this),bSaveValue:!0}).Show(),e.className="bx-calendar-form-arrow-r",this.PARTS.TIME_INPUT_M.nextSibling?this.PARTS.TIME_INPUT_M.parentNode.insertBefore(e,this.PARTS.TIME_INPUT_M.nextSibling):this.PARTS.TIME_INPUT_M.parentNode.appendChild(e);for(var i=0;i<7;i++)this.PARTS.WEEK.appendChild(BX.create("SPAN",{props:{className:"bx-calendar-name-day"},text:BX.message("DOW_"+(i+this.weekStart)%7)}));return this.DIV},this._time_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"time_show":BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened"),this.popup.adjustPosition();break;case"time_hide":BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened"),this.popup.adjustPosition();break;case"time_ampm":this.PARTS.TIME_AMPM.innerHTML="AM"==this.PARTS.TIME_AMPM.innerHTML?"PM":"AM";break;case"time_ampm_up":return void this._check_time({bSaveValue:!1},null,12);case"time_ampm_down":return void this._check_time({bSaveValue:!1},null,-12)}this._check_time()},this._button_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"submit":this.SaveValue();break;case"cancel":this.Close()}},this._check_time=function(t,e,i){var s=parseInt(this.PARTS.TIME_INPUT_H.value.substring(0,5),10)||0,n=parseInt(this.PARTS.TIME_INPUT_M.value.substring(0,5),10)||0,o=!1;t&&!t.bSaveValue?this.value.setUTCHours(this.value.getUTCHours()+i):isNaN(s)||(this.bAmPm&&12!=s&&"PM"==this.PARTS.TIME_AMPM.innerHTML&&(s+=12),o=!0,this.value.setUTCHours(s)),isNaN(n)||(o=!0,this.value.setUTCMinutes(n)),o&&this.SetValue(this.value)},this._set_layer=function(){var t=parseInt(this.value.getUTCFullYear()+""+BX.util.str_pad_left(this.value.getUTCMonth()+"",2,"0"));if(this._layers[t]||(this._layers[t]=this._create_layer(),this._layers[t].BXLAYERID=t),this._current_layer){var e=new Date(this.value.valueOf());e.setUTCHours(0),e.setUTCMinutes(0);var i=BX.findChild(this._layers[t],{tag:"A",className:"bx-calendar-active"},!0),s=BX.findChild(this._layers[t],{tag:"A",attr:{"data-date":e.valueOf()+""}},!0);i&&BX.removeClass(i,"bx-calendar-active"),s&&BX.addClass(s,"bx-calendar-active"),this._replace_layer(this._current_layer,this._layers[t])}else this.PARTS.LAYERS.appendChild(this._layers[t]);this._current_layer=this._layers[t]},this._replace_layer=function(t,e){if(t!=e)if(!BX.browser.IsIE()||BX.browser.IsDoctype()){var i=t.BXLAYERID>e.BXLAYERID?1:-1,s=0;new_top=-i*t.offsetHeight,t.style.position="relative",t.style.top="0px",t.style.zIndex=5,e.style.position="absolute",e.style.top=new_top+"px",e.style.zIndex=6,this.PARTS.LAYERS.appendChild(e);var n,o=15;(n=function(){new_top+=i*o,s+=i*o,i*new_top<0?(t.style.top=s+"px",e.style.top=new_top+"px",setTimeout(n,10)):(t.parentNode.removeChild(t),e.style.top="0px",e.style.position="static",e.style.zIndex=0)})()}else this.PARTS.LAYERS.replaceChild(e,t)},this._create_layer=function(){var t=BX.create("DIV",{props:{className:"bx-calendar-layer"}}),e=new Date(this.value);if(e.setUTCHours(0),e.setUTCMinutes(0),e.setUTCDate(1),e.getUTCDay()!=this.weekStart){var i=e.getUTCDay()-this.weekStart;i+=i<0?7:0,e=new Date(e.valueOf()-864e5*i)}for(var s=this.value.getUTCMonth(),n=this.value.getUTCDate(),o="",a=0;a<this.numRows;a++){o+='<div class="bx-calendar-range'+(a==this.numRows-1?" bx-calendar-range-noline":"")+'">';for(var r=0;r<7;r++){var i=e.getUTCDate(),l=e.getUTCDay(),d="bx-calendar-cell";s!=e.getUTCMonth()?d+=" bx-calendar-date-hidden":n==i&&(d+=" bx-calendar-active"),0!=l&&6!=l||(d+=" bx-calendar-weekend"),o+='<a href="javascript:void(0)" class="'+d+'" data-date="'+e.valueOf()+'">'+i+"</a>",e=new Date(e.valueOf()+864e5)}o+="</div>"}return t.innerHTML=o,t},this._prev=function(){this.SetMonth(this.value.getUTCMonth()-1)},this._next=function(){this.SetMonth(this.value.getUTCMonth()+1)},this._menu_month_content=function(){var t,e="",i=this.value.getUTCMonth();for(t=0;t<12;t++)e+='<a href="javascript:void(0)" class="bx-calendar-month'+(t==i?" bx-calendar-month-active":"")+'" onclick="BX.calendar.get().SetMonth('+t+')">'+BX.message("MONTH_"+(t+1))+"</a>";return'<div class="bx-calendar-month-popup"><div class="bx-calendar-month-title" onclick="BX.calendar.get().popup_month.close();">'+BX.message("MONTH_"+(this.value.getUTCMonth()+1))+'</div><div class="bx-calendar-month-content">'+e+"</div></div>"},this._menu_month=function(){this.popup_month?this.popup_month.BXMONTH!=this.value.getUTCMonth()&&(this.popup_month.setContent(this._menu_month_content()),this.popup_month.BXMONTH=this.value.getUTCMonth()):(this.popup_month=BX.PopupWindowManager.create("calendar_popup_month_"+this.control_id,this.PARTS.MONTH,{content:this._menu_month_content(),zIndex:3001,closeByEsc:!0,autoHide:!0,offsetTop:-29,offsetLeft:-1}),this.popup_month.BXMONTH=this.value.getUTCMonth()),this.popup_month.show()},this._menu_year_content=function(){for(var t='<div class="bx-calendar-year-popup"><div class="bx-calendar-year-title" onclick="BX.calendar.get().popup_year.close();">'+this.value.getUTCFullYear()+'</div><div class="bx-calendar-year-content" id="bx-calendar-year-content">',e=-3;e<=3;e++)t+='<a href="javascript:void(0)" class="bx-calendar-year-number'+(0==e?" bx-calendar-year-active":"")+'" onclick="BX.calendar.get().SetYear('+(this.value.getUTCFullYear()-e)+')">'+(this.value.getUTCFullYear()-e)+"</a>";return t+='</div><input type="text" class="bx-calendar-year-input" onkeyup="if(this.value>=1900&&this.value<=2100)BX.calendar.get().SetYear(this.value);" maxlength="4" /></div>'},this._menu_year=function(){this.popup_year?this.popup_year.BXYEAR!=this.value.getUTCFullYear()&&(this.popup_year.setContent(this._menu_year_content()),this.popup_year.BXYEAR=this.value.getUTCFullYear()):(this.popup_year=BX.PopupWindowManager.create("calendar_popup_year_"+this.control_id,this.PARTS.YEAR,{content:this._menu_year_content(),zIndex:3001,closeByEsc:!0,autoHide:!0,offsetTop:-29,offsetLeft:-1}),this.popup_year.BXYEAR=this.value.getUTCFullYear()),this.popup_year.show()},this._check_date=function(t){return BX.type.isString(t)&&(t=BX.parseDate(t)),BX.type.isDate(t)||(t=new Date,this.params.bHideTime&&(t.setHours(0),t.setMinutes(0))),t=BX.date.convertToUTC(t),t.setUTCMilliseconds(0),t.setUTCSeconds(0),t.BXCHECKED=!0,t}},BX.JCCalendar.prototype.Show=function(t){if(!BX.isReady)return void BX.ready(BX.delegate(function(){this.Show(t)},this));if(t.node=t.node||document.body,BX.type.isNotEmptyString(t.node)){var e=BX(t.node);e||(e=document.getElementsByName(t.node),e&&e.length>0&&(e=e[0])),t.node=e}if(t.node){if(t.field&&BX.type.isString(t.field)){var e=BX(t.field);if(e)t.field=e;else if(t.form&&BX.type.isString(t.form)&&(t.form=document.forms[t.form]),BX.type.isDomNode(t.form)&&t.form[t.field])t.field=t.form[t.field];else{var e=document.getElementsByName(t.field);e&&e.length>0&&(e=e[0],t.field=e)}BX.type.isString(t.field)&&(t.field=BX(t.field))}var i=!this.popup||!this.popup.isShown()||this.params.node!=t.node;this.params=t,this.params.bTime="undefined"==typeof this.params.bTime||!!this.params.bTime,this.params.bHideTime="undefined"==typeof this.params.bHideTime||!!this.params.bHideTime,this.weekStart=parseInt(this.params.weekStart||this.params.weekStart||BX.message("WEEK_START")),isNaN(this.weekStart)&&(this.weekStart=1),this.popup?this.popup.setBindElement(this.params.node):this._create(this.params);var s=!!this.params.bHideTime;return this.params.value?(this.SetValue(this.params.value),s=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0):this.params.field?(this.SetValue(this.params.field.value),s=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0):this.params.currentTime?this.SetValue(this.params.currentTime):this.SetValue(new Date),this.params.bTime?BX.removeClass(this.DIV,"bx-calendar-time-disabled"):BX.addClass(this.DIV,"bx-calendar-time-disabled"),s?BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened"):BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened"),i&&(this._auto_hide_disable(),this.popup.show(),setTimeout(BX.proxy(this._auto_hide_enable,this))),t.node.blur(),this}},BX.JCCalendar.prototype.SetDay=function(t){return this.value.setUTCDate(t),this.SetValue(this.value)},BX.JCCalendar.prototype.SetMonth=function(t){return this.popup_month&&this.popup_month.close(),this.value.setUTCMonth(t),this.SetValue(this.value)},BX.JCCalendar.prototype.SetYear=function(t){return this.popup_year&&this.popup_year.close(),this.value.setUTCFullYear(t),this.SetValue(this.value)},BX.JCCalendar.prototype.SetDate=function(t,e){return t=this._check_date(t),t.setUTCHours(this.value.getUTCHours()),t.setUTCMinutes(this.value.getUTCMinutes()),t.setUTCSeconds(this.value.getUTCSeconds()),this.params.bTime&&!e?this.SetValue(t):(this.SetValue(t),void this.SaveValue())},BX.JCCalendar.prototype.SetValue=function(t){if(this.value=t&&t.BXCHECKED?t:this._check_date(t),this.PARTS.MONTH.innerHTML=BX.message("MONTH_"+(this.value.getUTCMonth()+1)),this.PARTS.YEAR.innerHTML=this.value.getUTCFullYear(),this.params.bTime){var e=this.value.getUTCHours();this.bAmPm&&(e>=12?(this.PARTS.TIME_AMPM.innerHTML="PM",12!=e&&(e-=12)):(this.PARTS.TIME_AMPM.innerHTML="AM",0==e&&(e=12))),this.PARTS.TIME_INPUT_H.value=BX.util.str_pad_left(e.toString(),2,"0"),this.PARTS.TIME_INPUT_M.value=BX.util.str_pad_left(this.value.getUTCMinutes().toString(),2,"0")}return this._set_layer(),this},BX.JCCalendar.prototype.SaveValue=function(){this.popup_month&&this.popup_month.close(),this.popup_year&&this.popup_year.close();var t=!0;if(this.params.callback){var e=this.params.callback.apply(this,[this.value]);e===!1&&(t=!1)}if(t){if(this.params.field){var i=!!this.params.bTime&&BX.hasClass(this.PARTS.TIME,"bx-calendar-set-time-opened");this.params.field.value=BX.calendar.ValueToString(this.value,i,!0),BX.fireEvent(this.params.field,"change")}this.popup.close(),this.params.callback_after&&this.params.callback_after.apply(this,[this.value])}return this},BX.JCCalendar.prototype.Close=function(){return this.popup&&this.popup.close(),this},BX.JCSpinner=function(t){t=t||{},this.params={input:t.input||null,delta:t.delta||1,timeout_start:t.timeout_start||1e3,timeout_cont:t.timeout_cont||150,callback_start:t.callback_start||null,callback_change:t.callback_change||null,callback_finish:t.callback_finish||null,bSaveValue:"undefined"==typeof t.bSaveValue?!!t.input:!!t.bSaveValue},this.mousedown=!1,this.direction=1},BX.JCSpinner.prototype.Show=function(){return this.node=BX.create("span",{events:{mousedown:BX.delegateEvent({attr:"data-dir"},BX.delegate(this.Start,this))},html:'<a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-top" data-dir="1"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-bottom" data-dir="-1"><i></i></a>'}),this.node},BX.JCSpinner.prototype.Start=function(){this.mousedown=!0,this.direction=BX.proxy_context.getAttribute("data-dir")>0?1:-1,BX.bind(document,"mouseup",BX.proxy(this.MouseUp,this)),this.ChangeValue(!0)},BX.JCSpinner.prototype.ChangeValue=function(t){if(this.mousedown&&this.params.input){var e=parseInt(this.params.input.value,10)+this.params.delta*this.direction;this.params.bSaveValue&&(this.params.input.value=e),t&&this.params.callback_start&&this.params.callback_start(this.params,e,this.direction),this.params.callback_change&&this.params.callback_change(this.params,e,this.direction),setTimeout(BX.proxy(this.ChangeValue,this),t?this.params.timeout_start:this.params.timeout_cont)}},BX.JCSpinner.prototype.MouseUp=function(){this.mousedown=!1,BX.unbind(document,"mouseup",BX.proxy(this.MouseUp,this)),this.params.callback_finish&&this.params.callback_finish(this.params,this.params.input.value)},window.jsCalendar={Show:function(t,e,i,s,n,o,a,r){return BX.calendar({node:t,field:e,form:a,bTime:!!n,currentTime:o,bHideTimebar:!!r})},ValueToString:BX.calendar.ValueToString},BX.CClockSelector=function(t){this.params=t,this.params.popup_buttons=this.params.popup_buttons||[new BX.PopupWindowButton({text:BX.message("CAL_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(this.setValue,this)}})],this.isReady=!1,this.WND=new BX.PopupWindow(this.params.popup_id||"clock_selector_popup",this.params.node,this.params.popup_config||{titleBar:{content:BX.create("SPAN",{text:BX.message("CAL_TIME")})},offsetLeft:-45,offsetTop:-135,autoHide:!0,closeIcon:!0,zIndex:this.params.zIndex}),this.SHOW=!1,BX.addCustomEvent(this.WND,"onPopupClose",BX.delegate(this.onPopupClose,this)),this.obClocks={},this.CLOCK_ID=this.params.clock_id||"clock_selector"},BX.CClockSelector.prototype.Show=function(){return this.isReady?(this.WND.setButtons(this.params.popup_buttons),this.WND.show(),this.SHOW=!0,window["bxClock_"+this.obClocks[this.CLOCK_ID]]&&setTimeout("window['bxClock_"+this.obClocks[this.CLOCK_ID]+"'].CalculateCoordinates()",40),!0):(BX.addCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this)),BX.ajax.get("/bitrix/tools/clock_selector.php",{start_time:this.params.start_time,clock_id:this.CLOCK_ID,sessid:BX.bitrix_sessid()},BX.delegate(this.Ready,this)))},BX.CClockSelector.prototype.onClockRegister=function(t){t[this.CLOCK_ID]&&(this.obClocks[this.CLOCK_ID]=t[this.CLOCK_ID],BX.removeCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this)))},BX.CClockSelector.prototype.Ready=function(t){this.content=this.CreateContent(t),this.WND.setContent(this.content),this.isReady=!0,setTimeout(BX.proxy(this.Show,this),30)},BX.CClockSelector.prototype.CreateContent=function(t){return BX.create("DIV",{events:{click:BX.PreventDefault},html:'<div class="bx-tm-popup-clock">'+t+"</div>"})},BX.CClockSelector.prototype.setValue=function(t){if(this.params.callback){var e=BX.findChild(this.content,{tagName:"INPUT"},!0);this.params.callback.apply(this.params.node,[e.value])}return BX.PreventDefault(t)},BX.CClockSelector.prototype.closeWnd=function(t){return this.WND.close(),!t&&!window.event||BX.PreventDefault(t)},BX.CClockSelector.prototype.setNode=function(t){this.WND.setBindElement(t)},BX.CClockSelector.prototype.setTime=function(t){this.params.start_time=t,window["bxClock_"+this.obClocks[this.CLOCK_ID]]&&window["bxClock_"+this.obClocks[this.CLOCK_ID]].SetTime(parseInt(t/3600),parseInt(t%3600/60))},BX.CClockSelector.prototype.setCallback=function(t){this.params.callback=t},BX.CClockSelector.prototype.onPopupClose=function(){this.SHOW=!1}}}(),CAjaxThread.prototype._CreateHttpObject=function(){var t=null;if(window.XMLHttpRequest)try{t=new XMLHttpRequest}catch(e){}else if(window.ActiveXObject){try{t=new ActiveXObject("Microsoft.XMLHTTP")}catch(e){}if(!t)try{t=new ActiveXObject("Msxml2.XMLHTTP")}catch(e){}}return t},CAjaxThread.prototype.addAction=function(t){this.arAction.push(t)},CAjaxThread.prototype.clearActions=function(){this.arAction=[]},CAjaxThread.prototype.nextAction=function(){return this.arAction.shift()},CAjaxThread.prototype.Clear=function(){this.arAction=null,this.httpRequest=null},CAjax.prototype._PrepareData=function(t,e){var i="";if(null!=t)for(var s in t){i.length>0&&(i+="&");var n=jsAjaxUtil.urlencode(s);e&&(n=e+"["+n+"]"),i+="object"==typeof t[s]?this._PrepareData(t[s],n):n+"="+jsAjaxUtil.urlencode(t[s])}return i},CAjax.prototype.GetThread=function(t){return this.arThreads[t]},CAjax.prototype.InitThread=function(){for(;;){var t="TID"+Math.floor(1e6*Math.random());if(!this.arThreads[t])break}return this.arThreads[t]=new CAjaxThread(t),t},CAjax.prototype.AddAction=function(t,e){this.arThreads[t]&&this.arThreads[t].addAction(e)},CAjax.prototype._OnDataReady=function(t,e){if(this.arThreads[t])for(;obHandler=this.arThreads[t].nextAction();)obHandler(e)},CAjax.prototype._Close=function(t){this.arThreads[t]&&(this.arThreads[t].Clear(),this.arThreads[t]=null)},CAjax.prototype._SetHandler=function(t){function e(e){e||(e=window.event),e&&27==e.keyCode&&(s._Close(t),jsEvent.removeEvent(document,"keypress",this))}function i(){if(!s.bCancelled&&s.arThreads[t]&&s.arThreads[t].httpRequest&&4==s.arThreads[t].httpRequest.readyState){var e=s.arThreads[t].httpRequest.getResponseHeader("X-Bitrix-Ajax-Status"),i="Redirect"==e,n=s.arThreads[t].httpRequest.responseText;jsAjaxParser.mode="implode",n=jsAjaxParser.process(n),i||s._OnDataReady(t,n),s.__prepareOnload(),jsAjaxParser.code.length>0&&jsAjaxUtil.EvalPack(jsAjaxParser.code),s.__runOnload(),s._Close(t)}}var s=this;this.arThreads[t].httpRequest.onreadystatechange=i,jsEvent.addEvent(document,"keypress",e)},CAjax.prototype.__prepareOnload=function(){this.obTemporary=window.onload,window.onload=null},CAjax.prototype.__runOnload=function(){window.onload&&window.onload(),window.onload=this.obTemporary,this.obTemporary=null},CAjax.prototype.Send=function(t,e,i){if(this.arThreads[t]){if(null!=i)var s=this._PrepareData(i);else var s="";return s.length>0&&(e+=e.indexOf("?")==-1?"?"+s:"&"+s),this.arThreads[t].httpRequest?(this.arThreads[t].httpRequest.open("GET",e,!0),this._SetHandler(t),this.arThreads[t].httpRequest.send("")):void 0}},CAjax.prototype.Post=function(t,e,i){var s="";if(null!=i&&(s=this._PrepareData(i)),this.arThreads[t].httpRequest)return this.arThreads[t].httpRequest.open("POST",e,!0),this._SetHandler(t),this.arThreads[t].httpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),this.arThreads[t].httpRequest.send(s)},CAjaxForm.prototype.setProcessedFlag=function(t){t=null==t||!!t,this.obForm.bxAjaxProcessed=t,this.isFormProcessed=t},CAjaxForm.isFormProcessed=function(t){return!!t.bxAjaxProcessed&&t.bxAjaxProcessed},CAjaxForm.prototype.process=function(){function t(){if(e.obFrame.contentWindow.document&&0!=e.obFrame.contentWindow.document.body.innerHTML.length&&(null!=e.obHandler&&e.obHandler(e.obFrame.contentWindow.document.body.innerHTML),e.obFrame.contentWindow.AJAX_runExternal&&e.obFrame.contentWindow.AJAX_runExternal(),e.obFrame.contentWindow.AJAX_runGlobal&&e.obFrame.contentWindow.AJAX_runGlobal(),e.bFirst)){try{e.obForm.target=e.__tmpFormTarget,e.obAJAXIndicator.parentNode.removeChild(e.obAJAXIndicator),e.obForm.bxAjaxProcessed=!1}catch(t){e.obForm=null}e.obAJAXIndicator=null,"IE"!=this.currentBrowserDetected&&jsEvent.removeAllEvents(e.obFrame);setTimeout("document.body.removeChild(document.getElementById('"+e.obFrame.id+"'));",100);e.obFrame=null,window.onFormLoaded&&(window.onFormLoaded(),window.onFormLoaded=null)}}var e=this;if(!this.obForm.target||"AJAX_"!=this.obForm.target.substring(0,5)){"IE"==this.currentBrowserDetected?this.IsIE9?(this.obAJAXIndicator=document.createElement("input"),this.obAJAXIndicator.setAttribute("name","AJAX_CALL"),this.obAJAXIndicator.setAttribute("type","hidden")):this.obAJAXIndicator=document.createElement('<input name="AJAX_CALL" type="hidden" />'):(this.obAJAXIndicator=document.createElement("INPUT"),this.obAJAXIndicator.type="hidden",this.obAJAXIndicator.name="AJAX_CALL"),this.obAJAXIndicator.value="Y",this.obForm.appendChild(this.obAJAXIndicator);var i="AJAX_"+Math.round(1e5*Math.random());"IE"==this.currentBrowserDetected?this.IsIE9?(this.obFrame=document.createElement("iframe"),this.obFrame.setAttribute("name",i)):this.obFrame=document.createElement('<iframe name="'+i+'"></iframe>'):this.obFrame=document.createElement("IFRAME"),this.obFrame.style.display="none",this.obFrame.src="javascript:''",this.obFrame.id=i,this.obFrame.name=i,document.body.appendChild(this.obFrame),this.__tmpFormTarget=this.obForm.target,this.obForm.target=i,"IE"==this.currentBrowserDetected?this.obFrame.attachEvent("onload",t):jsEvent.addEvent(this.obFrame,"load",t),this.setProcessedFlag()}};var jsAjaxParser={code:[],mode:"implode",regexp:null,regexp_src:null,process:function(t){for(this.code=[],null==this.regexp&&(this.regexp=/(<script([^>]*)>)([\S\s]*?)(<\/script>)/i);;){var e=t.match(this.regexp);if(null==e)break;var i=e.index,s=e[0].length;if(i>0&&this.code.push({TYPE:"STRING",DATA:t.substring(0,i)}),"undefined"==typeof e[1]||e[1].indexOf("src=")==-1){var n=e[3];n=n.replace("<!--",""),this.code.push({TYPE:"SCRIPT",DATA:n})}else{null==this.regexp_src&&(this.regexp_src=/src="([^"]*)?"/i);var o=this.regexp_src.exec(e[1]);null!=o&&o[1]&&this.code.push({TYPE:"SCRIPT_EXT",DATA:o[1]})}t=t.substring(i+s)}if(t.length>0&&this.code.push({TYPE:"STRING",DATA:t}),"implode"==this.mode){t="";for(var a=0,r=this.code.length;a<r;a++)"STRING"==this.code[a].TYPE&&(t+=this.code[a].DATA);return t}return this.code}},jsAjaxUtil={RemoveAllChild:function(t){try{for(;t.childNodes.length>0;)jsEvent.clearObject(t.childNodes[0]),t.removeChild(t.childNodes[0])}catch(e){}},EvalGlobal:function(t){window.execScript?window.execScript(t,"javascript"):jsAjaxUtil.IsSafari()?window.setTimeout(t,0):window.eval(t)},arLoadedScripts:[],__isScriptLoaded:function(t){for(var e=0;e<jsAjaxUtil.arLoadedScripts.length;e++)if(jsAjaxUtil.arLoadedScripts[e]==t)return!0;return!1},EvalExternal:function(t){if(!/\/bitrix\/js\/main\/ajax.js$/i.test(t)&&!/\/bitrix\/js\/main\/core\/core.js$/i.test(t)&&!jsAjaxUtil.__isScriptLoaded(t)){jsAjaxUtil.arLoadedScripts.push(t);var e=new CAjaxThread;e.httpRequest.open("GET",t,!1),e.httpRequest.send("");var i=e.httpRequest.responseText;e.Clear(),e=null,jsAjaxUtil.EvalGlobal(i)}},EvalPack:function(t){for(var e=0,i=t.length;e<i;e++)"SCRIPT_EXT"==t[e].TYPE||"SCRIPT_SRC"==t[e].TYPE?jsAjaxUtil.EvalExternal(t[e].DATA):"SCRIPT"==t[e].TYPE&&jsAjaxUtil.EvalGlobal(t[e].DATA)},urlencode:function(t){return escape(t).replace(new RegExp("\\+","g"),"%2B")},trim:function(t){var e,i;return i=/^[ \r\n]+/g,e=t.replace(i,""),i=/[ \r\n]+$/g,e=e.replace(i,"")},GetWindowSize:function(){var t,e;self.innerHeight?(t=self.innerWidth,e=self.innerHeight):document.documentElement&&document.documentElement.clientHeight?(t=document.documentElement.clientWidth,e=document.documentElement.clientHeight):document.body&&(t=document.body.clientWidth,e=document.body.clientHeight);var i,s;self.pageYOffset?(i=self.pageXOffset,s=self.pageYOffset):document.documentElement&&document.documentElement.scrollTop?(i=document.documentElement.scrollLeft,s=document.documentElement.scrollTop):document.body&&(i=document.body.scrollLeft,s=document.body.scrollTop);var n,o;return document.compatMode&&"CSS1Compat"==document.compatMode?(n=document.documentElement.scrollWidth,o=document.documentElement.scrollHeight):(o=document.body.scrollHeight>document.body.offsetHeight?document.body.scrollHeight:document.body.offsetHeight,n=document.body.scrollWidth>document.body.offsetWidth||document.compatMode&&"BackCompat"==document.compatMode||document.documentElement&&!document.documentElement.clientWidth?document.body.scrollWidth:document.body.offsetWidth),{innerWidth:t,innerHeight:e,scrollLeft:i,scrollTop:s,scrollWidth:n,scrollHeight:o}},GetRealPos:function(t){if(t.getBoundingClientRect){var e=t.getBoundingClientRect(),i=jsAjaxUtil.GetWindowSize(),s={left:e.left+i.scrollLeft,top:e.top+i.scrollTop,right:e.right+i.scrollLeft,bottom:e.bottom+i.scrollTop};return s}if(!t||!t.offsetParent)return!1;var n=Array();n.left=t.offsetLeft,n.top=t.offsetTop;for(var o=t.offsetParent;o&&"BODY"!=o.tagName;)n.left+=o.offsetLeft,n.top+=o.offsetTop,o=o.offsetParent;return n.right=n.left+t.offsetWidth,n.bottom=n.top+t.offsetHeight,n},IsIE:function(){return document.attachEvent&&!jsAjaxUtil.IsOpera()},IsOpera:function(){return navigator.userAgent.toLowerCase().indexOf("opera")!=-1},IsSafari:function(){var t=navigator.userAgent.toLowerCase();return/webkit/.test(t)},LoadData:function(t,e){if(e){var i=jsAjax.InitThread();return jsAjax.AddAction(i,e),jsAjax.Send(i,t),i}},PostData:function(t,e,i){if(i){var s=jsAjax.InitThread();return jsAjax.AddAction(s,i),jsAjax.Post(s,t,e),s}},__LoadDataToDiv:function(t,e,i,s){function n(t){o&&(jsAjaxUtil.CloseLocalWaitWindow(a,o),i?(jsAjaxUtil.RemoveAllChild(o),o.innerHTML=t):o.innerHTML+=t)}if(null==i&&(i=!0),null==s&&(s=!0),"string"==typeof e||"object"==typeof e&&e.constructor==String)var o=document.getElementById(e);else var o=e;if(o){var a=Math.round(1e6*Math.random());jsAjaxUtil.ShowLocalWaitWindow(a,o,s);jsAjaxUtil.LoadData(t,n)}},InsertDataToNode:function(t,e,i){null==i&&(i=!0),jsAjaxUtil.__LoadDataToDiv(t,e,!0,i)},AppendDataToNode:function(t,e,i){null==i&&(i=!0),jsAjaxUtil.__LoadDataToDiv(t,e,!1,i)},GetStyleValue:function(t,e){if(t.currentStyle)var i=t.currentStyle[e];else if(window.getComputedStyle)var i=document.defaultView.getComputedStyle(t,null).getPropertyValue(e);return i},ShowLocalWaitWindow:function(t,e,i){function s(i){i||(i=window.event),i&&27==i.keyCode&&(jsAjaxUtil.CloseLocalWaitWindow(t,e),jsEvent.removeEvent(document,"keypress",s))}if("string"==typeof e||"object"==typeof e&&e.constructor==String)var n=document.getElementById(e);else var n=e;if(n.getBoundingClientRect)var o=n.getBoundingClientRect(),a=jsAjaxUtil.GetWindowSize(),r={left:o.left+a.scrollLeft,top:o.top+a.scrollTop,right:o.right+a.scrollLeft,bottom:o.bottom+a.scrollTop};else var r=jsAjaxUtil.GetRealPos(n);var l=n.id;if(r){if(null==i&&(i=!0),i){var d=document.body.appendChild(document.createElement("DIV"));d.id="waitshadow_"+l+"_"+t,d.className="waitwindowlocalshadow",d.style.top=r.top-5+"px",d.style.left=r.left-5+"px",d.style.height=r.bottom-r.top+10+"px",d.style.width=r.right-r.left+10+"px"}var h=document.body.appendChild(document.createElement("DIV"));h.id="wait_"+l+"_"+t,h.className="waitwindowlocal";var c=r.top+5;if(c<document.body.scrollTop&&(c=document.body.scrollTop+5),h.style.top=c+"px",h.style.left=r.left+5+"px",jsAjaxUtil.IsIE()){var p=document.createElement("IFRAME");p.src="javascript:''",p.id="waitframe_"+l+"_"+t,p.className="waitwindowlocal",p.style.width=h.offsetWidth+"px",p.style.height=h.offsetHeight+"px",p.style.left=h.style.left,p.style.top=h.style.top,document.body.appendChild(p)}jsEvent.addEvent(document,"keypress",s)}},CloseLocalWaitWindow:function(t,e){if("string"==typeof e||"object"==typeof e&&e.constructor==String)var i=document.getElementById(e);else var i=e;var s=i.id,n=document.getElementById("waitshadow_"+s+"_"+t);n&&document.body.removeChild(n);var o=document.getElementById("waitframe_"+s+"_"+t);o&&document.body.removeChild(o);var a=document.getElementById("wait_"+s+"_"+t);a&&document.body.removeChild(a)},SendForm:function(t,e){if("string"==typeof t||"object"==typeof t&&t.constructor==String)var i=document.getElementById(t);else var i=t;(!i.name||i.name.length<=0)&&(i.name="AJAXFORM_"+Math.floor(1e6*Math.random()));var s=new CAjaxForm(i,e,(!0));return s.process(),!0},InsertFormDataToNode:function(t,e,i){return null==i&&(i=!0),jsAjaxUtil.__LoadFormToDiv(t,e,!0,i)},AppendFormDataToNode:function(t,e,i){return null==i&&(i=!0),jsAjaxUtil.__LoadFormToDiv(t,e,!1,i)},__LoadFormToDiv:function(t,e,i,s){function n(t){o&&(i?(jsAjaxUtil.RemoveAllChild(o),o.innerHTML=t):o.innerHTML+=t,jsAjaxUtil.CloseLocalWaitWindow(o.id,o))}if(null==i&&(i=!0),null==s&&(s=!0),"string"==typeof e||"object"==typeof e&&e.constructor==String)var o=document.getElementById(e);else var o=e;if(o)return jsAjaxUtil.ShowLocalWaitWindow(o.id,o,s),jsAjaxUtil.SendForm(t,n)},UpdatePageData:function(t){t.TITLE&&jsAjaxUtil.UpdatePageTitle(t.TITLE),t.NAV_CHAIN&&jsAjaxUtil.UpdatePageNavChain(t.NAV_CHAIN),t.CSS&&t.CSS.length>0&&jsAjaxUtil.UpdatePageCSS(t.CSS),t.SCRIPTS&&t.SCRIPTS.length>0&&jsAjaxUtil.UpdatePageScripts(t.SCRIPTS);
},UpdatePageScripts:function(t){for(var e=0;e<t.length;e++)jsAjaxUtil.EvalExternal(t[e])},UpdatePageCSS:function(t){jsStyle.UnloadAll();for(var e=0;e<t.length;e++)jsStyle.Load(t[e])},UpdatePageTitle:function(t){var e=document.getElementById("pagetitle");e&&(e.removeChild(e.firstChild),e.firstChild?e.insertBefore(document.createTextNode(t),e.firstChild):e.appendChild(document.createTextNode(t))),document.title=t},UpdatePageNavChain:function(t){var e=document.getElementById("navigation");e&&(e.innerHTML=t)},ScrollToNode:function(t){if("string"==typeof t||"object"==typeof t&&t.constructor==String)var e=document.getElementById(t);else var e=t;if(e.scrollIntoView)e.scrollIntoView(!0);else{var i=jsAjaxUtil.GetRealPos(e);window.scrollTo(i.left,i.top)}}},jsStyle={arCSS:{},bInited:!1,Init:function(){var t=document.getElementsByTagName("LINK");if(t.length>0)for(var e=0;e<t.length;e++)if(t[e].href){var i=t[e].href,s=i.indexOf("://");s!=-1&&(i=i.substr(i.indexOf("/",s+3))),t[e].bxajaxflag=!1,this.arCSS[i]=t[e]}this.bInited=!0},Load:function(t){if(this.bInited||this.Init(),null!=this.arCSS[t])return void(this.arCSS[t].disabled=!1);var e=document.createElement("STYLE");e.type="text/css";var i=document.getElementsByTagName("HEAD")[0];if(i.insertBefore(e,i.firstChild),jsAjaxUtil.IsIE())e.styleSheet.addImport(t);else{var s=new CAjaxThread;s.httpRequest.onreadystatechange=null,s.httpRequest.open("GET",t,!1),s.httpRequest.send("");var n=s.httpRequest.responseText,o=t.lastIndexOf("/");if(o!=-1){var a=t.substring(0,o);n=n.replace(/url\(([^\/\\].*?)\)/gi,"url("+a+"/$1)")}s.Clear(),s=null,e.appendChild(document.createTextNode(n))}},Unload:function(t){this.bInited||this.Init(),null!=this.arCSS[t]&&(this.arCSS[t].disabled=!0)},UnloadAll:function(){if(this.bInited)for(var t in this.arCSS)this.arCSS[t].bxajaxflag&&this.Unload(t);else this.Init()}},jsEvent={objectList:[null],objectEventList:[null],__eventManager:function(t){t||(t=window.event);var e=!0;try{t.srcElement&&(t.currentTarget=t.srcElement)}catch(t){}if(this.bxEventIndex&&jsEvent.objectEventList[this.bxEventIndex]&&jsEvent.objectEventList[this.bxEventIndex][t.type])for(var i=jsEvent.objectEventList[this.bxEventIndex][t.type].length,s=0;s<i;s++)if(jsEvent.objectEventList[this.bxEventIndex][t.type]&&jsEvent.objectEventList[this.bxEventIndex][t.type][s]){var n=jsEvent.objectEventList[this.bxEventIndex][t.type][s](t);if("boolean"==typeof n&&(e=e&&n),!e)return!1}return!0},addEvent:function(t,e,i){t.bxEventIndex||(t.bxEventIndex=jsEvent.objectList.length,jsEvent.objectList[t.bxEventIndex]=t),jsEvent.objectEventList[t.bxEventIndex]||(jsEvent.objectEventList[t.bxEventIndex]={}),jsEvent.objectEventList[t.bxEventIndex][e]||(jsEvent.objectEventList[t.bxEventIndex][e]=[],t["on"+e]&&jsEvent.objectEventList[t.bxEventIndex][e].push(t["on"+e]),t["on"+e]=null,t["on"+e]=jsEvent.__eventManager),jsEvent.objectEventList[t.bxEventIndex][e].push(i)},removeEvent:function(t,e,i){if(t.bxEventIndex&&jsEvent.objectEventList[t.bxEventIndex][e])for(var s=0;s<jsEvent.objectEventList[t.bxEventIndex][e].length;s++)if(i==jsEvent.objectEventList[t.bxEventIndex][e][s])return void delete jsEvent.objectEventList[t.bxEventIndex][e][s]},removeAllHandlers:function(t,e){t.bxEventIndex&&jsEvent.objectEventList[t.bxEventIndex][e]&&(jsEvent.objectEventList[t.bxEventIndex][e]=[])},removeAllEvents:function(t){t.bxEventIndex&&jsEvent.objectEventList[t.bxEventIndex]&&(jsEvent.objectEventList[t.bxEventIndex]=[])},clearObject:function(t){t.bxEventIndex&&(jsEvent.objectEventList[t.bxEventIndex]&&delete jsEvent.objectEventList[t.bxEventIndex],jsEvent.objectList[t.bxEventIndex]&&delete jsEvent.objectList[t.bxEventIndex],delete t.bxEventIndex)}},jsAjaxHistory={expected_hash:"",counter:0,bInited:!1,obFrame:null,obImage:null,bHashCollision:!1,obTimer:null,__hide_object:function(t){t.style.position="absolute",t.style.top="-1000px",t.style.left="-1000px",t.style.height="10px",t.style.width="10px"},init:function(t){if(!jsAjaxHistory.bInited){jsAjaxHistory.expected_hash=window.location.hash,jsAjaxHistory.expected_hash&&"#"!=jsAjaxHistory.expected_hash||(jsAjaxHistory.expected_hash="__bx_no_hash__");var e={node:t,title:window.document.title,data:document.getElementById(t).innerHTML},i=document.getElementById("navigation");null!=i&&(e.nav_chain=i.innerHTML),jsAjaxHistoryContainer.put(jsAjaxHistory.expected_hash,e),jsAjaxHistory.obTimer=setTimeout(jsAjaxHistory.__hashListener,500),jsAjaxUtil.IsIE()?(jsAjaxHistory.obFrame=document.createElement("IFRAME"),jsAjaxHistory.__hide_object(jsAjaxHistory.obFrame),document.body.appendChild(jsAjaxHistory.obFrame),jsAjaxHistory.obFrame.contentWindow.document.open(),jsAjaxHistory.obFrame.contentWindow.document.write(jsAjaxHistory.expected_hash),jsAjaxHistory.obFrame.contentWindow.document.close(),jsAjaxHistory.obFrame.contentWindow.document.title=window.document.title):jsAjaxUtil.IsOpera()&&(jsAjaxHistory.obImage=document.createElement("IMG"),jsAjaxHistory.__hide_object(jsAjaxHistory.obImage),document.body.appendChild(jsAjaxHistory.obImage),jsAjaxHistory.obImage.setAttribute("src","javascript:location.href = 'javascript:jsAjaxHistory.__hashListener();';")),jsAjaxHistory.bInited=!0}},__hashListener:function(){if(jsAjaxHistory.obTimer&&(window.clearTimeout(jsAjaxHistory.obTimer),jsAjaxHistory.obTimer=null),null!=jsAjaxHistory.obFrame)var t=jsAjaxHistory.obFrame.contentWindow.document.body.innerText;else var t=window.location.hash;if(t&&"#"!=t||(t="__bx_no_hash__"),0==t.indexOf("#")&&(t=t.substring(1)),t!=jsAjaxHistory.expected_hash){var e=jsAjaxHistoryContainer.get(t);if(e&&(document.getElementById(e.node).innerHTML=e.data,jsAjaxUtil.UpdatePageTitle(e.title),e.nav_chain&&jsAjaxUtil.UpdatePageNavChain(e.nav_chain),jsAjaxHistory.expected_hash=t,null!=jsAjaxHistory.obFrame)){var i="__bx_no_hash__"==t?"":t;window.location.hash!=i&&window.location.hash!="#"+i&&(window.location.hash=i)}}jsAjaxHistory.obTimer=setTimeout(jsAjaxHistory.__hashListener,500)},put:function(t,e){var i={node:t,title:window.document.title,data:document.getElementById(t).innerHTML},s=document.getElementById("navigation");s&&(i.nav_chain=s.innerHTML),jsAjaxHistoryContainer.put(e,i),jsAjaxHistory.expected_hash=e,window.location.hash=jsAjaxUtil.urlencode(e),null!=jsAjaxHistory.obFrame&&(jsAjaxHistory.obFrame.contentWindow.document.open(),jsAjaxHistory.obFrame.contentWindow.document.write(e),jsAjaxHistory.obFrame.contentWindow.document.close(),jsAjaxHistory.obFrame.contentWindow.document.title=i.title)},checkRedirectStart:function(t,e){var i=window.location.hash;"#"==i.substring(0,1)&&(i=i.substring(1)),"view/"==i.substring(0,5)&&(jsAjaxHistory.bHashCollision=!0,document.write('<div id="__ajax_hash_collision_'+e+'" style="display: none;">'))},checkRedirectFinish:function(t,e){document.write("</div>");var i=window.location.hash;"#"==i.substring(0,1)&&(i=i.substring(1)),jsEvent.addEvent(window,"load",function(){if("view/"==i.substring(0,5)){var s=document.getElementById("__ajax_hash_collision_"+e),n=s.firstChild;jsAjaxUtil.RemoveAllChild(n),s.style.display="block",jsAjaxUtil.IsIE()||jsAjaxUtil.IsOpera()||jsAjaxUtil.IsSafari()||(i=jsAjaxHistory.urlencode(i)),i+=(i.indexOf("%3F")==-1?"%3F":"%26")+t+"="+e;var o="/bitrix/tools/ajax_redirector.php?hash="+i;jsAjaxUtil.InsertDataToNode(o,n,!1)}})},urlencode:function(t){return window.encodeURIComponent?encodeURIComponent(t):window.encodeURI?encodeURI(t):jsAjaxUtil.urlencode(t)}},jsAjaxHistoryContainer={arHistory:{},put:function(t,e){this.arHistory[t]=e},get:function(t){return this.arHistory[t]}};[].pop||(Array.prototype.pop=function(){if(this.length<=0)return!1;var t=this[this.length-1];return delete this[this.length-1],this.length--,t},Array.prototype.shift=function(){if(this.length<=0)return!1;var t=this.reverse(),e=t.pop();return this.prototype=t.reverse(),e},Array.prototype.push=function(t){this[this.length]=t});var jsAjax=new CAjax;
//# sourceMappingURL=maps/kernel.js.map
