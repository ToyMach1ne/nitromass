function JCAdminTitleSearch(e){var t=this;this.arParams={AJAX_PAGE:e.AJAX_PAGE,CONTAINER_ID:e.CONTAINER_ID,INPUT_ID:e.INPUT_ID,MIN_QUERY_LEN:parseInt(e.MIN_QUERY_LEN)},e.WAIT_IMAGE&&(this.arParams.WAIT_IMAGE=e.WAIT_IMAGE),e.MIN_QUERY_LEN<=0&&(e.MIN_QUERY_LEN=1),this.cache=[],this.cache_key=null,this.startText="",this.currentRow=-1,this.RESULT=null,this.CONTAINER=null,this.INPUT=null,this.WAIT=null,this.Hide=function(){t.RESULT.style.display="none",t.RESULT.innerHTML="",t.currentRow=-1,t.UnSelectAll(),BX.removeClass(t.INPUT.parentNode,"adm-header-search-block-active-popup")},this.ShowResult=function(e){var s=BX.pos(t.CONTAINER);s.width=s.right-s.left,t.RESULT.style.position="absolute",t.RESULT.style.top="4px",t.RESULT.style.left=s.left-7+"px",t.RESULT.style.width=s.width+14+"px",null!=e&&(t.RESULT.innerHTML=e),t.RESULT.innerHTML.length>0?(t.RESULT.style.display="block",BX.addClass(t.INPUT.parentNode,"adm-header-search-block-active-popup")):this.Hide()},this.onKeyPress=function(e){var s=BX.findChild(t.RESULT,{tag:"table","class":"adm-search-result"},!0);if(!s)return!1;var a=s.rows.length;switch(e){case 27:return t.Hide(),!0;case 40:"none"==t.RESULT.style.display&&(t.RESULT.style.display="block");for(var n=-1,o=0;o<a;o++){if(n==-1&&(n=o),t.currentRow<o){t.currentRow=o;break}"adm-search-selected"==s.rows[o].className&&(s.rows[o].className="")}return o==a&&t.currentRow!=o&&(t.currentRow=n),s.rows[t.currentRow].className="adm-search-selected",!0;case 38:"none"==t.RESULT.style.display&&(t.RESULT.style.display="block");for(var r=-1,o=a-1;o>=0;o--){if(r==-1&&(r=o),t.currentRow>o){t.currentRow=o;break}"adm-search-selected"==s.rows[o].className&&(s.rows[o].className="")}return o<0&&(t.currentRow=r),s.rows[t.currentRow].className="adm-search-selected",!0;case 13:if("block"==t.RESULT.style.display)for(var o=0;o<a;o++)if(t.currentRow==o&&!BX.findChild(s.rows[o],{"class":"adm-search-separator"},!0)){var i=BX.findChild(s.rows[o],{tag:"a"},!0);if(i)return window.location=i.href,!0}return!1}return!1},this.onTimeout=function(){if(t.INPUT.value!=t.oldValue&&t.INPUT.value!=t.startText)if(t.INPUT.value.length>=t.arParams.MIN_QUERY_LEN)if(t.oldValue=t.INPUT.value,t.cache_key=t.arParams.INPUT_ID+"|"+t.INPUT.value,null==t.cache[t.cache_key]){if(t.WAIT){var e=BX.pos(t.INPUT),s=e.bottom-e.top-2;t.WAIT.style.top=e.top+1+"px",t.WAIT.style.height=s+"px",t.WAIT.style.width=s+"px",t.WAIT.style.left=e.right-s+2+"px",t.WAIT.style.display="block"}BX.ajax.post(t.arParams.AJAX_PAGE,{ajax_call:"y",INPUT_ID:t.arParams.INPUT_ID,q:t.INPUT.value},function(e){t.cache[t.cache_key]=e,t.ShowResult(e),t.currentRow=-1,t.EnableMouseEvents(),t.WAIT&&(t.WAIT.style.display="none"),setTimeout(t.onTimeout,500)})}else t.ShowResult(t.cache[t.cache_key]),t.currentRow=-1,t.EnableMouseEvents(),setTimeout(t.onTimeout,500);else t.Hide(),setTimeout(t.onTimeout,500);else setTimeout(t.onTimeout,500)},this.UnSelectAll=function(){var e=BX.findChild(t.RESULT,{tag:"table","class":"adm-search-result"},!0);if(e)for(var s=e.rows.length,a=0;a<s;a++)e.rows[a].className=""},this.EnableMouseEvents=function(){var e=BX.findChild(t.RESULT,{tag:"table","class":"adm-search-result"},!0);if(e)for(var s=e.rows.length,a=0;a<s;a++)e.rows[a].id="row_"+a,e.rows[a].onmouseover=function(e){t.currentRow!=this.id.substr(4)&&(t.UnSelectAll(),this.className="adm-search-selected",t.currentRow=this.id.substr(4))},e.rows[a].onmouseout=function(e){this.className="",t.currentRow=-1}},this.onFocusLost=function(e){setTimeout(function(){t.Hide()},250)},this.onFocusGain=function(){t.RESULT.innerHTML.length&&t.ShowResult()},this.onKeyDown=function(e){if(e||(e=window.event),"block"==t.RESULT.style.display&&t.onKeyPress(e.keyCode))return BX.PreventDefault(e)},this.Init=function(){this.CONTAINER=document.getElementById(this.arParams.CONTAINER_ID),this.RESULT=document.getElementById("bx-panel").appendChild(document.createElement("DIV")),this.RESULT.className="adm-search-result-wrap",this.RESULT.style.display="none",this.INPUT=document.getElementById(this.arParams.INPUT_ID),this.startText=this.oldValue=this.INPUT.value,BX.bind(this.INPUT,"focus",function(){t.onFocusGain()}),BX.bind(this.INPUT,"blur",function(){t.onFocusLost()}),BX.bind(window,"resize",function(){t.onFocusGain()}),BX.browser.IsSafari()||BX.browser.IsIE()?this.INPUT.onkeydown=this.onKeyDown:this.INPUT.onkeypress=this.onKeyDown,this.arParams.WAIT_IMAGE&&(this.WAIT=document.body.appendChild(document.createElement("DIV")),this.WAIT.style.backgroundImage="url('"+this.arParams.WAIT_IMAGE+"')",BX.browser.IsIE()||(this.WAIT.style.backgroundRepeat="none"),this.WAIT.style.display="none",this.WAIT.style.position="absolute",this.WAIT.style.zIndex="1100"),setTimeout(this.onTimeout,500)},BX.ready(function(){t.Init(e)})}
//# sourceMappingURL=maps/admin_search.js.map
