!function(window){BX.WindowManager||(BX.WindowManager={_stack:[],_runtime_resize:{},_delta:2,_delta_start:1e3,currently_loaded:null,settings_category:"BX.WindowManager.9.5",register:function(t){this.currently_loaded=null;var e=t.Get();e.style.zIndex=t.zIndex=this.GetZIndex(),t.WM_REG_INDEX=this._stack.length,this._stack.push(t),this._stack.length<2&&BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},unregister:function(t){if(null!=t.WM_REG_INDEX){var e;if(this._stack.length>0){for(;(e=this.__pop_stack())!=t;)if(!e){e=null;break}return this._stack.length<=0&&this.enableKeyCheck(),e}return null}},__pop_stack:function(t){if(this._stack.length>0){var e=this._stack.pop();return e.WM_REG_INDEX=null,BX.onCustomEvent(e,"onWindowUnRegister",[t===!0]),e}return null},clean:function(){for(;this.__pop_stack(!0););this._stack=null,this.disableKeyCheck()},Get:function(){return this.currently_loaded?this.currently_loaded:this._stack.length>0?this._stack[this._stack.length-1]:null},setStartZIndex:function(t){this._delta_start=t},restoreStartZIndex:function(){this._delta_start=1e3},GetZIndex:function(){var t=null!=(_current=this._stack[this._stack.length-1])?parseInt(_current.Get().style.zIndex)+this._delta:this._delta_start;return t},__get_check_url:function(t){var e=t.indexOf("?");return e==-1?t:t.substring(0,e)},saveWindowSize:function(t,e){var i=this.__get_check_url(t);BX.userOptions&&(BX.userOptions.save(this.settings_category,"size_"+i,"width",e.width),BX.userOptions.save(this.settings_category,"size_"+i,"height",e.height)),this._runtime_resize[i]=e},saveWindowOptions:function(t,e){if(BX.userOptions)for(var i in e)BX.userOptions.save(this.settings_category,"options_"+t,i,e[i])},getRuntimeWindowSize:function(t){return this._runtime_resize[this.__get_check_url(t)]},disableKeyCheck:function(){BX.unbind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},enableKeyCheck:function(){BX.bind(document,"keyup",BX.proxy(this.__checkKeyPress,this))},__checkKeyPress:function(t){if(null==t&&(t=window.event),27==t.keyCode){var e=BX.WindowManager.Get();e&&!e.unclosable&&e.Close()}}},BX.garbage(BX.WindowManager.clean,BX.WindowManager),BX.CWindowButton=function(t){t.btn?(this.btn=t.btn,this.parentWindow=t.parentWindow,/save|apply/i.test(this.btn.name)&&BX.bind(this.btn,"click",BX.delegate(this.disableUntilError,this))):(this.title=t.title,this.hint=t.hint,this.id=t.id,this.name=t.name,this.className=t.className,this.action=t.action,this.onclick=t.onclick,t.Button&&BX.type.isFunction(t.Button)&&(this.Button=t.Button),this.btn=null)},BX.CWindowButton.prototype.disable=function(){this.btn&&this.parentWindow.showWait(this.btn)},BX.CWindowButton.prototype.enable=function(){this.btn&&this.parentWindow.closeWait(this.btn)},BX.CWindowButton.prototype.emulate=function(){if(!this.btn||!this.btn.disabled){var t=this.action?BX.delegate(this.action,this):this.onclick?this.onclick:this.btn?this.btn.getAttribute("onclick"):"";t&&(setTimeout(t,50),this.btn&&/save|apply/i.test(this.btn.name)&&!this.action&&this.disableUntilError())}},BX.CWindowButton.prototype.Button=function(parentWindow){this.parentWindow=parentWindow;var btn={props:{type:"button",name:this.id?this.id:this.name,value:this.title?this.title:this.name,id:this.id}};return this.hint&&(btn.props.title=this.hint),this.className&&(btn.props.className=this.className),this.action?btn.events={click:BX.delegate(this.action,this)}:this.onclick&&(BX.browser.IsIE()?btn.events={click:BX.delegate(function(){eval(this.onclick)},this)}:btn.attrs={onclick:this.onclick}),this.btn=BX.create("INPUT",btn),this.btn},BX.CWindowButton.prototype.disableUntilError=function(){this.disable(),this.__window_error_handler_set||(BX.addCustomEvent(this.parentWindow,"onWindowError",BX.delegate(this.enable,this)),this.__window_error_handler_set=!0)},BX.CWindow=function(t,e){this.DIV=t||document.createElement("DIV"),this.SETTINGS={resizable:!1,min_height:0,min_width:0,top:0,left:0,draggable:!1,drag_restrict:!0,resize_restrict:!0},this.ELEMENTS={draggable:[],resizer:[],close:[]},this.type="float"==e?"float":"dialog",BX.adjust(this.DIV,{props:{className:"bx-core-window"},style:{zIndex:0,position:"absolute",display:"none",top:this.SETTINGS.top+"px",left:this.SETTINGS.left+"px",height:"100px",width:"100px"}}),this.isOpen=!1,BX.addCustomEvent(this,"onWindowRegister",BX.delegate(this.onRegister,this)),BX.addCustomEvent(this,"onWindowUnRegister",BX.delegate(this.onUnRegister,this)),this.MOUSEOVER=null,BX.bind(this.DIV,"mouseover",BX.delegate(this.__set_msover,this)),BX.bind(this.DIV,"mouseout",BX.delegate(this.__unset_msover,this)),BX.ready(BX.delegate(function(){document.body.appendChild(this.DIV)},this))},BX.CWindow.prototype.Get=function(){return this.DIV},BX.CWindow.prototype.visible=function(){return this.isOpen},BX.CWindow.prototype.Show=function(t){this.DIV.style.display="block",t||(BX.WindowManager.register(this),BX.onCustomEvent(this,"onWindowRegister"))},BX.CWindow.prototype.Hide=function(){BX.WindowManager.unregister(this),this.DIV.style.display="none"},BX.CWindow.prototype.onRegister=function(){this.isOpen=!0},BX.CWindow.prototype.onUnRegister=function(t){this.isOpen=!1,t||this.PARAMS&&this.PARAMS.content_url?(t&&BX.onCustomEvent(this,"onWindowClose",[this,!0]),this.DIV.parentNode&&this.DIV.parentNode.removeChild(this.DIV)):this.DIV.style.display="none"},BX.CWindow.prototype.CloseDialog=BX.CWindow.prototype.Close=function(t){if(BX.onCustomEvent(this,"onBeforeWindowClose",[this]),t!==!0&&this.denyClose)return!1;if(BX.onCustomEvent(this,"onWindowClose",[this]),this.bExpanded){var e=BX.GetDocElement();BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),e.style.overflow=this.__expand_settings.overflow}BX.WindowManager.unregister(this)},BX.CWindow.prototype.SetResize=function(t){t.style.cursor="se-resize",BX.bind(t,"mousedown",BX.proxy(this.__startResize,this)),this.ELEMENTS.resizer.push(t),this.SETTINGS.resizable=!0},BX.CWindow.prototype.SetExpand=function(t,e){e=e||"click",BX.bind(t,e,BX.proxy(this.__expand,this))},BX.CWindow.prototype.__expand_onresize=function(){var t=BX.GetWindowInnerSize();this.DIV.style.width=t.innerWidth+"px",this.DIV.style.height=t.innerHeight+"px",BX.onCustomEvent(this,"onWindowResize")},BX.CWindow.prototype.__expand=function(){var t=BX.GetDocElement();if(this.bExpanded)BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),this.SETTINGS.resizable=this.__expand_settings.resizable,this.SETTINGS.draggable=this.__expand_settings.draggable,t.style.overflow=this.__expand_settings.overflow,this.DIV.style.top=this.__expand_settings.top,this.DIV.style.left=this.__expand_settings.left,this.DIV.style.width=this.__expand_settings.width,this.DIV.style.height=this.__expand_settings.height,window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop),this.bExpanded=!1,BX.onCustomEvent(this,"onWindowNarrow"),BX.onCustomEvent(this,"onWindowResize");else{var e=BX.GetWindowScrollPos(),i=BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.DIV.style.width,height:this.DIV.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")},this.SETTINGS.resizable=!1,this.SETTINGS.draggable=!1,window.scrollTo(0,0),t.style.overflow="hidden",this.DIV.style.top="0px",this.DIV.style.left="0px",this.DIV.style.width=i.innerWidth+"px",this.DIV.style.height=i.innerHeight+"px",this.bExpanded=!0,BX.onCustomEvent(this,"onWindowExpand"),BX.onCustomEvent(this,"onWindowResize"),BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}},BX.CWindow.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width),s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();this.pos.left+i>o.scrollWidth-this.dw&&(i=o.scrollWidth-this.pos.left-this.dw)}this.DIV.style.width=i+"px",this.DIV.style.height=s+"px",BX.onCustomEvent(this,"onWindowResize")},BX.CWindow.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return!1;t||(t=window.event),this.wndSize=BX.GetWindowScrollPos(),this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth,this.pos=BX.pos(this.DIV),this.x=t.clientX+this.wndSize.scrollLeft,this.y=t.clientY+this.wndSize.scrollTop,this.dx=this.pos.left+this.pos.width-this.x,this.dy=this.pos.top+this.pos.height-this.y,this.dw=this.pos.width-parseInt(this.DIV.style.width),BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="se-resize",BX.onCustomEvent(this,"onWindowResizeStart")},BX.CWindow.prototype.__moveResize=function(t){t||(t=window.event);var e=BX.GetWindowScrollPos(),i=t.clientX+e.scrollLeft,s=t.clientY+e.scrollTop;this.x==i&&this.y==s||(this.Resize(i,s),this.x=i,this.y=s)},BX.CWindow.prototype.__stopResize=function(){document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.unbind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.onmousedown=null;var t=document.body;t.ondrag=t.onselectstart=null,t.style.MozUserSelect=this.DIV.style.MozUserSelect="",t.style.cursor="",BX.onCustomEvent(this,"onWindowResizeFinished")},BX.CWindow.prototype.SetClose=function(t){BX.bind(t,"click",BX.proxy(this.Close,this)),this.ELEMENTS.close.push(t)},BX.CWindow.prototype.SetDraggable=function(t){BX.bind(t,"mousedown",BX.proxy(this.__startDrag,this)),t.style.cursor="move",this.ELEMENTS.draggable.push(t),this.SETTINGS.draggable=!0},BX.CWindow.prototype.Move=function(t,e){var i=1,s=parseInt(this.DIV.style.left)+t,o=parseInt(this.DIV.style.top)+e;if(this.SETTINGS.drag_restrict){s<0&&(s=0);var n=BX.GetWindowScrollSize(),r=this.DIV.offsetWidth;floatHeight=this.DIV.offsetHeight,s>n.scrollWidth-r-i&&(s=n.scrollWidth-r-i),o>n.scrollHeight-floatHeight-i&&(o=n.scrollHeight-floatHeight-i),o<0&&(o=0)}this.DIV.style.left=s+"px",this.DIV.style.top=o+"px"},BX.CWindow.prototype.__startDrag=function(t){if(!this.SETTINGS.draggable)return!1;t||(t=window.event),this.x=t.clientX+document.body.scrollLeft,this.y=t.clientY+document.body.scrollTop,this.__bWasDragged=!1,BX.bind(document,"mousemove",BX.proxy(this.__moveDrag,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopDrag,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;return e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="move",BX.PreventDefault(t)},BX.CWindow.prototype.__moveDrag=function(t){t||(t=window.event);var e=t.clientX+document.body.scrollLeft,i=t.clientY+document.body.scrollTop;this.x==e&&this.y==i||(this.Move(e-this.x,i-this.y),this.x=e,this.y=i,this.__bWasDragged||(BX.onCustomEvent(this,"onWindowDragStart"),this.__bWasDragged=!0,BX.bind(BX.proxy_context,"click",BX.PreventDefault)),BX.onCustomEvent(this,"onWindowDrag"))},BX.CWindow.prototype.__stopDrag=function(t){document.body.releaseCapture&&document.body.releaseCapture(),BX.unbind(document,"mousemove",BX.proxy(this.__moveDrag,this)),BX.unbind(document,"mouseup",BX.proxy(this.__stopDrag,this)),document.onmousedown=null;var e=document.body;if(e.ondrag=e.onselectstart=null,e.style.MozUserSelect=this.DIV.style.MozUserSelect="",e.style.cursor="",this.__bWasDragged){BX.onCustomEvent(this,"onWindowDragFinished");var i=BX.proxy_context;setTimeout(function(){BX.unbind(i,"click",BX.PreventDefault)},100),this.__bWasDragged=!1}return BX.PreventDefault(t)},BX.CWindow.prototype.DenyClose=function(){this.denyClose=!0},BX.CWindow.prototype.AllowClose=function(){this.denyClose=!1},BX.CWindow.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]),this._wait&&BX.closeWait(this._wait),alert(t)},BX.CWindow.prototype.__set_msover=function(){this.MOUSEOVER=!0},BX.CWindow.prototype.__unset_msover=function(){this.MOUSEOVER=!1},BX.CWindowDialog=function(){arguments[1]="dialog",BX.CWindowDialog.superclass.constructor.apply(this,arguments),this.DIV.style.top="10px",this.OVERLAY=null},BX.extend(BX.CWindowDialog,BX.CWindow),BX.CWindowDialog.prototype.__resizeOverlay=function(){var t=BX.GetWindowScrollSize();this.OVERLAY.style.width=t.scrollWidth+"px"},BX.CWindowDialog.prototype.CreateOverlay=function(t){if(null==this.OVERLAY){var e=BX.GetWindowScrollSize();this.OVERLAY=document.body.appendChild(BX.create("DIV",{style:{position:"absolute",top:"0px",left:"0px",zIndex:t||parseInt(this.DIV.style.zIndex)-2,width:e.scrollWidth+"px",height:e.scrollHeight+"px"}}))}return this.OVERLAY},BX.CWindowDialog.prototype.Show=function(){BX.CWindowDialog.superclass.Show.apply(this,arguments),this.CreateOverlay(),this.OVERLAY.style.display="block",this.OVERLAY.style.zIndex=parseInt(this.DIV.style.zIndex)-2,BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this)),BX.bind(window,"resize",BX.proxy(this.__resizeOverlay,this))},BX.CWindowDialog.prototype.onUnRegister=function(t){BX.CWindowDialog.superclass.onUnRegister.apply(this,arguments),this.clean?this.OVERLAY.parentNode&&this.OVERLAY.parentNode.removeChild(this.OVERLAY):this.OVERLAY.style.display="none",BX.unbind(window,"resize",BX.proxy(this.__resizeOverlay,this))},BX.CDialog=function(t){BX.CDialog.superclass.constructor.apply(this),this._sender="core_window_cdialog",this.PARAMS=t||{};for(var e in this.defaultParams)"undefined"==typeof this.PARAMS[e]&&(this.PARAMS[e]=this.defaultParams[e]);if(this.PARAMS.width=isNaN(parseInt(this.PARAMS.width))?this.defaultParams.width:this.PARAMS.width,this.PARAMS.height=isNaN(parseInt(this.PARAMS.height))?this.defaultParams.height:this.PARAMS.height,this.PARAMS.resize_id||this.PARAMS.content_url){var i=BX.WindowManager.getRuntimeWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url);i&&(this.PARAMS.width=i.width,this.PARAMS.height=i.height)}BX.addClass(this.DIV,"bx-core-adm-dialog"),this.DIV.id="bx-admin-prefix",this.PARTS={},this.DIV.style.height=null,this.DIV.style.width=null,this.PARTS.TITLEBAR=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head"}})),this.PARTS.TITLE_CONTAINER=this.PARTS.TITLEBAR.appendChild(BX.create("SPAN",{props:{className:"bx-core-adm-dialog-head-inner"},text:this.PARAMS.title})),this.PARTS.TITLEBAR_ICONS=this.PARTS.TITLEBAR.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-icons"},children:this.PARAMS.resizable?[BX.create("SPAN",{props:{className:"bx-core-adm-icon-expand",title:BX.message("JS_CORE_WINDOW_EXPAND")}}),BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]:[BX.create("SPAN",{props:{className:"bx-core-adm-icon-close",title:BX.message("JS_CORE_WINDOW_CLOSE")}})]})),this.PARTS.CONTENT=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap adm-workarea"}})),this.PARTS.CONTENT_DATA=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-content"},style:{height:this.PARAMS.height+"px",width:this.PARAMS.width+"px"}})),this.PARTS.HEAD=this.PARTS.CONTENT_DATA.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-head-block"+(this.PARAMS.icon?" "+this.PARAMS.icon:"")}})),this.SetHead(this.PARAMS.head),this.SetContent(this.PARAMS.content),this.SetTitle(this.PARAMS.title),this.SetClose(this.PARTS.TITLEBAR_ICONS.lastChild),this.PARAMS.resizable&&(this.SetExpand(this.PARTS.TITLEBAR_ICONS.firstChild),BX.addCustomEvent(this,"onWindowExpand",BX.proxy(this.__onexpand,this)),BX.addCustomEvent(this,"onWindowNarrow",BX.proxy(this.__onexpand,this))),this.PARTS.FOOT=this.PARTS.BUTTONS_CONTAINER=this.PARTS.CONTENT.appendChild(BX.create("DIV",{props:{className:"bx-core-adm-dialog-buttons"},children:this.ShowButtons()})),this.PARAMS.draggable&&this.SetDraggable(this.PARTS.TITLEBAR),this.SetExpand(this.PARTS.TITLEBAR,"dblclick"),this.PARAMS.resizable&&(this.PARTS.RESIZER=this.DIV.appendChild(BX.create("DIV",{props:{className:"bx-core-resizer"}})),this.SetResize(this.PARTS.RESIZER),this.SETTINGS.min_width=this.PARAMS.min_width,this.SETTINGS.min_height=this.PARAMS.min_height),this.auth_callback=BX.delegate(function(){this.PARAMS.content="",this.hideNotify(),this.Show()},this)},BX.extend(BX.CDialog,BX.CWindowDialog),BX.CDialog.prototype.defaultParams={width:700,height:400,min_width:500,min_height:300,resizable:!0,draggable:!0,title:"",icon:""},BX.CDialog.prototype.showWait=function(t){if(BX.type.isElementNode(t)&&("button"==t.type||"submit"==t.type)){BX.defer(function(){t.disabled=!0})();var e=BX.hasClass(t,"adm-btn-save")||BX.hasClass(t,"adm-btn-save"),i=(BX.findParent(t,BX.is_fixed)||document.body,BX.pos(t,!0));return t.bxwaiter=this.PARTS.FOOT.appendChild(BX.create("DIV",{props:{className:"adm-btn-load-img"+(e?"-green":"")},style:{top:parseInt((i.bottom+i.top)/2-10)+"px",left:parseInt((i.right+i.left)/2-10)+"px"}})),BX.addClass(t,"adm-btn-load"),this.lastWaitElement=t,t.bxwaiter}},BX.CDialog.prototype.closeWait=function(t){t=t||this.lastWaitElement,BX.type.isElementNode(t)&&(t.bxwaiter&&(t.bxwaiter.parentNode&&t.bxwaiter.parentNode.removeChild(t.bxwaiter),t.bxwaiter=null),t.disabled=!1,BX.removeClass(t,"adm-btn-load"),this.lastWaitElement==t&&(this.lastWaitElement=null))},BX.CDialog.prototype.Authorize=function(t){this.bSkipReplaceContent=!0,this.ShowError(BX.message("JSADM_AUTH_REQ")),BX.onCustomEvent(this,"onWindowError",[]),BX.closeWait(),new BX.CAuthDialog({content_url:this.PARAMS.content_url,auth_result:t,callback:BX.delegate(function(){this.auth_callback&&this.auth_callback()},this)}).Show()},BX.CDialog.prototype.ShowError=function(t){BX.onCustomEvent(this,"onWindowError",[t]),this.closeWait(),this._wait&&BX.closeWait(this._wait),this.Notify(t,!0)},BX.CDialog.prototype.__expandGetSize=function(){var t=BX.GetDocElement();t.style.overflow="hidden";var e=BX.GetWindowInnerSize();return t.scrollTop=0,this.DIV.style.top="-"+this.dxShadow+"px",this.DIV.style.left="-"+this.dxShadow+"px",{width:e.innerWidth-parseInt(BX.style(this.PARTS.CONTENT,"padding-right"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-left"))+this.dxShadow,height:e.innerHeight-this.PARTS.TITLEBAR.offsetHeight-this.PARTS.FOOT.offsetHeight-parseInt(BX.style(this.PARTS.CONTENT,"padding-top"))-parseInt(BX.style(this.PARTS.CONTENT,"padding-bottom"))+this.dxShadow}},BX.CDialog.prototype.__expand=function(){var t=BX.GetDocElement();if(this.dxShadow=2,this.bExpanded)BX.unbind(window,"resize",BX.proxy(this.__expand_onresize,this)),this.SETTINGS.resizable=this.__expand_settings.resizable,this.SETTINGS.draggable=this.__expand_settings.draggable,t.style.overflow=this.__expand_settings.overflow,this.DIV.style.top=this.__expand_settings.top,this.DIV.style.left=this.__expand_settings.left,this.PARTS.CONTENT_DATA.style.width=this.__expand_settings.width,this.PARTS.CONTENT_DATA.style.height=this.__expand_settings.height,window.scrollTo(this.__expand_settings.scrollLeft,this.__expand_settings.scrollTop),this.bExpanded=!1,BX.onCustomEvent(this,"onWindowNarrow"),BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{width:parseInt(this.__expand_settings.width),height:parseInt(this.__expand_settings.height)}]);else{var e=BX.GetWindowScrollPos();BX.GetWindowInnerSize();this.__expand_settings={resizable:this.SETTINGS.resizable,draggable:this.SETTINGS.draggable,width:this.PARTS.CONTENT_DATA.style.width,height:this.PARTS.CONTENT_DATA.style.height,left:this.DIV.style.left,top:this.DIV.style.top,scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,overflow:BX.style(t,"overflow")},this.SETTINGS.resizable=!1,this.SETTINGS.draggable=!1;var i=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=i.width+"px",this.PARTS.CONTENT_DATA.style.height=i.height+"px",window.scrollTo(0,0),t.style.overflow="hidden",this.bExpanded=!0,BX.onCustomEvent(this,"onWindowExpand"),BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{width:i.width,height:i.height}]),BX.bind(window,"resize",BX.proxy(this.__expand_onresize,this))}},BX.CDialog.prototype.__expand_onresize=function(){var t=this.__expandGetSize();this.PARTS.CONTENT_DATA.style.width=t.width+"px",this.PARTS.CONTENT_DATA.style.height=t.height+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[t])},BX.CDialog.prototype.__onexpand=function(){var t=this.PARTS.TITLEBAR_ICONS.firstChild;t.className=BX.toggle(t.className,["bx-core-adm-icon-expand","bx-core-adm-icon-narrow"]),t.title=BX.toggle(t.title,[BX.message("JS_CORE_WINDOW_EXPAND"),BX.message("JS_CORE_WINDOW_NARROW")]),this.PARTS.RESIZER&&(this.PARTS.RESIZER.style.display=this.bExpanded?"none":"block")},BX.CDialog.prototype.__startResize=function(t){if(!this.SETTINGS.resizable)return!1;t||(t=window.event),this.wndSize=BX.GetWindowScrollPos(),this.wndSize.innerWidth=BX.GetWindowInnerSize().innerWidth,this.pos=BX.pos(this.PARTS.CONTENT_DATA),this.x=t.clientX+this.wndSize.scrollLeft,this.y=t.clientY+this.wndSize.scrollTop,this.dx=this.pos.left+this.pos.width-this.x,this.dy=this.pos.top+this.pos.height-this.y,this.dw=this.pos.width-parseInt(this.PARTS.CONTENT_DATA.style.width)+parseInt(BX.style(this.PARTS.CONTENT,"padding-right")),BX.bind(document,"mousemove",BX.proxy(this.__moveResize,this)),BX.bind(document,"mouseup",BX.proxy(this.__stopResize,this)),document.body.setCapture&&document.body.setCapture(),document.onmousedown=BX.False;var e=document.body;e.ondrag=e.onselectstart=BX.False,e.style.MozUserSelect=this.DIV.style.MozUserSelect="none",e.style.cursor="se-resize",BX.onCustomEvent(this,"onWindowResizeStart")},BX.CDialog.prototype.Resize=function(t,e){var i=Math.max(t-this.pos.left+this.dx,this.SETTINGS.min_width),s=Math.max(e-this.pos.top+this.dy,this.SETTINGS.min_height);if(this.SETTINGS.resize_restrict){var o=BX.GetWindowScrollSize();this.pos.left+i>o.scrollWidth-this.dw&&(i=o.scrollWidth-this.pos.left-this.dw)}this.PARTS.CONTENT_DATA.style.width=i+"px",this.PARTS.CONTENT_DATA.style.height=s+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[{height:s,width:i}])},BX.CDialog.prototype.SetSize=function(t){this.PARTS.CONTENT_DATA.style.width=t.width+"px",this.PARTS.CONTENT_DATA.style.height=t.height+"px",BX.onCustomEvent(this,"onWindowResize"),BX.onCustomEvent(this,"onWindowResizeExt",[t])},BX.CDialog.prototype.GetParameters=function(t){var e=this.GetForm();if(!e)return"";var i,s="",o=e.elements.length,n="";for(i=0;i<o;i++){""!=s&&(n="&");var r=e.elements[i];if(!r.disabled)switch(r.type.toLowerCase()){case"text":case"textarea":case"password":case"hidden":if(null==t&&"_alt"==r.name.substr(r.name.length-4)&&e.elements[r.name.substr(0,r.name.length-4)])break;s+=n+r.name+"="+BX.util.urlencode(r.value);break;case"radio":r.checked&&(s+=n+r.name+"="+BX.util.urlencode(r.value));break;case"checkbox":s+=n+r.name+"="+BX.util.urlencode(r.checked?"Y":"N");break;case"select-one":var h="";h=null==t&&e.elements[r.name+"_alt"]&&0==r.selectedIndex?e.elements[r.name+"_alt"].value:r.value,s+=n+r.name+"="+BX.util.urlencode(h);break;case"select-multiple":var a,l=!1,d=r.options.length;for(a=0;a<d;a++)r.options[a].selected&&(s+=n+r.name+"="+BX.util.urlencode(r.options[a].value),l=!0);l||(s+=n+r.name+"=")}}return s},BX.CDialog.prototype.PostParameters=function(t){var e=this.PARAMS.content_url;null==t&&(t=""),t+=(""==t?"":"&")+"bxsender="+this._sender,index=e.indexOf("?"),index==-1?e+="?"+t:e=e.substring(0,index)+"?"+t+"&"+e.substring(index+1),BX.showWait(),this.auth_callback=BX.delegate(function(){this.hideNotify(),this.PostParameters(t)},this),BX.ajax.post(e,this.GetParameters(),BX.delegate(function(t){BX.closeWait(),this.bSkipReplaceContent||(this.ClearButtons(),this.SetContent(t),this.Show(!0)),this.bSkipReplaceContent=!1},this))},BX.CDialog.prototype.Submit=function(t,e){var i=this.GetForm();if(i){if(i.onsubmit=null,i.method="POST",!i.action||e){var e=e||this.PARAMS.content_url;null!=t&&(index=e.indexOf("?"),index==-1?e+="?"+t:e=e.substring(0,index)+"?"+t+"&"+e.substring(index+1)),i.action=e}i._bxsender||(i._bxsender=i.appendChild(BX.create("INPUT",{attrs:{type:"hidden",name:"bxsender",value:this._sender}}))),this._wait=BX.showWait(),this.auth_callback=BX.delegate(function(){this.hideNotify(),this.Submit(t)},this),BX.ajax.submit(i,BX.delegate(function(){this.closeWait()},this))}else alert("no form registered!")},BX.CDialog.prototype.GetForm=function(){if(null==this.__form){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__form=t[0]?t[0]:null}return this.__form},BX.CDialog.prototype.GetRealForm=function(){if(null==this.__rform){var t=this.PARTS.CONTENT_DATA.getElementsByTagName("FORM");this.__rform=t[1]?t[1]:t[0]?t[0]:null}return this.__rform},BX.CDialog.prototype._checkButton=function(t){for(var e=["btnSave","btnCancel","btnClose"],i=0;i<e.length;i++)if(this[e[i]]&&t==this[e[i]])return e[i];return!1},BX.CDialog.prototype.ShowButtons=function(){var t=[];if(this.PARAMS.buttons){this.PARAMS.buttons.title&&(this.PARAMS.buttons=[this.PARAMS.buttons]);for(var e=0,i=this.PARAMS.buttons.length;e<i;e++)if(BX.type.isNotEmptyString(this.PARAMS.buttons[e]))t.push(this.PARAMS.buttons[e]);else if(this.PARAMS.buttons[e]){if(!BX.is_subclass_of(this.PARAMS.buttons[e],BX.CWindowButton)){var s=this._checkButton(this.PARAMS.buttons[e]);this.PARAMS.buttons[e]=new BX.CWindowButton(this.PARAMS.buttons[e]),s&&(this[s]=this.PARAMS.buttons[e])}t.push(this.PARAMS.buttons[e].Button(this))}}return t},BX.CDialog.prototype.setAutosave=function(){if(!this.bSetAutosaveDelay)return this.bSetAutosaveDelay=!0,void setTimeout(BX.proxy(this.setAutosave,this),10)},BX.CDialog.prototype.SetTitle=function(t){this.PARAMS.title=t,BX.cleanNode(this.PARTS.TITLE_CONTAINER).appendChild(document.createTextNode(this.PARAMS.title))},BX.CDialog.prototype.SetHead=function(t){this.PARAMS.head=BX.util.trim(t),this.PARTS.HEAD.innerHTML=this.PARAMS.head||"&nbsp;",this.PARTS.HEAD.style.display=this.PARAMS.head?"block":"none",this.adjustSize()},BX.CDialog.prototype.Notify=function(t,e){this.PARTS.NOTIFY||(this.PARTS.NOTIFY=this.DIV.insertBefore(BX.create("DIV",{props:{className:"adm-warning-block"},children:[BX.create("SPAN",{props:{className:"adm-warning-text"}}),BX.create("SPAN",{props:{className:"adm-warning-icon"}}),BX.create("SPAN",{props:{className:"adm-warning-close"},events:{click:BX.proxy(this.hideNotify,this)}})]}),this.DIV.firstChild)),e?BX.addClass(this.PARTS.NOTIFY,"adm-warning-block-red"):BX.removeClass(this.PARTS.NOTIFY,"adm-warning-block-red"),this.PARTS.NOTIFY.firstChild.innerHTML=t||"&nbsp;",this.PARTS.NOTIFY.firstChild.style.width=this.PARAMS.width+"px",BX.removeClass(this.PARTS.NOTIFY,"adm-warning-animate")},BX.CDialog.prototype.hideNotify=function(){BX.addClass(this.PARTS.NOTIFY,"adm-warning-animate")},BX.CDialog.prototype.__adjustHeadToIcon=function(){this.PARTS.HEAD.offsetHeight?(this.icon_image&&this.icon_image.height&&this.icon_image.height>this.PARTS.HEAD.offsetHeight-5&&(this.PARTS.HEAD.style.height=this.icon_image.height+5+"px",this.adjustSize()),this.icon_image.onload=null,this.icon_image=null):setTimeout(BX.delegate(this.__adjustHeadToIcon,this),50)},BX.CDialog.prototype.SetIcon=function(t){if(this.PARAMS.icon!=t&&(this.PARAMS.icon&&BX.removeClass(this.PARTS.HEAD,this.PARAMS.icon),this.PARAMS.icon=t,this.PARAMS.icon)){BX.addClass(this.PARTS.HEAD,this.PARAMS.icon);var e=(BX.style(this.PARTS.HEAD,"background-image")||BX.style(this.PARTS.HEAD,"backgroundImage")).replace('url("',"").replace('")',"");BX.type.isNotEmptyString(e)&&"none"!=e&&(this.icon_image=new Image,this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this),this.icon_image.src=e)}this.adjustSize()},BX.CDialog.prototype.SetIconFile=function(t){this.icon_image=new Image,this.icon_image.onload=BX.delegate(this.__adjustHeadToIcon,this),this.icon_image.src=t,BX.adjust(this.PARTS.HEAD,{style:{backgroundImage:"url("+t+")",backgroundPosition:"right 9px"}}),this.adjustSize()},BX.CDialog.prototype.SetButtons=function(t){if(BX.type.isString(t)){if(t.length>0){this.PARTS.BUTTONS_CONTAINER.innerHTML+=t;var e=this.PARTS.BUTTONS_CONTAINER.getElementsByTagName("INPUT");if(e.length>0){this.PARAMS.buttons=[];for(var i=0;i<e.length;i++)this.PARAMS.buttons.push(new BX.CWindowButton({btn:e[i],parentWindow:this}))}}}else this.PARAMS.buttons=t,BX.adjust(this.PARTS.BUTTONS_CONTAINER,{children:this.ShowButtons()});this.adjustSize()},BX.CDialog.prototype.ClearButtons=function(){BX.cleanNode(this.PARTS.BUTTONS_CONTAINER),this.adjustSize()},BX.CDialog.prototype.SetContent=function(t){this.__form=null,BX.type.isElementNode(t)?t.parentNode&&t.parentNode.removeChild(t):BX.type.isString(t)&&(t=BX.create("DIV",{html:t})),this.PARAMS.content=t,BX.cleanNode(this.PARTS.CONTENT_DATA),BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARTS.HEAD,BX.create("DIV",{props:{className:"bx-core-adm-dialog-content-wrap-inner"},children:[this.PARAMS.content]})]}),this.PARAMS.content_url&&this.GetForm()&&(this.__form.submitbtn=this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}})),this.__form.onsubmit=BX.delegate(this.__submit,this))},BX.CDialog.prototype.__submit=function(t){for(var e=0,i=this.PARAMS.buttons.length;e<i;e++)if(this.PARAMS.buttons[e]&&(this.PARAMS.buttons[e].name&&/save|apply/i.test(this.PARAMS.buttons[e].name)||this.PARAMS.buttons[e].btn&&this.PARAMS.buttons[e].btn.name&&/save|apply/i.test(this.PARAMS.buttons[e].btn.name))){this.PARAMS.buttons[e].emulate();break}return BX.PreventDefault(t)},BX.CDialog.prototype.SwapContent=function(t){t=BX(t),BX.cleanNode(this.PARTS.CONTENT_DATA),t.parentNode.removeChild(t),this.PARTS.CONTENT_DATA.appendChild(t),t.style.display="block",this.SetContent(t.innerHTML)},BX.CDialog.prototype.adjustSize=function(){},BX.CDialog.prototype.__adjustSize=function(){},BX.CDialog.prototype.adjustSizeEx=function(){BX.defer(this.__adjustSizeEx,this)()},BX.CDialog.prototype.__adjustSizeEx=function(){for(var t=this.PARTS.CONTENT_DATA.firstChild,e=0;t;)e+=t.offsetHeight+parseInt(BX.style(t,"margin-top"))+parseInt(BX.style(t,"margin-bottom")),t=BX.nextSibling(t);e&&(this.PARTS.CONTENT_DATA.style.height=e+"px")},BX.CDialog.prototype.__onResizeFinished=function(){BX.WindowManager.saveWindowSize(this.PARAMS.resize_id||this.PARAMS.content_url,{height:parseInt(this.PARTS.CONTENT_DATA.style.height),width:parseInt(this.PARTS.CONTENT_DATA.style.width)})},BX.CDialog.prototype.Show=function(t){if(!this.PARAMS.content&&this.PARAMS.content_url&&BX.ajax&&!t){var e=BX.showWait();BX.WindowManager.currently_loaded=this,this.CreateOverlay(parseInt(BX.style(e,"z-index"))-1),this.OVERLAY.style.display="block",this.OVERLAY.className="bx-core-dialog-overlay";var i="",s="GET";this.PARAMS.content_post&&(i=this.PARAMS.content_post,s="POST");var o=this.PARAMS.content_url+(this.PARAMS.content_url.indexOf("?")<0?"?":"&")+"bxsender="+this._sender;this.auth_callback=BX.delegate(function(){this.PARAMS.content="",this.hideNotify(),this.Show()},this),BX.ajax({method:s,dataType:"html",url:o,data:i,onsuccess:BX.delegate(function(t){BX.closeWait(null,e),this.SetContent(t||"&nbsp;"),this.Show()},this),processScriptsConsecutive:!0})}else BX.WindowManager.currently_loaded=null,BX.CDialog.superclass.Show.apply(this,arguments),this.adjustPos(),this.OVERLAY.className="bx-core-dialog-overlay",this.__adjustSize(),BX.addCustomEvent(this,"onWindowResize",BX.proxy(this.__adjustSize,this)),this.PARAMS.resizable&&(this.PARAMS.content_url||this.PARAMS.resize_id)&&BX.addCustomEvent(this,"onWindowResizeFinished",BX.delegate(this.__onResizeFinished,this))},BX.CDialog.prototype.GetInnerPos=function(){return{width:parseInt(this.PARTS.CONTENT_DATA.style.width),height:parseInt(this.PARTS.CONTENT_DATA.style.height)}},BX.CDialog.prototype.adjustPos=function(){
if(!this.bExpanded){var t=BX.GetWindowInnerSize(),e=BX.GetWindowScrollPos();BX.adjust(this.DIV,{style:{left:parseInt(e.scrollLeft+t.innerWidth/2-parseInt(this.DIV.offsetWidth)/2)+"px",top:Math.max(parseInt(e.scrollTop+t.innerHeight/2-parseInt(this.DIV.offsetHeight)/2),0)+"px"}})}},BX.CDialog.prototype.GetContent=function(){return this.PARTS.CONTENT_DATA},BX.CDialog.prototype.btnSave=BX.CDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:BX.browser.IsIE()&&BX.browser.IsDoctype()&&!BX.browser.IsIE10()?"":"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.PostParameters()}},BX.CDialog.prototype.btnCancel=BX.CDialog.btnCancel={title:BX.message("JS_CORE_WINDOW_CANCEL"),id:"cancel",name:"cancel",action:function(){this.parentWindow.Close()}},BX.CDialog.prototype.btnClose=BX.CDialog.btnClose={title:BX.message("JS_CORE_WINDOW_CLOSE"),id:"close",name:"close",action:function(){this.parentWindow.Close()}},BX.CAdminDialog=function(t){BX.CAdminDialog.superclass.constructor.apply(this,arguments),this._sender="core_window_cadmindialog",BX.addClass(this.DIV,"bx-core-adm-admin-dialog"),this.PARTS.CONTENT.insertBefore(this.PARTS.HEAD,this.PARTS.CONTENT.firstChild),this.PARTS.HEAD.className="bx-core-adm-dialog-tabs"},BX.extend(BX.CAdminDialog,BX.CDialog),BX.CAdminDialog.prototype.SetHead=function(){if(BX.CAdminDialog.superclass.SetHead.apply(this,arguments),this.PARTS.HEAD.firstChild&&BX.type.isElementNode(this.PARTS.HEAD.firstChild)){for(var t=this.PARTS.HEAD.firstChild,e=0;t;)e+=t.offsetWidth+parseInt(BX.style(t,"margin-left"))+parseInt(BX.style(t,"margin-right")),t=BX.nextSibling(t);this.SETTINGS.min_width=Math.max(e,this.SETTINGS.min_width)-2,this.PARAMS.width<this.SETTINGS.min_width&&BX.adjust(this.PARTS.CONTENT_DATA,{style:{width:this.SETTINGS.min_width+"px"}})}},BX.CAdminDialog.prototype.SetContent=function(t){this.__form=null,BX.type.isElementNode(t)&&t.parentNode&&t.parentNode.removeChild(t),this.PARAMS.content=t,BX.cleanNode(this.PARTS.CONTENT_DATA),BX.adjust(this.PARTS.CONTENT_DATA,{children:[this.PARAMS.content||"&nbsp;"]}),this.PARAMS.content_url&&this.GetForm()&&(this.__form.appendChild(BX.create("INPUT",{props:{type:"submit"},style:{display:"none"}})),this.__form.onsubmit=BX.delegate(this.__submit,this))},BX.CAdminDialog.prototype.__adjustSizeEx=function(){var t=BX.firstChild(this.PARTS.CONTENT_DATA).offsetHeight;t&&(this.PARTS.CONTENT_DATA.style.height=t+"px")},BX.CAdminDialog.prototype.__expandGetSize=function(){var t=BX.CAdminDialog.superclass.__expandGetSize.apply(this,arguments);return t.width-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-right"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-left")),t.height-=parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-top"))+parseInt(BX.style(this.PARTS.CONTENT_DATA,"padding-bottom")),t.height-=this.PARTS.HEAD.offsetHeight,t},BX.CAdminDialog.prototype.Submit=function(){var t=this.GetForm();return!t||t.bxpublic||/bxpublic=/.test(t.action)||t.appendChild(BX.create("INPUT",{props:{type:"hidden",name:"bxpublic",value:"Y"}})),BX.CAdminDialog.superclass.Submit.apply(this,arguments)},BX.CAdminDialog.prototype.btnSave=BX.CAdminDialog.btnSave={title:BX.message("JS_CORE_WINDOW_SAVE"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.Submit()}},BX.CAdminDialog.btnCancel=BX.CAdminDialog.superclass.btnCancel,BX.CAdminDialog.btnClose=BX.CAdminDialog.superclass.btnClose,BX.CDebugDialog=function(t){BX.CDebugDialog.superclass.constructor.apply(this,arguments)},BX.extend(BX.CDebugDialog,BX.CDialog),BX.CDebugDialog.prototype.ShowDetails=function(t){var e=BX(t);e&&(this.div_detail_current&&(this.div_detail_current.style.display="none"),e.style.display="block",this.div_detail_current=e)},BX.CDebugDialog.prototype.SetContent=function(t){if(t){var e=t.split("#DIVIDER#");e.length>1?(this.PARAMS.content=e[1],this.PARTS.CONTENT_DATA.style.overflow="hidden",BX.CDebugDialog.superclass.SetContent.apply(this,[e[1]]),this.PARTS.CONTENT_INNER=this.PARTS.CONTENT_DATA.firstChild.nextSibling,this.PARTS.CONTENT_TOP=this.PARTS.CONTENT_DATA.insertBefore(BX.create("DIV",{props:{className:"bx-debug-content-top"},html:e[0]}),this.PARTS.CONTENT_INNER),this.PARTS.CONTENT_INNER.style.overflow="auto"):BX.CDebugDialog.superclass.SetContent.apply(this,arguments)}},BX.CDebugDialog.prototype.__adjustSize=function(){if(BX.CDebugDialog.superclass.__adjustSize.apply(this,arguments),this.PARTS.CONTENT_TOP){var t=this.PARTS.CONTENT_DATA.offsetHeight-this.PARTS.HEAD.offsetHeight-this.PARTS.CONTENT_TOP.offsetHeight-38;t>0&&(this.PARTS.CONTENT_INNER.style.height=t+"px")}},BX.CEditorDialog=function(t){BX.CEditorDialog.superclass.constructor.apply(this,arguments),BX.removeClass(this.PARTS.CONTENT,"bx-core-adm-dialog-content-wrap"),BX.removeClass(this.PARTS.CONTENT_DATA,"bx-core-adm-dialog-content"),BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner"),BX.removeClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-adm-dialog-buttons"),BX.addClass(this.PARTS.CONTENT,"bx-core-editor-dialog-content-wrap"),BX.addClass(this.PARTS.CONTENT_DATA,"bx-core-editor-dialog-content"),BX.addClass(this.PARTS.BUTTONS_CONTAINER,"bx-core-editor-dialog-buttons")},BX.extend(BX.CEditorDialog,BX.CDialog),BX.CEditorDialog.prototype.SetContent=function(){BX.CEditorDialog.superclass.SetContent.apply(this,arguments),BX.removeClass(this.PARTS.CONTENT_DATA.lastChild,"bx-core-adm-dialog-content-wrap-inner")},BX.CAuthDialog=function(t){t.resizable=!1,t.width=350,t.height=200,t.buttons=[this.btnSave],BX.CAuthDialog.superclass.constructor.apply(this,arguments),this._sender="core_window_cauthdialog",BX.addClass(this.DIV,"bx-core-auth-dialog"),BX.AUTHAGENT=this},BX.extend(BX.CAuthDialog,BX.CDialog),BX.CAuthDialog.prototype.btnSave=BX.CAuthDialog.btnSave={title:BX.message("JS_CORE_WINDOW_AUTH"),id:"savebtn",name:"savebtn",className:"adm-btn-save",action:function(){this.disableUntilError(),this.parentWindow.Submit({},this.parentWindow.PARAMS.content_url)}},BX.CAuthDialog.prototype.SetError=function(t){BX.closeWait(),t&&this.ShowError(t.MESSAGE||t)},BX.CAuthDialog.prototype.setAuthResult=function(t){BX.closeWait(),t===!1?(this.Close(),this.PARAMS.callback&&this.PARAMS.callback()):this.SetError(t)},BX.CWindowFloat=function(t){BX.CWindowFloat.superclass.constructor.apply(this,[t,"float"]),this.SETTINGS.resizable=!1},BX.extend(BX.CWindowFloat,BX.CWindow),BX.CWindowFloat.prototype.adjustPos=function(){this.PARAMS.parent?this.adjustToNode():this.PARAMS.x&&this.PARAMS.y&&this.adjustToPos([this.PARAMS.x,this.PARAMS.y])},BX.CWindowFloat.prototype.adjustToPos=function(t){this.DIV.style.left=parseInt(t[0])+"px",this.DIV.style.top=parseInt(t[1])+"px"},BX.CWindowFloat.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent);return t},BX.CWindowFloat.prototype.adjustToNode=function(t){if(t=t||this.PARAMS.parent,this.PARAMS.parent=BX(t),this.PARAMS.parent){var e=this.adjustToNodeGetPos();this.DIV.style.top=e.top+"px",this.DIV.style.left=e.left+"px",this.PARAMS.parent.OPENER=this}},BX.CWindowFloat.prototype.Show=function(){this.adjustToPos([-1e3,-1e3]),BX.CWindowFloat.superclass.Show.apply(this,arguments),this.adjustPos()},BX.COpener=function(t){this.PARAMS=t||{},this.MENU=t.MENU||[],this.DIV=t.DIV,this.ATTACH=t.ATTACH||t.DIV,this.ATTACH_MODE=t.ATTACH_MODE||"bottom",this.ACTIVE_CLASS=t.ACTIVE_CLASS||"",this.LEVEL=t.LEVEL||0,this.CLOSE_ON_CLICK="undefined"==typeof t.CLOSE_ON_CLICK||!!t.CLOSE_ON_CLICK,this.ADJUST_ON_CLICK="undefined"==typeof t.ADJUST_ON_CLICK||!!t.ADJUST_ON_CLICK,this.TYPE="hover"==this.PARAMS.TYPE?"hover":"click",this._openTimeout=null,"hover"==this.PARAMS.TYPE&&0!==t.TIMEOUT?this.TIMEOUT=t.TIMEOUT||1e3:this.TIMEOUT=0,this.PARAMS.MENU_URL&&(this.bMenuLoaded=!1,this.bMenuLoading=!1,this.MENU=[{TEXT:BX.message("JS_CORE_LOADING"),CLOSE_ON_CLICK:!1}],this.PARAMS.MENU_PRELOAD&&BX.defer(this.Load,this)()),BX.ready(BX.defer(this.Init,this))},BX.COpener.prototype.Init=function(){switch(this.DIV=BX(this.DIV),this.TYPE){case"hover":BX.bind(this.DIV,"mouseover",BX.proxy(this.Open,this)),BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this));break;case"click":BX.bind(this.DIV,"click",BX.proxy(this.Toggle,this))}this.bMenuInit=!1},BX.COpener.prototype.Load=function(){if(this.PARAMS.MENU_URL&&!this.bMenuLoaded&&!this.bMenuLoading){var t=this.PARAMS.MENU_URL;t.indexOf("sessid=")<=0&&(t+=(t.indexOf("?")>0?"&":"?")+"sessid="+BX.bitrix_sessid()),this.bMenuLoading=!0,BX.ajax.loadJSON(t,BX.proxy(this.SetMenu,this),BX.proxy(this.LoadFailed,this))}},BX.COpener.prototype.SetMenu=function(t){this.bMenuLoaded=!0,this.bMenuLoading=!1,this.bMenuInit?this.MENU.setItems(t):this.MENU=t},BX.COpener.prototype.LoadFailed=function(){this.bMenuLoading=!1,BX.debug(arguments)},BX.COpener.prototype.checkAdminMenu=function(){return"bx-admin-prefix"==document.documentElement.id||!!BX.findParent(this.DIV,{property:{id:"bx-admin-prefix"}})},BX.COpener.prototype.Toggle=function(t){if(this.__clear_timeout(),this.bMenuInit&&this.MENU.visible())this.MENU.Close();else{var e=this.TIMEOUT;this.TIMEOUT=0,this.Open(t),this.TIMEOUT=e}return!(!t&&!window.event)&&BX.PreventDefault(t)},BX.COpener.prototype.GetMenu=function(){return this.bMenuInit||(BX.type.isArray(this.MENU)&&(this.MENU=new BX.CMenu({ITEMS:this.MENU,ATTACH_MODE:this.ATTACH_MODE,SET_ID:this.checkAdminMenu()?"bx-admin-prefix":"",CLOSE_ON_CLICK:!!this.CLOSE_ON_CLICK,ADJUST_ON_CLICK:!!this.ADJUST_ON_CLICK,LEVEL:this.LEVEL,parent:BX(this.DIV),parent_attach:BX(this.ATTACH)}),this.LEVEL>0&&(BX.bind(this.MENU.DIV,"mouseover",BX.proxy(this._on_menu_hover,this)),BX.bind(this.MENU.DIV,"mouseout",BX.proxy(this._on_menu_hout,this)))),BX.addCustomEvent(this.MENU,"onMenuOpen",BX.proxy(this.handler_onopen,this)),BX.addCustomEvent(this.MENU,"onMenuClose",BX.proxy(this.handler_onclose,this)),BX.addCustomEvent("onMenuItemHover",BX.proxy(this.handler_onover,this)),this.bMenuInit=!0),this.MENU},BX.COpener.prototype.Open=function(t){return this.GetMenu(),this.bOpen=!0,this.__clear_timeout(),this.TIMEOUT>0?(BX.bind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this)),this._openTimeout=setTimeout(BX.proxy(this.__open,this),this.TIMEOUT)):this.__open(),this.PARAMS.MENU_URL&&!this.bMenuLoaded&&(this._loadTimeout=setTimeout(BX.proxy(this.Load,this),parseInt(this.TIMEOUT/2))),!0},BX.COpener.prototype.__clear_timeout=function(){this._openTimeout&&clearTimeout(this._openTimeout),this._loadTimeout&&clearTimeout(this._loadTimeout),BX.unbind(this.DIV,"mouseout",BX.proxy(this.__clear_timeout,this))},BX.COpener.prototype._on_menu_hover=function(){this.bMenuHover=!0,this.__clear_timeout(),this.ACTIVE_CLASS&&BX.addClass(this.DIV,this.ACTIVE_CLASS)},BX.COpener.prototype._on_menu_hout=function(){this.bMenuHover=!1},BX.COpener.prototype.handler_onover=function(t,e){this.bMenuHover||(e!=this&&t==this.LEVEL-1&&this.ACTIVE_CLASS&&BX.removeClass(this.DIV,this.ACTIVE_CLASS),this.bMenuInit&&t<=this.LEVEL-1&&this.MENU.visible()&&e!=this&&(this.__clear_timeout(),this._openTimeout=setTimeout(BX.proxy(this.Close,this),this.TIMEOUT)))},BX.COpener.prototype.handler_onopen=function(){this.bOpen=!0,this.ACTIVE_CLASS&&BX.addClass(this.DIV,this.ACTIVE_CLASS),BX.defer(function(){BX.onCustomEvent(this,"onOpenerMenuOpen")},this)()},BX.COpener.prototype.handler_onclose=function(){this.bOpen=!1,BX.onCustomEvent(this,"onOpenerMenuClose"),this.ACTIVE_CLASS&&BX.removeClass(this.DIV,this.ACTIVE_CLASS)},BX.COpener.prototype.Close=function(t){this.bMenuInit&&(this._openTimeout&&clearTimeout(this._openTimeout),this.bOpen=!1,this.__close())},BX.COpener.prototype.__open=function(){this.__clear_timeout(),this.bMenuInit&&this.bOpen&&!this.MENU.visible()&&this.MENU.Show()},BX.COpener.prototype.__close=function(){this.bMenuInit&&!this.bOpen&&this.MENU.visible()&&this.MENU.Hide()},BX.COpener.prototype.__close_immediately=function(){this.bOpen=!1,this.__close()},BX.COpener.prototype.isMenuVisible=function(){return null!=this.MENU.visible&&this.MENU.visible()},BX.CMenu=function(t){BX.CMenu.superclass.constructor.apply(this),this.DIV.style.width="auto",this.DIV.style.height="auto",this.PARAMS=t||{},this.PARTS={},this.PARAMS.ATTACH_MODE=this.PARAMS.ATTACH_MODE||"bottom",this.PARAMS.CLOSE_ON_CLICK="undefined"==typeof this.PARAMS.CLOSE_ON_CLICK||this.PARAMS.CLOSE_ON_CLICK,this.PARAMS.ADJUST_ON_CLICK="undefined"==typeof this.PARAMS.ADJUST_ON_CLICK||this.PARAMS.ADJUST_ON_CLICK,this.PARAMS.LEVEL=this.PARAMS.LEVEL||0,this.DIV.className="bx-core-popup-menu bx-core-popup-menu-"+this.PARAMS.ATTACH_MODE+" bx-core-popup-menu-level"+this.PARAMS.LEVEL,+("undefined"!=typeof this.PARAMS.ADDITIONAL_CLASS?" "+this.PARAMS.ADDITIONAL_CLASS:""),this.PARAMS.SET_ID&&(this.DIV.id=this.PARAMS.SET_ID),0==this.PARAMS.LEVEL&&(this.ARROW=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-core-popup-menu-angle"},style:{left:"15px"}}))),this.PARAMS.CLASS_NAME&&(this.DIV.className+=" "+this.PARAMS.CLASS_NAME),BX.bind(this.DIV,"click",BX.eventCancelBubble),this.ITEMS=[],this.setItems(this.PARAMS.ITEMS),BX.addCustomEvent("onMenuOpen",BX.proxy(this._onMenuOpen,this)),BX.addCustomEvent("onMenuItemSelected",BX.proxy(this.Hide,this))},BX.extend(BX.CMenu,BX.CWindowFloat),BX.CMenu.broadcastCloseEvent=function(){BX.onCustomEvent("onMenuItemSelected")},BX.CMenu._toggleChecked=function(){BX.toggleClass(this,"bx-core-popup-menu-item-checked")},BX.CMenu._itemDblClick=function(){window.location.href=this.href},BX.CMenu.prototype.toggleArrow=function(t){this.ARROW&&("undefined"==typeof t&&(t="hidden"==this.ARROW.style.visibility),this.ARROW.style.visibility=t?"visible":"hidden")},BX.CMenu.prototype.visible=function(){return"none"!==this.DIV.style.display},BX.CMenu.prototype._onMenuOpen=function(t,e){this.visible()&&e==this.PARAMS.LEVEL&&t!=this&&this.Hide()},BX.CMenu.prototype.onUnRegister=function(){this.visible()&&this.Hide()},BX.CMenu.prototype.setItems=function(t){if(this.PARAMS.ITEMS=t,BX.cleanNode(this.DIV),this.ARROW&&this.DIV.appendChild(this.ARROW),this.PARAMS.ITEMS){this.PARAMS.ITEMS=BX.util.array_values(this.PARAMS.ITEMS);for(var e=!1,i=0,s=0,o=this.PARAMS.ITEMS.length;s<o;s++)(0!=s&&s!=o-1||!this.PARAMS.ITEMS[s].SEPARATOR)&&(i++,e||(e=!!this.PARAMS.ITEMS[s].GLOBAL_ICON),this.addItem(this.PARAMS.ITEMS[s],s));1===i?BX.addClass(this.DIV,"bx-core-popup-menu-single-item"):BX.removeClass(this.DIV,"bx-core-popup-menu-single-item"),e?BX.removeClass(this.DIV,"bx-core-popup-menu-no-icons"):BX.addClass(this.DIV,"bx-core-popup-menu-no-icons")}},BX.CMenu.prototype.addItem=function(t,e){if(this.ITEMS.push(t),t.SEPARATOR)t.NODE=BX.create("DIV",{props:{className:"bx-core-popup-menu-separator"}});else{var i=!!t.MENU&&(BX.type.isArray(t.MENU)&&t.MENU.length>0||t.MENU instanceof BX.CMenu)||!!t.MENU_URL;t.DISABLED&&(t.CLOSE_ON_CLICK=!1,t.LINK=null,t.ONCLICK=null,t.ACTION=null),t.NODE=BX.create(t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?"A":"SPAN",{props:{className:"bx-core-popup-menu-item"+(i?" bx-core-popup-menu-item-opener":"")+(t.DEFAULT?" bx-core-popup-menu-item-default":"")+(t.DISABLED?" bx-core-popup-menu-item-disabled":"")+(t.CHECKED?" bx-core-popup-menu-item-checked":""),title:BX.message.MENU_ENABLE_TOOLTIP?t.TITLE||"":"",BXMENULEVEL:this.PARAMS.LEVEL},attrs:t.LINK||BX.browser.IsIE()&&!BX.browser.IsDoctype()?{href:t.LINK||"javascript:void(0)"}:{},events:{mouseover:function(){BX.onCustomEvent("onMenuItemHover",[this.BXMENULEVEL,this.OPENER])}},html:'<span class="bx-core-popup-menu-item-icon'+(t.GLOBAL_ICON?" "+t.GLOBAL_ICON:"")+'"></span><span class="bx-core-popup-menu-item-text">'+t.TEXT+"</span>"}),i&&!t.DISABLED?t.NODE.OPENER=new BX.COpener({DIV:t.NODE,ACTIVE_CLASS:"bx-core-popup-menu-item-opened",TYPE:"hover",MENU:t.MENU,MENU_URL:t.MENU_URL,MENU_PRELOAD:!!t.MENU_PRELOAD,LEVEL:this.PARAMS.LEVEL+1,ATTACH_MODE:"right",TIMEOUT:500}):this.PARAMS.CLOSE_ON_CLICK&&("undefined"==typeof t.CLOSE_ON_CLICK||t.CLOSE_ON_CLICK)?BX.bind(t.NODE,"click",BX.CMenu.broadcastCloseEvent):this.PARAMS.ADJUST_ON_CLICK&&("undefined"==typeof t.ADJUST_ON_CLICK||t.ADJUST_ON_CLICK)&&BX.bind(t.NODE,"click",BX.defer(this.adjustPos,this)),i&&t.LINK&&BX.bind(t.NODE,"dblclick",BX.CMenu._itemDblClick),"undefined"!=typeof t.CHECKED&&BX.bind(t.NODE,"click",BX.CMenu._toggleChecked),t.ONCLICK=t.ACTION||t.ONCLICK,t.ONCLICK&&(BX.type.isString(t.ONCLICK)&&(t.ONCLICK=new Function("event",t.ONCLICK)),BX.bind(t.NODE,"click",t.ONCLICK))}this.DIV.appendChild(t.NODE)},BX.CMenu.prototype._documentClickBind=function(){this._documentClickUnBind(),BX.bind(document,"click",BX.proxy(this._documentClick,this))},BX.CMenu.prototype._documentClickUnBind=function(){BX.unbind(document,"click",BX.proxy(this._documentClick,this))},BX.CMenu.prototype._documentClick=function(t){t=t||window.event,(!t||BX.getEventButton(t)&BX.MSLEFT)&&this.Close()},BX.CMenu.prototype.Show=function(){BX.onCustomEvent(this,"onMenuOpen",[this,this.PARAMS.LEVEL]),BX.CMenu.superclass.Show.apply(this,[]),this.bCloseEventFired=!1,BX.addCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this)),BX.defer(this._documentClickBind,this)()},BX.CMenu.prototype.Close=BX.CMenu.prototype.Hide=function(){this.visible()&&(BX.removeCustomEvent(this.PARAMS.parent_attach,"onChangeNodePosition",BX.proxy(this.adjustToNode,this)),this._documentClickUnBind(),this.bCloseEventFired||(BX.onCustomEvent(this,"onMenuClose",[this,this.PARAMS.LEVEL]),this.bCloseEventFired=!0),BX.CMenu.superclass.Hide.apply(this,arguments))},BX.CMenu.prototype.__adjustMenuToNode=function(){var t=BX.pos(this.PARAMS.parent_attach),e=!!BX.findParent(this.PARAMS.parent_attach,BX.is_fixed);if(e?this.DIV.style.position="fixed":this.DIV.style.position="absolute",t.top||(this.DIV.style.top="-1000px",this.DIV.style.left="-1000px"),!this.bTimeoutSet){var i=this.DIV.offsetWidth,s=this.DIV.offsetHeight;if(!i)return setTimeout(BX.delegate(function(){this.bTimeoutSet=!1,this.__adjustMenuToNode()},this),100),void(this.bTimeoutSet=!0);var o={},n=BX.GetWindowSize();switch(this.PARAMS.ATTACH_MODE){case"bottom":if(o.top=t.bottom+9,o.left=t.left,this.ARROW){var r=parseInt(this.ARROW.style.left);r=t.width>i?parseInt(i/2-7):parseInt(Math.min(i,t.width)/2-7),r<7&&(o.left-=15,r+=15)}if(o.left>n.scrollWidth-i-10){var h=o.left;o.left=n.scrollWidth-i-10,this.ARROW&&(r+=h-o.left)}e&&(o.left-=n.scrollLeft),this.ARROW&&(this.ARROW.style.left=r+"px");break;case"right":o.top=t.top-1,o.left=t.right,o.left>n.scrollWidth-i-10&&(o.left=t.left-i-1)}if(e&&(o.top-=n.scrollTop),this.ARROW&&(this.ARROW.className="bx-core-popup-menu-angle"),o.top+s>n.scrollTop+n.innerHeight||o.top+s>n.scrollHeight){var a="bottom"==this.PARAMS.ATTACH_MODE?t.top-s-9:t.bottom-s+1;(a>n.scrollTop||o.top+s>n.scrollHeight)&&(o.top+s>n.scrollHeight?(o.top=Math.max(0,n.scrollHeight-s),this.toggleArrow(!1)):(o.top=a,this.ARROW&&(this.ARROW.className="bx-core-popup-menu-angle-bottom")))}o.top+o.left==0?this.Hide():(this.DIV.style.top=o.top+"px",this.DIV.style.left=o.left+"px")}},BX.CMenu.prototype.adjustToNode=function(t){this.PARAMS.parent_attach=BX(t)||this.PARAMS.parent_attach||this.PARAMS.parent,this.__adjustMenuToNode()},BX.CMenuOpener=function(t){BX.CMenuOpener.superclass.constructor.apply(this),this.PARAMS=t||{},this.setParent(this.PARAMS.parent),this.PARTS={},this.SETTINGS.drag_restrict=!0,this.defaultAction=null,this.timeout=500,this.DIV.className="bx-component-opener",this.DIV.ondblclick=BX.PreventDefault,this.PARAMS.component_id&&(this.PARAMS.transform=!!this.PARAMS.transform),this.OPENERS=[],this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar"+(this.PARAMS.transform?" bx-context-toolbar-vertical-mode":"")}})),this.PARTS.INNER=this.DIV.firstChild.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-inner"},html:'<span class="bx-context-toolbar-drag-icon"></span><span class="bx-context-toolbar-vertical-line"></span><br>'})),this.EXTRA_BUTTONS={};for(var e=0,i=0,s=this.PARAMS.menu.length;i<s;i++){var o=this.addItem(this.PARAMS.menu[i]);null!=o&&(e++,this.PARTS.INNER.appendChild(o),this.PARTS.INNER.appendChild(BX.create("BR")))}var n=e>0;if(this.PARTS.ICONS=this.PARTS.INNER.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-icons"}})),this.PARAMS.component_id&&(this.PARAMS.pin=!!this.PARAMS.pin,n&&this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-separator"}})),this.PARTS.ICON_PIN=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin"},events:{click:BX.delegate(this.__pin_btn_clicked,this)}}))),this.EXTRA_BUTTONS.components2_props){var r=this.EXTRA_BUTTONS.components2_props||{URL:"javascript:void(0)"};null==this.defaultAction&&(this.defaultAction=r.ONCLICK,this.defaultActionTitle=r.TITLE||r.TEXT),r.URL="javascript:"+BX.util.urlencode(r.ONCLICK),this.ATTACH=this.PARTS.ICONS.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button bx-context-toolbar-button-settings"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"},children:[BX.create("A",{attrs:{href:r.URL},events:{mouseover:BX.proxy(this.__msover_text,this),mouseout:BX.proxy(this.__msout_text,this),mousedown:BX.proxy(this.__msdown_text,this)},html:'<span class="bx-context-toolbar-button-icon bx-context-toolbar-settings-icon"></span>'}),BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-button-arrow"},events:{mouseover:BX.proxy(this.__msover_arrow,this),mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},html:'<span class="bx-context-toolbar-button-arrow"></span>'})]})]})),this.OPENER=this.ATTACH.firstChild.lastChild;var h=this.attachMenu(this.EXTRA_BUTTONS.components2_submenu.MENU);BX.addCustomEvent(h,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this)),BX.addCustomEvent(h,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))}if(e>1&&(this.PARTS.ICONS.appendChild(BX.create("span",{props:{className:"bx-context-toolbar-separator bx-context-toolbar-separator-switcher"}})),this.ICON_TRANSFORM=this.PARTS.ICONS.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},props:{className:"bx-context-toolbar-switcher"},events:{click:BX.delegate(this.__trf_btn_clicked,this)}}))),this.PARAMS.HINT&&(this.DIV.BXHINT=this.HINT=new BX.CHint({parent:this.DIV,hint:this.PARAMS.HINT.TEXT||"",title:this.PARAMS.HINT.TITLE||"",hide_timeout:this.timeout/2,preventHide:!1})),BX.addCustomEvent(this,"onWindowDragFinished",BX.delegate(this.__onMoveFinished,this)),BX.addCustomEvent("onDynamicModeChange",BX.delegate(this.__onDynamicModeChange,this)),BX.addCustomEvent("onTopPanelCollapse",BX.delegate(this.__onPanelCollapse,this)),BX.addCustomEvent("onMenuOpenerMoved",BX.delegate(this.checkPosition,this)),BX.addCustomEvent("onMenuOpenerUnhide",BX.delegate(this.checkPosition,this)),this.OPENERS)for(var i=0,s=this.OPENERS.length;i<s;i++)BX.addCustomEvent(this.OPENERS[i],"onOpenerMenuOpen",BX.proxy(this.__hide_hint,this))},BX.extend(BX.CMenuOpener,BX.CWindowFloat),BX.CMenuOpener.prototype.setParent=function(t){t=BX(t),t.OPENER&&t.OPENER!=this&&(t.OPENER.Close(),t.OPENER.clearHoverHoutEvents()),this.PARAMS.parent&&this.PARAMS.parent!=t&&(this.clearHoverHoutEvents(),this.PARAMS.parent.OPENER=null),this.PARAMS.parent=t,this.PARAMS.parent.OPENER=this},BX.CMenuOpener.prototype.setHoverHoutEvents=function(t,e){this.__opener_events_set||(BX.bind(this.Get(),"mouseover",t),BX.bind(this.Get(),"mouseout",e),this.__opener_events_set=!0)},BX.CMenuOpener.prototype.clearHoverHoutEvents=function(){this.Get()&&(BX.unbindAll(this.Get()),this.__opener_events_set=!1)},BX.CMenuOpener.prototype.unclosable=!0,BX.CMenuOpener.prototype.__check_intersection=function(t,e){return!(e.right<=t.left||e.left>=t.right||e.bottom<=t.top||e.top>=t.bottom)},BX.CMenuOpener.prototype.__msover_text=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-hover")},BX.CMenuOpener.prototype.__msout_text=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.ATTACH,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")},BX.CMenuOpener.prototype.__msover_arrow=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover")},BX.CMenuOpener.prototype.__msout_arrow=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.ATTACH,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")},BX.CMenuOpener.prototype.__msdown_text=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-text-active")},BX.CMenuOpener.prototype.__msdown_arrow=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.ATTACH,"bx-context-toolbar-button-arrow-active")},BX.CMenuOpener.prototype.__menu_close=function(){this._menu_open=!1,this.bx_active=!1,BX.removeClass(this.ATTACH,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active"),this.bx_hover||(BX.removeClass(this.ATTACH,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover"),this.bx_hover=!1)},BX.CMenuOpener.prototype.__menu_open=function(){this._menu_open=!0},BX.CMenuOpener.prototype.checkPosition=function(){this.isMenuVisible()||"none"==this.DIV.style.display||this==BX.proxy_context||BX.proxy_context.zIndex>this.zIndex||this.correctPosition(BX.proxy_context)},BX.CMenuOpener.prototype.correctPosition=function(t){var e=BX.pos(this.DIV),i=BX.pos(t.Get());if(this.__check_intersection(e,i)){var s=i.top-e.height;s<0&&(s=i.bottom),this.DIV.style.top=s+"px",BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),BX.onCustomEvent(this,"onMenuOpenerMoved")}},BX.CMenuOpener.prototype.restorePosition=function(){this.MOUSEOVER||this.isMenuVisible()?this.restore_pos_timeout=setTimeout(BX.proxy(this.restorePosition,this),this.timeout):(this.originalPos&&(this.DIV.style.top=this.originalPos.top+"px"),BX.removeCustomEvent(BX.proxy_context,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),this.restore_pos_timeout&&clearTimeout(this.restore_pos_timeout))},BX.CMenuOpener.prototype.Show=function(){BX.CMenuOpener.superclass.Show.apply(this,arguments),this.SetDraggable(this.PARTS.INNER.firstChild),this.DIV.style.width="auto",this.DIV.style.height="auto",this.PARAMS.pin?(this.bPosAdjusted=!0,this.bMoved=!0,this.PARAMS.top&&(this.DIV.style.top=this.PARAMS.top+"px"),this.PARAMS.left&&(this.DIV.style.left=this.PARAMS.left+"px"),this.DIV.style.display=!BX.admin.dynamic_mode||BX.admin.dynamic_mode_show_borders?"block":"none","block"==this.DIV.style.display&&setTimeout(BX.delegate(function(){BX.onCustomEvent(this,"onMenuOpenerUnhide")},this),50)):(this.DIV.style.left="-1000px",this.DIV.style.top="-1000px",this.Hide())},BX.CMenuOpener.prototype.executeDefaultAction=function(){this.defaultAction&&(BX.type.isFunction(this.defaultAction)?this.defaultAction():BX.type.isString(this.defaultAction)&&BX.evalGlobal(this.defaultAction))},BX.CMenuOpener.prototype.__onDynamicModeChange=function(t){this.DIV.style.display=t?"block":"none"},BX.CMenuOpener.prototype.__onPanelCollapse=function(t,e){this.DIV.style.top=parseInt(this.DIV.style.top)+e+"px",this.PARAMS.pin&&this.__savePosition()},BX.CMenuOpener.prototype.__onMoveFinished=function(){BX.onCustomEvent(this,"onMenuOpenerMoved"),this.bMoved=!0,this.PARAMS.pin&&this.__savePosition()},BX.CMenuOpener.prototype.__savePosition=function(){var t={};t.pin=this.PARAMS.pin,this.PARAMS.pin?(t.transform=this.PARAMS.transform,this.bMoved&&(t.left=parseInt(this.DIV.style.left),t.top=parseInt(this.DIV.style.top))):(t.top=!1,t.left=!1,t.transform=!1),BX.WindowManager.saveWindowOptions(this.PARAMS.component_id,t)},BX.CMenuOpener.prototype.__pin_btn_clicked=function(){this.Pin()},BX.CMenuOpener.prototype.Pin=function(t){null==t?this.PARAMS.pin=!this.PARAMS.pin:this.PARAMS.pin=!!t,this.PARTS.ICON_PIN.className=this.PARAMS.pin?"bx-context-toolbar-pin-fixed":"bx-context-toolbar-pin",this.__savePosition()},BX.CMenuOpener.prototype.__trf_btn_clicked=function(){this.Transform()},BX.CMenuOpener.prototype.Transform=function(t){if(null==t?this.PARAMS.transform=!this.PARAMS.transform:this.PARAMS.transform=!!t,this.bMoved)var e=BX.pos(this.DIV);this.PARAMS.transform?BX.addClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode"):BX.removeClass(this.DIV.firstChild,"bx-context-toolbar-vertical-mode"),this.bMoved?this.DIV.style.left=e.right-this.DIV.offsetWidth-(BX.browser.IsIE()&&!BX.browser.IsDoctype()?2:0)+"px":this.adjustPos(),this.__savePosition()},BX.CMenuOpener.prototype.adjustToNodeGetPos=function(){var t=BX.pos(this.PARAMS.parent),e=BX.GetWindowScrollSize(),i=this.DIV.offsetWidth;return t.left-=BX.admin.__border_dx,t.top-=BX.admin.__border_dx,t.top-=45,t.left>e.scrollWidth-i&&(t.left=e.scrollWidth-i),t},BX.CMenuOpener.prototype.addItem=function(t){if(t.TYPE)return this.EXTRA_BUTTONS[t.TYPE]=t,null;var e=new BX.CMenuOpenerItem(t);return null==this.defaultAction&&(e.item.ONCLICK?this.defaultAction=t.ONCLICK:e.item.MENU&&(this.defaultAction=BX.delegate(function(){this.Open()},e.item.OPENER)),this.defaultActionTitle=t.TITLE||t.TEXT,BX.addClass(e.Get(),"bx-content-toolbar-default")),e.item.OPENER&&(this.OPENERS[this.OPENERS.length]=e.item.OPENER),e.Get()},BX.CMenuOpener.prototype.attachMenu=function(t){var e=new BX.COpener({DIV:this.OPENER,ATTACH:this.ATTACH,MENU:t,TYPE:"click"});return this.OPENERS[this.OPENERS.length]=e,e},BX.CMenuOpener.prototype.__hide_hint=function(){this.HINT&&this.HINT.__hide_immediately()},BX.CMenuOpener.prototype.isMenuVisible=function(){for(var t=0,e=this.OPENERS.length;t<e;t++)if(this.OPENERS[t].isMenuVisible())return!0;return!1},BX.CMenuOpener.prototype.Hide=function(){this.PARAMS.pin||(this.DIV.style.display="none",BX.onCustomEvent(this,"onMenuOpenerHide"))},BX.CMenuOpener.prototype.UnHide=function(){this.DIV.style.display="block",this.bPosAdjusted||this.PARAMS.pin||(this.adjustPos(),this.bPosAdjusted=!0),null!=this.originalPos||this.bMoved||(this.originalPos=BX.pos(this.DIV)),BX.onCustomEvent(this,"onMenuOpenerUnhide")},BX.CMenuOpenerItem=function(t){this.item=t,this.item.ACTION&&!this.item.ONCLICK&&(this.item.ONCLICK=this.item.ACTION),this.DIV=BX.create("SPAN"),this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-underlay"}})),this.WRAPPER=this.DIV.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-button-wrapper"},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button",title:t.TITLE},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-inner"}})]})]}));var e=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-icon"+(this.item.ICON||this.item.ICONCLASS?" "+(this.item.ICON||this.item.ICONCLASS):"")},attrs:this.item.ICON||this.item.ICONCLASS||!this.item.SRC&&!this.item.IMAGE?{}:{style:"background: scroll transparent url("+(this.item.SRC||this.item.IMAGE)+") no-repeat center center !important;"}}),i=BX.create("SPAN",{props:{className:"bx-context-toolbar-button-text"},text:this.item.TEXT});this.item.ACTION&&!this.item.ONCLICK&&(this.item.ONCLICK=this.item.ACTION),this.bHasMenu=!!this.item.MENU,this.bHasAction=!!this.item.ONCLICK,this.bHasAction?(this.LINK=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:this.bHasMenu?BX.proxy(this.__msover_text,this):BX.proxy(this.__msover,this),mouseout:this.bHasMenu?BX.proxy(this.__msout_text,this):BX.proxy(this.__msout,this),mousedown:this.bHasMenu?BX.proxy(this.__msdown_text,this):BX.proxy(this.__msdown,this)},children:[e,i]})),this.bHasMenu&&(this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{props:{className:"bx-context-toolbar-button-arrow"},attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover_arrow,this),
mouseout:BX.proxy(this.__msout_arrow,this),mousedown:BX.proxy(this.__msdown_arrow,this)},children:[BX.create("SPAN",{props:{className:"bx-context-toolbar-button-arrow"}})]})))):this.bHasMenu&&(this.item.ONCLICK=null,this.LINK=this.LINK_MENU=this.WRAPPER.firstChild.firstChild.appendChild(BX.create("A",{attrs:{href:"javascript: void(0)"},events:{mouseover:BX.proxy(this.__msover,this),mouseout:BX.proxy(this.__msout,this),mousedown:BX.proxy(this.__msdown,this)},children:[e,i]})),this.LINK.appendChild(BX.create("SPAN",{props:{className:"bx-context-toolbar-single-button-arrow"}}))),this.bHasMenu&&(this.item.SUBMENU=new BX.CMenu({ATTACH_MODE:"bottom",ITEMS:this.item.MENU,parent:this.LINK_MENU,parent_attach:this.WRAPPER.firstChild}),this.item.OPENER=new BX.COpener({DIV:this.LINK_MENU,TYPE:"click",MENU:this.item.SUBMENU}),BX.addCustomEvent(this.item.OPENER,"onOpenerMenuOpen",BX.proxy(this.__menu_open,this)),BX.addCustomEvent(this.item.OPENER,"onOpenerMenuClose",BX.proxy(this.__menu_close,this))),this.bHasAction&&BX.bind(this.LINK,"click",BX.delegate(this.__click,this))},BX.CMenuOpenerItem.prototype.Get=function(){return this.DIV},BX.CMenuOpenerItem.prototype.__msover=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover")},BX.CMenuOpenerItem.prototype.__msout=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-active")},BX.CMenuOpenerItem.prototype.__msover_text=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover")},BX.CMenuOpenerItem.prototype.__msout_text=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-hover bx-context-toolbar-button-text-active")},BX.CMenuOpenerItem.prototype.__msover_arrow=function(){this.bx_hover=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover")},BX.CMenuOpenerItem.prototype.__msout_arrow=function(){this.bx_hover=!1,this._menu_open||BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-hover bx-context-toolbar-button-arrow-active")},BX.CMenuOpenerItem.prototype.__msdown=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active")},BX.CMenuOpenerItem.prototype.__msdown_text=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-text-active")},BX.CMenuOpenerItem.prototype.__msdown_arrow=function(){this.bx_active=!0,this._menu_open||BX.addClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-arrow-active")},BX.CMenuOpenerItem.prototype.__menu_close=function(){this._menu_open=!1,this.bx_active=!1,BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-active bx-context-toolbar-button-text-active bx-context-toolbar-button-arrow-active"),this.bx_hover||(BX.removeClass(this.LINK.parentNode.parentNode,"bx-context-toolbar-button-hover bx-context-toolbar-button-text-hover bx-context-toolbar-button-arrow-hover"),this.bx_hover=!1)},BX.CMenuOpenerItem.prototype.__menu_open=function(){this._menu_open=!0},BX.CMenuOpenerItem.prototype.__click=function(){BX.evalGlobal(this.item.ONCLICK)},BX.CPageOpener=function(t){BX.CPageOpener.superclass.constructor.apply(this,arguments),this.timeout=505,window.PAGE_EDIT_CONTROL=this},BX.extend(BX.CPageOpener,BX.CMenuOpener),BX.CPageOpener.prototype.checkPosition=function(){this!=BX.proxy_context&&this.correctPosition(BX.proxy_context)},BX.CPageOpener.prototype.correctPosition=function(t){if(!this.bPosCorrected){if("none"==this.DIV.style.display){var e=this.adjustToNodeGetPos();e.bottom=e.top+30,e.right=e.left+300}else var e=BX.pos(this.DIV);var i=BX.pos(t.Get());this.__check_intersection(e,i)&&(this.DIV.style.display="none",BX.addCustomEvent(t,"onMenuOpenerHide",BX.proxy(this.restorePosition,this)),this.bPosCorrected=!0)}},BX.CPageOpener.prototype.restorePosition=function(){BX.proxy_context&&"none"==BX.proxy_context.Get().style.display&&(this.bPosCorrected=!1,(this.PARAMS.parent.bx_over||this.PARAMS.pin)&&this.UnHide(),BX.removeCustomEvent("onMenuOpenerHide",BX.proxy(this.restorePosition,this)))},BX.CPageOpener.prototype.UnHide=function(){this.bPosCorrected||BX.CPageOpener.superclass.UnHide.apply(this,arguments)},BX.CPageOpener.prototype.Remove=function(){BX.admin.removeComponentBorder(this.PARAMS.parent),BX.userOptions.save("global","settings","page_edit_control_enable","N"),this.DIV.style.display="none"},BX.CHintSimple=function(){BX.CHintSimple.superclass.constructor.apply(this,arguments)},BX.extend(BX.CHintSimple,BX.CHint),BX.CHintSimple.prototype.Init=function(){this.DIV=document.body.appendChild(BX.create("DIV",{props:{className:"bx-tooltip-simple"},style:{display:"none"},children:[this.CONTENT=BX.create("DIV")]})),this.HINT_TITLE&&this.CONTENT.appendChild(BX.create("B",{text:this.HINT_TITLE})),this.HINT&&(this.CONTENT_TEXT=this.CONTENT.appendChild(BX.create("DIV")).appendChild(BX.create("SPAN",{html:this.HINT}))),this.PARAMS.preventHide&&(BX.bind(this.DIV,"mouseout",BX.proxy(this.Hide,this)),BX.bind(this.DIV,"mouseover",BX.proxy(this.Show,this))),this.bInited=!0},BX.adminInformer={itemsShow:3,Init:function(t){t&&(BX.adminInformer.itemsShow=t);var e=BX("admin-informer");e&&document.body.appendChild(e),BX.addCustomEvent("onTopPanelCollapse",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},Toggle:function(t){var e=BX("admin-informer");if(!e)return!1;var i=BX.pos(t);return e.style.top=parseInt(i.top)+parseInt(i.height)+7+"px",e.style.left=i.left+"px",BX.hasClass(e,"adm-informer-active")?BX.adminInformer.Hide(e):BX.adminInformer.Show(e),!1},Close:function(t){BX.adminInformer.Hide(BX("admin-informer"))},OnInnerClick:function(t){var e=t.target||t.srcElement;if("a"!=e.nodeName.toLowerCase()||BX.hasClass(e,"adm-informer-footer")){var i=BX.PreventDefault(t);return i}return!0},ToggleExtra:function(){var t=BX("adm-informer-footer");return BX.hasClass(t,"adm-informer-footer-collapsed")?this.ShowAll():this.HideExtra(),!1},ShowAll:function(){for(var t=BX("admin-informer"),e=0;e<t.children.length;e++)BX.hasClass(t.children[e],"adm-informer-item")&&"none"==t.children[e].style.display&&(t.children[e].style.display="block");var i=BX("adm-informer-footer");return void 0!==i.textContent?i.textContent=BX.message("JSADM_AI_HIDE_EXTRA"):i.innerText=BX.message("JSADM_AI_HIDE_EXTRA"),BX.removeClass(i,"adm-informer-footer-collapsed"),!1},HideExtra:function(){for(var t=BX("admin-informer"),e=0,i=BX.adminInformer.itemsShow+1;i<t.children.length;i++)BX.hasClass(t.children[i],"adm-informer-item")&&"block"==t.children[i].style.display&&(t.children[i].style.display="none",e++);var s=BX("adm-informer-footer"),o=BX.message("JSADM_AI_ALL_NOTIF")+" ("+(BX.adminInformer.itemsShow+parseInt(e))+")";return void 0!==s.textContent?s.textContent=o:s.innerText=o,BX.addClass(s,"adm-informer-footer-collapsed"),!1},Show:function(t){var e=BX("adm-header-notif-block");e&&BX.addClass(e,"adm-header-notif-block-active"),BX.onCustomEvent(t,"onBeforeAdminInformerShow"),setTimeout(BX.proxy(function(){BX.bind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer))},BX.adminInformer),0),BX.addClass(t,"adm-informer-active"),setTimeout(function(){BX.addClass(t,"adm-informer-animate")},0)},Hide:function(t){var e=BX("adm-header-notif-block");e&&BX.removeClass(e,"adm-header-notif-block-active");BX.unbind(document,"click",BX.proxy(BX.adminInformer.Close,BX.adminInformer)),BX.removeClass(t,"adm-informer-animate"),this.IsAnimationSupported()?setTimeout(function(){BX.removeClass(t,"adm-informer-active")},300):BX.removeClass(t,"adm-informer-active"),BX.onCustomEvent(t,"onAdminInformerHide")},IsAnimationSupported:function(){var t=document.body||document.documentElement;return"string"==typeof t.style.transition||("string"==typeof t.style.MozTransition||("string"==typeof t.style.OTransition||("string"==typeof t.style.WebkitTransition||"string"==typeof t.style.msTransition)))},SetItemHtml:function(t,e){var i=BX("adm-informer-item-html-"+t);return!!i&&(i.innerHTML=e,!0)},SetItemFooter:function(t,e){var i=BX("adm-informer-item-footer-"+t);return!!i&&(i.innerHTML=e,e?i.style.display="block":i.style.display="none",!0)}})}(window);
//# sourceMappingURL=maps/core_window.js.map
