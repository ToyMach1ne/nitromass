!function(){if(!BX.date){BX.date={},BX.date.format=function(e,t,a,i){function s(e,t,a,i){for(var s=f((a-t)/1e3),l=0;l<e.length;l++){var _=e[l][0],c=e[l][1],u=null;if("s"==_){if(s<60)return BX.date.format(c,t,a,i)}else if(null!=(u=/^s(\d+)/.exec(_))){if(s<u[1])return BX.date.format(c,t,a,i)}else if("i"==_){if(s<3600)return BX.date.format(c,t,a,i)}else if(null!=(u=/^i(\d+)/.exec(_))){if(s<60*u[1])return BX.date.format(c,t,a,i)}else if("H"==_){if(s<86400)return BX.date.format(c,t,a,i)}else if(null!=(u=/^H(\d+)/.exec(_))){if(s<60*u[1]*60)return BX.date.format(c,t,a,i)}else if("d"==_){if(s<2678400)return BX.date.format(c,t,a,i)}else if(null!=(u=/^d(\d+)/.exec(_))){if(s<60*u[1]*60)return BX.date.format(c,t,a,i)}else if("m"==_){if(s<31536e3)return BX.date.format(c,t,a,i)}else if(null!=(u=/^m(\d+)/.exec(_))){if(s<31*u[1]*24*60*60)return BX.date.format(c,t,a,i)}else if("today"==_){var d=n(a),p=o(a),h=r(a),m=i?new Date(Date.UTC(d,p,h,0,0,0,0)):new Date(d,p,h,0,0,0,0),D=i?new Date(Date.UTC(d,p,h+1,0,0,0,0)):new Date(d,p,h+1,0,0,0,0);if(t>=m&&t<D)return BX.date.format(c,t,a,i)}else if("yesterday"==_){d=n(a),p=o(a),h=r(a);var T=i?new Date(Date.UTC(d,p,h-1,0,0,0,0)):new Date(d,p,h-1,0,0,0,0),B=i?new Date(Date.UTC(d,p,h,0,0,0,0)):new Date(d,p,h,0,0,0,0);if(t>=T&&t<B)return BX.date.format(c,t,a,i)}else if("tommorow"==_){d=n(a),p=o(a),h=r(a);var M=i?new Date(Date.UTC(d,p,h+1,0,0,0,0)):new Date(d,p,h+1,0,0,0,0),X=i?new Date(Date.UTC(d,p,h+2,0,0,0,0)):new Date(d,p,h+2,0,0,0,0);if(t>=M&&t<X)return BX.date.format(c,t,a,i)}else if("-"==_&&s<0)return BX.date.format(c,t,a,i)}return e.length>0?BX.date.format(e.pop()[1],t,a,i):""}function n(e){return M?e.getUTCFullYear():e.getFullYear()}function r(e){return M?e.getUTCDate():e.getDate()}function o(e){return M?e.getUTCMonth():e.getMonth()}function l(e){return M?e.getUTCHours():e.getHours()}function _(e){return M?e.getUTCMinutes():e.getMinutes()}function c(e){return M?e.getUTCSeconds():e.getSeconds()}function u(e){return M?e.getUTCMilliseconds():e.getMilliseconds()}function d(e){return M?e.getUTCDay():e.getDay()}function p(e,t){return M?e.setUTCDate(t):e.setDate(t)}function h(e,t,a){return M?e.setUTCMonth(t,a):e.setMonth(t,a)}function m(e,t){var a=e<100?Math.abs(e):Math.abs(e%100),i=a%10,s="";return s=0==a?BX.message(t[0]):1==a?BX.message(t[1]):a>=10&&a<=20?BX.message(t["10_20"]):1==i?BX.message(t.MOD_1):2<=i&&i<=4?BX.message(t.MOD_2_4):BX.message(t.MOD_OTHER),s.replace(/#VALUE#/g,e)}function D(e,t){return O[e]?O[e]():t}function f(e){return e>=0?Math.floor(e):Math.ceil(e)}var T=BX.type.isDate(t)?new Date(t.getTime()):BX.type.isNumber(t)?new Date(1e3*t):new Date,B=BX.type.isDate(a)?new Date(a.getTime()):BX.type.isNumber(a)?new Date(1e3*a):new Date,M=!!i;if(BX.type.isArray(e))return s(e,T,B,M);if(!BX.type.isNotEmptyString(e))return"";var X=/\\?(sago|iago|isago|Hago|dago|mago|Yago|sdiff|idiff|Hdiff|ddiff|mdiff|Ydiff|yesterday|today|tommorow|[a-z])/gi,O={d:function(){return BX.util.str_pad_left(r(T).toString(),2,"0")},D:function(){return BX.message("DOW_"+d(T))},j:function(){return r(T)},l:function(){return BX.message("DAY_OF_WEEK_"+d(T))},N:function(){return d(T)||7},S:function(){return r(T)%10==1&&11!=r(T)?"st":r(T)%10==2&&12!=r(T)?"nd":r(T)%10==3&&13!=r(T)?"rd":"th"},w:function(){return d(T)},z:function(){var e=new Date(n(T),0,1),t=new Date(n(T),o(T),r(T));return Math.ceil((t-e)/864e5)},W:function(){var e=new Date(T.getTime()),t=(d(T)+6)%7;p(e,r(e)-t+3);var a=e.getTime();h(e,0,1),4!=d(e)&&h(e,0,1+(4-d(e)+7)%7);var i=1+Math.ceil((a-e)/6048e5);return BX.util.str_pad_left(i.toString(),2,"0")},F:function(){return BX.message("MONTH_"+(o(T)+1)+"_S")},f:function(){return BX.message("MONTH_"+(o(T)+1))},m:function(){return BX.util.str_pad_left((o(T)+1).toString(),2,"0")},M:function(){return BX.message("MON_"+(o(T)+1))},n:function(){return o(T)+1},t:function(){var e=M?new Date(Date.UTC(n(T),o(T)+1,0)):new Date(n(T),o(T)+1,0);return r(e)},L:function(){var e=n(T);return e%4==0&&e%100!=0||e%400==0?1:0},o:function(){var e=new Date(T.getTime());return p(e,r(e)-(d(T)+6)%7+3),n(e)},Y:function(){return n(T)},y:function(){return n(T).toString().slice(2)},a:function(){return l(T)>11?"pm":"am"},A:function(){return l(T)>11?"PM":"AM"},B:function(){var e=(T.getUTCHours()+1)%24+T.getUTCMinutes()/60+T.getUTCSeconds()/3600;return BX.util.str_pad_left(Math.floor(1e3*e/24).toString(),3,"0")},g:function(){return l(T)%12||12},G:function(){return l(T)},h:function(){return BX.util.str_pad_left((l(T)%12||12).toString(),2,"0")},H:function(){return BX.util.str_pad_left(l(T).toString(),2,"0")},i:function(){return BX.util.str_pad_left(_(T).toString(),2,"0")},s:function(){return BX.util.str_pad_left(c(T).toString(),2,"0")},u:function(){return BX.util.str_pad_left((1e3*u(T)).toString(),6,"0")},e:function(){return M?"UTC":""},I:function(){if(M)return 0;var e=new Date(n(T),0,1),t=Date.UTC(n(T),0,1),a=new Date(n(T),6,0),i=Date.UTC(n(T),6,0);return 0+(e-t!==a-i)},O:function(){if(M)return"+0000";var e=T.getTimezoneOffset(),t=Math.abs(e);return(e>0?"-":"+")+BX.util.str_pad_left((100*Math.floor(t/60)+t%60).toString(),4,"0")},P:function(){if(M)return"+00:00";var e=this.O();return e.substr(0,3)+":"+e.substr(3)},Z:function(){return M?0:60*-T.getTimezoneOffset()},c:function(){return"Y-m-d\\TH:i:sP".replace(X,D)},r:function(){return"D, d M Y H:i:s O".replace(X,D)},U:function(){return Math.floor(T.getTime()/1e3)},sago:function(){return m(f((B-T)/1e3),{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},sdiff:function(){return m(f((B-T)/1e3),{0:"FD_SECOND_DIFF_0",1:"FD_SECOND_DIFF_1","10_20":"FD_SECOND_DIFF_10_20",MOD_1:"FD_SECOND_DIFF_MOD_1",MOD_2_4:"FD_SECOND_DIFF_MOD_2_4",MOD_OTHER:"FD_SECOND_DIFF_MOD_OTHER"})},iago:function(){return m(f((B-T)/60/1e3),{0:"FD_MINUTE_AGO_0",1:"FD_MINUTE_AGO_1","10_20":"FD_MINUTE_AGO_10_20",MOD_1:"FD_MINUTE_AGO_MOD_1",MOD_2_4:"FD_MINUTE_AGO_MOD_2_4",MOD_OTHER:"FD_MINUTE_AGO_MOD_OTHER"})},idiff:function(){return m(f((B-T)/60/1e3),{0:"FD_MINUTE_DIFF_0",1:"FD_MINUTE_DIFF_1","10_20":"FD_MINUTE_DIFF_10_20",MOD_1:"FD_MINUTE_DIFF_MOD_1",MOD_2_4:"FD_MINUTE_DIFF_MOD_2_4",MOD_OTHER:"FD_MINUTE_DIFF_MOD_OTHER"})},isago:function(){var e=f((B-T)/60/1e3),t=m(e,{0:"FD_MINUTE_0",1:"FD_MINUTE_1","10_20":"FD_MINUTE_10_20",MOD_1:"FD_MINUTE_MOD_1",MOD_2_4:"FD_MINUTE_MOD_2_4",MOD_OTHER:"FD_MINUTE_MOD_OTHER"});t+=" ";var a=f((B-T)/1e3)-60*e;return t+=m(a,{0:"FD_SECOND_AGO_0",1:"FD_SECOND_AGO_1","10_20":"FD_SECOND_AGO_10_20",MOD_1:"FD_SECOND_AGO_MOD_1",MOD_2_4:"FD_SECOND_AGO_MOD_2_4",MOD_OTHER:"FD_SECOND_AGO_MOD_OTHER"})},Hago:function(){return m(f((B-T)/60/60/1e3),{0:"FD_HOUR_AGO_0",1:"FD_HOUR_AGO_1","10_20":"FD_HOUR_AGO_10_20",MOD_1:"FD_HOUR_AGO_MOD_1",MOD_2_4:"FD_HOUR_AGO_MOD_2_4",MOD_OTHER:"FD_HOUR_AGO_MOD_OTHER"})},Hdiff:function(){return m(f((B-T)/60/60/1e3),{0:"FD_HOUR_DIFF_0",1:"FD_HOUR_DIFF_1","10_20":"FD_HOUR_DIFF_10_20",MOD_1:"FD_HOUR_DIFF_MOD_1",MOD_2_4:"FD_HOUR_DIFF_MOD_2_4",MOD_OTHER:"FD_HOUR_DIFF_MOD_OTHER"})},yesterday:function(){return BX.message("FD_YESTERDAY")},today:function(){return BX.message("FD_TODAY")},tommorow:function(){return BX.message("FD_TOMORROW")},dago:function(){return m(f((B-T)/60/60/24/1e3),{0:"FD_DAY_AGO_0",1:"FD_DAY_AGO_1","10_20":"FD_DAY_AGO_10_20",MOD_1:"FD_DAY_AGO_MOD_1",MOD_2_4:"FD_DAY_AGO_MOD_2_4",MOD_OTHER:"FD_DAY_AGO_MOD_OTHER"})},ddiff:function(){return m(f((B-T)/60/60/24/1e3),{0:"FD_DAY_DIFF_0",1:"FD_DAY_DIFF_1","10_20":"FD_DAY_DIFF_10_20",MOD_1:"FD_DAY_DIFF_MOD_1",MOD_2_4:"FD_DAY_DIFF_MOD_2_4",MOD_OTHER:"FD_DAY_DIFF_MOD_OTHER"})},mago:function(){return m(f((B-T)/60/60/24/31/1e3),{0:"FD_MONTH_AGO_0",1:"FD_MONTH_AGO_1","10_20":"FD_MONTH_AGO_10_20",MOD_1:"FD_MONTH_AGO_MOD_1",MOD_2_4:"FD_MONTH_AGO_MOD_2_4",MOD_OTHER:"FD_MONTH_AGO_MOD_OTHER"})},mdiff:function(){return m(f((B-T)/60/60/24/31/1e3),{0:"FD_MONTH_DIFF_0",1:"FD_MONTH_DIFF_1","10_20":"FD_MONTH_DIFF_10_20",MOD_1:"FD_MONTH_DIFF_MOD_1",MOD_2_4:"FD_MONTH_DIFF_MOD_2_4",MOD_OTHER:"FD_MONTH_DIFF_MOD_OTHER"})},Yago:function(){return m(f((B-T)/60/60/24/365/1e3),{0:"FD_YEARS_AGO_0",1:"FD_YEARS_AGO_1","10_20":"FD_YEARS_AGO_10_20",MOD_1:"FD_YEARS_AGO_MOD_1",MOD_2_4:"FD_YEARS_AGO_MOD_2_4",MOD_OTHER:"FD_YEARS_AGO_MOD_OTHER"})},Ydiff:function(){return m(f((B-T)/60/60/24/365/1e3),{0:"FD_YEARS_DIFF_0",1:"FD_YEARS_DIFF_1","10_20":"FD_YEARS_DIFF_10_20",MOD_1:"FD_YEARS_DIFF_MOD_1",MOD_2_4:"FD_YEARS_DIFF_MOD_2_4",MOD_OTHER:"FD_YEARS_DIFF_MOD_OTHER"})},x:function(){return BX.date.format([["tommorow","tommorow, H:i"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")],["s","sago"],["i","iago"],["today","today, H:i"],["yesterday","yesterday, H:i"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATETIME")).replace(/:s$/g,"")]],T,B,M)},X:function(){var e=BX.date.format([["tommorow","tommorow"],["-",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))],["today","today"],["yesterday","yesterday"],["",BX.date.convertBitrixFormat(BX.message("FORMAT_DATE"))]],T,B,M),t=BX.date.format([["tommorow","H:i"],["today","H:i"],["yesterday","H:i"],["",""]],T,B,M);return t.length>0?BX.message("FD_DAY_AT_TIME").replace(/#DAY#/g,e).replace(/#TIME#/g,t):e},Q:function(){var e=f((B-T)/60/60/24/1e3);return 0==e?BX.message("FD_DAY_DIFF_1").replace(/#VALUE#/g,1):BX.date.format([["d","ddiff"],["m","mdiff"],["","Ydiff"]],T,B)}},v=!1;e[0]&&"^"==e[0]&&(v=!0,e=e.substr(1));var C=e.replace(X,D);return v&&(C=C.replace(/\s*00:00:00\s*/g,"").replace(/(\d\d:\d\d)(:00)/g,"$1").replace(/(\s*00:00\s*)(?!:)/g,"")),C},BX.date.convertBitrixFormat=function(e){return BX.type.isNotEmptyString(e)?e.replace("YYYY","Y").replace("MMMM","F").replace("MM","m").replace("M","M").replace("DD","d").replace("G","g").replace(/GG/i,"G").replace("H","h").replace(/HH/i,"H").replace("MI","i").replace("SS","s").replace("TT","A").replace("T","a"):""},BX.date.convertToUTC=function(e){return BX.type.isDate(e)?new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())):null},BX.date.getNewDate=function(e){return new Date(BX.date.getBrowserTimestamp(e))},BX.date.getBrowserTimestamp=function(e){return void 0==this._browserOffset&&(this._browserOffset=60*(new Date).getTimezoneOffset()),1e3*(parseInt(e,10)+parseInt(BX.message("SERVER_TZ_OFFSET"))+this._browserOffset)},BX.date.getServerTimestamp=function(e){return void 0==this._browserOffset&&(this._browserOffset=60*(new Date).getTimezoneOffset()),Math.round(e/1e3-(parseInt(BX.message("SERVER_TZ_OFFSET"),10)+parseInt(this._browserOffset,10)))};var e=null;BX.calendar=function(e){return BX.calendar.get().Show(e)},BX.calendar.get=function(){return e||(e=new BX.JCCalendar),e},BX.calendar.InsertDaysBack=function(e,t){if(""!=t){var a=new Date;t>0&&a.setTime(a.valueOf()-864e5*t),e.value=BX.date.format(BX.date.convertBitrixFormat(BX.message("FORMAT_DATE")),a,null,!0)}else e.value=""},BX.calendar.ValueToString=function(e,t,a){return BX.date.format(BX.date.convertBitrixFormat(BX.message(t?"FORMAT_DATETIME":"FORMAT_DATE")),e,null,!!a)},BX.CalendarPeriod={Init:function(e,t,a){""==e.value&&""==t.value||""!=a.value||(a.value="interval"),a.onchange()},ChangeDirectOpts:function(e,t){var a=BX.findChild(t,{className:"adm-select adm-calendar-direction"},!0);"week"==e?(a.options[0].text=BX.message("JSADM_CALEND_PREV_WEEK"),a.options[1].text=BX.message("JSADM_CALEND_CURR_WEEK"),a.options[2].text=BX.message("JSADM_CALEND_NEXT_WEEK")):(a.options[0].text=BX.message("JSADM_CALEND_PREV"),a.options[1].text=BX.message("JSADM_CALEND_CURR"),a.options[2].text=BX.message("JSADM_CALEND_NEXT"))},SaveAndClearInput:function(e){window.SavedPeriodValues||(window.SavedPeriodValues={}),window.SavedPeriodValues[e.id]=e.value,e.value=""},RestoreInput:function(e){window.SavedPeriodValues&&window.SavedPeriodValues[e.id]&&(e.value=window.SavedPeriodValues[e.id],delete window.SavedPeriodValues[e.id])},OnChangeP:function(e){var t=e.parentNode.parentNode,a=bShowTo=bShowDirect=bShowSeparate=!1,i=BX.findChild(t,{className:"adm-input-wrap adm-calendar-inp adm-calendar-first"}),s=BX.findChild(t,{className:"adm-input-wrap adm-calendar-second"}),n=BX.findChild(t,{className:"adm-select-wrap adm-calendar-direction"}),r=BX.findChild(t,{className:"adm-calendar-separate"}),o=BX.findChild(t,{className:"adm-input adm-calendar-from"},!0),l=BX.findChild(t,{className:"adm-input adm-calendar-to"},!0);switch(e.value){case"day":case"week":case"month":case"quarter":case"year":bShowDirect=!0,BX.CalendarPeriod.OnChangeD(n.children[0]);break;case"before":bShowTo=!0;break;case"after":a=!0;break;case"exact":a=!0;break;case"interval":a=bShowTo=bShowSeparate=!0,BX.CalendarPeriod.RestoreInput(o),BX.CalendarPeriod.RestoreInput(l);break;case"":BX.CalendarPeriod.SaveAndClearInput(o),BX.CalendarPeriod.SaveAndClearInput(l)}BX.CalendarPeriod.ChangeDirectOpts(e.value,t),i.style.display=a?"inline-block":"none",s.style.display=bShowTo?"inline-block":"none",n.style.display=bShowDirect?"inline-block":"none",r.style.display=bShowSeparate?"inline-block":"none"},OnChangeD:function(e){var t=e.parentNode.parentNode,a=BX.findChild(t,{className:"adm-input adm-calendar-from"},!0),i=BX.findChild(t,{className:"adm-input adm-calendar-to"},!0),s=BX.findChild(t,{className:"adm-select adm-calendar-period"},!0),n=0;switch(e.value){case"previous":n=-1;break;case"next":n=1;break;case"current":}var r=!1,o=!1,l=new Date,_=l.getFullYear(),c=l.getMonth(),u=l.getDate(),d=l.getDay();switch(0==d&&(d=7),s.value){case"day":r=new Date(_,c,u+n,0,0,0),o=new Date(_,c,u+n,23,59,59);break;case"week":r=new Date(_,c,u-d+1+7*n,0,0,0),o=new Date(_,c,u+(7-d)+7*n,23,59,59);break;case"month":r=new Date(_,c+n,1,0,0,0),o=new Date(_,c+1+n,0,23,59,59);break;case"quarter":var p=Math.floor(c/3)+n;r=new Date(_,3*p,1,0,0,0),o=new Date(_,3*(p+1),0,23,59,59);break;case"year":r=new Date(_+n,0,1,0,0,0),o=new Date(_+1+n,0,0,23,59,59)}var h=window[a.name+"_bTime"]?BX.message("FORMAT_DATETIME"):BX.message("FORMAT_DATE");r&&(a.value=BX.formatDate(r,h),BX.addClass(a,"adm-calendar-inp-setted")),o&&(i.value=BX.formatDate(o,h),BX.addClass(i,"adm-calendar-inp-setted"))}},BX.JCCalendar=function(){this.params={},this.bAmPm=BX.isAmPmMode(),this.popup=null,this.popup_month=null,this.popup_year=null,this.value=null,this.control_id=Math.random(),this._layers={},this._current_layer=null,this.DIV=null,this.PARTS={},this.weekStart=0,this.numRows=6,this._create=function(e){this.popup=new BX.PopupWindow("calendar_popup_"+this.control_id,e.node,{closeByEsc:!0,autoHide:!1,content:this._get_content(),zIndex:3e3,bindOptions:{forceBindPosition:!0}}),BX.bind(this.popup.popupContainer,"click",this.popup.cancelBubble)},this._auto_hide_disable=function(){BX.unbind(document,"click",BX.proxy(this._auto_hide,this))},this._auto_hide_enable=function(){BX.bind(document,"click",BX.proxy(this._auto_hide,this))},this._auto_hide=function(e){this._auto_hide_disable(),this.popup.close()},this._get_content=function(){var e=BX.delegate(function(e){e=e||window.event,this.SetDate(new Date(parseInt(BX.proxy_context.getAttribute("data-date"))),"dblclick"==e.type)},this);this.DIV=BX.create("DIV",{props:{className:"bx-calendar"},children:[BX.create("DIV",{props:{className:"bx-calendar-header"},children:[BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-left-arrow"},events:{click:BX.proxy(this._prev,this)}}),BX.create("SPAN",{props:{className:"bx-calendar-header-content"},children:[this.PARTS.MONTH=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-month"},events:{click:BX.proxy(this._menu_month,this)}}),this.PARTS.YEAR=BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-top-year"},events:{click:BX.proxy(this._menu_year,this)}})]}),BX.create("A",{attrs:{href:"javascript:void(0)"},props:{className:"bx-calendar-right-arrow"},events:{click:BX.proxy(this._next,this)}})]}),this.PARTS.WEEK=BX.create("DIV",{props:{className:"bx-calendar-name-day-wrap"}}),this.PARTS.LAYERS=BX.create("DIV",{props:{className:"bx-calendar-cell-block"},events:{click:BX.delegateEvent({className:"bx-calendar-cell"},e),dblclick:BX.delegateEvent({className:"bx-calendar-cell"},e)}}),this.PARTS.TIME=BX.create("DIV",{props:{className:"bx-calendar-set-time-wrap"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._time_actions,this))},html:'<a href="javascript:void(0)" data-action="time_show" class="bx-calendar-set-time"><i></i>'+BX.message("CAL_TIME_SET")+'</a><div class="bx-calendar-form-block"><span class="bx-calendar-form-text">'+BX.message("CAL_TIME")+'</span><span class="bx-calendar-form"><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" /><span class="bx-calendar-form-separator"></span><input type="text" class="bx-calendar-form-input" maxwidth="2" onkeyup="BX.calendar.get()._check_time()" />'+(this.bAmPm?'<span class="bx-calendar-AM-PM-block"><span class="bx-calendar-AM-PM-text" data-action="time_ampm"></span><span class="bx-calendar-form-arrow-r"><a href="javascript:void(0)" class="bx-calendar-form-arrow-top" data-action="time_ampm_up"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow-bottom" data-action="time_ampm_down"><i></i></a></span></span>':"")+'</span><a href="javascript:void(0)" data-action="time_hide" class="bx-calendar-form-close"><i></i></a></div>'}),BX.create("DIV",{props:{className:"bx-calendar-button-block"},events:{click:BX.delegateEvent({attr:"data-action"},BX.delegate(this._button_actions,this))},html:'<a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-select" data-action="submit"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("CAL_BUTTON")+'</span><span class="bx-calendar-button-right"></span></a><a href="javascript:void(0)" class="bx-calendar-button bx-calendar-button-cancel" data-action="cancel"><span class="bx-calendar-button-left"></span><span class="bx-calendar-button-text">'+BX.message("JS_CORE_WINDOW_CLOSE")+'</span><span class="bx-calendar-button-right"></span></a>'})]}),this.PARTS.TIME_INPUT_H=BX.findChild(this.PARTS.TIME,{tag:"INPUT"},!0),this.PARTS.TIME_INPUT_M=this.PARTS.TIME_INPUT_H.nextSibling.nextSibling,this.bAmPm&&(this.PARTS.TIME_AMPM=this.PARTS.TIME_INPUT_M.nextSibling.firstChild);var t=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_H,callback_change:BX.proxy(this._check_time,this),bSaveValue:!1}).Show();t.className="bx-calendar-form-arrow-l",this.PARTS.TIME_INPUT_H.parentNode.insertBefore(t,this.PARTS.TIME_INPUT_H),t=new BX.JCSpinner({input:this.PARTS.TIME_INPUT_M,callback_change:BX.proxy(this._check_time,this),bSaveValue:!0}).Show(),t.className="bx-calendar-form-arrow-r",this.PARTS.TIME_INPUT_M.nextSibling?this.PARTS.TIME_INPUT_M.parentNode.insertBefore(t,this.PARTS.TIME_INPUT_M.nextSibling):this.PARTS.TIME_INPUT_M.parentNode.appendChild(t);for(var a=0;a<7;a++)this.PARTS.WEEK.appendChild(BX.create("SPAN",{props:{className:"bx-calendar-name-day"},text:BX.message("DOW_"+(a+this.weekStart)%7)}));return this.DIV},this._time_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"time_show":BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened"),this.popup.adjustPosition();break;case"time_hide":BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened"),this.popup.adjustPosition();break;case"time_ampm":this.PARTS.TIME_AMPM.innerHTML="AM"==this.PARTS.TIME_AMPM.innerHTML?"PM":"AM";break;case"time_ampm_up":return void this._check_time({bSaveValue:!1},null,12);case"time_ampm_down":return void this._check_time({bSaveValue:!1},null,-12)}this._check_time()},this._button_actions=function(){switch(BX.proxy_context.getAttribute("data-action")){case"submit":this.SaveValue();break;case"cancel":this.Close()}},this._check_time=function(e,t,a){var i=parseInt(this.PARTS.TIME_INPUT_H.value.substring(0,5),10)||0,s=parseInt(this.PARTS.TIME_INPUT_M.value.substring(0,5),10)||0,n=!1;e&&!e.bSaveValue?this.value.setUTCHours(this.value.getUTCHours()+a):isNaN(i)||(this.bAmPm&&12!=i&&"PM"==this.PARTS.TIME_AMPM.innerHTML&&(i+=12),n=!0,this.value.setUTCHours(i)),isNaN(s)||(n=!0,this.value.setUTCMinutes(s)),n&&this.SetValue(this.value)},this._set_layer=function(){var e=parseInt(this.value.getUTCFullYear()+""+BX.util.str_pad_left(this.value.getUTCMonth()+"",2,"0"));if(this._layers[e]||(this._layers[e]=this._create_layer(),this._layers[e].BXLAYERID=e),this._current_layer){var t=new Date(this.value.valueOf());t.setUTCHours(0),t.setUTCMinutes(0);var a=BX.findChild(this._layers[e],{tag:"A",className:"bx-calendar-active"},!0),i=BX.findChild(this._layers[e],{tag:"A",attr:{"data-date":t.valueOf()+""}},!0);a&&BX.removeClass(a,"bx-calendar-active"),i&&BX.addClass(i,"bx-calendar-active"),this._replace_layer(this._current_layer,this._layers[e])}else this.PARTS.LAYERS.appendChild(this._layers[e]);this._current_layer=this._layers[e]},this._replace_layer=function(e,t){if(e!=t)if(!BX.browser.IsIE()||BX.browser.IsDoctype()){var a=e.BXLAYERID>t.BXLAYERID?1:-1,i=0;new_top=-a*e.offsetHeight,e.style.position="relative",e.style.top="0px",e.style.zIndex=5,t.style.position="absolute",t.style.top=new_top+"px",t.style.zIndex=6,this.PARTS.LAYERS.appendChild(t);var s,n=15;(s=function(){new_top+=a*n,i+=a*n,a*new_top<0?(e.style.top=i+"px",t.style.top=new_top+"px",setTimeout(s,10)):(e.parentNode.removeChild(e),t.style.top="0px",t.style.position="static",t.style.zIndex=0)})()}else this.PARTS.LAYERS.replaceChild(t,e)},this._create_layer=function(){var e=BX.create("DIV",{props:{className:"bx-calendar-layer"}}),t=new Date(this.value);if(t.setUTCHours(0),t.setUTCMinutes(0),t.setUTCDate(1),t.getUTCDay()!=this.weekStart){var a=t.getUTCDay()-this.weekStart;a+=a<0?7:0,t=new Date(t.valueOf()-864e5*a)}for(var i=this.value.getUTCMonth(),s=this.value.getUTCDate(),n="",r=0;r<this.numRows;r++){n+='<div class="bx-calendar-range'+(r==this.numRows-1?" bx-calendar-range-noline":"")+'">';for(var o=0;o<7;o++){var a=t.getUTCDate(),l=t.getUTCDay(),_="bx-calendar-cell";i!=t.getUTCMonth()?_+=" bx-calendar-date-hidden":s==a&&(_+=" bx-calendar-active"),0!=l&&6!=l||(_+=" bx-calendar-weekend"),n+='<a href="javascript:void(0)" class="'+_+'" data-date="'+t.valueOf()+'">'+a+"</a>",t=new Date(t.valueOf()+864e5)}n+="</div>"}return e.innerHTML=n,e},this._prev=function(){this.SetMonth(this.value.getUTCMonth()-1)},this._next=function(){this.SetMonth(this.value.getUTCMonth()+1)},this._menu_month_content=function(){var e,t="",a=this.value.getUTCMonth();for(e=0;e<12;e++)t+='<a href="javascript:void(0)" class="bx-calendar-month'+(e==a?" bx-calendar-month-active":"")+'" onclick="BX.calendar.get().SetMonth('+e+')">'+BX.message("MONTH_"+(e+1))+"</a>";return'<div class="bx-calendar-month-popup"><div class="bx-calendar-month-title" onclick="BX.calendar.get().popup_month.close();">'+BX.message("MONTH_"+(this.value.getUTCMonth()+1))+'</div><div class="bx-calendar-month-content">'+t+"</div></div>"},this._menu_month=function(){this.popup_month?this.popup_month.BXMONTH!=this.value.getUTCMonth()&&(this.popup_month.setContent(this._menu_month_content()),this.popup_month.BXMONTH=this.value.getUTCMonth()):(this.popup_month=BX.PopupWindowManager.create("calendar_popup_month_"+this.control_id,this.PARTS.MONTH,{content:this._menu_month_content(),zIndex:3001,closeByEsc:!0,autoHide:!0,offsetTop:-29,offsetLeft:-1}),this.popup_month.BXMONTH=this.value.getUTCMonth()),this.popup_month.show()},this._menu_year_content=function(){for(var e='<div class="bx-calendar-year-popup"><div class="bx-calendar-year-title" onclick="BX.calendar.get().popup_year.close();">'+this.value.getUTCFullYear()+'</div><div class="bx-calendar-year-content" id="bx-calendar-year-content">',t=-3;t<=3;t++)e+='<a href="javascript:void(0)" class="bx-calendar-year-number'+(0==t?" bx-calendar-year-active":"")+'" onclick="BX.calendar.get().SetYear('+(this.value.getUTCFullYear()-t)+')">'+(this.value.getUTCFullYear()-t)+"</a>";return e+='</div><input type="text" class="bx-calendar-year-input" onkeyup="if(this.value>=1900&&this.value<=2100)BX.calendar.get().SetYear(this.value);" maxlength="4" /></div>'},this._menu_year=function(){this.popup_year?this.popup_year.BXYEAR!=this.value.getUTCFullYear()&&(this.popup_year.setContent(this._menu_year_content()),this.popup_year.BXYEAR=this.value.getUTCFullYear()):(this.popup_year=BX.PopupWindowManager.create("calendar_popup_year_"+this.control_id,this.PARTS.YEAR,{content:this._menu_year_content(),zIndex:3001,closeByEsc:!0,autoHide:!0,offsetTop:-29,offsetLeft:-1}),this.popup_year.BXYEAR=this.value.getUTCFullYear()),this.popup_year.show()},this._check_date=function(e){return BX.type.isString(e)&&(e=BX.parseDate(e)),BX.type.isDate(e)||(e=new Date,this.params.bHideTime&&(e.setHours(0),e.setMinutes(0))),e=BX.date.convertToUTC(e),e.setUTCMilliseconds(0),e.setUTCSeconds(0),e.BXCHECKED=!0,e}},BX.JCCalendar.prototype.Show=function(e){if(!BX.isReady)return void BX.ready(BX.delegate(function(){this.Show(e)},this));if(e.node=e.node||document.body,BX.type.isNotEmptyString(e.node)){var t=BX(e.node);t||(t=document.getElementsByName(e.node),t&&t.length>0&&(t=t[0])),e.node=t}if(e.node){if(e.field&&BX.type.isString(e.field)){var t=BX(e.field);if(t)e.field=t;else if(e.form&&BX.type.isString(e.form)&&(e.form=document.forms[e.form]),BX.type.isDomNode(e.form)&&e.form[e.field])e.field=e.form[e.field];else{var t=document.getElementsByName(e.field);t&&t.length>0&&(t=t[0],e.field=t)}BX.type.isString(e.field)&&(e.field=BX(e.field))}var a=!this.popup||!this.popup.isShown()||this.params.node!=e.node;this.params=e,this.params.bTime="undefined"==typeof this.params.bTime||!!this.params.bTime,this.params.bHideTime="undefined"==typeof this.params.bHideTime||!!this.params.bHideTime,this.weekStart=parseInt(this.params.weekStart||this.params.weekStart||BX.message("WEEK_START")),isNaN(this.weekStart)&&(this.weekStart=1),this.popup?this.popup.setBindElement(this.params.node):this._create(this.params);var i=!!this.params.bHideTime;return this.params.value?(this.SetValue(this.params.value),i=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0):this.params.field?(this.SetValue(this.params.field.value),i=this.value.getUTCHours()<=0&&this.value.getUTCMinutes()<=0):this.params.currentTime?this.SetValue(this.params.currentTime):this.SetValue(new Date),this.params.bTime?BX.removeClass(this.DIV,"bx-calendar-time-disabled"):BX.addClass(this.DIV,"bx-calendar-time-disabled"),i?BX.removeClass(this.PARTS.TIME,"bx-calendar-set-time-opened"):BX.addClass(this.PARTS.TIME,"bx-calendar-set-time-opened"),a&&(this._auto_hide_disable(),this.popup.show(),setTimeout(BX.proxy(this._auto_hide_enable,this))),e.node.blur(),this}},BX.JCCalendar.prototype.SetDay=function(e){return this.value.setUTCDate(e),this.SetValue(this.value)},BX.JCCalendar.prototype.SetMonth=function(e){return this.popup_month&&this.popup_month.close(),this.value.setUTCMonth(e),this.SetValue(this.value)},BX.JCCalendar.prototype.SetYear=function(e){return this.popup_year&&this.popup_year.close(),this.value.setUTCFullYear(e),this.SetValue(this.value)},BX.JCCalendar.prototype.SetDate=function(e,t){return e=this._check_date(e),e.setUTCHours(this.value.getUTCHours()),e.setUTCMinutes(this.value.getUTCMinutes()),e.setUTCSeconds(this.value.getUTCSeconds()),this.params.bTime&&!t?this.SetValue(e):(this.SetValue(e),void this.SaveValue())},BX.JCCalendar.prototype.SetValue=function(e){if(this.value=e&&e.BXCHECKED?e:this._check_date(e),this.PARTS.MONTH.innerHTML=BX.message("MONTH_"+(this.value.getUTCMonth()+1)),this.PARTS.YEAR.innerHTML=this.value.getUTCFullYear(),this.params.bTime){var t=this.value.getUTCHours();this.bAmPm&&(t>=12?(this.PARTS.TIME_AMPM.innerHTML="PM",12!=t&&(t-=12)):(this.PARTS.TIME_AMPM.innerHTML="AM",0==t&&(t=12))),this.PARTS.TIME_INPUT_H.value=BX.util.str_pad_left(t.toString(),2,"0"),this.PARTS.TIME_INPUT_M.value=BX.util.str_pad_left(this.value.getUTCMinutes().toString(),2,"0")}return this._set_layer(),this},BX.JCCalendar.prototype.SaveValue=function(){this.popup_month&&this.popup_month.close(),this.popup_year&&this.popup_year.close();var e=!0;if(this.params.callback){var t=this.params.callback.apply(this,[this.value]);t===!1&&(e=!1)}if(e){if(this.params.field){var a=!!this.params.bTime&&BX.hasClass(this.PARTS.TIME,"bx-calendar-set-time-opened");this.params.field.value=BX.calendar.ValueToString(this.value,a,!0),BX.fireEvent(this.params.field,"change")}this.popup.close(),this.params.callback_after&&this.params.callback_after.apply(this,[this.value])}return this},BX.JCCalendar.prototype.Close=function(){return this.popup&&this.popup.close(),this},BX.JCSpinner=function(e){e=e||{},this.params={input:e.input||null,delta:e.delta||1,timeout_start:e.timeout_start||1e3,timeout_cont:e.timeout_cont||150,callback_start:e.callback_start||null,callback_change:e.callback_change||null,callback_finish:e.callback_finish||null,bSaveValue:"undefined"==typeof e.bSaveValue?!!e.input:!!e.bSaveValue},this.mousedown=!1,this.direction=1},BX.JCSpinner.prototype.Show=function(){return this.node=BX.create("span",{events:{mousedown:BX.delegateEvent({attr:"data-dir"},BX.delegate(this.Start,this))},html:'<a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-top" data-dir="1"><i></i></a><a href="javascript:void(0)" class="bx-calendar-form-arrow bx-calendar-form-arrow-bottom" data-dir="-1"><i></i></a>'}),this.node},BX.JCSpinner.prototype.Start=function(){this.mousedown=!0,this.direction=BX.proxy_context.getAttribute("data-dir")>0?1:-1,BX.bind(document,"mouseup",BX.proxy(this.MouseUp,this)),this.ChangeValue(!0)},BX.JCSpinner.prototype.ChangeValue=function(e){if(this.mousedown&&this.params.input){var t=parseInt(this.params.input.value,10)+this.params.delta*this.direction;this.params.bSaveValue&&(this.params.input.value=t),e&&this.params.callback_start&&this.params.callback_start(this.params,t,this.direction),this.params.callback_change&&this.params.callback_change(this.params,t,this.direction),setTimeout(BX.proxy(this.ChangeValue,this),e?this.params.timeout_start:this.params.timeout_cont)}},BX.JCSpinner.prototype.MouseUp=function(){this.mousedown=!1,BX.unbind(document,"mouseup",BX.proxy(this.MouseUp,this)),this.params.callback_finish&&this.params.callback_finish(this.params,this.params.input.value)},window.jsCalendar={Show:function(e,t,a,i,s,n,r,o){return BX.calendar({node:e,field:t,form:r,bTime:!!s,currentTime:n,bHideTimebar:!!o})},ValueToString:BX.calendar.ValueToString},BX.CClockSelector=function(e){this.params=e,this.params.popup_buttons=this.params.popup_buttons||[new BX.PopupWindowButton({text:BX.message("CAL_BUTTON"),className:"popup-window-button-create",events:{click:BX.proxy(this.setValue,this)}})],this.isReady=!1,this.WND=new BX.PopupWindow(this.params.popup_id||"clock_selector_popup",this.params.node,this.params.popup_config||{titleBar:{content:BX.create("SPAN",{text:BX.message("CAL_TIME")})},offsetLeft:-45,offsetTop:-135,autoHide:!0,closeIcon:!0,zIndex:this.params.zIndex}),this.SHOW=!1,BX.addCustomEvent(this.WND,"onPopupClose",BX.delegate(this.onPopupClose,this)),this.obClocks={},this.CLOCK_ID=this.params.clock_id||"clock_selector"},BX.CClockSelector.prototype.Show=function(){return this.isReady?(this.WND.setButtons(this.params.popup_buttons),this.WND.show(),this.SHOW=!0,window["bxClock_"+this.obClocks[this.CLOCK_ID]]&&setTimeout("window['bxClock_"+this.obClocks[this.CLOCK_ID]+"'].CalculateCoordinates()",40),!0):(BX.addCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this)),BX.ajax.get("/bitrix/tools/clock_selector.php",{start_time:this.params.start_time,clock_id:this.CLOCK_ID,sessid:BX.bitrix_sessid()},BX.delegate(this.Ready,this)))},BX.CClockSelector.prototype.onClockRegister=function(e){e[this.CLOCK_ID]&&(this.obClocks[this.CLOCK_ID]=e[this.CLOCK_ID],BX.removeCustomEvent("onClockRegister",BX.proxy(this.onClockRegister,this)))},BX.CClockSelector.prototype.Ready=function(e){this.content=this.CreateContent(e),this.WND.setContent(this.content),
this.isReady=!0,setTimeout(BX.proxy(this.Show,this),30)},BX.CClockSelector.prototype.CreateContent=function(e){return BX.create("DIV",{events:{click:BX.PreventDefault},html:'<div class="bx-tm-popup-clock">'+e+"</div>"})},BX.CClockSelector.prototype.setValue=function(e){if(this.params.callback){var t=BX.findChild(this.content,{tagName:"INPUT"},!0);this.params.callback.apply(this.params.node,[t.value])}return BX.PreventDefault(e)},BX.CClockSelector.prototype.closeWnd=function(e){return this.WND.close(),!e&&!window.event||BX.PreventDefault(e)},BX.CClockSelector.prototype.setNode=function(e){this.WND.setBindElement(e)},BX.CClockSelector.prototype.setTime=function(e){this.params.start_time=e,window["bxClock_"+this.obClocks[this.CLOCK_ID]]&&window["bxClock_"+this.obClocks[this.CLOCK_ID]].SetTime(parseInt(e/3600),parseInt(e%3600/60))},BX.CClockSelector.prototype.setCallback=function(e){this.params.callback=e},BX.CClockSelector.prototype.onPopupClose=function(){this.SHOW=!1}}}();
//# sourceMappingURL=maps/core_date.js.map
